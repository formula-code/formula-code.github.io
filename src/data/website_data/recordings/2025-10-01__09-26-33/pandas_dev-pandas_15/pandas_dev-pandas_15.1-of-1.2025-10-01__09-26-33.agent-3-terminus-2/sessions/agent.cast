{"version": 2, "width": 160, "height": 40, "timestamp": 1762994897, "env": {"SHELL": "/bin/bash", "TERM": "screen"}}
[0.0, "o", "(asv_3.8) root@7e2a5ae1b193:/workspace/repo# "]
[0.002, "i", "asciinema rec --stdin /logs/agent.cast\r"]
[0.004, "o", "asciinema rec --stdin /logs/agent.cast\r\n"]
[1.242, "o", "\u001b[?2004l\r\n"]
[2.478, "o", "\u001b[0;31masciinema: /logs/agent.cast already exists, aborting\u001b[0m\r\n"]
[3.714, "o", "\u001b[0;31masciinema: use --overwrite option if you want to overwrite existing recording\u001b[0m\r\n"]
[5.0, "o", "(asv_3.8) root@7e2a5ae1b193:/workspace/repo# "]
[5.002, "i", "clear\r"]
[5.004, "o", "clear\r\n"]
[7.478, "o", "\u001b[?2004l\r\n"]
[10.0, "o", "(asv_3.8) root@7e2a5ae1b193:/workspace/repo# "]
[10.002, "i", "ls -la\r"]
[10.004, "o", "ls -la\r\n"]
[10.139622, "o", "\u001b[?2004l\r\n"]
[10.273243, "o", "total 208\r\n"]
[10.406865, "o", "drwxr-xr-x 1 root root  4096 Oct  1 15:15 \u001b[0m\u001b[01;34m.\u001b[0m\r\n"]
[10.540486, "o", "drwxr-xr-x 1 root root  4096 Sep 15 17:10 \u001b[01;34m..\u001b[0m\r\n"]
[10.674108, "o", "drwxr-xr-x 2 root root  4096 Sep 12 21:44 \u001b[01;34m.circleci\u001b[0m\r\n"]
[10.80773, "o", "-rw-r--r-- 1 root root  1021 Sep 12 21:44 .devcontainer.json\r\n"]
[10.941351, "o", "drwxr-xr-x 1 root root  4096 Oct  1 15:15 \u001b[01;34m.git\u001b[0m\r\n"]
[11.074973, "o", "-rw-r--r-- 1 root root   229 Sep 12 21:44 .gitattributes\r\n"]
[11.208595, "o", "drwxr-xr-x 1 root root  4096 Sep 12 21:44 \u001b[01;34m.github\u001b[0m\r\n"]
[11.342216, "o", "-rw-r--r-- 1 root root  1740 Sep 12 21:44 .gitignore\r\n"]
[11.475838, "o", "-rw-r--r-- 1 root root  2322 Sep 12 21:44 .gitpod.yml\r\n"]
[11.609459, "o", "-rw-r--r-- 1 root root   761 Sep 12 21:44 .libcst.codemod.yaml\r\n"]
[11.743081, "o", "-rw-r--r-- 1 root root   109 Sep 12 21:44 .pep8speaks.yml\r\n"]
[11.876703, "o", "-rw-r--r-- 1 root root 16108 Sep 12 21:44 .pre-commit-config.yaml\r\n"]
[12.010324, "o", "-rw-r--r-- 1 root root  2284 Sep 12 21:44 AUTHORS.md\r\n"]
[12.143946, "o", "-rw-r--r-- 1 root root   372 Sep 12 21:44 CITATION.cff\r\n"]
[12.277568, "o", "-rw-r--r-- 1 root root   369 Sep 12 21:44 Dockerfile\r\n"]
[12.411189, "o", "-rw-r--r-- 1 root root  1634 Sep 12 21:44 LICENSE\r\n"]
[12.544811, "o", "drwxr-xr-x 1 root root  4096 Sep 12 21:44 \u001b[01;34mLICENSES\u001b[0m\r\n"]
[12.678432, "o", "-rw-r--r-- 1 root root  1228 Sep 12 21:44 MANIFEST.in\r\n"]
[12.812054, "o", "-rw-r--r-- 1 root root 10387 Sep 12 21:44 README.md\r\n"]
[12.945676, "o", "-rw-r--r-- 1 root root   246 Sep 12 21:44 RELEASE.md\r\n"]
[13.079297, "o", "drwxr-xr-x 1 root root  4096 Sep 12 21:44 \u001b[01;34masv_bench\u001b[0m\r\n"]
[13.212919, "o", "drwxr-xr-x 1 root root  4096 Sep 12 21:44 \u001b[01;34mci\u001b[0m\r\n"]
[13.346541, "o", "-rw-r--r-- 1 root root   256 Sep 12 21:41 codecov.yml\r\n"]
[13.480162, "o", "drwxr-xr-x 1 root root  4096 Sep 12 21:44 \u001b[01;34mdoc\u001b[0m\r\n"]
[13.613784, "o", "-rw-r--r-- 1 root root  2116 Sep 12 21:44 environment.yml\r\n"]
[13.747405, "o", "drwxr-xr-x 1 root root  4096 Sep 12 21:44 \u001b[01;34mgitpod\u001b[0m\r\n"]
[13.881027, "o", "drwxr-xr-x 1 root root  4096 Sep 13 21:55 \u001b[01;34mpandas\u001b[0m\r\n"]
[14.014649, "o", "-rw-r--r-- 1 root root 15980 Sep 12 21:44 pyproject.toml\r\n"]
[14.14827, "o", "-rw-r--r-- 1 root root  4429 Sep 12 21:44 pyright_reportGeneralTypeIssues.json\r\n"]
[14.281892, "o", "-rw-r--r-- 1 root root  1103 Sep 12 21:44 requirements-dev.txt\r\n"]
[14.415514, "o", "drwxr-xr-x 1 root root  4096 Sep 12 21:44 \u001b[01;34mscripts\u001b[0m\r\n"]
[14.549135, "o", "-rw-r--r-- 1 root root  2095 Sep 12 21:44 setup.cfg\r\n"]
[14.682757, "o", "-rwxr-xr-x 1 root root 21965 Sep 12 21:44 \u001b[01;32msetup.py\u001b[0m\r\n"]
[14.816378, "o", "drwxr-xr-x 2 root root  4096 Sep 12 21:41 \u001b[01;34mtypings\u001b[0m\r\n"]
[15.0, "o", "(asv_3.8) root@7e2a5ae1b193:/workspace/repo# "]
[15.002, "i", "ls -la asv_bench/\r"]
[15.004, "o", "ls -la asv_bench/\r\n"]
[15.83, "o", "\u001b[?2004l\r\n"]
[16.654, "o", "total 24\r\n"]
[17.478, "o", "drwxr-xr-x 1 root root 4096 Sep 12 21:44 \u001b[0m\u001b[01;34m.\u001b[0m\r\n"]
[18.302, "o", "drwxr-xr-x 1 root root 4096 Oct  1 15:15 \u001b[01;34m..\u001b[0m\r\n"]
[19.126, "o", "-rw-r--r-- 1 root root 5217 Sep 12 21:44 asv.conf.json\r\n"]
[20.0, "o", "(asv_3.8) root@7e2a5ae1b193:/workspace/repo# "]
[20.002, "i", "ls -la asv_bench/benchmarks/\r"]
[20.004, "o", "ls -la asv_bench/benchmarks/\r\n"]
[20.113478, "o", "\u001b[?2004l\r\n"]
[20.220957, "o", "total 360\r\n"]
[20.328435, "o", "drwxr-xr-x 1 root root  4096 Sep 12 21:44 \u001b[0m\u001b[01;34m.\u001b[0m\r\n"]
[20.435913, "o", "drwxr-xr-x 1 root root  4096 Sep 12 21:44 \u001b[01;34m..\u001b[0m\r\n"]
[20.543391, "o", "-rw-r--r-- 1 root root    25 Sep 12 21:41 __init__.py\r\n"]
[20.65087, "o", "-rw-r--r-- 1 root root  5557 Sep 12 21:44 algorithms.py\r\n"]
[20.758348, "o", "drwxr-xr-x 1 root root  4096 Sep 12 21:44 \u001b[01;34malgos\u001b[0m\r\n"]
[20.865826, "o", "-rw-r--r-- 1 root root 13432 Sep 12 21:44 arithmetic.py\r\n"]
[20.973304, "o", "-rw-r--r-- 1 root root  4190 Sep 12 21:44 array.py\r\n"]
[21.080783, "o", "-rw-r--r-- 1 root root  1414 Sep 12 21:41 attrs_caching.py\r\n"]
[21.188261, "o", "-rw-r--r-- 1 root root   739 Sep 12 21:41 boolean.py\r\n"]
[21.295739, "o", "-rw-r--r-- 1 root root  9877 Sep 12 21:44 categoricals.py\r\n"]
[21.403217, "o", "-rw-r--r-- 1 root root  3468 Sep 12 21:44 ctors.py\r\n"]
[21.510696, "o", "-rw-r--r-- 1 root root  3494 Sep 12 21:44 dtypes.py\r\n"]
[21.618174, "o", "-rw-r--r-- 1 root root  1986 Sep 12 21:44 eval.py\r\n"]
[21.725652, "o", "-rw-r--r-- 1 root root   379 Sep 12 21:41 finalize.py\r\n"]
[21.83313, "o", "-rw-r--r-- 1 root root  5114 Sep 12 21:44 frame_ctor.py\r\n"]
[21.940609, "o", "-rw-r--r-- 1 root root 20537 Sep 12 21:44 frame_methods.py\r\n"]
[22.048087, "o", "-rw-r--r-- 1 root root  8068 Sep 12 21:44 gil.py\r\n"]
[22.155565, "o", "-rw-r--r-- 1 root root 29113 Sep 12 21:44 groupby.py\r\n"]
[22.263043, "o", "-rw-r--r-- 1 root root  2393 Sep 12 21:41 hash_functions.py\r\n"]
[22.370522, "o", "-rw-r--r-- 1 root root  2268 Sep 12 21:44 index_cached_properties.py\r\n"]
[22.478, "o", "-rw-r--r-- 1 root root  6823 Sep 12 21:44 index_object.py\r\n"]
[22.585478, "o", "-rw-r--r-- 1 root root 16039 Sep 12 21:44 indexing.py\r\n"]
[22.692957, "o", "-rw-r--r-- 1 root root  6170 Sep 12 21:44 indexing_engines.py\r\n"]
[22.800435, "o", "-rw-r--r-- 1 root root  9246 Sep 12 21:44 inference.py\r\n"]
[22.907913, "o", "drwxr-xr-x 1 root root  4096 Sep 12 21:44 \u001b[01;34mio\u001b[0m\r\n"]
[23.015391, "o", "-rw-r--r-- 1 root root 16468 Sep 12 21:44 join_merge.py\r\n"]
[23.12287, "o", "-rw-r--r-- 1 root root  2394 Sep 12 21:44 libs.py\r\n"]
[23.230348, "o", "-rw-r--r-- 1 root root 11365 Sep 12 21:44 multiindex_object.py\r\n"]
[23.337826, "o", "-rw-r--r-- 1 root root   623 Sep 12 21:44 package.py\r\n"]
[23.445304, "o", "-rw-r--r-- 1 root root  1739 Sep 12 21:44 pandas_vb_common.py\r\n"]
[23.552783, "o", "-rw-r--r-- 1 root root  2908 Sep 12 21:44 period.py\r\n"]
[23.660261, "o", "-rw-r--r-- 1 root root  4554 Sep 12 21:41 plotting.py\r\n"]
[23.767739, "o", "-rw-r--r-- 1 root root  5328 Sep 12 21:44 reindex.py\r\n"]
[23.875217, "o", "-rw-r--r-- 1 root root  2107 Sep 12 21:44 replace.py\r\n"]
[23.982696, "o", "-rw-r--r-- 1 root root  9446 Sep 12 21:44 reshape.py\r\n"]
[24.090174, "o", "-rw-r--r-- 1 root root 11474 Sep 12 21:44 rolling.py\r\n"]
[24.197652, "o", "-rw-r--r-- 1 root root  9599 Sep 12 21:44 series_methods.py\r\n"]
[24.30513, "o", "-rw-r--r-- 1 root root  6815 Sep 12 21:44 sparse.py\r\n"]
[24.412609, "o", "-rw-r--r-- 1 root root  3748 Sep 12 21:44 stat_ops.py\r\n"]
[24.520087, "o", "-rw-r--r-- 1 root root  1818 Sep 12 21:44 strftime.py\r\n"]
[24.627565, "o", "-rw-r--r-- 1 root root  7777 Sep 12 21:44 strings.py\r\n"]
[24.735043, "o", "-rw-r--r-- 1 root root  1528 Sep 12 21:41 timedelta.py\r\n"]
[24.842522, "o", "-rw-r--r-- 1 root root  8550 Sep 12 21:44 timeseries.py\r\n"]
[25.0, "o", "(asv_3.8) root@7e2a5ae1b193:/workspace/repo# "]
[25.002, "i", "find . -name \"asv_benchmarks.txt\" -type f\r"]
[25.004, "o", "find . -name \"asv_benchmarks.txt\" -type f\r\n"]
[25.006, "o", "\u001b[?2004l\r\n"]
[30.0, "o", "(asv_3.8) root@7e2a5ae1b193:/workspace/repo# "]
[30.002, "i", "head -50 asv_bench/benchmarks/rolling.py\r"]
[30.004, "o", "head -50 asv_bench/benchmarks/rolling.py\r\n"]
[30.102941, "o", "\u001b[?2004l\r\n"]
[30.199882, "o", "import warnings\r\n"]
[30.296824, "o", "\r\n"]
[30.393765, "o", "import numpy as np\r\n"]
[30.490706, "o", "\r\n"]
[30.587647, "o", "import pandas as pd\r\n"]
[30.684588, "o", "\r\n"]
[30.781529, "o", "\r\n"]
[30.878471, "o", "class Methods:\r\n"]
[30.975412, "o", "    params = (\r\n"]
[31.072353, "o", "        [\"DataFrame\", \"Series\"],\r\n"]
[31.169294, "o", "        [(\"rolling\", {\"window\": 10}), (\"rolling\", {\"window\": 1000}), (\"expanding\", {})],\r\n"]
[31.266235, "o", "        [\"int\", \"float\"],\r\n"]
[31.363176, "o", "        [\"median\", \"mean\", \"max\", \"min\", \"std\", \"count\", \"skew\", \"kurt\", \"sum\", \"sem\"],\r\n"]
[31.460118, "o", "    )\r\n"]
[31.557059, "o", "    param_names = [\"constructor\", \"window_kwargs\", \"dtype\", \"method\"]\r\n"]
[31.654, "o", "\r\n"]
[31.750941, "o", "    def setup(self, constructor, window_kwargs, dtype, method):\r\n"]
[31.847882, "o", "        N = 10**5\r\n"]
[31.944824, "o", "        window, kwargs = window_kwargs\r\n"]
[32.041765, "o", "        arr = (100 * np.random.random(N)).astype(dtype)\r\n"]
[32.138706, "o", "        obj = getattr(pd, constructor)(arr)\r\n"]
[32.235647, "o", "        self.window = getattr(obj, window)(**kwargs)\r\n"]
[32.332588, "o", "\r\n"]
[32.429529, "o", "    def time_method(self, constructor, window_kwargs, dtype, method):\r\n"]
[32.526471, "o", "        getattr(self.window, method)()\r\n"]
[32.623412, "o", "\r\n"]
[32.720353, "o", "    def peakmem_method(self, constructor, window_kwargs, dtype, method):\r\n"]
[32.817294, "o", "        getattr(self.window, method)()\r\n"]
[32.914235, "o", "\r\n"]
[33.011176, "o", "\r\n"]
[33.108118, "o", "class Apply:\r\n"]
[33.205059, "o", "    params = (\r\n"]
[33.302, "o", "        [\"DataFrame\", \"Series\"],\r\n"]
[33.398941, "o", "        [3, 300],\r\n"]
[33.495882, "o", "        [\"int\", \"float\"],\r\n"]
[33.592824, "o", "        [sum, np.sum, lambda x: np.sum(x) + 5],\r\n"]
[33.689765, "o", "        [True, False],\r\n"]
[33.786706, "o", "    )\r\n"]
[33.883647, "o", "    param_names = [\"constructor\", \"window\", \"dtype\", \"function\", \"raw\"]\r\n"]
[33.980588, "o", "\r\n"]
[34.077529, "o", "    def setup(self, constructor, window, dtype, function, raw):\r\n"]
[34.174471, "o", "        N = 10**3\r\n"]
[34.271412, "o", "        arr = (100 * np.random.random(N)).astype(dtype)\r\n"]
[34.368353, "o", "        self.roll = getattr(pd, constructor)(arr).rolling(window)\r\n"]
[34.465294, "o", "\r\n"]
[34.562235, "o", "    def time_rolling(self, constructor, window, dtype, function, raw):\r\n"]
[34.659176, "o", "        self.roll.apply(function, raw=raw)\r\n"]
[34.756118, "o", "\r\n"]
[34.853059, "o", "\r\n"]
[35.0, "o", "(asv_3.8) root@7e2a5ae1b193:/workspace/repo# "]
[35.002, "i", "grep -i groupby asv_bench/benchmarks/rolling.py\r"]
[35.004, "o", "grep -i groupby asv_bench/benchmarks/rolling.py\r\n"]
[35.359143, "o", "\u001b[?2004l\r\n"]
[35.712286, "o", "            pd.DataFrame({\"A\": groups, \"B\": arr}).\u001b[01;31m\u001b[Kgroupby\u001b[m\u001b[K(\"A\"), window\r\n"]
[36.065429, "o", "    def time_\u001b[01;31m\u001b[Kgroupby\u001b[m\u001b[K(self, kwargs_window, method, pairwise):\r\n"]
[36.418571, "o", "class \u001b[01;31m\u001b[KGroupby\u001b[m\u001b[K:\r\n"]
[36.771714, "o", "        self.\u001b[01;31m\u001b[Kgroupby\u001b[m\u001b[K_window = getattr(df.\u001b[01;31m\u001b[Kgroupby\u001b[m\u001b[K(\"A\"), window)(**kwargs)\r\n"]
[37.124857, "o", "        getattr(self.\u001b[01;31m\u001b[Kgroupby\u001b[m\u001b[K_window, method)()\r\n"]
[37.478, "o", "class \u001b[01;31m\u001b[KGroupby\u001b[m\u001b[KLargeGroups:\r\n"]
[37.831143, "o", "        self.df.\u001b[01;31m\u001b[Kgroupby\u001b[m\u001b[K(\"A\").rolling(3).mean()\r\n"]
[38.184286, "o", "class \u001b[01;31m\u001b[KGroupby\u001b[m\u001b[KEWM:\r\n"]
[38.537429, "o", "        self.gb_ewm = df.\u001b[01;31m\u001b[Kgroupby\u001b[m\u001b[K(\"A\").ewm(com=1.0)\r\n"]
[38.890571, "o", "    def time_\u001b[01;31m\u001b[Kgroupby\u001b[m\u001b[K_method(self, method):\r\n"]
[39.243714, "o", "class \u001b[01;31m\u001b[KGroupby\u001b[m\u001b[KEWMEngine:\r\n"]
[39.596857, "o", "        self.gb_ewm = df.\u001b[01;31m\u001b[Kgroupby\u001b[m\u001b[K(\"A\").ewm(com=1.0)\r\n"]
[40.0, "o", "(asv_3.8) root@7e2a5ae1b193:/workspace/repo# "]
[40.002, "i", "grep -A 20 \"^class Groupby:\" asv_bench/benchmarks/rolling.py\r"]
[40.004, "o", "grep -A 20 \"^class Groupby:\" asv_bench/benchmarks/rolling.py\r\n"]
[40.230727, "o", "\u001b[?2004l\r\n"]
[40.455455, "o", "\u001b[01;31m\u001b[Kclass Groupby:\u001b[m\u001b[K\r\n"]
[40.680182, "o", "    params = (\r\n"]
[40.904909, "o", "        [\"sum\", \"median\", \"mean\", \"max\", \"min\", \"kurt\", \"sum\"],\r\n"]
[41.129636, "o", "        [\r\n"]
[41.354364, "o", "            (\"rolling\", {\"window\": 2}),\r\n"]
[41.579091, "o", "            (\"rolling\", {\"window\": \"30s\"}),\r\n"]
[41.803818, "o", "            (\"expanding\", {}),\r\n"]
[42.028545, "o", "        ],\r\n"]
[42.253273, "o", "    )\r\n"]
[42.478, "o", "\r\n"]
[42.702727, "o", "    def setup(self, method, window_kwargs):\r\n"]
[42.927455, "o", "        N = 1000\r\n"]
[43.152182, "o", "        window, kwargs = window_kwargs\r\n"]
[43.376909, "o", "        df = pd.DataFrame(\r\n"]
[43.601636, "o", "            {\r\n"]
[43.826364, "o", "                \"A\": [str(i) for i in range(N)] * 10,\r\n"]
[44.051091, "o", "                \"B\": list(range(N)) * 10,\r\n"]
[44.275818, "o", "            }\r\n"]
[44.500545, "o", "        )\r\n"]
[44.725273, "o", "        if isinstance(kwargs.get(\"window\", None), str):\r\n"]
[45.0, "o", "(asv_3.8) root@7e2a5ae1b193:/workspace/repo# "]
[45.002, "i", "grep -A 30 \"^class Groupby:\" asv_bench/benchmarks/rolling.py\r"]
[45.004, "o", "grep -A 30 \"^class Groupby:\" asv_bench/benchmarks/rolling.py\r\n"]
[45.1605, "o", "\u001b[?2004l\r\n"]
[45.315, "o", "\u001b[01;31m\u001b[Kclass Groupby:\u001b[m\u001b[K\r\n"]
[45.4695, "o", "    params = (\r\n"]
[45.624, "o", "        [\"sum\", \"median\", \"mean\", \"max\", \"min\", \"kurt\", \"sum\"],\r\n"]
[45.7785, "o", "        [\r\n"]
[45.933, "o", "            (\"rolling\", {\"window\": 2}),\r\n"]
[46.0875, "o", "            (\"rolling\", {\"window\": \"30s\"}),\r\n"]
[46.242, "o", "            (\"expanding\", {}),\r\n"]
[46.3965, "o", "        ],\r\n"]
[46.551, "o", "    )\r\n"]
[46.7055, "o", "\r\n"]
[46.86, "o", "    def setup(self, method, window_kwargs):\r\n"]
[47.0145, "o", "        N = 1000\r\n"]
[47.169, "o", "        window, kwargs = window_kwargs\r\n"]
[47.3235, "o", "        df = pd.DataFrame(\r\n"]
[47.478, "o", "            {\r\n"]
[47.6325, "o", "                \"A\": [str(i) for i in range(N)] * 10,\r\n"]
[47.787, "o", "                \"B\": list(range(N)) * 10,\r\n"]
[47.9415, "o", "            }\r\n"]
[48.096, "o", "        )\r\n"]
[48.2505, "o", "        if isinstance(kwargs.get(\"window\", None), str):\r\n"]
[48.405, "o", "            df.index = pd.date_range(start=\"1900-01-01\", freq=\"1min\", periods=N * 10)\r\n"]
[48.5595, "o", "        self.groupby_window = getattr(df.groupby(\"A\"), window)(**kwargs)\r\n"]
[48.714, "o", "\r\n"]
[48.8685, "o", "    def time_method(self, method, window_kwargs):\r\n"]
[49.023, "o", "        getattr(self.groupby_window, method)()\r\n"]
[49.1775, "o", "\r\n"]
[49.332, "o", "\r\n"]
[49.4865, "o", "class GroupbyLargeGroups:\r\n"]
[49.641, "o", "    # https://github.com/pandas-dev/pandas/issues/38038\r\n"]
[49.7955, "o", "    # specific example where the rolling operation on a larger dataframe\r\n"]
[50.0, "o", "(asv_3.8) root@7e2a5ae1b193:/workspace/repo# "]
[50.002, "i", "grep -A 25 \"^class GroupbyLargeGroups:\" asv_bench/benchmarks/rolling.py\r"]
[50.004, "o", "grep -A 25 \"^class GroupbyLargeGroups:\" asv_bench/benchmarks/rolling.py\r\n"]
[50.189111, "o", "\u001b[?2004l\r\n"]
[50.372222, "o", "\u001b[01;31m\u001b[Kclass GroupbyLargeGroups:\u001b[m\u001b[K\r\n"]
[50.555333, "o", "    # https://github.com/pandas-dev/pandas/issues/38038\r\n"]
[50.738444, "o", "    # specific example where the rolling operation on a larger dataframe\r\n"]
[50.921556, "o", "    # is relatively cheap (few but large groups), but creation of\r\n"]
[51.104667, "o", "    # MultiIndex of result can be expensive\r\n"]
[51.287778, "o", "\r\n"]
[51.470889, "o", "    def setup(self):\r\n"]
[51.654, "o", "        N = 100000\r\n"]
[51.837111, "o", "        self.df = pd.DataFrame({\"A\": [1, 2] * (N // 2), \"B\": np.random.randn(N)})\r\n"]
[52.020222, "o", "\r\n"]
[52.203333, "o", "    def time_rolling_multiindex_creation(self):\r\n"]
[52.386444, "o", "        self.df.groupby(\"A\").rolling(3).mean()\r\n"]
[52.569556, "o", "\r\n"]
[52.752667, "o", "\r\n"]
[52.935778, "o", "class GroupbyEWM:\r\n"]
[53.118889, "o", "    params = [\"var\", \"std\", \"cov\", \"corr\"]\r\n"]
[53.302, "o", "    param_names = [\"method\"]\r\n"]
[53.485111, "o", "\r\n"]
[53.668222, "o", "    def setup(self, method):\r\n"]
[53.851333, "o", "        df = pd.DataFrame({\"A\": range(50), \"B\": range(50)})\r\n"]
[54.034444, "o", "        self.gb_ewm = df.groupby(\"A\").ewm(com=1.0)\r\n"]
[54.217556, "o", "\r\n"]
[54.400667, "o", "    def time_groupby_method(self, method):\r\n"]
[54.583778, "o", "        getattr(self.gb_ewm, method)()\r\n"]
[54.766889, "o", "\r\n"]
[55.0, "o", "(asv_3.8) root@7e2a5ae1b193:/workspace/repo# "]
[55.002, "i", "cd asv_bench\r"]
[55.004, "o", "cd asv_bench\r\n"]
[55.006, "o", "\u001b[?2004l\r\n"]
[60.0, "o", "(asv_3.8) root@7e2a5ae1b193:/workspace/repo/asv_bench# "]
[60.002, "i", "asv run --python=same --bench=\"rolling.Groupby.*\"\r"]
[60.004, "o", "asv run --python=same --bench=\"rolling.Groupby.*\"\r\n"]
[60.132769, "o", "\u001b[?2004l\r\n"]
[60.259538, "o", "\u00b7 \u001b[0;32mDiscovering benchmarks\u001b[0m\r\n"]
[60.386308, "o", "\u00b7 \u001b[0;32mRunning 4 total benchmarks (1 commits * 1 environments * 4 benchmarks)\u001b[0m\r\n"]
[60.513077, "o", "[ 0.00%] \u00b7\u00b7 \u001b[0;34mBenchmarking existing-py_opt_conda_envs_asv_3.8_bin_python\u001b[0m\r\n"]
[60.639846, "o", "[12.50%] \u00b7\u00b7\u00b7 \u001b[0;39mRunning (rolling.Groupby.time_method--)\u001b[0m....\r\n"]
[60.766615, "o", "[62.50%] \u00b7\u00b7\u00b7 \u001b[0;39mrolling.Groupby.time_method\u001b[0m                                                                                                                     ok\r\n"]
[60.893385, "o", "[62.50%] \u00b7\u00b7\u00b7 \u001b[0;39m=========== ============================ ================================ ===================\u001b[0m\r\n"]
[61.020154, "o", "             --                                                param2                                     \r\n"]
[61.146923, "o", "             ----------- ---------------------------------------------------------------------------------\r\n"]
[61.273692, "o", "                param1    ('rolling', {'window': 2})   ('rolling', {'window': '30s'})   ('expanding', {}) \r\n"]
[61.400462, "o", "             =========== ============================ ================================ ===================\r\n"]
[61.527231, "o", "              'sum' (0)           40.2\u00b10.4ms                     16.3\u00b10.5ms                 14.9\u00b10.2ms    \r\n"]
[61.654, "o", "                median            41.6\u00b10.4ms                     19.5\u00b10.4ms                 17.6\u00b10.2ms    \r\n"]
[61.780769, "o", "                 mean             39.6\u00b10.4ms                     16.0\u00b10.2ms                 15.0\u00b10.1ms    \r\n"]
[61.907538, "o", "                 max              39.6\u00b10.1ms                     16.0\u00b10.3ms                 15.0\u00b10.2ms    \r\n"]
[62.034308, "o", "                 min              39.5\u00b10.4ms                     16.6\u00b10.4ms                 15.3\u00b10.3ms    \r\n"]
[62.161077, "o", "                 kurt             40.2\u00b10.4ms                     16.0\u00b10.2ms                 15.0\u00b10.2ms    \r\n"]
[62.287846, "o", "              'sum' (1)           40.0\u00b10.4ms                     16.4\u00b10.3ms                 14.9\u00b10.3ms    \r\n"]
[62.414615, "o", "             =========== ============================ ================================ ===================\r\n"]
[62.541385, "o", "\r\n"]
[62.668154, "o", "[75.00%] \u00b7\u00b7\u00b7 \u001b[0;39mrolling.GroupbyEWM.time_groupby_method\u001b[0m                                                                                                          ok\r\n"]
[62.794923, "o", "[75.00%] \u00b7\u00b7\u00b7 \u001b[0;39m======== =============\u001b[0m\r\n"]
[62.921692, "o", "              method               \r\n"]
[63.048462, "o", "             -------- -------------\r\n"]
[63.175231, "o", "               var     1.03\u00b10.05ms \r\n"]
[63.302, "o", "               std       1.20\u00b10ms  \r\n"]
[63.428769, "o", "               cov      3.80\u00b10.3ms \r\n"]
[63.555538, "o", "               corr     4.15\u00b10.3ms \r\n"]
[63.682308, "o", "             ======== =============\r\n"]
[63.809077, "o", "\r\n"]
[63.935846, "o", "[87.50%] \u00b7\u00b7\u00b7 \u001b[0;39mrolling.GroupbyEWMEngine.time_groupby_mean\u001b[0m                                                                                                      ok\r\n"]
[64.062615, "o", "[87.50%] \u00b7\u00b7\u00b7 \u001b[0;39m======== =============\u001b[0m\r\n"]
[64.189385, "o", "              engine               \r\n"]
[64.316154, "o", "             -------- -------------\r\n"]
[64.442923, "o", "              cython   1.06\u00b10.02ms \r\n"]
[64.569692, "o", "              numba     1.51\u00b10.2ms \r\n"]
[64.696462, "o", "             ======== =============\r\n"]
[64.823231, "o", "\r\n"]
[65.0, "o", "(asv_3.8) root@7e2a5ae1b193:/workspace/repo/asv_bench# "]
[65.002, "i", "asv profile --python=same rolling.Groupby.time_method\r"]
[65.004, "o", "asv profile --python=same rolling.Groupby.time_method\r\n"]
[66.654, "o", "\u001b[?2004l\r\n"]
[68.302, "o", "\u00b7 \u001b[0;32mDiscovering benchmarks\u001b[0m\r\n"]
[70.0, "o", "(asv_3.8) root@7e2a5ae1b193:/workspace/repo/asv_bench# "]
[70.002, "i", "asv profile --python=same --config=asv.conf.json \"rolling.Groupby.time_method('sum', ('rolling', {'window'\r"]
[70.004, "o", "asv profile --python=same --config=asv.conf.json \"rolling.Groupby.time_method('sum', ('rolling', {'window'\r\n"]
[71.242, "o", "': 2}))\"\r\n"]
[72.478, "o", "\u001b[?2004l\r\n"]
[73.714, "o", "\u00b7 \u001b[0;32mDiscovering benchmarks\u001b[0m\r\n"]
[75.0, "o", "(asv_3.8) root@7e2a5ae1b193:/workspace/repo/asv_bench# "]
[75.002, "i", "cd ..\r"]
[75.004, "o", "cd ..\r\n"]
[75.006, "o", "\u001b[?2004l\r\n"]
[80.0, "o", "(asv_3.8) root@7e2a5ae1b193:/workspace/repo# "]
[80.002, "i", "ls -la pandas/\r"]
[80.004, "o", "ls -la pandas/\r\n"]
[80.220957, "o", "\u001b[?2004l\r\n"]
[80.435913, "o", "total 180\r\n"]
[80.65087, "o", "drwxr-xr-x 1 root root  4096 Sep 13 21:55 \u001b[0m\u001b[01;34m.\u001b[0m\r\n"]
[80.865826, "o", "drwxr-xr-x 1 root root  4096 Oct  1 15:15 \u001b[01;34m..\u001b[0m\r\n"]
[81.080783, "o", "-rw-r--r-- 1 root root  8025 Sep 12 21:44 __init__.py\r\n"]
[81.295739, "o", "drwxr-xr-x 2 root root  4096 Sep 13 21:55 \u001b[01;34m__pycache__\u001b[0m\r\n"]
[81.510696, "o", "drwxr-xr-x 1 root root  4096 Sep 13 21:55 \u001b[01;34m_config\u001b[0m\r\n"]
[81.725652, "o", "drwxr-xr-x 1 root root  4096 Sep 13 21:55 \u001b[01;34m_libs\u001b[0m\r\n"]
[81.940609, "o", "drwxr-xr-x 1 root root  4096 Sep 13 21:55 \u001b[01;34m_testing\u001b[0m\r\n"]
[82.155565, "o", "-rw-r--r-- 1 root root 10695 Sep 12 21:44 _typing.py\r\n"]
[82.370522, "o", "-rw-r--r-- 1 root root 23606 Sep 12 21:44 _version.py\r\n"]
[82.585478, "o", "drwxr-xr-x 1 root root  4096 Sep 13 21:55 \u001b[01;34mapi\u001b[0m\r\n"]
[82.800435, "o", "drwxr-xr-x 1 root root  4096 Sep 13 21:55 \u001b[01;34marrays\u001b[0m\r\n"]
[83.015391, "o", "drwxr-xr-x 1 root root  4096 Sep 13 21:55 \u001b[01;34mcompat\u001b[0m\r\n"]
[83.230348, "o", "-rw-r--r-- 1 root root 48744 Sep 12 21:44 conftest.py\r\n"]
[83.445304, "o", "drwxr-xr-x 1 root root  4096 Sep 13 21:55 \u001b[01;34mcore\u001b[0m\r\n"]
[83.660261, "o", "drwxr-xr-x 1 root root  4096 Sep 13 21:55 \u001b[01;34merrors\u001b[0m\r\n"]
[83.875217, "o", "drwxr-xr-x 1 root root  4096 Sep 13 21:55 \u001b[01;34mio\u001b[0m\r\n"]
[84.090174, "o", "drwxr-xr-x 1 root root  4096 Sep 13 21:55 \u001b[01;34mplotting\u001b[0m\r\n"]
[84.30513, "o", "-rw-r--r-- 1 root root   313 Sep 12 21:44 testing.py\r\n"]
[84.520087, "o", "drwxr-xr-x 1 root root  4096 Sep 12 21:44 \u001b[01;34mtests\u001b[0m\r\n"]
[84.735043, "o", "drwxr-xr-x 1 root root  4096 Sep 13 21:55 \u001b[01;34mtseries\u001b[0m\r\n"]
[85.0, "o", "(asv_3.8) root@7e2a5ae1b193:/workspace/repo# "]
[85.002, "i", "ls -la pandas/core/\r"]
[85.004, "o", "ls -la pandas/core/\r\n"]
[85.115867, "o", "\u001b[?2004l\r\n"]
[85.225733, "o", "total 1652\r\n"]
[85.3356, "o", "drwxr-xr-x 1 root root   4096 Sep 13 21:55 \u001b[0m\u001b[01;34m.\u001b[0m\r\n"]
[85.445467, "o", "drwxr-xr-x 1 root root   4096 Sep 13 21:55 \u001b[01;34m..\u001b[0m\r\n"]
[85.555333, "o", "-rw-r--r-- 1 root root      0 Sep 12 21:41 __init__.py\r\n"]
[85.6652, "o", "drwxr-xr-x 2 root root   4096 Sep 13 21:55 \u001b[01;34m__pycache__\u001b[0m\r\n"]
[85.775067, "o", "drwxr-xr-x 1 root root   4096 Sep 13 21:55 \u001b[01;34m_numba\u001b[0m\r\n"]
[85.884933, "o", "-rw-r--r-- 1 root root   9963 Sep 12 21:44 accessor.py\r\n"]
[85.9948, "o", "-rw-r--r-- 1 root root  59086 Sep 12 21:44 algorithms.py\r\n"]
[86.104667, "o", "-rw-r--r-- 1 root root   2943 Sep 12 21:44 api.py\r\n"]
[86.214533, "o", "-rw-r--r-- 1 root root  47388 Sep 12 21:44 apply.py\r\n"]
[86.3244, "o", "drwxr-xr-x 1 root root   4096 Sep 13 21:55 \u001b[01;34marray_algos\u001b[0m\r\n"]
[86.434267, "o", "-rw-r--r-- 1 root root  17607 Sep 12 21:44 arraylike.py\r\n"]
[86.544133, "o", "drwxr-xr-x 1 root root   4096 Sep 13 21:55 \u001b[01;34marrays\u001b[0m\r\n"]
[86.654, "o", "-rw-r--r-- 1 root root  41097 Sep 12 21:44 base.py\r\n"]
[86.763867, "o", "-rw-r--r-- 1 root root  17912 Sep 12 21:44 common.py\r\n"]
[86.873733, "o", "drwxr-xr-x 1 root root   4096 Sep 13 21:55 \u001b[01;34mcomputation\u001b[0m\r\n"]
[86.9836, "o", "-rw-r--r-- 1 root root  25648 Sep 12 21:44 config_init.py\r\n"]
[87.093467, "o", "-rw-r--r-- 1 root root  24371 Sep 12 21:44 construction.py\r\n"]
[87.203333, "o", "drwxr-xr-x 1 root root   4096 Sep 13 21:55 \u001b[01;34mdtypes\u001b[0m\r\n"]
[87.3132, "o", "-rw-r--r-- 1 root root   3646 Sep 12 21:44 flags.py\r\n"]
[87.423067, "o", "-rw-r--r-- 1 root root 394129 Sep 12 21:44 frame.py\r\n"]
[87.532933, "o", "-rw-r--r-- 1 root root 416917 Sep 12 21:44 generic.py\r\n"]
[87.6428, "o", "drwxr-xr-x 1 root root   4096 Sep 13 21:55 \u001b[01;34mgroupby\u001b[0m\r\n"]
[87.752667, "o", "drwxr-xr-x 1 root root   4096 Sep 13 21:55 \u001b[01;34mindexers\u001b[0m\r\n"]
[87.862533, "o", "drwxr-xr-x 1 root root   4096 Sep 13 21:55 \u001b[01;34mindexes\u001b[0m\r\n"]
[87.9724, "o", "-rw-r--r-- 1 root root  90659 Sep 12 21:44 indexing.py\r\n"]
[88.082267, "o", "drwxr-xr-x 1 root root   4096 Sep 13 21:55 \u001b[01;34minterchange\u001b[0m\r\n"]
[88.192133, "o", "drwxr-xr-x 1 root root   4096 Sep 13 21:55 \u001b[01;34minternals\u001b[0m\r\n"]
[88.302, "o", "drwxr-xr-x 1 root root   4096 Sep 13 21:55 \u001b[01;34mmethods\u001b[0m\r\n"]
[88.411867, "o", "-rw-r--r-- 1 root root  31032 Sep 12 21:44 missing.py\r\n"]
[88.521733, "o", "-rw-r--r-- 1 root root  50584 Sep 12 21:44 nanops.py\r\n"]
[88.6316, "o", "drwxr-xr-x 1 root root   4096 Sep 13 21:55 \u001b[01;34mops\u001b[0m\r\n"]
[88.741467, "o", "-rw-r--r-- 1 root root  74031 Sep 12 21:44 resample.py\r\n"]
[88.851333, "o", "drwxr-xr-x 1 root root   4096 Sep 13 21:55 \u001b[01;34mreshape\u001b[0m\r\n"]
[88.9612, "o", "-rw-r--r-- 1 root root   1114 Sep 12 21:44 roperator.py\r\n"]
[89.071067, "o", "-rw-r--r-- 1 root root   4621 Sep 12 21:44 sample.py\r\n"]
[89.180933, "o", "-rw-r--r-- 1 root root 182288 Sep 12 21:44 series.py\r\n"]
[89.2908, "o", "-rw-r--r-- 1 root root  27395 Sep 12 21:44 shared_docs.py\r\n"]
[89.400667, "o", "-rw-r--r-- 1 root root  22149 Sep 12 21:44 sorting.py\r\n"]
[89.510533, "o", "drwxr-xr-x 1 root root   4096 Sep 12 21:44 \u001b[01;34msparse\u001b[0m\r\n"]
[89.6204, "o", "drwxr-xr-x 1 root root   4096 Sep 13 21:55 \u001b[01;34mstrings\u001b[0m\r\n"]
[89.730267, "o", "drwxr-xr-x 1 root root   4096 Sep 13 21:55 \u001b[01;34mtools\u001b[0m\r\n"]
[89.840133, "o", "drwxr-xr-x 1 root root   4096 Sep 13 21:55 \u001b[01;34mutil\u001b[0m\r\n"]
[90.0, "o", "(asv_3.8) root@7e2a5ae1b193:/workspace/repo# "]
[90.002, "i", "ls -la pandas/core/window/\r"]
[90.004, "o", "ls -la pandas/core/window/\r\n"]
[90.386308, "o", "\u001b[?2004l\r\n"]
[90.766615, "o", "total 200\r\n"]
[91.146923, "o", "drwxr-xr-x 1 root root  4096 Sep 13 21:55 \u001b[0m\u001b[01;34m.\u001b[0m\r\n"]
[91.527231, "o", "drwxr-xr-x 1 root root  4096 Sep 13 21:55 \u001b[01;34m..\u001b[0m\r\n"]
[91.907538, "o", "-rw-r--r-- 1 root root   450 Sep 12 21:41 __init__.py\r\n"]
[92.287846, "o", "drwxr-xr-x 2 root root  4096 Sep 13 21:55 \u001b[01;34m__pycache__\u001b[0m\r\n"]
[92.668154, "o", "-rw-r--r-- 1 root root  6713 Sep 12 21:44 common.py\r\n"]
[93.048462, "o", "-rw-r--r-- 1 root root  4263 Sep 12 21:44 doc.py\r\n"]
[93.428769, "o", "-rw-r--r-- 1 root root 33092 Sep 12 21:44 ewm.py\r\n"]
[93.809077, "o", "-rw-r--r-- 1 root root 23877 Sep 12 21:44 expanding.py\r\n"]
[94.189385, "o", "-rw-r--r-- 1 root root 10727 Sep 12 21:44 numba_.py\r\n"]
[94.569692, "o", "-rw-r--r-- 1 root root  3728 Sep 12 21:44 online.py\r\n"]
[95.0, "o", "(asv_3.8) root@7e2a5ae1b193:/workspace/repo# "]
[95.002, "i", "ls -la pandas/core/groupby/\r"]
[95.004, "o", "ls -la pandas/core/groupby/\r\n"]
[95.359143, "o", "\u001b[?2004l\r\n"]
[95.712286, "o", "total 356\r\n"]
[96.065429, "o", "drwxr-xr-x 1 root root   4096 Sep 13 21:55 \u001b[0m\u001b[01;34m.\u001b[0m\r\n"]
[96.418571, "o", "drwxr-xr-x 1 root root   4096 Sep 13 21:55 \u001b[01;34m..\u001b[0m\r\n"]
[96.771714, "o", "-rw-r--r-- 1 root root    301 Sep 12 21:44 __init__.py\r\n"]
[97.124857, "o", "drwxr-xr-x 2 root root   4096 Sep 13 21:55 \u001b[01;34m__pycache__\u001b[0m\r\n"]
[97.478, "o", "-rw-r--r-- 1 root root   2675 Sep 12 21:44 base.py\r\n"]
[97.831143, "o", "-rw-r--r-- 1 root root   3050 Sep 12 21:44 categorical.py\r\n"]
[98.184286, "o", "-rw-r--r-- 1 root root  86321 Sep 12 21:44 generic.py\r\n"]
[98.537429, "o", "-rw-r--r-- 1 root root 144480 Sep 12 21:44 groupby.py\r\n"]
[98.890571, "o", "-rw-r--r-- 1 root root  35947 Sep 12 21:44 grouper.py\r\n"]
[99.243714, "o", "-rw-r--r-- 1 root root   9482 Sep 12 21:44 indexing.py\r\n"]
[99.596857, "o", "-rw-r--r-- 1 root root   4961 Sep 12 21:44 numba_.py\r\n"]
[100.0, "o", "(asv_3.8) root@7e2a5ae1b193:/workspace/repo# "]
[100.002, "i", "grep -r \"rolling\" pandas/core/groupby/ | head -10\r"]
[100.004, "o", "grep -r \"rolling\" pandas/core/groupby/ | head -10\r\n"]
[100.386308, "o", "\u001b[?2004l\r\n"]
[100.766615, "o", "grep: pandas/core/groupby/groupby.py:    def rolling(self, *args, **kwargs) -> RollingGroupby:\r\n"]
[101.146923, "o", "pandas/core/groupby/__pycache__/groupby.cpython-38.pyc: binary file matches\r\n"]
[101.527231, "o", "grep: pandas/core/groupby/groupby.py:        Return a rolling grouper, providing rolling functionality per group.\r\n"]
[101.907538, "o", "pandas/core/groupby/groupby.py:            based on the defined ``get_window_bounds`` method. Additional rolling\r\n"]
[102.287846, "o", "pandas/core/groupby/groupby.py:            to calculate the rolling window, rather than the DataFrame's index.\r\n"]
[102.668154, "o", "pandas/core/groupby/groupby.py:            an integer index is not used to calculate the rolling window.\r\n"]
[103.048462, "o", "pandas/core/groupby/groupby.py:            Execute the rolling operation per single column or row (``'single'``)\r\n"]
[103.428769, "o", "pandas/core/groupby/groupby.py:            Return a new grouper with our rolling appended.\r\n"]
[103.809077, "o", "pandas/core/groupby/groupby.py:        Series.rolling : Calling object with Series data.\r\n"]
[104.189385, "o", "pandas/core/groupby/groupby.py:        DataFrame.rolling : Calling object with DataFrames.\r\n"]
[104.569692, "o", "pandas/core/groupby/groupby.py:        >>> df.groupby('A').rolling(2).sum()\r\n"]
[105.0, "o", "(asv_3.8) root@7e2a5ae1b193:/workspace/repo# "]
[105.002, "i", "grep -A 30 \"def rolling\" pandas/core/groupby/groupby.py\r"]
[105.004, "o", "grep -A 30 \"def rolling\" pandas/core/groupby/groupby.py\r\n"]
[105.1605, "o", "\u001b[?2004l\r\n"]
[105.315, "o", "    \u001b[01;31m\u001b[Kdef rolling\u001b[m\u001b[K(self, *args, **kwargs) -> RollingGroupby:\r\n"]
[105.4695, "o", "        \"\"\"\r\n"]
[105.624, "o", "        Return a rolling grouper, providing rolling functionality per group.\r\n"]
[105.7785, "o", "\r\n"]
[105.933, "o", "        Parameters\r\n"]
[106.0875, "o", "        ----------\r\n"]
[106.242, "o", "        window : int, timedelta, str, offset, or BaseIndexer subclass\r\n"]
[106.3965, "o", "            Size of the moving window.\r\n"]
[106.551, "o", "\r\n"]
[106.7055, "o", "            If an integer, the fixed number of observations used for\r\n"]
[106.86, "o", "            each window.\r\n"]
[107.0145, "o", "\r\n"]
[107.169, "o", "            If a timedelta, str, or offset, the time period of each window. Each\r\n"]
[107.3235, "o", "            window will be a variable sized based on the observations included in\r\n"]
[107.478, "o", "            the time-period. This is only valid for datetimelike indexes.\r\n"]
[107.6325, "o", "            To learn more about the offsets & frequency strings, please see `this link\r\n"]
[107.787, "o", "            <https://pandas.pydata.org/pandas-docs/stable/user_guide/timeseries.html#offset-aliases>`__.\r\n"]
[107.9415, "o", "\r\n"]
[108.096, "o", "            If a BaseIndexer subclass, the window boundaries\r\n"]
[108.2505, "o", "            based on the defined ``get_window_bounds`` method. Additional rolling\r\n"]
[108.405, "o", "            keyword arguments, namely ``min_periods``, ``center``, ``closed`` and\r\n"]
[108.5595, "o", "            ``step`` will be passed to ``get_window_bounds``.\r\n"]
[108.714, "o", "\r\n"]
[108.8685, "o", "        min_periods : int, default None\r\n"]
[109.023, "o", "            Minimum number of observations in window required to have a value;\r\n"]
[109.1775, "o", "            otherwise, result is ``np.nan``.\r\n"]
[109.332, "o", "\r\n"]
[109.4865, "o", "            For a window that is specified by an offset,\r\n"]
[109.641, "o", "            ``min_periods`` will default to 1.\r\n"]
[109.7955, "o", "\r\n"]
[110.0, "o", "(asv_3.8) root@7e2a5ae1b193:/workspace/repo# "]
[110.002, "i", "grep -A 50 \"def rolling\" pandas/core/groupby/groupby.py | tail -30\r"]
[110.004, "o", "grep -A 50 \"def rolling\" pandas/core/groupby/groupby.py | tail -30\r\n"]
[110.165484, "o", "\u001b[?2004l\r\n"]
[110.324968, "o", "            ``step`` will be passed to ``get_window_bounds``.\r\n"]
[110.484452, "o", "\r\n"]
[110.643935, "o", "        min_periods : int, default None\r\n"]
[110.803419, "o", "            Minimum number of observations in window required to have a value;\r\n"]
[110.962903, "o", "            otherwise, result is ``np.nan``.\r\n"]
[111.122387, "o", "\r\n"]
[111.281871, "o", "            For a window that is specified by an offset,\r\n"]
[111.441355, "o", "            ``min_periods`` will default to 1.\r\n"]
[111.600839, "o", "\r\n"]
[111.760323, "o", "            For a window that is specified by an integer, ``min_periods`` will default\r\n"]
[111.919806, "o", "            to the size of the window.\r\n"]
[112.07929, "o", "\r\n"]
[112.238774, "o", "        center : bool, default False\r\n"]
[112.398258, "o", "            If False, set the window labels as the right edge of the window index.\r\n"]
[112.557742, "o", "\r\n"]
[112.717226, "o", "            If True, set the window labels as the center of the window index.\r\n"]
[112.87671, "o", "\r\n"]
[113.036194, "o", "        win_type : str, default None\r\n"]
[113.195677, "o", "            If ``None``, all points are evenly weighted.\r\n"]
[113.355161, "o", "\r\n"]
[113.514645, "o", "            If a string, it must be a valid `scipy.signal window function\r\n"]
[113.674129, "o", "            <https://docs.scipy.org/doc/scipy/reference/signal.windows.html#module-scipy.signal.windows>`__.\r\n"]
[113.833613, "o", "\r\n"]
[113.993097, "o", "            Certain Scipy window types require additional parameters to be passed\r\n"]
[114.152581, "o", "            in the aggregation function. The additional parameters must match\r\n"]
[114.312065, "o", "            the keywords specified in the Scipy window type method signature.\r\n"]
[114.471548, "o", "\r\n"]
[114.631032, "o", "        on : str, optional\r\n"]
[114.790516, "o", "            For a DataFrame, a column label or Index level on which\r\n"]
[115.0, "o", "(asv_3.8) root@7e2a5ae1b193:/workspace/repo# "]
[115.002, "i", "grep -A 100 \"def rolling\" pandas/core/groupby/groupby.py | grep -A 20 \"from pandas.core.window\"\r"]
[115.004, "o", "grep -A 100 \"def rolling\" pandas/core/groupby/groupby.py | grep -A 20 \"from pandas.core.window\"\r\n"]
[115.006, "o", "\u001b[?2004l\r\n"]
[120.0, "o", "(asv_3.8) root@7e2a5ae1b193:/workspace/repo# "]
[120.002, "i", "grep -n \"RollingGroupby\" pandas/core/groupby/groupby.py\r"]
[120.004, "o", "grep -n \"RollingGroupby\" pandas/core/groupby/groupby.py\r\n"]
[120.83, "o", "\u001b[?2004l\r\n"]
[121.654, "o", "\u001b[32m\u001b[K140\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K        \u001b[01;31m\u001b[KRollingGroupby\u001b[m\u001b[K,\r\n"]
[122.478, "o", "\u001b[32m\u001b[K2650\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K    def rolling(self, *args, **kwargs) -> \u001b[01;31m\u001b[KRollingGroupby\u001b[m\u001b[K:\r\n"]
[123.302, "o", "\u001b[32m\u001b[K2733\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K        \u001b[01;31m\u001b[KRollingGroupby\u001b[m\u001b[K\r\n"]
[124.126, "o", "\u001b[32m\u001b[K2779\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K        from pandas.core.window import \u001b[01;31m\u001b[KRollingGroupby\u001b[m\u001b[K\r\n"]
[125.0, "o", "(asv_3.8) root@7e2a5ae1b193:/workspace/repo# "]
[125.002, "i", "sed -n '2775,2790p' pandas/core/groupby/groupby.py\r"]
[125.004, "o", "sed -n '2775,2790p' pandas/core/groupby/groupby.py\r\n"]
[125.296824, "o", "\u001b[?2004l\r\n"]
[125.587647, "o", "          1  2  0.589\r\n"]
[125.878471, "o", "        2 2  3    NaN\r\n"]
[126.169294, "o", "          3  4  0.705\r\n"]
[126.460118, "o", "        \"\"\"\r\n"]
[126.750941, "o", "        from pandas.core.window import RollingGroupby\r\n"]
[127.041765, "o", "\r\n"]
[127.332588, "o", "        return RollingGroupby(\r\n"]
[127.623412, "o", "            self._selected_obj,\r\n"]
[127.914235, "o", "            *args,\r\n"]
[128.205059, "o", "            _grouper=self.grouper,\r\n"]
[128.495882, "o", "            _as_index=self.as_index,\r\n"]
[128.786706, "o", "            **kwargs,\r\n"]
[129.077529, "o", "        )\r\n"]
[129.368353, "o", "\r\n"]
[129.659176, "o", "    @final\r\n"]
[130.0, "o", "(asv_3.8) root@7e2a5ae1b193:/workspace/repo# "]
[130.002, "i", "grep -n \"class RollingGroupby\" pandas/core/window/rolling.py\r"]
[130.004, "o", "grep -n \"class RollingGroupby\" pandas/core/window/rolling.py\r\n"]
[132.478, "o", "\u001b[?2004l\r\n"]
[135.0, "o", "(asv_3.8) root@7e2a5ae1b193:/workspace/repo# "]
[135.002, "i", "sed -n '2688,2720p' pandas/core/window/rolling.py\r"]
[135.004, "o", "sed -n '2688,2720p' pandas/core/window/rolling.py\r\n"]
[135.151412, "o", "\u001b[?2004l\r\n"]
[135.296824, "o", "class RollingGroupby(BaseWindowGroupby, Rolling):\r\n"]
[135.442235, "o", "    \"\"\"\r\n"]
[135.587647, "o", "    Provide a rolling groupby implementation.\r\n"]
[135.733059, "o", "    \"\"\"\r\n"]
[135.878471, "o", "\r\n"]
[136.023882, "o", "    _attributes = Rolling._attributes + BaseWindowGroupby._attributes\r\n"]
[136.169294, "o", "\r\n"]
[136.314706, "o", "    def _get_window_indexer(self) -> GroupbyIndexer:\r\n"]
[136.460118, "o", "        \"\"\"\r\n"]
[136.605529, "o", "        Return an indexer class that will compute the window start and end bounds\r\n"]
[136.750941, "o", "\r\n"]
[136.896353, "o", "        Returns\r\n"]
[137.041765, "o", "        -------\r\n"]
[137.187176, "o", "        GroupbyIndexer\r\n"]
[137.332588, "o", "        \"\"\"\r\n"]
[137.478, "o", "        rolling_indexer: type[BaseIndexer]\r\n"]
[137.623412, "o", "        indexer_kwargs: dict[str, Any] | None = None\r\n"]
[137.768824, "o", "        index_array = self._index_array\r\n"]
[137.914235, "o", "        if isinstance(self.window, BaseIndexer):\r\n"]
[138.059647, "o", "            rolling_indexer = type(self.window)\r\n"]
[138.205059, "o", "            indexer_kwargs = self.window.__dict__.copy()\r\n"]
[138.350471, "o", "            assert isinstance(indexer_kwargs, dict)  # for mypy\r\n"]
[138.495882, "o", "            # We'll be using the index of each group later\r\n"]
[138.641294, "o", "            indexer_kwargs.pop(\"index_array\", None)\r\n"]
[138.786706, "o", "            window = self.window\r\n"]
[138.932118, "o", "        elif self._win_freq_i8 is not None:\r\n"]
[139.077529, "o", "            rolling_indexer = VariableWindowIndexer\r\n"]
[139.222941, "o", "            # error: Incompatible types in assignment (expression has type\r\n"]
[139.368353, "o", "            # \"int\", variable has type \"BaseIndexer\")\r\n"]
[139.513765, "o", "            window = self._win_freq_i8  # type: ignore[assignment]\r\n"]
[139.659176, "o", "        else:\r\n"]
[139.804588, "o", "            rolling_indexer = FixedWindowIndexer\r\n"]
[140.0, "o", "(asv_3.8) root@7e2a5ae1b193:/workspace/repo# "]
[140.002, "i", "grep -n \"def \" pandas/core/window/rolling.py | grep -A5 -B5 2688\r"]
[140.004, "o", "grep -n \"def \" pandas/core/window/rolling.py | grep -A5 -B5 2688\r\n"]
[140.006, "o", "\u001b[?2004l\r\n"]
[145.0, "o", "(asv_3.8) root@7e2a5ae1b193:/workspace/repo# "]
[145.002, "i", "sed -n '2688,2800p' pandas/core/window/rolling.py | grep -n \"def \"\r"]
[145.004, "o", "sed -n '2688,2800p' pandas/core/window/rolling.py | grep -n \"def \"\r\n"]
[146.654, "o", "\u001b[?2004l\r\n"]
[148.302, "o", "\u001b[32m\u001b[K8\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K    \u001b[01;31m\u001b[Kdef \u001b[m\u001b[K_get_window_indexer(self) -> GroupbyIndexer:\r\n"]
[150.0, "o", "(asv_3.8) root@7e2a5ae1b193:/workspace/repo# "]
[150.002, "i", "grep -n \"class BaseWindowGroupby\" pandas/core/window/rolling.py\r"]
[150.004, "o", "grep -n \"class BaseWindowGroupby\" pandas/core/window/rolling.py\r\n"]
[152.478, "o", "\u001b[?2004l\r\n"]
[155.0, "o", "(asv_3.8) root@7e2a5ae1b193:/workspace/repo# "]
[155.002, "i", "sed -n '669,720p' pandas/core/window/rolling.py\r"]
[155.004, "o", "sed -n '669,720p' pandas/core/window/rolling.py\r\n"]
[155.099283, "o", "\u001b[?2004l\r\n"]
[155.192566, "o", "class BaseWindowGroupby(BaseWindow):\r\n"]
[155.285849, "o", "    \"\"\"\r\n"]
[155.379132, "o", "    Provide the groupby windowing facilities.\r\n"]
[155.472415, "o", "    \"\"\"\r\n"]
[155.565698, "o", "\r\n"]
[155.658981, "o", "    _grouper: BaseGrouper\r\n"]
[155.752264, "o", "    _as_index: bool\r\n"]
[155.845547, "o", "    _attributes: list[str] = [\"_grouper\"]\r\n"]
[155.93883, "o", "\r\n"]
[156.032113, "o", "    def __init__(\r\n"]
[156.125396, "o", "        self,\r\n"]
[156.218679, "o", "        obj: DataFrame | Series,\r\n"]
[156.311962, "o", "        *args,\r\n"]
[156.405245, "o", "        _grouper: BaseGrouper,\r\n"]
[156.498528, "o", "        _as_index: bool = True,\r\n"]
[156.591811, "o", "        **kwargs,\r\n"]
[156.685094, "o", "    ) -> None:\r\n"]
[156.778377, "o", "        from pandas.core.groupby.ops import BaseGrouper\r\n"]
[156.87166, "o", "\r\n"]
[156.964943, "o", "        if not isinstance(_grouper, BaseGrouper):\r\n"]
[157.058226, "o", "            raise ValueError(\"Must pass a BaseGrouper object.\")\r\n"]
[157.151509, "o", "        self._grouper = _grouper\r\n"]
[157.244792, "o", "        self._as_index = _as_index\r\n"]
[157.338075, "o", "        # GH 32262: It's convention to keep the grouping column in\r\n"]
[157.431358, "o", "        # groupby.<agg_func>, but unexpected to users in\r\n"]
[157.524642, "o", "        # groupby.rolling.<agg_func>\r\n"]
[157.617925, "o", "        obj = obj.drop(columns=self._grouper.names, errors=\"ignore\")\r\n"]
[157.711208, "o", "        # GH 15354\r\n"]
[157.804491, "o", "        if kwargs.get(\"step\") is not None:\r\n"]
[157.897774, "o", "            raise NotImplementedError(\"step not implemented for groupby\")\r\n"]
[157.991057, "o", "        super().__init__(obj, *args, **kwargs)\r\n"]
[158.08434, "o", "\r\n"]
[158.177623, "o", "    def _apply(\r\n"]
[158.270906, "o", "        self,\r\n"]
[158.364189, "o", "        func: Callable[..., Any],\r\n"]
[158.457472, "o", "        name: str,\r\n"]
[158.550755, "o", "        numeric_only: bool = False,\r\n"]
[158.644038, "o", "        numba_args: tuple[Any, ...] = (),\r\n"]
[158.737321, "o", "        **kwargs,\r\n"]
[158.830604, "o", "    ) -> DataFrame | Series:\r\n"]
[158.923887, "o", "        result = super()._apply(\r\n"]
[159.01717, "o", "            func,\r\n"]
[159.110453, "o", "            name,\r\n"]
[159.203736, "o", "            numeric_only,\r\n"]
[159.297019, "o", "            numba_args,\r\n"]
[159.390302, "o", "            **kwargs,\r\n"]
[159.483585, "o", "        )\r\n"]
[159.576868, "o", "        # Reconstruct the resulting MultiIndex\r\n"]
[159.670151, "o", "        # 1st set of levels = group by labels\r\n"]
[159.763434, "o", "        # 2nd set of levels = original DataFrame/Series index\r\n"]
[159.856717, "o", "        grouped_object_index = self.obj.index\r\n"]
[160.0, "o", "(asv_3.8) root@7e2a5ae1b193:/workspace/repo# "]
[160.002, "i", "sed -n '700,760p' pandas/core/window/rolling.py\r"]
[160.004, "o", "sed -n '700,760p' pandas/core/window/rolling.py\r\n"]
[160.085742, "o", "\u001b[?2004l\r\n"]
[160.165484, "o", "\r\n"]
[160.245226, "o", "    def _apply(\r\n"]
[160.324968, "o", "        self,\r\n"]
[160.40471, "o", "        func: Callable[..., Any],\r\n"]
[160.484452, "o", "        name: str,\r\n"]
[160.564194, "o", "        numeric_only: bool = False,\r\n"]
[160.643935, "o", "        numba_args: tuple[Any, ...] = (),\r\n"]
[160.723677, "o", "        **kwargs,\r\n"]
[160.803419, "o", "    ) -> DataFrame | Series:\r\n"]
[160.883161, "o", "        result = super()._apply(\r\n"]
[160.962903, "o", "            func,\r\n"]
[161.042645, "o", "            name,\r\n"]
[161.122387, "o", "            numeric_only,\r\n"]
[161.202129, "o", "            numba_args,\r\n"]
[161.281871, "o", "            **kwargs,\r\n"]
[161.361613, "o", "        )\r\n"]
[161.441355, "o", "        # Reconstruct the resulting MultiIndex\r\n"]
[161.521097, "o", "        # 1st set of levels = group by labels\r\n"]
[161.600839, "o", "        # 2nd set of levels = original DataFrame/Series index\r\n"]
[161.680581, "o", "        grouped_object_index = self.obj.index\r\n"]
[161.760323, "o", "        grouped_index_name = [*grouped_object_index.names]\r\n"]
[161.840065, "o", "        groupby_keys = copy.copy(self._grouper.names)\r\n"]
[161.919806, "o", "        result_index_names = groupby_keys + grouped_index_name\r\n"]
[161.999548, "o", "\r\n"]
[162.07929, "o", "        drop_columns = [\r\n"]
[162.159032, "o", "            key\r\n"]
[162.238774, "o", "            for key in self._grouper.names\r\n"]
[162.318516, "o", "            if key not in self.obj.index.names or key is None\r\n"]
[162.398258, "o", "        ]\r\n"]
[162.478, "o", "\r\n"]
[162.557742, "o", "        if len(drop_columns) != len(groupby_keys):\r\n"]
[162.637484, "o", "            # Our result will have still kept the column in the result\r\n"]
[162.717226, "o", "            result = result.drop(columns=drop_columns, errors=\"ignore\")\r\n"]
[162.796968, "o", "\r\n"]
[162.87671, "o", "        codes = self._grouper.codes\r\n"]
[162.956452, "o", "        levels = copy.copy(self._grouper.levels)\r\n"]
[163.036194, "o", "\r\n"]
[163.115935, "o", "        group_indices = self._grouper.indices.values()\r\n"]
[163.195677, "o", "        if group_indices:\r\n"]
[163.275419, "o", "            indexer = np.concatenate(list(group_indices))\r\n"]
[163.355161, "o", "        else:\r\n"]
[163.434903, "o", "            indexer = np.array([], dtype=np.intp)\r\n"]
[163.514645, "o", "        codes = [c.take(indexer) for c in codes]\r\n"]
[163.594387, "o", "\r\n"]
[163.674129, "o", "        # if the index of the original dataframe needs to be preserved, append\r\n"]
[163.753871, "o", "        # this index (but reordered) to the codes/levels from the groupby\r\n"]
[163.833613, "o", "        if grouped_object_index is not None:\r\n"]
[163.913355, "o", "            idx = grouped_object_index.take(indexer)\r\n"]
[163.993097, "o", "            if not isinstance(idx, MultiIndex):\r\n"]
[164.072839, "o", "                idx = MultiIndex.from_arrays([idx])\r\n"]
[164.152581, "o", "            codes.extend(list(idx.codes))\r\n"]
[164.232323, "o", "            levels.extend(list(idx.levels))\r\n"]
[164.312065, "o", "\r\n"]
[164.391806, "o", "        result_index = MultiIndex(\r\n"]
[164.471548, "o", "            levels, codes, names=result_index_names, verify_integrity=False\r\n"]
[164.55129, "o", "        )\r\n"]
[164.631032, "o", "\r\n"]
[164.710774, "o", "        result.index = result_index\r\n"]
[164.790516, "o", "        if not self._as_index:\r\n"]
[164.870258, "o", "            result = result.reset_index(level=list(range(len(groupby_keys))))\r\n"]
[165.0, "o", "(asv_3.8) root@7e2a5ae1b193:/workspace/repo# "]
[165.002, "i", "cp pandas/core/window/rolling.py pandas/core/window/rolling.py.backup\r"]
[165.004, "o", "cp pandas/core/window/rolling.py pandas/core/window/rolling.py.backup\r\n"]
[165.006, "o", "\u001b[?2004l\r\n"]
[170.0, "o", "(asv_3.8) root@7e2a5ae1b193:/workspace/repo# "]
[170.002, "i", "cat > /tmp/rolling_optimization.py << 'EOF'\r"]
[170.004, "o", "cat > /tmp/rolling_optimization.py << 'EOF'\r\n"]
[170.042088, "o", "\u001b[?2004l\r\n"]
[170.078175, "o", "\u001b[?2004h> # Optimized _apply method for BaseWindowGroupby\r\n"]
[170.114263, "o", "\u001b[?2004l\r\n"]
[170.15035, "o", "\u001b[?2004h> def _apply_optimized(\r\n"]
[170.186438, "o", "\u001b[?2004l\r\n"]
[170.222526, "o", "\u001b[?2004h>     self,\r\n"]
[170.258613, "o", "\u001b[?2004l\r\n"]
[170.294701, "o", "\u001b[?2004h>     func: Callable[..., Any],\r\n"]
[170.330788, "o", "\u001b[?2004l\r\n"]
[170.366876, "o", "\u001b[?2004h>     name: str,\r\n"]
[170.402964, "o", "\u001b[?2004l\r\n"]
[170.439051, "o", "\u001b[?2004h>     numeric_only: bool = False,\r\n"]
[170.475139, "o", "\u001b[?2004l\r\n"]
[170.511226, "o", "\u001b[?2004h>     numba_args: tuple[Any, ...] = (),\r\n"]
[170.547314, "o", "\u001b[?2004l\r\n"]
[170.583401, "o", "\u001b[?2004h>     **kwargs,\r\n"]
[170.619489, "o", "\u001b[?2004l\r\n"]
[170.655577, "o", "\u001b[?2004h> ) -> DataFrame | Series:\r\n"]
[170.691664, "o", "\u001b[?2004l\r\n"]
[170.727752, "o", "\u001b[?2004h>     result = super()._apply(\r\n"]
[170.763839, "o", "\u001b[?2004l\r\n"]
[170.799927, "o", "\u001b[?2004h>         func,\r\n"]
[170.836015, "o", "\u001b[?2004l\r\n"]
[170.872102, "o", "\u001b[?2004h>         name,\r\n"]
[170.90819, "o", "\u001b[?2004l\r\n"]
[170.944277, "o", "\u001b[?2004h>         numeric_only,\r\n"]
[170.980365, "o", "\u001b[?2004l\r\n"]
[171.016453, "o", "\u001b[?2004h>         numba_args,\r\n"]
[171.05254, "o", "\u001b[?2004l\r\n"]
[171.088628, "o", "\u001b[?2004h>         **kwargs,\r\n"]
[171.124715, "o", "\u001b[?2004l\r\n"]
[171.160803, "o", "\u001b[?2004h>     )\r\n"]
[171.196891, "o", "\u001b[?2004l\r\n"]
[171.232978, "o", "\u001b[?2004h>     # Reconstruct the resulting MultiIndex\r\n"]
[171.269066, "o", "\u001b[?2004l\r\n"]
[171.305153, "o", "\u001b[?2004h>     # 1st set of levels = group by labels\r\n"]
[171.341241, "o", "\u001b[?2004l\r\n"]
[171.377328, "o", "\u001b[?2004h>     # 2nd set of levels = original DataFrame/Series index\r\n"]
[171.413416, "o", "\u001b[?2004l\r\n"]
[171.449504, "o", "\u001b[?2004h>     grouped_object_index = self.obj.index\r\n"]
[171.485591, "o", "\u001b[?2004l\r\n"]
[171.521679, "o", "\u001b[?2004h>     grouped_index_name = [*grouped_object_index.names]\r\n"]
[171.557766, "o", "\u001b[?2004l\r\n"]
[171.593854, "o", "\u001b[?2004h>     groupby_keys = copy.copy(self._grouper.names)\r\n"]
[171.629942, "o", "\u001b[?2004l\r\n"]
[171.666029, "o", "\u001b[?2004h>     result_index_names = groupby_keys + grouped_index_name\r\n"]
[171.702117, "o", "\u001b[?2004l\r\n"]
[171.738204, "o", "\u001b[?2004h> \r\n"]
[171.774292, "o", "\u001b[?2004l\r\n"]
[171.81038, "o", "\u001b[?2004h>     drop_columns = [\r\n"]
[171.846467, "o", "\u001b[?2004l\r\n"]
[171.882555, "o", "\u001b[?2004h>         key\r\n"]
[171.918642, "o", "\u001b[?2004l\r\n"]
[171.95473, "o", "\u001b[?2004h>         for key in self._grouper.names\r\n"]
[171.990818, "o", "\u001b[?2004l\r\n"]
[172.026905, "o", "\u001b[?2004h>         if key not in self.obj.index.names or key is None\r\n"]
[172.062993, "o", "\u001b[?2004l\r\n"]
[172.09908, "o", "\u001b[?2004h>     ]\r\n"]
[172.135168, "o", "\u001b[?2004l\r\n"]
[172.171255, "o", "\u001b[?2004h> \r\n"]
[172.207343, "o", "\u001b[?2004l\r\n"]
[172.243431, "o", "\u001b[?2004h>     if len(drop_columns) != len(groupby_keys):\r\n"]
[172.279518, "o", "\u001b[?2004l\r\n"]
[172.315606, "o", "\u001b[?2004h>         # Our result will have still kept the column in the result\r\n"]
[172.351693, "o", "\u001b[?2004l\r\n"]
[172.387781, "o", "\u001b[?2004h>         result = result.drop(columns=drop_columns, errors=\"ignore\")\r\n"]
[172.423869, "o", "\u001b[?2004l\r\n"]
[172.459956, "o", "\u001b[?2004h> \r\n"]
[172.496044, "o", "\u001b[?2004l\r\n"]
[172.532131, "o", "\u001b[?2004h>     codes = self._grouper.codes\r\n"]
[172.568219, "o", "\u001b[?2004l\r\n"]
[172.604307, "o", "\u001b[?2004h>     levels = copy.copy(self._grouper.levels)\r\n"]
[172.640394, "o", "\u001b[?2004l\r\n"]
[172.676482, "o", "\u001b[?2004h> \r\n"]
[172.712569, "o", "\u001b[?2004l\r\n"]
[172.748657, "o", "\u001b[?2004h>     # OPTIMIZATION: Use more efficient indexer creation\r\n"]
[172.784745, "o", "\u001b[?2004l\r\n"]
[172.820832, "o", "\u001b[?2004h>     group_indices_values = self._grouper.indices.values()\r\n"]
[172.85692, "o", "\u001b[?2004l\r\n"]
[172.893007, "o", "\u001b[?2004h>     if group_indices_values:\r\n"]
[172.929095, "o", "\u001b[?2004l\r\n"]
[172.965182, "o", "\u001b[?2004h>         # Use np.concatenate directly on the values without converting to list\r\n"]
[173.00127, "o", "\u001b[?2004l\r\n"]
[173.037358, "o", "\u001b[?2004h>         indexer = np.concatenate(group_indices_values)\r\n"]
[173.073445, "o", "\u001b[?2004l\r\n"]
[173.109533, "o", "\u001b[?2004h>     else:\r\n"]
[173.14562, "o", "\u001b[?2004l\r\n"]
[173.181708, "o", "\u001b[?2004h>         indexer = np.array([], dtype=np.intp)\r\n"]
[173.217796, "o", "\u001b[?2004l\r\n"]
[173.253883, "o", "\u001b[?2004h>     \r\n"]
[173.289971, "o", "\u001b[?2004l\r\n"]
[173.326058, "o", "\u001b[?2004h>     # OPTIMIZATION: Use advanced indexing instead of .take() in loop\r\n"]
[173.362146, "o", "\u001b[?2004l\r\n"]
[173.398234, "o", "\u001b[?2004h>     codes = [c[indexer] for c in codes]\r\n"]
[173.434321, "o", "\u001b[?2004l\r\n"]
[173.470409, "o", "\u001b[?2004h> \r\n"]
[173.506496, "o", "\u001b[?2004l\r\n"]
[173.542584, "o", "\u001b[?2004h>     # if the index of the original dataframe needs to be preserved, append\r\n"]
[173.578672, "o", "\u001b[?2004l\r\n"]
[173.614759, "o", "\u001b[?2004h>     # this index (but reordered) to the codes/levels from the groupby\r\n"]
[173.650847, "o", "\u001b[?2004l\r\n"]
[173.686934, "o", "\u001b[?2004h>     if grouped_object_index is not None:\r\n"]
[173.723022, "o", "\u001b[?2004l\r\n"]
[173.759109, "o", "\u001b[?2004h>         # OPTIMIZATION: Use direct indexing instead of .take()\r\n"]
[173.795197, "o", "\u001b[?2004l\r\n"]
[173.831285, "o", "\u001b[?2004h>         idx = grouped_object_index[indexer]\r\n"]
[173.867372, "o", "\u001b[?2004l\r\n"]
[173.90346, "o", "\u001b[?2004h>         if not isinstance(idx, MultiIndex):\r\n"]
[173.939547, "o", "\u001b[?2004l\r\n"]
[173.975635, "o", "\u001b[?2004h>             idx = MultiIndex.from_arrays([idx])\r\n"]
[174.011723, "o", "\u001b[?2004l\r\n"]
[174.04781, "o", "\u001b[?2004h>         codes.extend(list(idx.codes))\r\n"]
[174.083898, "o", "\u001b[?2004l\r\n"]
[174.119985, "o", "\u001b[?2004h>         levels.extend(list(idx.levels))\r\n"]
[174.156073, "o", "\u001b[?2004l\r\n"]
[174.192161, "o", "\u001b[?2004h> \r\n"]
[174.228248, "o", "\u001b[?2004l\r\n"]
[174.264336, "o", "\u001b[?2004h>     # OPTIMIZATION: Create MultiIndex more efficiently\r\n"]
[174.300423, "o", "\u001b[?2004l\r\n"]
[174.336511, "o", "\u001b[?2004h>     result_index = MultiIndex(\r\n"]
[174.372599, "o", "\u001b[?2004l\r\n"]
[174.408686, "o", "\u001b[?2004h>         levels, codes, names=result_index_names, verify_integrity=False\r\n"]
[174.444774, "o", "\u001b[?2004l\r\n"]
[174.480861, "o", "\u001b[?2004h>     )\r\n"]
[174.516949, "o", "\u001b[?2004l\r\n"]
[174.553036, "o", "\u001b[?2004h> \r\n"]
[174.589124, "o", "\u001b[?2004l\r\n"]
[174.625212, "o", "\u001b[?2004h>     result.index = result_index\r\n"]
[174.661299, "o", "\u001b[?2004l\r\n"]
[174.697387, "o", "\u001b[?2004h>     if not self._as_index:\r\n"]
[174.733474, "o", "\u001b[?2004l\r\n"]
[174.769562, "o", "\u001b[?2004h>         result = result.reset_index(level=list(range(len(groupby_keys))))\r\n"]
[174.80565, "o", "\u001b[?2004l\r\n"]
[174.841737, "o", "\u001b[?2004h>     return result\r\n"]
[174.877825, "o", "\u001b[?2004l\r\n"]
[174.913912, "o", "\u001b[?2004h> EOF\r\n"]
[175.0, "o", "(asv_3.8) root@7e2a5ae1b193:/workspace/repo# "]
[175.002, "i", "python3 -c \"\r"]
[175.004, "o", "python3 -c \"\r\n"]
[175.076629, "o", "\u001b[?2004l\r\n"]
[175.147257, "o", "\u001b[?2004h> import re\r\n"]
[175.217886, "o", "\u001b[?2004l\r\n"]
[175.288514, "o", "\u001b[?2004h> \r\n"]
[175.359143, "o", "\u001b[?2004l\r\n"]
[175.429771, "o", "\u001b[?2004h> # Read the original file\r\n"]
[175.5004, "o", "\u001b[?2004l\r\n"]
[175.571029, "o", "\u001b[?2004h> with open('pandas/core/window/rolling.py', 'r') as f:\r\n"]
[175.641657, "o", "\u001b[?2004l\r\n"]
[175.712286, "o", "\u001b[?2004h>     content = f.read()\r\n"]
[175.782914, "o", "\u001b[?2004l\r\n"]
[175.853543, "o", "\u001b[?2004h> \r\n"]
[175.924171, "o", "\u001b[?2004l\r\n"]
[175.9948, "o", "\u001b[?2004h> # Replace the problematic lines with optimized versions\r\n"]
[176.065429, "o", "\u001b[?2004l\r\n"]
[176.136057, "o", "\u001b[?2004h> # Line 1: Replace list(group_indices) with direct values\r\n"]
[176.206686, "o", "\u001b[?2004l\r\n"]
[176.277314, "o", "\u001b[?2004h> content = re.sub(\r\n"]
[176.347943, "o", "\u001b[?2004l\r\n"]
[176.418571, "o", "\u001b[?2004h>     r'indexer = np\\.concatenate\\(list\\(group_indices\\)\\)',\r\n"]
[176.4892, "o", "\u001b[?2004l\r\n"]
[176.559829, "o", "\u001b[?2004h>     'indexer = np.concatenate(group_indices)',\r\n"]
[176.630457, "o", "\u001b[?2004l\r\n"]
[176.701086, "o", "\u001b[?2004h>     content\r\n"]
[176.771714, "o", "\u001b[?2004l\r\n"]
[176.842343, "o", "\u001b[?2004h> )\r\n"]
[176.912971, "o", "\u001b[?2004l\r\n"]
[176.9836, "o", "\u001b[?2004h> \r\n"]
[177.054229, "o", "\u001b[?2004l\r\n"]
[177.124857, "o", "\u001b[?2004h> # Line 2: Replace .take() with direct indexing for codes\r\n"]
[177.195486, "o", "\u001b[?2004l\r\n"]
[177.266114, "o", "\u001b[?2004h> content = re.sub(\r\n"]
[177.336743, "o", "\u001b[?2004l\r\n"]
[177.407371, "o", "\u001b[?2004h>     r'codes = \\[c\\.take\\(indexer\\) for c in codes\\]',\r\n"]
[177.478, "o", "\u001b[?2004l\r\n"]
[177.548629, "o", "\u001b[?2004h>     'codes = [c[indexer] for c in codes]',\r\n"]
[177.619257, "o", "\u001b[?2004l\r\n"]
[177.689886, "o", "\u001b[?2004h>     content\r\n"]
[177.760514, "o", "\u001b[?2004l\r\n"]
[177.831143, "o", "\u001b[?2004h> )\r\n"]
[177.901771, "o", "\u001b[?2004l\r\n"]
[177.9724, "o", "\u001b[?2004h> \r\n"]
[178.043029, "o", "\u001b[?2004l\r\n"]
[178.113657, "o", "\u001b[?2004h> # Line 3: Replace .take() with direct indexing for grouped_object_index\r\n"]
[178.184286, "o", "\u001b[?2004l\r\n"]
[178.254914, "o", "\u001b[?2004h> content = re.sub(\r\n"]
[178.325543, "o", "\u001b[?2004l\r\n"]
[178.396171, "o", "\u001b[?2004h>     r'idx = grouped_object_index\\.take\\(indexer\\)',\r\n"]
[178.4668, "o", "\u001b[?2004l\r\n"]
[178.537429, "o", "\u001b[?2004h>     'idx = grouped_object_index[indexer]',\r\n"]
[178.608057, "o", "\u001b[?2004l\r\n"]
[178.678686, "o", "\u001b[?2004h>     content\r\n"]
[178.749314, "o", "\u001b[?2004l\r\n"]
[178.819943, "o", "\u001b[?2004h> )\r\n"]
[178.890571, "o", "\u001b[?2004l\r\n"]
[178.9612, "o", "\u001b[?2004h> \r\n"]
[179.031829, "o", "\u001b[?2004l\r\n"]
[179.102457, "o", "\u001b[?2004h> # Write back the optimized content\r\n"]
[179.173086, "o", "\u001b[?2004l\r\n"]
[179.243714, "o", "\u001b[?2004h> with open('pandas/core/window/rolling.py', 'w') as f:\r\n"]
[179.314343, "o", "\u001b[?2004l\r\n"]
[179.384971, "o", "\u001b[?2004h>     f.write(content)\r\n"]
[179.4556, "o", "\u001b[?2004l\r\n"]
[179.526229, "o", "\u001b[?2004h> \r\n"]
[179.596857, "o", "\u001b[?2004l\r\n"]
[179.667486, "o", "\u001b[?2004h> print('Applied optimizations to rolling.py')\r\n"]
[179.738114, "o", "\u001b[?2004l\r\n"]
[179.808743, "o", "\u001b[?2004h> \"\r\n"]
[179.879371, "o", "\u001b[?2004l\r\n"]
[180.0, "o", "(asv_3.8) root@7e2a5ae1b193:/workspace/repo# "]
[180.002, "i", "sed -n '735,745p' pandas/core/window/rolling.py\r"]
[180.004, "o", "sed -n '735,745p' pandas/core/window/rolling.py\r\n"]
[180.418, "o", "\u001b[?2004l\r\n"]
[180.83, "o", "        levels = copy.copy(self._grouper.levels)\r\n"]
[181.242, "o", "\r\n"]
[181.654, "o", "        group_indices = self._grouper.indices.values()\r\n"]
[182.066, "o", "        if group_indices:\r\n"]
[182.478, "o", "            indexer = np.concatenate(group_indices)\r\n"]
[182.89, "o", "        else:\r\n"]
[183.302, "o", "            indexer = np.array([], dtype=np.intp)\r\n"]
[183.714, "o", "        codes = [c[indexer] for c in codes]\r\n"]
[184.126, "o", "\r\n"]
[184.538, "o", "        # if the index of the original dataframe needs to be preserved, append\r\n"]
[185.0, "o", "(asv_3.8) root@7e2a5ae1b193:/workspace/repo# "]
[185.002, "i", "sed -n '743,750p' pandas/core/window/rolling.py\r"]
[185.004, "o", "sed -n '743,750p' pandas/core/window/rolling.py\r\n"]
[185.555333, "o", "\u001b[?2004l\r\n"]
[186.104667, "o", "\r\n"]
[186.654, "o", "        # if the index of the original dataframe needs to be preserved, append\r\n"]
[187.203333, "o", "        # this index (but reordered) to the codes/levels from the groupby\r\n"]
[187.752667, "o", "        if grouped_object_index is not None:\r\n"]
[188.302, "o", "            idx = grouped_object_index[indexer]\r\n"]
[188.851333, "o", "            if not isinstance(idx, MultiIndex):\r\n"]
[189.400667, "o", "                idx = MultiIndex.from_arrays([idx])\r\n"]
[190.0, "o", "(asv_3.8) root@7e2a5ae1b193:/workspace/repo# "]
[190.002, "i", "cd asv_bench\r"]
[190.004, "o", "cd asv_bench\r\n"]
[190.006, "o", "\u001b[?2004l\r\n"]
[195.0, "o", "(asv_3.8) root@7e2a5ae1b193:/workspace/repo/asv_bench# "]
[195.002, "i", "asv run --python=same --bench=\"rolling.Groupby.*\"\r"]
[195.004, "o", "asv run --python=same --bench=\"rolling.Groupby.*\"\r\n"]
[195.016, "o", "\u001b[?2004l\r\n"]
[195.026, "o", "\u00b7 \u001b[0;32mDiscovering benchmarks\u001b[0m\r\n"]
[195.036, "o", "\u00b7 \u001b[0;32mRunning 4 total benchmarks (1 commits * 1 environments * 4 benchmarks)\u001b[0m\r\n"]
[195.046, "o", "[ 0.00%] \u00b7\u00b7 \u001b[0;34mBenchmarking existing-py_opt_conda_envs_asv_3.8_bin_python\u001b[0m\r\n"]
[195.056, "o", "[12.50%] \u00b7\u00b7\u00b7 \u001b[0;39mRunning (rolling.Groupby.time_method--)\u001b[0m....\r\n"]
[195.066, "o", "[62.50%] \u00b7\u00b7\u00b7 \u001b[0;39mrolling.Groupby.time_method\u001b[0m                                                                                                                 failed\r\n"]
[195.076, "o", "[62.50%] \u00b7\u00b7\u00b7 \u001b[0;39m=========== ============================ ================================ ===================\u001b[0m\r\n"]
[195.086, "o", "             --                                                param2                                     \r\n"]
[195.096, "o", "             ----------- ---------------------------------------------------------------------------------\r\n"]
[195.106, "o", "                param1    ('rolling', {'window': 2})   ('rolling', {'window': '30s'})   ('expanding', {}) \r\n"]
[195.116, "o", "             =========== ============================ ================================ ===================\r\n"]
[195.126, "o", "              'sum' (0)             failed                         failed                     failed      \r\n"]
[195.136, "o", "                median              failed                         failed                     failed      \r\n"]
[195.146, "o", "                 mean               failed                         failed                     failed      \r\n"]
[195.156, "o", "                 max                failed                         failed                     failed      \r\n"]
[195.166, "o", "                 min                failed                         failed                     failed      \r\n"]
[195.176, "o", "                 kurt               failed                         failed                     failed      \r\n"]
[195.186, "o", "              'sum' (1)             failed                         failed                     failed      \r\n"]
[195.196, "o", "             =========== ============================ ================================ ===================\r\n"]
[195.206, "o", "             For parameters: 'sum' (0), ('rolling', {'window': 2})\r\n"]
[195.216, "o", "             Traceback (most recent call last):\r\n"]
[195.226, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/server.py\", line 179, in _run_server\r\n"]
[195.236, "o", "                 _run(run_args)\r\n"]
[195.246, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/run.py\", line 72, in _run\r\n"]
[195.256, "o", "                 result = benchmark.do_run()\r\n"]
[195.266, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/benchmarks/_base.py\", line 661, in do_run\r\n"]
[195.276, "o", "                 return self.run(*self._current_params)\r\n"]
[195.286, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/benchmarks/time.py\", line 165, in run\r\n"]
[195.296, "o", "                 samples, number = self.benchmark_timing(\r\n"]
[195.306, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/benchmarks/time.py\", line 258, in benchmark_timing\r\n"]
[195.316, "o", "                 timing = timer.timeit(number)\r\n"]
[195.326, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/timeit.py\", line 177, in timeit\r\n"]
[195.336, "o", "                 timing = self.inner(it, self.timer)\r\n"]
[195.346, "o", "               File \"<timeit-src>\", line 6, in inner\r\n"]
[195.356, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/benchmarks/time.py\", line 90, in func\r\n"]
[195.366, "o", "                 self.func(*param)\r\n"]
[195.376, "o", "               File \"/workspace/repo/asv_bench/benchmarks/rolling.py\", line 309, in time_method\r\n"]
[195.386, "o", "                 getattr(self.groupby_window, method)()\r\n"]
[195.396, "o", "               File \"/workspace/repo/pandas/core/window/rolling.py\", line 1993, in sum\r\n"]
[195.406, "o", "                 return super().sum(\r\n"]
[195.416, "o", "               File \"/workspace/repo/pandas/core/window/rolling.py\", line 1443, in sum\r\n"]
[195.426, "o", "                 return self._apply(window_func, name=\"sum\", numeric_only=numeric_only)\r\n"]
[195.436, "o", "               File \"/workspace/repo/pandas/core/window/rolling.py\", line 739, in _apply\r\n"]
[195.446, "o", "                 indexer = np.concatenate(group_indices)\r\n"]
[195.456, "o", "               File \"<__array_function__ internals>\", line 200, in concatenate\r\n"]
[195.466, "o", "             TypeError: The first input argument needs to be a sequence\r\n"]
[195.476, "o", "             \r\n"]
[195.486, "o", "             For parameters: 'sum' (0), ('rolling', {'window': '30s'})\r\n"]
[195.496, "o", "             Traceback (most recent call last):\r\n"]
[195.506, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/server.py\", line 179, in _run_server\r\n"]
[195.516, "o", "                 _run(run_args)\r\n"]
[195.526, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/run.py\", line 72, in _run\r\n"]
[195.536, "o", "                 result = benchmark.do_run()\r\n"]
[195.546, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/benchmarks/_base.py\", line 661, in do_run\r\n"]
[195.556, "o", "                 return self.run(*self._current_params)\r\n"]
[195.566, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/benchmarks/time.py\", line 165, in run\r\n"]
[195.576, "o", "                 samples, number = self.benchmark_timing(\r\n"]
[195.586, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/benchmarks/time.py\", line 258, in benchmark_timing\r\n"]
[195.596, "o", "                 timing = timer.timeit(number)\r\n"]
[195.606, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/timeit.py\", line 177, in timeit\r\n"]
[195.616, "o", "                 timing = self.inner(it, self.timer)\r\n"]
[195.626, "o", "               File \"<timeit-src>\", line 6, in inner\r\n"]
[195.636, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/benchmarks/time.py\", line 90, in func\r\n"]
[195.646, "o", "                 self.func(*param)\r\n"]
[195.656, "o", "               File \"/workspace/repo/asv_bench/benchmarks/rolling.py\", line 309, in time_method\r\n"]
[195.666, "o", "                 getattr(self.groupby_window, method)()\r\n"]
[195.676, "o", "               File \"/workspace/repo/pandas/core/window/rolling.py\", line 1993, in sum\r\n"]
[195.686, "o", "                 return super().sum(\r\n"]
[195.696, "o", "               File \"/workspace/repo/pandas/core/window/rolling.py\", line 1443, in sum\r\n"]
[195.706, "o", "                 return self._apply(window_func, name=\"sum\", numeric_only=numeric_only)\r\n"]
[195.716, "o", "               File \"/workspace/repo/pandas/core/window/rolling.py\", line 739, in _apply\r\n"]
[195.726, "o", "                 indexer = np.concatenate(group_indices)\r\n"]
[195.736, "o", "               File \"<__array_function__ internals>\", line 200, in concatenate\r\n"]
[195.746, "o", "             TypeError: The first input argument needs to be a sequence\r\n"]
[195.756, "o", "             \r\n"]
[195.766, "o", "             For parameters: 'sum' (0), ('expanding', {})\r\n"]
[195.776, "o", "             Traceback (most recent call last):\r\n"]
[195.786, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/server.py\", line 179, in _run_server\r\n"]
[195.796, "o", "                 _run(run_args)\r\n"]
[195.806, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/run.py\", line 72, in _run\r\n"]
[195.816, "o", "                 result = benchmark.do_run()\r\n"]
[195.826, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/benchmarks/_base.py\", line 661, in do_run\r\n"]
[195.836, "o", "                 return self.run(*self._current_params)\r\n"]
[195.846, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/benchmarks/time.py\", line 165, in run\r\n"]
[195.856, "o", "                 samples, number = self.benchmark_timing(\r\n"]
[195.866, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/benchmarks/time.py\", line 258, in benchmark_timing\r\n"]
[195.876, "o", "                 timing = timer.timeit(number)\r\n"]
[195.886, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/timeit.py\", line 177, in timeit\r\n"]
[195.896, "o", "                 timing = self.inner(it, self.timer)\r\n"]
[195.906, "o", "               File \"<timeit-src>\", line 6, in inner\r\n"]
[195.916, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/benchmarks/time.py\", line 90, in func\r\n"]
[195.926, "o", "                 self.func(*param)\r\n"]
[195.936, "o", "               File \"/workspace/repo/asv_bench/benchmarks/rolling.py\", line 309, in time_method\r\n"]
[195.946, "o", "                 getattr(self.groupby_window, method)()\r\n"]
[195.956, "o", "               File \"/workspace/repo/pandas/core/window/expanding.py\", line 239, in sum\r\n"]
[195.966, "o", "                 return super().sum(\r\n"]
[195.976, "o", "               File \"/workspace/repo/pandas/core/window/rolling.py\", line 1443, in sum\r\n"]
[195.986, "o", "                 return self._apply(window_func, name=\"sum\", numeric_only=numeric_only)\r\n"]
[195.996, "o", "               File \"/workspace/repo/pandas/core/window/rolling.py\", line 739, in _apply\r\n"]
[196.006, "o", "                 indexer = np.concatenate(group_indices)\r\n"]
[196.016, "o", "               File \"<__array_function__ internals>\", line 200, in concatenate\r\n"]
[196.026, "o", "             TypeError: The first input argument needs to be a sequence\r\n"]
[196.036, "o", "             \r\n"]
[196.046, "o", "             For parameters: 'median', ('rolling', {'window': 2})\r\n"]
[196.056, "o", "             Traceback (most recent call last):\r\n"]
[196.066, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/server.py\", line 179, in _run_server\r\n"]
[196.076, "o", "                 _run(run_args)\r\n"]
[196.086, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/run.py\", line 72, in _run\r\n"]
[196.096, "o", "                 result = benchmark.do_run()\r\n"]
[196.106, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/benchmarks/_base.py\", line 661, in do_run\r\n"]
[196.116, "o", "                 return self.run(*self._current_params)\r\n"]
[196.126, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/benchmarks/time.py\", line 165, in run\r\n"]
[196.136, "o", "                 samples, number = self.benchmark_timing(\r\n"]
[196.146, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/benchmarks/time.py\", line 258, in benchmark_timing\r\n"]
[196.156, "o", "                 timing = timer.timeit(number)\r\n"]
[196.166, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/timeit.py\", line 177, in timeit\r\n"]
[196.176, "o", "                 timing = self.inner(it, self.timer)\r\n"]
[196.186, "o", "               File \"<timeit-src>\", line 6, in inner\r\n"]
[196.196, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/benchmarks/time.py\", line 90, in func\r\n"]
[196.206, "o", "                 self.func(*param)\r\n"]
[196.216, "o", "               File \"/workspace/repo/asv_bench/benchmarks/rolling.py\", line 309, in time_method\r\n"]
[196.226, "o", "                 getattr(self.groupby_window, method)()\r\n"]
[196.236, "o", "               File \"/workspace/repo/pandas/core/window/rolling.py\", line 2155, in median\r\n"]
[196.246, "o", "                 return super().median(\r\n"]
[196.256, "o", "               File \"/workspace/repo/pandas/core/window/rolling.py\", line 1530, in median\r\n"]
[196.266, "o", "                 return self._apply(window_func, name=\"median\", numeric_only=numeric_only)\r\n"]
[196.276, "o", "               File \"/workspace/repo/pandas/core/window/rolling.py\", line 739, in _apply\r\n"]
[196.286, "o", "                 indexer = np.concatenate(group_indices)\r\n"]
[196.296, "o", "               File \"<__array_function__ internals>\", line 200, in concatenate\r\n"]
[196.306, "o", "             TypeError: The first input argument needs to be a sequence\r\n"]
[196.316, "o", "             \r\n"]
[196.326, "o", "             For parameters: 'median', ('rolling', {'window': '30s'})\r\n"]
[196.336, "o", "             Traceback (most recent call last):\r\n"]
[196.346, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/server.py\", line 179, in _run_server\r\n"]
[196.356, "o", "                 _run(run_args)\r\n"]
[196.366, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/run.py\", line 72, in _run\r\n"]
[196.376, "o", "                 result = benchmark.do_run()\r\n"]
[196.386, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/benchmarks/_base.py\", line 661, in do_run\r\n"]
[196.396, "o", "                 return self.run(*self._current_params)\r\n"]
[196.406, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/benchmarks/time.py\", line 165, in run\r\n"]
[196.416, "o", "                 samples, number = self.benchmark_timing(\r\n"]
[196.426, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/benchmarks/time.py\", line 258, in benchmark_timing\r\n"]
[196.436, "o", "                 timing = timer.timeit(number)\r\n"]
[196.446, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/timeit.py\", line 177, in timeit\r\n"]
[196.456, "o", "                 timing = self.inner(it, self.timer)\r\n"]
[196.466, "o", "               File \"<timeit-src>\", line 6, in inner\r\n"]
[196.476, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/benchmarks/time.py\", line 90, in func\r\n"]
[196.486, "o", "                 self.func(*param)\r\n"]
[196.496, "o", "               File \"/workspace/repo/asv_bench/benchmarks/rolling.py\", line 309, in time_method\r\n"]
[196.506, "o", "                 getattr(self.groupby_window, method)()\r\n"]
[196.516, "o", "               File \"/workspace/repo/pandas/core/window/rolling.py\", line 2155, in median\r\n"]
[196.526, "o", "                 return super().median(\r\n"]
[196.536, "o", "               File \"/workspace/repo/pandas/core/window/rolling.py\", line 1530, in median\r\n"]
[196.546, "o", "                 return self._apply(window_func, name=\"median\", numeric_only=numeric_only)\r\n"]
[196.556, "o", "               File \"/workspace/repo/pandas/core/window/rolling.py\", line 739, in _apply\r\n"]
[196.566, "o", "                 indexer = np.concatenate(group_indices)\r\n"]
[196.576, "o", "               File \"<__array_function__ internals>\", line 200, in concatenate\r\n"]
[196.586, "o", "             TypeError: The first input argument needs to be a sequence\r\n"]
[196.596, "o", "             \r\n"]
[196.606, "o", "             For parameters: 'median', ('expanding', {})\r\n"]
[196.616, "o", "             Traceback (most recent call last):\r\n"]
[196.626, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/server.py\", line 179, in _run_server\r\n"]
[196.636, "o", "                 _run(run_args)\r\n"]
[196.646, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/run.py\", line 72, in _run\r\n"]
[196.656, "o", "                 result = benchmark.do_run()\r\n"]
[196.666, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/benchmarks/_base.py\", line 661, in do_run\r\n"]
[196.676, "o", "                 return self.run(*self._current_params)\r\n"]
[196.686, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/benchmarks/time.py\", line 165, in run\r\n"]
[196.696, "o", "                 samples, number = self.benchmark_timing(\r\n"]
[196.706, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/benchmarks/time.py\", line 258, in benchmark_timing\r\n"]
[196.716, "o", "                 timing = timer.timeit(number)\r\n"]
[196.726, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/timeit.py\", line 177, in timeit\r\n"]
[196.736, "o", "                 timing = self.inner(it, self.timer)\r\n"]
[196.746, "o", "               File \"<timeit-src>\", line 6, in inner\r\n"]
[196.756, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/benchmarks/time.py\", line 90, in func\r\n"]
[196.766, "o", "                 self.func(*param)\r\n"]
[196.776, "o", "               File \"/workspace/repo/asv_bench/benchmarks/rolling.py\", line 309, in time_method\r\n"]
[196.786, "o", "                 getattr(self.groupby_window, method)()\r\n"]
[196.796, "o", "               File \"/workspace/repo/pandas/core/window/expanding.py\", line 347, in median\r\n"]
[196.806, "o", "                 return super().median(\r\n"]
[196.816, "o", "               File \"/workspace/repo/pandas/core/window/rolling.py\", line 1530, in median\r\n"]
[196.826, "o", "                 return self._apply(window_func, name=\"median\", numeric_only=numeric_only)\r\n"]
[196.836, "o", "               File \"/workspace/repo/pandas/core/window/rolling.py\", line 739, in _apply\r\n"]
[196.846, "o", "                 indexer = np.concatenate(group_indices)\r\n"]
[196.856, "o", "               File \"<__array_function__ internals>\", line 200, in concatenate\r\n"]
[196.866, "o", "             TypeError: The first input argument needs to be a sequence\r\n"]
[196.876, "o", "             \r\n"]
[196.886, "o", "             For parameters: 'mean', ('rolling', {'window': 2})\r\n"]
[196.896, "o", "             Traceback (most recent call last):\r\n"]
[196.906, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/server.py\", line 179, in _run_server\r\n"]
[196.916, "o", "                 _run(run_args)\r\n"]
[196.926, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/run.py\", line 72, in _run\r\n"]
[196.936, "o", "                 result = benchmark.do_run()\r\n"]
[196.946, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/benchmarks/_base.py\", line 661, in do_run\r\n"]
[196.956, "o", "                 return self.run(*self._current_params)\r\n"]
[196.966, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/benchmarks/time.py\", line 165, in run\r\n"]
[196.976, "o", "                 samples, number = self.benchmark_timing(\r\n"]
[196.986, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/benchmarks/time.py\", line 258, in benchmark_timing\r\n"]
[196.996, "o", "                 timing = timer.timeit(number)\r\n"]
[197.006, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/timeit.py\", line 177, in timeit\r\n"]
[197.016, "o", "                 timing = self.inner(it, self.timer)\r\n"]
[197.026, "o", "               File \"<timeit-src>\", line 6, in inner\r\n"]
[197.036, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/benchmarks/time.py\", line 90, in func\r\n"]
[197.046, "o", "                 self.func(*param)\r\n"]
[197.056, "o", "               File \"/workspace/repo/asv_bench/benchmarks/rolling.py\", line 309, in time_method\r\n"]
[197.066, "o", "                 getattr(self.groupby_window, method)()\r\n"]
[197.076, "o", "               File \"/workspace/repo/pandas/core/window/rolling.py\", line 2113, in mean\r\n"]
[197.086, "o", "                 return super().mean(\r\n"]
[197.096, "o", "               File \"/workspace/repo/pandas/core/window/rolling.py\", line 1509, in mean\r\n"]
[197.106, "o", "                 return self._apply(window_func, name=\"mean\", numeric_only=numeric_only)\r\n"]
[197.116, "o", "               File \"/workspace/repo/pandas/core/window/rolling.py\", line 739, in _apply\r\n"]
[197.126, "o", "                 indexer = np.concatenate(group_indices)\r\n"]
[197.136, "o", "               File \"<__array_function__ internals>\", line 200, in concatenate\r\n"]
[197.146, "o", "             TypeError: The first input argument needs to be a sequence\r\n"]
[197.156, "o", "             \r\n"]
[197.166, "o", "             For parameters: 'mean', ('rolling', {'window': '30s'})\r\n"]
[197.176, "o", "             Traceback (most recent call last):\r\n"]
[197.186, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/server.py\", line 179, in _run_server\r\n"]
[197.196, "o", "                 _run(run_args)\r\n"]
[197.206, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/run.py\", line 72, in _run\r\n"]
[197.216, "o", "                 result = benchmark.do_run()\r\n"]
[197.226, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/benchmarks/_base.py\", line 661, in do_run\r\n"]
[197.236, "o", "                 return self.run(*self._current_params)\r\n"]
[197.246, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/benchmarks/time.py\", line 165, in run\r\n"]
[197.256, "o", "                 samples, number = self.benchmark_timing(\r\n"]
[197.266, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/benchmarks/time.py\", line 258, in benchmark_timing\r\n"]
[197.276, "o", "                 timing = timer.timeit(number)\r\n"]
[197.286, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/timeit.py\", line 177, in timeit\r\n"]
[197.296, "o", "                 timing = self.inner(it, self.timer)\r\n"]
[197.306, "o", "               File \"<timeit-src>\", line 6, in inner\r\n"]
[197.316, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/benchmarks/time.py\", line 90, in func\r\n"]
[197.326, "o", "                 self.func(*param)\r\n"]
[197.336, "o", "               File \"/workspace/repo/asv_bench/benchmarks/rolling.py\", line 309, in time_method\r\n"]
[197.346, "o", "                 getattr(self.groupby_window, method)()\r\n"]
[197.356, "o", "               File \"/workspace/repo/pandas/core/window/rolling.py\", line 2113, in mean\r\n"]
[197.366, "o", "                 return super().mean(\r\n"]
[197.376, "o", "               File \"/workspace/repo/pandas/core/window/rolling.py\", line 1509, in mean\r\n"]
[197.386, "o", "                 return self._apply(window_func, name=\"mean\", numeric_only=numeric_only)\r\n"]
[197.396, "o", "               File \"/workspace/repo/pandas/core/window/rolling.py\", line 739, in _apply\r\n"]
[197.406, "o", "                 indexer = np.concatenate(group_indices)\r\n"]
[197.416, "o", "               File \"<__array_function__ internals>\", line 200, in concatenate\r\n"]
[197.426, "o", "             TypeError: The first input argument needs to be a sequence\r\n"]
[197.436, "o", "             \r\n"]
[197.446, "o", "             For parameters: 'mean', ('expanding', {})\r\n"]
[197.456, "o", "             Traceback (most recent call last):\r\n"]
[197.466, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/server.py\", line 179, in _run_server\r\n"]
[197.476, "o", "                 _run(run_args)\r\n"]
[197.486, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/run.py\", line 72, in _run\r\n"]
[197.496, "o", "                 result = benchmark.do_run()\r\n"]
[197.506, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/benchmarks/_base.py\", line 661, in do_run\r\n"]
[197.516, "o", "                 return self.run(*self._current_params)\r\n"]
[197.526, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/benchmarks/time.py\", line 165, in run\r\n"]
[197.536, "o", "                 samples, number = self.benchmark_timing(\r\n"]
[197.546, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/benchmarks/time.py\", line 258, in benchmark_timing\r\n"]
[197.556, "o", "                 timing = timer.timeit(number)\r\n"]
[197.566, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/timeit.py\", line 177, in timeit\r\n"]
[197.576, "o", "                 timing = self.inner(it, self.timer)\r\n"]
[197.586, "o", "               File \"<timeit-src>\", line 6, in inner\r\n"]
[197.596, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/benchmarks/time.py\", line 90, in func\r\n"]
[197.606, "o", "                 self.func(*param)\r\n"]
[197.616, "o", "               File \"/workspace/repo/asv_bench/benchmarks/rolling.py\", line 309, in time_method\r\n"]
[197.626, "o", "                 getattr(self.groupby_window, method)()\r\n"]
[197.636, "o", "               File \"/workspace/repo/pandas/core/window/expanding.py\", line 320, in mean\r\n"]
[197.646, "o", "                 return super().mean(\r\n"]
[197.656, "o", "               File \"/workspace/repo/pandas/core/window/rolling.py\", line 1509, in mean\r\n"]
[197.666, "o", "                 return self._apply(window_func, name=\"mean\", numeric_only=numeric_only)\r\n"]
[197.676, "o", "               File \"/workspace/repo/pandas/core/window/rolling.py\", line 739, in _apply\r\n"]
[197.686, "o", "                 indexer = np.concatenate(group_indices)\r\n"]
[197.696, "o", "               File \"<__array_function__ internals>\", line 200, in concatenate\r\n"]
[197.706, "o", "             TypeError: The first input argument needs to be a sequence\r\n"]
[197.716, "o", "             \r\n"]
[197.726, "o", "             For parameters: 'max', ('rolling', {'window': 2})\r\n"]
[197.736, "o", "             Traceback (most recent call last):\r\n"]
[197.746, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/server.py\", line 179, in _run_server\r\n"]
[197.756, "o", "                 _run(run_args)\r\n"]
[197.766, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/run.py\", line 72, in _run\r\n"]
[197.776, "o", "                 result = benchmark.do_run()\r\n"]
[197.786, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/benchmarks/_base.py\", line 661, in do_run\r\n"]
[197.796, "o", "                 return self.run(*self._current_params)\r\n"]
[197.806, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/benchmarks/time.py\", line 165, in run\r\n"]
[197.816, "o", "                 samples, number = self.benchmark_timing(\r\n"]
[197.826, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/benchmarks/time.py\", line 258, in benchmark_timing\r\n"]
[197.836, "o", "                 timing = timer.timeit(number)\r\n"]
[197.846, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/timeit.py\", line 177, in timeit\r\n"]
[197.856, "o", "                 timing = self.inner(it, self.timer)\r\n"]
[197.866, "o", "               File \"<timeit-src>\", line 6, in inner\r\n"]
[197.876, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/benchmarks/time.py\", line 90, in func\r\n"]
[197.886, "o", "                 self.func(*param)\r\n"]
[197.896, "o", "               File \"/workspace/repo/asv_bench/benchmarks/rolling.py\", line 309, in time_method\r\n"]
[197.906, "o", "                 getattr(self.groupby_window, method)()\r\n"]
[197.916, "o", "               File \"/workspace/repo/pandas/core/window/rolling.py\", line 2022, in max\r\n"]
[197.926, "o", "                 return super().max(\r\n"]
[197.936, "o", "               File \"/workspace/repo/pandas/core/window/rolling.py\", line 1465, in max\r\n"]
[197.946, "o", "                 return self._apply(window_func, name=\"max\", numeric_only=numeric_only)\r\n"]
[197.956, "o", "               File \"/workspace/repo/pandas/core/window/rolling.py\", line 739, in _apply\r\n"]
[197.966, "o", "                 indexer = np.concatenate(group_indices)\r\n"]
[197.976, "o", "               File \"<__array_function__ internals>\", line 200, in concatenate\r\n"]
[197.986, "o", "             TypeError: The first input argument needs to be a sequence\r\n"]
[197.996, "o", "             \r\n"]
[198.006, "o", "             For parameters: 'max', ('rolling', {'window': '30s'})\r\n"]
[198.016, "o", "             Traceback (most recent call last):\r\n"]
[198.026, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/server.py\", line 179, in _run_server\r\n"]
[198.036, "o", "                 _run(run_args)\r\n"]
[198.046, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/run.py\", line 72, in _run\r\n"]
[198.056, "o", "                 result = benchmark.do_run()\r\n"]
[198.066, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/benchmarks/_base.py\", line 661, in do_run\r\n"]
[198.076, "o", "                 return self.run(*self._current_params)\r\n"]
[198.086, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/benchmarks/time.py\", line 165, in run\r\n"]
[198.096, "o", "                 samples, number = self.benchmark_timing(\r\n"]
[198.106, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/benchmarks/time.py\", line 258, in benchmark_timing\r\n"]
[198.116, "o", "                 timing = timer.timeit(number)\r\n"]
[198.126, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/timeit.py\", line 177, in timeit\r\n"]
[198.136, "o", "                 timing = self.inner(it, self.timer)\r\n"]
[198.146, "o", "               File \"<timeit-src>\", line 6, in inner\r\n"]
[198.156, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/benchmarks/time.py\", line 90, in func\r\n"]
[198.166, "o", "                 self.func(*param)\r\n"]
[198.176, "o", "               File \"/workspace/repo/asv_bench/benchmarks/rolling.py\", line 309, in time_method\r\n"]
[198.186, "o", "                 getattr(self.groupby_window, method)()\r\n"]
[198.196, "o", "               File \"/workspace/repo/pandas/core/window/rolling.py\", line 2022, in max\r\n"]
[198.206, "o", "                 return super().max(\r\n"]
[198.216, "o", "               File \"/workspace/repo/pandas/core/window/rolling.py\", line 1465, in max\r\n"]
[198.226, "o", "                 return self._apply(window_func, name=\"max\", numeric_only=numeric_only)\r\n"]
[198.236, "o", "               File \"/workspace/repo/pandas/core/window/rolling.py\", line 739, in _apply\r\n"]
[198.246, "o", "                 indexer = np.concatenate(group_indices)\r\n"]
[198.256, "o", "               File \"<__array_function__ internals>\", line 200, in concatenate\r\n"]
[198.266, "o", "             TypeError: The first input argument needs to be a sequence\r\n"]
[198.276, "o", "             \r\n"]
[198.286, "o", "             For parameters: 'max', ('expanding', {})\r\n"]
[198.296, "o", "             Traceback (most recent call last):\r\n"]
[198.306, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/server.py\", line 179, in _run_server\r\n"]
[198.316, "o", "                 _run(run_args)\r\n"]
[198.326, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/run.py\", line 72, in _run\r\n"]
[198.336, "o", "                 result = benchmark.do_run()\r\n"]
[198.346, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/benchmarks/_base.py\", line 661, in do_run\r\n"]
[198.356, "o", "                 return self.run(*self._current_params)\r\n"]
[198.366, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/benchmarks/time.py\", line 165, in run\r\n"]
[198.376, "o", "                 samples, number = self.benchmark_timing(\r\n"]
[198.386, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/benchmarks/time.py\", line 258, in benchmark_timing\r\n"]
[198.396, "o", "                 timing = timer.timeit(number)\r\n"]
[198.406, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/timeit.py\", line 177, in timeit\r\n"]
[198.416, "o", "                 timing = self.inner(it, self.timer)\r\n"]
[198.426, "o", "               File \"<timeit-src>\", line 6, in inner\r\n"]
[198.436, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/benchmarks/time.py\", line 90, in func\r\n"]
[198.446, "o", "                 self.func(*param)\r\n"]
[198.456, "o", "               File \"/workspace/repo/asv_bench/benchmarks/rolling.py\", line 309, in time_method\r\n"]
[198.466, "o", "                 getattr(self.groupby_window, method)()\r\n"]
[198.476, "o", "               File \"/workspace/repo/pandas/core/window/expanding.py\", line 266, in max\r\n"]
[198.486, "o", "                 return super().max(\r\n"]
[198.496, "o", "               File \"/workspace/repo/pandas/core/window/rolling.py\", line 1465, in max\r\n"]
[198.506, "o", "                 return self._apply(window_func, name=\"max\", numeric_only=numeric_only)\r\n"]
[198.516, "o", "               File \"/workspace/repo/pandas/core/window/rolling.py\", line 739, in _apply\r\n"]
[198.526, "o", "                 indexer = np.concatenate(group_indices)\r\n"]
[198.536, "o", "               File \"<__array_function__ internals>\", line 200, in concatenate\r\n"]
[198.546, "o", "             TypeError: The first input argument needs to be a sequence\r\n"]
[198.556, "o", "             \r\n"]
[198.566, "o", "             For parameters: 'min', ('rolling', {'window': 2})\r\n"]
[198.576, "o", "             Traceback (most recent call last):\r\n"]
[198.586, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/server.py\", line 179, in _run_server\r\n"]
[198.596, "o", "                 _run(run_args)\r\n"]
[198.606, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/run.py\", line 72, in _run\r\n"]
[198.616, "o", "                 result = benchmark.do_run()\r\n"]
[198.626, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/benchmarks/_base.py\", line 661, in do_run\r\n"]
[198.636, "o", "                 return self.run(*self._current_params)\r\n"]
[198.646, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/benchmarks/time.py\", line 165, in run\r\n"]
[198.656, "o", "                 samples, number = self.benchmark_timing(\r\n"]
[198.666, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/benchmarks/time.py\", line 258, in benchmark_timing\r\n"]
[198.676, "o", "                 timing = timer.timeit(number)\r\n"]
[198.686, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/timeit.py\", line 177, in timeit\r\n"]
[198.696, "o", "                 timing = self.inner(it, self.timer)\r\n"]
[198.706, "o", "               File \"<timeit-src>\", line 6, in inner\r\n"]
[198.716, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/benchmarks/time.py\", line 90, in func\r\n"]
[198.726, "o", "                 self.func(*param)\r\n"]
[198.736, "o", "               File \"/workspace/repo/asv_bench/benchmarks/rolling.py\", line 309, in time_method\r\n"]
[198.746, "o", "                 getattr(self.groupby_window, method)()\r\n"]
[198.756, "o", "               File \"/workspace/repo/pandas/core/window/rolling.py\", line 2064, in min\r\n"]
[198.766, "o", "                 return super().min(\r\n"]
[198.776, "o", "               File \"/workspace/repo/pandas/core/window/rolling.py\", line 1487, in min\r\n"]
[198.786, "o", "                 return self._apply(window_func, name=\"min\", numeric_only=numeric_only)\r\n"]
[198.796, "o", "               File \"/workspace/repo/pandas/core/window/rolling.py\", line 739, in _apply\r\n"]
[198.806, "o", "                 indexer = np.concatenate(group_indices)\r\n"]
[198.816, "o", "               File \"<__array_function__ internals>\", line 200, in concatenate\r\n"]
[198.826, "o", "             TypeError: The first input argument needs to be a sequence\r\n"]
[198.836, "o", "             \r\n"]
[198.846, "o", "             For parameters: 'min', ('rolling', {'window': '30s'})\r\n"]
[198.856, "o", "             Traceback (most recent call last):\r\n"]
[198.866, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/server.py\", line 179, in _run_server\r\n"]
[198.876, "o", "                 _run(run_args)\r\n"]
[198.886, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/run.py\", line 72, in _run\r\n"]
[198.896, "o", "                 result = benchmark.do_run()\r\n"]
[198.906, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/benchmarks/_base.py\", line 661, in do_run\r\n"]
[198.916, "o", "                 return self.run(*self._current_params)\r\n"]
[198.926, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/benchmarks/time.py\", line 165, in run\r\n"]
[198.936, "o", "                 samples, number = self.benchmark_timing(\r\n"]
[198.946, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/benchmarks/time.py\", line 258, in benchmark_timing\r\n"]
[198.956, "o", "                 timing = timer.timeit(number)\r\n"]
[198.966, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/timeit.py\", line 177, in timeit\r\n"]
[198.976, "o", "                 timing = self.inner(it, self.timer)\r\n"]
[198.986, "o", "               File \"<timeit-src>\", line 6, in inner\r\n"]
[198.996, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/benchmarks/time.py\", line 90, in func\r\n"]
[199.006, "o", "                 self.func(*param)\r\n"]
[199.016, "o", "               File \"/workspace/repo/asv_bench/benchmarks/rolling.py\", line 309, in time_method\r\n"]
[199.026, "o", "                 getattr(self.groupby_window, method)()\r\n"]
[199.036, "o", "               File \"/workspace/repo/pandas/core/window/rolling.py\", line 2064, in min\r\n"]
[199.046, "o", "                 return super().min(\r\n"]
[199.056, "o", "               File \"/workspace/repo/pandas/core/window/rolling.py\", line 1487, in min\r\n"]
[199.066, "o", "                 return self._apply(window_func, name=\"min\", numeric_only=numeric_only)\r\n"]
[199.076, "o", "               File \"/workspace/repo/pandas/core/window/rolling.py\", line 739, in _apply\r\n"]
[199.086, "o", "                 indexer = np.concatenate(group_indices)\r\n"]
[199.096, "o", "               File \"<__array_function__ internals>\", line 200, in concatenate\r\n"]
[199.106, "o", "             TypeError: The first input argument needs to be a sequence\r\n"]
[199.116, "o", "             \r\n"]
[199.126, "o", "             For parameters: 'min', ('expanding', {})\r\n"]
[199.136, "o", "             Traceback (most recent call last):\r\n"]
[199.146, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/server.py\", line 179, in _run_server\r\n"]
[199.156, "o", "                 _run(run_args)\r\n"]
[199.166, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/run.py\", line 72, in _run\r\n"]
[199.176, "o", "                 result = benchmark.do_run()\r\n"]
[199.186, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/benchmarks/_base.py\", line 661, in do_run\r\n"]
[199.196, "o", "                 return self.run(*self._current_params)\r\n"]
[199.206, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/benchmarks/time.py\", line 165, in run\r\n"]
[199.216, "o", "                 samples, number = self.benchmark_timing(\r\n"]
[199.226, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/benchmarks/time.py\", line 258, in benchmark_timing\r\n"]
[199.236, "o", "                 timing = timer.timeit(number)\r\n"]
[199.246, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/timeit.py\", line 177, in timeit\r\n"]
[199.256, "o", "                 timing = self.inner(it, self.timer)\r\n"]
[199.266, "o", "               File \"<timeit-src>\", line 6, in inner\r\n"]
[199.276, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/benchmarks/time.py\", line 90, in func\r\n"]
[199.286, "o", "                 self.func(*param)\r\n"]
[199.296, "o", "               File \"/workspace/repo/asv_bench/benchmarks/rolling.py\", line 309, in time_method\r\n"]
[199.306, "o", "                 getattr(self.groupby_window, method)()\r\n"]
[199.316, "o", "               File \"/workspace/repo/pandas/core/window/expanding.py\", line 293, in min\r\n"]
[199.326, "o", "                 return super().min(\r\n"]
[199.336, "o", "               File \"/workspace/repo/pandas/core/window/rolling.py\", line 1487, in min\r\n"]
[199.346, "o", "                 return self._apply(window_func, name=\"min\", numeric_only=numeric_only)\r\n"]
[199.356, "o", "               File \"/workspace/repo/pandas/core/window/rolling.py\", line 739, in _apply\r\n"]
[199.366, "o", "                 indexer = np.concatenate(group_indices)\r\n"]
[199.376, "o", "               File \"<__array_function__ internals>\", line 200, in concatenate\r\n"]
[199.386, "o", "             TypeError: The first input argument needs to be a sequence\r\n"]
[199.396, "o", "             \r\n"]
[199.406, "o", "             For parameters: 'kurt', ('rolling', {'window': 2})\r\n"]
[199.416, "o", "             Traceback (most recent call last):\r\n"]
[199.426, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/server.py\", line 179, in _run_server\r\n"]
[199.436, "o", "                 _run(run_args)\r\n"]
[199.446, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/run.py\", line 72, in _run\r\n"]
[199.456, "o", "                 result = benchmark.do_run()\r\n"]
[199.466, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/benchmarks/_base.py\", line 661, in do_run\r\n"]
[199.476, "o", "                 return self.run(*self._current_params)\r\n"]
[199.486, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/benchmarks/time.py\", line 165, in run\r\n"]
[199.496, "o", "                 samples, number = self.benchmark_timing(\r\n"]
[199.506, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/benchmarks/time.py\", line 258, in benchmark_timing\r\n"]
[199.516, "o", "                 timing = timer.timeit(number)\r\n"]
[199.526, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/timeit.py\", line 177, in timeit\r\n"]
[199.536, "o", "                 timing = self.inner(it, self.timer)\r\n"]
[199.546, "o", "               File \"<timeit-src>\", line 6, in inner\r\n"]
[199.556, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/benchmarks/time.py\", line 90, in func\r\n"]
[199.566, "o", "                 self.func(*param)\r\n"]
[199.576, "o", "               File \"/workspace/repo/asv_bench/benchmarks/rolling.py\", line 309, in time_method\r\n"]
[199.586, "o", "                 getattr(self.groupby_window, method)()\r\n"]
[199.596, "o", "               File \"/workspace/repo/pandas/core/window/rolling.py\", line 2375, in kurt\r\n"]
[199.606, "o", "                 return super().kurt(numeric_only=numeric_only)\r\n"]
[199.616, "o", "               File \"/workspace/repo/pandas/core/window/rolling.py\", line 1593, in kurt\r\n"]
[199.626, "o", "                 return self._apply(\r\n"]
[199.636, "o", "               File \"/workspace/repo/pandas/core/window/rolling.py\", line 739, in _apply\r\n"]
[199.646, "o", "                 indexer = np.concatenate(group_indices)\r\n"]
[199.656, "o", "               File \"<__array_function__ internals>\", line 200, in concatenate\r\n"]
[199.666, "o", "             TypeError: The first input argument needs to be a sequence\r\n"]
[199.676, "o", "             \r\n"]
[199.686, "o", "             For parameters: 'kurt', ('rolling', {'window': '30s'})\r\n"]
[199.696, "o", "             Traceback (most recent call last):\r\n"]
[199.706, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/server.py\", line 179, in _run_server\r\n"]
[199.716, "o", "                 _run(run_args)\r\n"]
[199.726, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/run.py\", line 72, in _run\r\n"]
[199.736, "o", "                 result = benchmark.do_run()\r\n"]
[199.746, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/benchmarks/_base.py\", line 661, in do_run\r\n"]
[199.756, "o", "                 return self.run(*self._current_params)\r\n"]
[199.766, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/benchmarks/time.py\", line 165, in run\r\n"]
[199.776, "o", "                 samples, number = self.benchmark_timing(\r\n"]
[199.786, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/benchmarks/time.py\", line 258, in benchmark_timing\r\n"]
[199.796, "o", "                 timing = timer.timeit(number)\r\n"]
[199.806, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/timeit.py\", line 177, in timeit\r\n"]
[199.816, "o", "                 timing = self.inner(it, self.timer)\r\n"]
[199.826, "o", "               File \"<timeit-src>\", line 6, in inner\r\n"]
[199.836, "o", "               File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/benchmarks/time.py\", line 90, in func\r\n"]
[199.846, "o", "                 self.func(*param)\r\n"]
[199.856, "o", "               File \"/workspace/repo/asv_bench/benchmarks/rolling.py\", line 309, in time_method\r\n"]
[199.866, "o", "                 getattr(self.groupby_window, method)()\r\n"]
[199.876, "o", "               File \"/workspace/repo/pandas/core/window/rolling.py\", line 2375, in kurt\r\n"]
[199.886, "o", "                 return super().kurt(numeric_only=numeric_only)\r\n"]
[199.896, "o", "               File \"/workspace/repo/pandas/core/window/rolling.py\", line 1593, in kurt\r\n"]
[199.906, "o", "                 return self._apply(\r\n"]
[199.916, "o", "               File \"/workspace/repo/pandas/core/window/rolling.py\", line 739, in _apply\r\n"]
[199.926, "o", "                 indexer = np.concatenate(group_indices)\r\n"]
[199.936, "o", "               File \"<__array_function__ internals>\", line 200, in concatenate\r\n"]
[200.0, "o", "(asv_3.8) root@7e2a5ae1b193:/workspace/repo/asv_bench# "]
[200.002, "i", "cd ..\r"]
[200.004, "o", "cd ..\r\n"]
[200.006, "o", "\u001b[?2004l\r\n"]
[205.0, "o", "(asv_3.8) root@7e2a5ae1b193:/workspace/repo# "]
[205.002, "i", "python3 -c \"\r"]
[205.004, "o", "python3 -c \"\r\n"]
[205.1296, "o", "\u001b[?2004l\r\n"]
[205.2532, "o", "\u001b[?2004h> import re\r\n"]
[205.3768, "o", "\u001b[?2004l\r\n"]
[205.5004, "o", "\u001b[?2004h> \r\n"]
[205.624, "o", "\u001b[?2004l\r\n"]
[205.7476, "o", "\u001b[?2004h> # Read the current file\r\n"]
[205.8712, "o", "\u001b[?2004l\r\n"]
[205.9948, "o", "\u001b[?2004h> with open('pandas/core/window/rolling.py', 'r') as f:\r\n"]
[206.1184, "o", "\u001b[?2004l\r\n"]
[206.242, "o", "\u001b[?2004h>     content = f.read()\r\n"]
[206.3656, "o", "\u001b[?2004l\r\n"]
[206.4892, "o", "\u001b[?2004h> \r\n"]
[206.6128, "o", "\u001b[?2004l\r\n"]
[206.7364, "o", "\u001b[?2004h> # Fix the concatenation issue - revert back to using list()\r\n"]
[206.86, "o", "\u001b[?2004l\r\n"]
[206.9836, "o", "\u001b[?2004h> content = re.sub(\r\n"]
[207.1072, "o", "\u001b[?2004l\r\n"]
[207.2308, "o", "\u001b[?2004h>     r'indexer = np\\.concatenate\\(group_indices\\)',\r\n"]
[207.3544, "o", "\u001b[?2004l\r\n"]
[207.478, "o", "\u001b[?2004h>     'indexer = np.concatenate(list(group_indices))',\r\n"]
[207.6016, "o", "\u001b[?2004l\r\n"]
[207.7252, "o", "\u001b[?2004h>     content\r\n"]
[207.8488, "o", "\u001b[?2004l\r\n"]
[207.9724, "o", "\u001b[?2004h> )\r\n"]
[208.096, "o", "\u001b[?2004l\r\n"]
[208.2196, "o", "\u001b[?2004h> \r\n"]
[208.3432, "o", "\u001b[?2004l\r\n"]
[208.4668, "o", "\u001b[?2004h> # Write back the fixed content\r\n"]
[208.5904, "o", "\u001b[?2004l\r\n"]
[208.714, "o", "\u001b[?2004h> with open('pandas/core/window/rolling.py', 'w') as f:\r\n"]
[208.8376, "o", "\u001b[?2004l\r\n"]
[208.9612, "o", "\u001b[?2004h>     f.write(content)\r\n"]
[209.0848, "o", "\u001b[?2004l\r\n"]
[209.2084, "o", "\u001b[?2004h> \r\n"]
[209.332, "o", "\u001b[?2004l\r\n"]
[209.4556, "o", "\u001b[?2004h> print('Fixed concatenation issue while keeping other optimizations')\r\n"]
[209.5792, "o", "\u001b[?2004l\r\n"]
[209.7028, "o", "\u001b[?2004h> \"\r\n"]
[209.8264, "o", "\u001b[?2004l\r\n"]
[210.0, "o", "(asv_3.8) root@7e2a5ae1b193:/workspace/repo# "]
[210.002, "i", "sed -n '735,745p' pandas/core/window/rolling.py\r"]
[210.004, "o", "sed -n '735,745p' pandas/core/window/rolling.py\r\n"]
[210.418, "o", "\u001b[?2004l\r\n"]
[210.83, "o", "        levels = copy.copy(self._grouper.levels)\r\n"]
[211.242, "o", "\r\n"]
[211.654, "o", "        group_indices = self._grouper.indices.values()\r\n"]
[212.066, "o", "        if group_indices:\r\n"]
[212.478, "o", "            indexer = np.concatenate(list(group_indices))\r\n"]
[212.89, "o", "        else:\r\n"]
[213.302, "o", "            indexer = np.array([], dtype=np.intp)\r\n"]
[213.714, "o", "        codes = [c[indexer] for c in codes]\r\n"]
[214.126, "o", "\r\n"]
[214.538, "o", "        # if the index of the original dataframe needs to be preserved, append\r\n"]
[215.0, "o", "(asv_3.8) root@7e2a5ae1b193:/workspace/repo# "]
[215.002, "i", "cd asv_bench\r"]
[215.004, "o", "cd asv_bench\r\n"]
[215.006, "o", "\u001b[?2004l\r\n"]
[220.0, "o", "(asv_3.8) root@7e2a5ae1b193:/workspace/repo/asv_bench# "]
[220.002, "i", "asv run --python=same --bench=\"rolling.Groupby.*\"\r"]
[220.004, "o", "asv run --python=same --bench=\"rolling.Groupby.*\"\r\n"]
[220.132769, "o", "\u001b[?2004l\r\n"]
[220.259538, "o", "\u00b7 \u001b[0;32mDiscovering benchmarks\u001b[0m\r\n"]
[220.386308, "o", "\u00b7 \u001b[0;32mRunning 4 total benchmarks (1 commits * 1 environments * 4 benchmarks)\u001b[0m\r\n"]
[220.513077, "o", "[ 0.00%] \u00b7\u00b7 \u001b[0;34mBenchmarking existing-py_opt_conda_envs_asv_3.8_bin_python\u001b[0m\r\n"]
[220.639846, "o", "[12.50%] \u00b7\u00b7\u00b7 \u001b[0;39mRunning (rolling.Groupby.time_method--)\u001b[0m....\r\n"]
[220.766615, "o", "[62.50%] \u00b7\u00b7\u00b7 \u001b[0;39mrolling.Groupby.time_method\u001b[0m                                                                                                                     ok\r\n"]
[220.893385, "o", "[62.50%] \u00b7\u00b7\u00b7 \u001b[0;39m=========== ============================ ================================ ===================\u001b[0m\r\n"]
[221.020154, "o", "             --                                                param2                                     \r\n"]
[221.146923, "o", "             ----------- ---------------------------------------------------------------------------------\r\n"]
[221.273692, "o", "                param1    ('rolling', {'window': 2})   ('rolling', {'window': '30s'})   ('expanding', {}) \r\n"]
[221.400462, "o", "             =========== ============================ ================================ ===================\r\n"]
[221.527231, "o", "              'sum' (0)           40.2\u00b10.7ms                     16.6\u00b10.2ms                15.1\u00b10.08ms    \r\n"]
[221.654, "o", "                median            45.0\u00b110ms                      19.5\u00b10.2ms                 17.9\u00b10.2ms    \r\n"]
[221.780769, "o", "                 mean             40.8\u00b10.5ms                     16.5\u00b10.2ms                 15.5\u00b10.1ms    \r\n"]
[221.907538, "o", "                 max              40.6\u00b10.6ms                     16.8\u00b10.2ms                 15.4\u00b10.2ms    \r\n"]
[222.034308, "o", "                 min              40.5\u00b10.2ms                     16.6\u00b10.4ms                 15.7\u00b10.3ms    \r\n"]
[222.161077, "o", "                 kurt             40.9\u00b10.5ms                     16.6\u00b10.3ms                 15.6\u00b10.2ms    \r\n"]
[222.287846, "o", "              'sum' (1)           40.4\u00b10.2ms                     16.6\u00b10.2ms                 15.3\u00b10.2ms    \r\n"]
[222.414615, "o", "             =========== ============================ ================================ ===================\r\n"]
[222.541385, "o", "\r\n"]
[222.668154, "o", "[75.00%] \u00b7\u00b7\u00b7 \u001b[0;39mrolling.GroupbyEWM.time_groupby_method\u001b[0m                                                                                                          ok\r\n"]
[222.794923, "o", "[75.00%] \u00b7\u00b7\u00b7 \u001b[0;39m======== =============\u001b[0m\r\n"]
[222.921692, "o", "              method               \r\n"]
[223.048462, "o", "             -------- -------------\r\n"]
[223.175231, "o", "               var      1.13\u00b10.2ms \r\n"]
[223.302, "o", "               std     1.26\u00b10.02ms \r\n"]
[223.428769, "o", "               cov      4.19\u00b10.2ms \r\n"]
[223.555538, "o", "               corr     3.83\u00b10.1ms \r\n"]
[223.682308, "o", "             ======== =============\r\n"]
[223.809077, "o", "\r\n"]
[223.935846, "o", "[87.50%] \u00b7\u00b7\u00b7 \u001b[0;39mrolling.GroupbyEWMEngine.time_groupby_mean\u001b[0m                                                                                                      ok\r\n"]
[224.062615, "o", "[87.50%] \u00b7\u00b7\u00b7 \u001b[0;39m======== =============\u001b[0m\r\n"]
[224.189385, "o", "              engine               \r\n"]
[224.316154, "o", "             -------- -------------\r\n"]
[224.442923, "o", "              cython   1.05\u00b10.01ms \r\n"]
[224.569692, "o", "              numba     1.47\u00b10.1ms \r\n"]
[224.696462, "o", "             ======== =============\r\n"]
[224.823231, "o", "\r\n"]
[225.0, "o", "(asv_3.8) root@7e2a5ae1b193:/workspace/repo/asv_bench# "]
[225.002, "i", "cd ..\r"]
[225.004, "o", "cd ..\r\n"]
[225.006, "o", "\u001b[?2004l\r\n"]
[230.0, "o", "(asv_3.8) root@7e2a5ae1b193:/workspace/repo# "]
[230.002, "i", "grep -n \"def _apply\" pandas/core/window/rolling.py | head -5\r"]
[230.004, "o", "grep -n \"def _apply\" pandas/core/window/rolling.py | head -5\r\n"]
[230.83, "o", "\u001b[?2004l\r\n"]
[231.654, "o", "436:    def _apply_series(\r\n"]
[232.478, "o", "456:    def _apply_blockwise(\r\n"]
[233.302, "o", "509:    def _apply_tablewise(\r\n"]
[234.126, "o", "535:    def _apply_pairwise(\r\n"]
[235.0, "o", "(asv_3.8) root@7e2a5ae1b193:/workspace/repo# "]
[235.002, "i", "sed -n '558,600p' pandas/core/window/rolling.py\r"]
[235.004, "o", "sed -n '558,600p' pandas/core/window/rolling.py\r\n"]
[235.118364, "o", "\u001b[?2004l\r\n"]
[235.230727, "o", "    def _apply(\r\n"]
[235.343091, "o", "        self,\r\n"]
[235.455455, "o", "        func: Callable[..., Any],\r\n"]
[235.567818, "o", "        name: str,\r\n"]
[235.680182, "o", "        numeric_only: bool = False,\r\n"]
[235.792545, "o", "        numba_args: tuple[Any, ...] = (),\r\n"]
[235.904909, "o", "        **kwargs,\r\n"]
[236.017273, "o", "    ):\r\n"]
[236.129636, "o", "        \"\"\"\r\n"]
[236.242, "o", "        Rolling statistical measure using supplied function.\r\n"]
[236.354364, "o", "\r\n"]
[236.466727, "o", "        Designed to be used with passed-in Cython array-based functions.\r\n"]
[236.579091, "o", "\r\n"]
[236.691455, "o", "        Parameters\r\n"]
[236.803818, "o", "        ----------\r\n"]
[236.916182, "o", "        func : callable function to apply\r\n"]
[237.028545, "o", "        name : str,\r\n"]
[237.140909, "o", "        numba_args : tuple\r\n"]
[237.253273, "o", "            args to be passed when func is a numba func\r\n"]
[237.365636, "o", "        **kwargs\r\n"]
[237.478, "o", "            additional arguments for rolling function and window function\r\n"]
[237.590364, "o", "\r\n"]
[237.702727, "o", "        Returns\r\n"]
[237.815091, "o", "        -------\r\n"]
[237.927455, "o", "        y : type of input\r\n"]
[238.039818, "o", "        \"\"\"\r\n"]
[238.152182, "o", "        window_indexer = self._get_window_indexer()\r\n"]
[238.264545, "o", "        min_periods = (\r\n"]
[238.376909, "o", "            self.min_periods\r\n"]
[238.489273, "o", "            if self.min_periods is not None\r\n"]
[238.601636, "o", "            else window_indexer.window_size\r\n"]
[238.714, "o", "        )\r\n"]
[238.826364, "o", "\r\n"]
[238.938727, "o", "        def homogeneous_func(values: np.ndarray):\r\n"]
[239.051091, "o", "            # calculation function\r\n"]
[239.163455, "o", "\r\n"]
[239.275818, "o", "            if values.size == 0:\r\n"]
[239.388182, "o", "                return values.copy()\r\n"]
[239.500545, "o", "\r\n"]
[239.612909, "o", "            def calc(x):\r\n"]
[239.725273, "o", "                start, end = window_indexer.get_window_bounds(\r\n"]
[239.837636, "o", "                    num_values=len(x),\r\n"]
[240.0, "o", "(asv_3.8) root@7e2a5ae1b193:/workspace/repo# "]
[240.002, "i", "sed -n '590,640p' pandas/core/window/rolling.py\r"]
[240.004, "o", "sed -n '590,640p' pandas/core/window/rolling.py\r\n"]
[240.101077, "o", "\u001b[?2004l\r\n"]
[240.196154, "o", "\r\n"]
[240.291231, "o", "        def homogeneous_func(values: np.ndarray):\r\n"]
[240.386308, "o", "            # calculation function\r\n"]
[240.481385, "o", "\r\n"]
[240.576462, "o", "            if values.size == 0:\r\n"]
[240.671538, "o", "                return values.copy()\r\n"]
[240.766615, "o", "\r\n"]
[240.861692, "o", "            def calc(x):\r\n"]
[240.956769, "o", "                start, end = window_indexer.get_window_bounds(\r\n"]
[241.051846, "o", "                    num_values=len(x),\r\n"]
[241.146923, "o", "                    min_periods=min_periods,\r\n"]
[241.242, "o", "                    center=self.center,\r\n"]
[241.337077, "o", "                    closed=self.closed,\r\n"]
[241.432154, "o", "                    step=self.step,\r\n"]
[241.527231, "o", "                )\r\n"]
[241.622308, "o", "                self._check_window_bounds(start, end, len(x))\r\n"]
[241.717385, "o", "\r\n"]
[241.812462, "o", "                return func(x, start, end, min_periods, *numba_args)\r\n"]
[241.907538, "o", "\r\n"]
[242.002615, "o", "            with np.errstate(all=\"ignore\"):\r\n"]
[242.097692, "o", "                result = calc(values)\r\n"]
[242.192769, "o", "\r\n"]
[242.287846, "o", "            return result\r\n"]
[242.382923, "o", "\r\n"]
[242.478, "o", "        if self.method == \"single\":\r\n"]
[242.573077, "o", "            return self._apply_blockwise(homogeneous_func, name, numeric_only)\r\n"]
[242.668154, "o", "        else:\r\n"]
[242.763231, "o", "            return self._apply_tablewise(homogeneous_func, name, numeric_only)\r\n"]
[242.858308, "o", "\r\n"]
[242.953385, "o", "    def _numba_apply(\r\n"]
[243.048462, "o", "        self,\r\n"]
[243.143538, "o", "        func: Callable[..., Any],\r\n"]
[243.238615, "o", "        engine_kwargs: dict[str, bool] | None = None,\r\n"]
[243.333692, "o", "        *func_args,\r\n"]
[243.428769, "o", "    ):\r\n"]
[243.523846, "o", "        window_indexer = self._get_window_indexer()\r\n"]
[243.618923, "o", "        min_periods = (\r\n"]
[243.714, "o", "            self.min_periods\r\n"]
[243.809077, "o", "            if self.min_periods is not None\r\n"]
[243.904154, "o", "            else window_indexer.window_size\r\n"]
[243.999231, "o", "        )\r\n"]
[244.094308, "o", "        obj = self._create_data(self._selected_obj)\r\n"]
[244.189385, "o", "        if self.axis == 1:\r\n"]
[244.284462, "o", "            obj = obj.T\r\n"]
[244.379538, "o", "        values = self._prep_values(obj.to_numpy())\r\n"]
[244.474615, "o", "        if values.ndim == 1:\r\n"]
[244.569692, "o", "            values = values.reshape(-1, 1)\r\n"]
[244.664769, "o", "        start, end = window_indexer.get_window_bounds(\r\n"]
[244.759846, "o", "            num_values=len(values),\r\n"]
[244.854923, "o", "            min_periods=min_periods,\r\n"]
[245.0, "o", "(asv_3.8) root@7e2a5ae1b193:/workspace/repo# "]
[245.002, "i", "grep -n \"class GroupbyIndexer\" pandas/core/window/rolling.py\r"]
[245.004, "o", "grep -n \"class GroupbyIndexer\" pandas/core/window/rolling.py\r\n"]
[245.006, "o", "\u001b[?2004l\r\n"]
[250.0, "o", "(asv_3.8) root@7e2a5ae1b193:/workspace/repo# "]
[250.002, "i", "find pandas/ -name \"*.py\" -exec grep -l \"GroupbyIndexer\" {} \\;\r"]
[250.004, "o", "find pandas/ -name \"*.py\" -exec grep -l \"GroupbyIndexer\" {} \\;\r\n"]
[250.9948, "o", "\u001b[?2004l\r\n"]
[251.9836, "o", "pandas/core/window/rolling.py\r\n"]
[252.9724, "o", "pandas/core/window/expanding.py\r\n"]
[253.9612, "o", "pandas/core/window/ewm.py\r\n"]
[255.0, "o", "(asv_3.8) root@7e2a5ae1b193:/workspace/repo# "]
[255.002, "i", "grep -n \"class GroupbyIndexer\" pandas/core/indexers/objects.py\r"]
[255.004, "o", "grep -n \"class GroupbyIndexer\" pandas/core/indexers/objects.py\r\n"]
[257.478, "o", "\u001b[?2004l\r\n"]
[260.0, "o", "(asv_3.8) root@7e2a5ae1b193:/workspace/repo# "]
[260.002, "i", "sed -n '285,330p' pandas/core/indexers/objects.py\r"]
[260.004, "o", "sed -n '285,330p' pandas/core/indexers/objects.py\r\n"]
[260.111191, "o", "\u001b[?2004l\r\n"]
[260.216383, "o", "class GroupbyIndexer(BaseIndexer):\r\n"]
[260.321574, "o", "    \"\"\"Calculate bounds to compute groupby rolling, mimicking df.groupby().rolling()\"\"\"\r\n"]
[260.426766, "o", "\r\n"]
[260.531957, "o", "    def __init__(\r\n"]
[260.637149, "o", "        self,\r\n"]
[260.74234, "o", "        index_array: np.ndarray | None = None,\r\n"]
[260.847532, "o", "        window_size: int | BaseIndexer = 0,\r\n"]
[260.952723, "o", "        groupby_indices: dict | None = None,\r\n"]
[261.057915, "o", "        window_indexer: type[BaseIndexer] = BaseIndexer,\r\n"]
[261.163106, "o", "        indexer_kwargs: dict | None = None,\r\n"]
[261.268298, "o", "        **kwargs,\r\n"]
[261.373489, "o", "    ) -> None:\r\n"]
[261.478681, "o", "        \"\"\"\r\n"]
[261.583872, "o", "        Parameters\r\n"]
[261.689064, "o", "        ----------\r\n"]
[261.794255, "o", "        index_array : np.ndarray or None\r\n"]
[261.899447, "o", "            np.ndarray of the index of the original object that we are performing\r\n"]
[262.004638, "o", "            a chained groupby operation over. This index has been pre-sorted relative to\r\n"]
[262.10983, "o", "            the groups\r\n"]
[262.215021, "o", "        window_size : int or BaseIndexer\r\n"]
[262.320213, "o", "            window size during the windowing operation\r\n"]
[262.425404, "o", "        groupby_indices : dict or None\r\n"]
[262.530596, "o", "            dict of {group label: [positional index of rows belonging to the group]}\r\n"]
[262.635787, "o", "        window_indexer : BaseIndexer\r\n"]
[262.740979, "o", "            BaseIndexer class determining the start and end bounds of each group\r\n"]
[262.84617, "o", "        indexer_kwargs : dict or None\r\n"]
[262.951362, "o", "            Custom kwargs to be passed to window_indexer\r\n"]
[263.056553, "o", "        **kwargs :\r\n"]
[263.161745, "o", "            keyword arguments that will be available when get_window_bounds is called\r\n"]
[263.266936, "o", "        \"\"\"\r\n"]
[263.372128, "o", "        self.groupby_indices = groupby_indices or {}\r\n"]
[263.477319, "o", "        self.window_indexer = window_indexer\r\n"]
[263.582511, "o", "        self.indexer_kwargs = indexer_kwargs.copy() if indexer_kwargs else {}\r\n"]
[263.687702, "o", "        super().__init__(\r\n"]
[263.792894, "o", "            index_array=index_array,\r\n"]
[263.898085, "o", "            window_size=self.indexer_kwargs.pop(\"window_size\", window_size),\r\n"]
[264.003277, "o", "            **kwargs,\r\n"]
[264.108468, "o", "        )\r\n"]
[264.21366, "o", "\r\n"]
[264.318851, "o", "    @Appender(get_window_bounds_doc)\r\n"]
[264.424043, "o", "    def get_window_bounds(\r\n"]
[264.529234, "o", "        self,\r\n"]
[264.634426, "o", "        num_values: int = 0,\r\n"]
[264.739617, "o", "        min_periods: int | None = None,\r\n"]
[264.844809, "o", "        center: bool | None = None,\r\n"]
[265.0, "o", "(asv_3.8) root@7e2a5ae1b193:/workspace/repo# "]
[265.002, "i", "sed -n '320,380p' pandas/core/indexers/objects.py\r"]
[265.004, "o", "sed -n '320,380p' pandas/core/indexers/objects.py\r\n"]
[265.085742, "o", "\u001b[?2004l\r\n"]
[265.165484, "o", "            window_size=self.indexer_kwargs.pop(\"window_size\", window_size),\r\n"]
[265.245226, "o", "            **kwargs,\r\n"]
[265.324968, "o", "        )\r\n"]
[265.40471, "o", "\r\n"]
[265.484452, "o", "    @Appender(get_window_bounds_doc)\r\n"]
[265.564194, "o", "    def get_window_bounds(\r\n"]
[265.643935, "o", "        self,\r\n"]
[265.723677, "o", "        num_values: int = 0,\r\n"]
[265.803419, "o", "        min_periods: int | None = None,\r\n"]
[265.883161, "o", "        center: bool | None = None,\r\n"]
[265.962903, "o", "        closed: str | None = None,\r\n"]
[266.042645, "o", "        step: int | None = None,\r\n"]
[266.122387, "o", "    ) -> tuple[np.ndarray, np.ndarray]:\r\n"]
[266.202129, "o", "        # 1) For each group, get the indices that belong to the group\r\n"]
[266.281871, "o", "        # 2) Use the indices to calculate the start & end bounds of the window\r\n"]
[266.361613, "o", "        # 3) Append the window bounds in group order\r\n"]
[266.441355, "o", "        start_arrays = []\r\n"]
[266.521097, "o", "        end_arrays = []\r\n"]
[266.600839, "o", "        window_indices_start = 0\r\n"]
[266.680581, "o", "        for key, indices in self.groupby_indices.items():\r\n"]
[266.760323, "o", "            index_array: np.ndarray | None\r\n"]
[266.840065, "o", "\r\n"]
[266.919806, "o", "            if self.index_array is not None:\r\n"]
[266.999548, "o", "                index_array = self.index_array.take(ensure_platform_int(indices))\r\n"]
[267.07929, "o", "            else:\r\n"]
[267.159032, "o", "                index_array = self.index_array\r\n"]
[267.238774, "o", "            indexer = self.window_indexer(\r\n"]
[267.318516, "o", "                index_array=index_array,\r\n"]
[267.398258, "o", "                window_size=self.window_size,\r\n"]
[267.478, "o", "                **self.indexer_kwargs,\r\n"]
[267.557742, "o", "            )\r\n"]
[267.637484, "o", "            start, end = indexer.get_window_bounds(\r\n"]
[267.717226, "o", "                len(indices), min_periods, center, closed, step\r\n"]
[267.796968, "o", "            )\r\n"]
[267.87671, "o", "            start = start.astype(np.int64)\r\n"]
[267.956452, "o", "            end = end.astype(np.int64)\r\n"]
[268.036194, "o", "            assert len(start) == len(\r\n"]
[268.115935, "o", "                end\r\n"]
[268.195677, "o", "            ), \"these should be equal in length from get_window_bounds\"\r\n"]
[268.275419, "o", "            # Cannot use groupby_indices as they might not be monotonic with the object\r\n"]
[268.355161, "o", "            # we're rolling over\r\n"]
[268.434903, "o", "            window_indices = np.arange(\r\n"]
[268.514645, "o", "                window_indices_start, window_indices_start + len(indices)\r\n"]
[268.594387, "o", "            )\r\n"]
[268.674129, "o", "            window_indices_start += len(indices)\r\n"]
[268.753871, "o", "            # Extend as we'll be slicing window like [start, end)\r\n"]
[268.833613, "o", "            window_indices = np.append(window_indices, [window_indices[-1] + 1]).astype(\r\n"]
[268.913355, "o", "                np.int64, copy=False\r\n"]
[268.993097, "o", "            )\r\n"]
[269.072839, "o", "            start_arrays.append(window_indices.take(ensure_platform_int(start)))\r\n"]
[269.152581, "o", "            end_arrays.append(window_indices.take(ensure_platform_int(end)))\r\n"]
[269.232323, "o", "        if len(start_arrays) == 0:\r\n"]
[269.312065, "o", "            return np.array([], dtype=np.int64), np.array([], dtype=np.int64)\r\n"]
[269.391806, "o", "        start = np.concatenate(start_arrays)\r\n"]
[269.471548, "o", "        end = np.concatenate(end_arrays)\r\n"]
[269.55129, "o", "        return start, end\r\n"]
[269.631032, "o", "\r\n"]
[269.710774, "o", "\r\n"]
[269.790516, "o", "class ExponentialMovingWindowIndexer(BaseIndexer):\r\n"]
[269.870258, "o", "    \"\"\"Calculate ewm window bounds (the entire window)\"\"\"\r\n"]
[270.0, "o", "(asv_3.8) root@7e2a5ae1b193:/workspace/repo# "]
[270.002, "i", "cp pandas/core/indexers/objects.py pandas/core/indexers/objects.py.backup\r"]
[270.004, "o", "cp pandas/core/indexers/objects.py pandas/core/indexers/objects.py.backup\r\n"]
[270.006, "o", "\u001b[?2004l\r\n"]
[275.0, "o", "(asv_3.8) root@7e2a5ae1b193:/workspace/repo# "]
[275.002, "i", "python3 -c \"\r"]
[275.004, "o", "python3 -c \"\r\n"]
[275.036519, "o", "\u001b[?2004l\r\n"]
[275.067037, "o", "\u001b[?2004h> import re\r\n"]
[275.097556, "o", "\u001b[?2004l\r\n"]
[275.128074, "o", "\u001b[?2004h> \r\n"]
[275.158593, "o", "\u001b[?2004l\r\n"]
[275.189111, "o", "\u001b[?2004h> # Read the original file\r\n"]
[275.21963, "o", "\u001b[?2004l\r\n"]
[275.250148, "o", "\u001b[?2004h> with open('pandas/core/indexers/objects.py', 'r') as f:\r\n"]
[275.280667, "o", "\u001b[?2004l\r\n"]
[275.311185, "o", "\u001b[?2004h>     content = f.read()\r\n"]
[275.341704, "o", "\u001b[?2004l\r\n"]
[275.372222, "o", "\u001b[?2004h> \r\n"]
[275.402741, "o", "\u001b[?2004l\r\n"]
[275.433259, "o", "\u001b[?2004h> # Find the get_window_bounds method and replace it with an optimized version\r\n"]
[275.463778, "o", "\u001b[?2004l\r\n"]
[275.494296, "o", "\u001b[?2004h> optimized_method = '''\r\n"]
[275.524815, "o", "\u001b[?2004l\r\n"]
[275.555333, "o", "\u001b[?2004h>     @Appender(get_window_bounds_doc)\r\n"]
[275.585852, "o", "\u001b[?2004l\r\n"]
[275.61637, "o", "\u001b[?2004h>     def get_window_bounds(\r\n"]
[275.646889, "o", "\u001b[?2004l\r\n"]
[275.677407, "o", "\u001b[?2004h>         self,\r\n"]
[275.707926, "o", "\u001b[?2004l\r\n"]
[275.738444, "o", "\u001b[?2004h>         num_values: int = 0,\r\n"]
[275.768963, "o", "\u001b[?2004l\r\n"]
[275.799481, "o", "\u001b[?2004h>         min_periods: int | None = None,\r\n"]
[275.83, "o", "\u001b[?2004l\r\n"]
[275.860519, "o", "\u001b[?2004h>         center: bool | None = None,\r\n"]
[275.891037, "o", "\u001b[?2004l\r\n"]
[275.921556, "o", "\u001b[?2004h>         closed: str | None = None,\r\n"]
[275.952074, "o", "\u001b[?2004l\r\n"]
[275.982593, "o", "\u001b[?2004h>         step: int | None = None,\r\n"]
[276.013111, "o", "\u001b[?2004l\r\n"]
[276.04363, "o", "\u001b[?2004h>     ) -> tuple[np.ndarray, np.ndarray]:\r\n"]
[276.074148, "o", "\u001b[?2004l\r\n"]
[276.104667, "o", "\u001b[?2004h>         # OPTIMIZED: Pre-calculate total length and pre-allocate arrays\r\n"]
[276.135185, "o", "\u001b[?2004l\r\n"]
[276.165704, "o", "\u001b[?2004h>         if not self.groupby_indices:\r\n"]
[276.196222, "o", "\u001b[?2004l\r\n"]
[276.226741, "o", "\u001b[?2004h>             return np.array([], dtype=np.int64), np.array([], dtype=np.int64)\r\n"]
[276.257259, "o", "\u001b[?2004l\r\n"]
[276.287778, "o", "\u001b[?2004h>         \r\n"]
[276.318296, "o", "\u001b[?2004l\r\n"]
[276.348815, "o", "\u001b[?2004h>         # Pre-calculate total length for pre-allocation\r\n"]
[276.379333, "o", "\u001b[?2004l\r\n"]
[276.409852, "o", "\u001b[?2004h>         total_length = sum(len(indices) for indices in self.groupby_indices.values())\r\n"]
[276.44037, "o", "\u001b[?2004l\r\n"]
[276.470889, "o", "\u001b[?2004h>         start_result = np.empty(total_length, dtype=np.int64)\r\n"]
[276.501407, "o", "\u001b[?2004l\r\n"]
[276.531926, "o", "\u001b[?2004h>         end_result = np.empty(total_length, dtype=np.int64)\r\n"]
[276.562444, "o", "\u001b[?2004l\r\n"]
[276.592963, "o", "\u001b[?2004h>         \r\n"]
[276.623481, "o", "\u001b[?2004l\r\n"]
[276.654, "o", "\u001b[?2004h>         # OPTIMIZED: Single indexer instance reuse when possible\r\n"]
[276.684519, "o", "\u001b[?2004l\r\n"]
[276.715037, "o", "\u001b[?2004h>         if self.index_array is None:\r\n"]
[276.745556, "o", "\u001b[?2004l\r\n"]
[276.776074, "o", "\u001b[?2004h>             base_indexer = self.window_indexer(\r\n"]
[276.806593, "o", "\u001b[?2004l\r\n"]
[276.837111, "o", "\u001b[?2004h>                 index_array=None,\r\n"]
[276.86763, "o", "\u001b[?2004l\r\n"]
[276.898148, "o", "\u001b[?2004h>                 window_size=self.window_size,\r\n"]
[276.928667, "o", "\u001b[?2004l\r\n"]
[276.959185, "o", "\u001b[?2004h>                 **self.indexer_kwargs,\r\n"]
[276.989704, "o", "\u001b[?2004l\r\n"]
[277.020222, "o", "\u001b[?2004h>             )\r\n"]
[277.050741, "o", "\u001b[?2004l\r\n"]
[277.081259, "o", "\u001b[?2004h>         \r\n"]
[277.111778, "o", "\u001b[?2004l\r\n"]
[277.142296, "o", "\u001b[?2004h>         current_pos = 0\r\n"]
[277.172815, "o", "\u001b[?2004l\r\n"]
[277.203333, "o", "\u001b[?2004h>         window_indices_start = 0\r\n"]
[277.233852, "o", "\u001b[?2004l\r\n"]
[277.26437, "o", "\u001b[?2004h>         \r\n"]
[277.294889, "o", "\u001b[?2004l\r\n"]
[277.325407, "o", "\u001b[?2004h>         for key, indices in self.groupby_indices.items():\r\n"]
[277.355926, "o", "\u001b[?2004l\r\n"]
[277.386444, "o", "\u001b[?2004h>             group_len = len(indices)\r\n"]
[277.416963, "o", "\u001b[?2004l\r\n"]
[277.447481, "o", "\u001b[?2004h>             \r\n"]
[277.478, "o", "\u001b[?2004l\r\n"]
[277.508519, "o", "\u001b[?2004h>             if self.index_array is not None:\r\n"]
[277.539037, "o", "\u001b[?2004l\r\n"]
[277.569556, "o", "\u001b[?2004h>                 # OPTIMIZED: Use direct indexing when possible\r\n"]
[277.600074, "o", "\u001b[?2004l\r\n"]
[277.630593, "o", "\u001b[?2004h>                 index_array = self.index_array[indices]\r\n"]
[277.661111, "o", "\u001b[?2004l\r\n"]
[277.69163, "o", "\u001b[?2004h>                 indexer = self.window_indexer(\r\n"]
[277.722148, "o", "\u001b[?2004l\r\n"]
[277.752667, "o", "\u001b[?2004h>                     index_array=index_array,\r\n"]
[277.783185, "o", "\u001b[?2004l\r\n"]
[277.813704, "o", "\u001b[?2004h>                     window_size=self.window_size,\r\n"]
[277.844222, "o", "\u001b[?2004l\r\n"]
[277.874741, "o", "\u001b[?2004h>                     **self.indexer_kwargs,\r\n"]
[277.905259, "o", "\u001b[?2004l\r\n"]
[277.935778, "o", "\u001b[?2004h>                 )\r\n"]
[277.966296, "o", "\u001b[?2004l\r\n"]
[277.996815, "o", "\u001b[?2004h>             else:\r\n"]
[278.027333, "o", "\u001b[?2004l\r\n"]
[278.057852, "o", "\u001b[?2004h>                 indexer = base_indexer\r\n"]
[278.08837, "o", "\u001b[?2004l\r\n"]
[278.118889, "o", "\u001b[?2004h>             \r\n"]
[278.149407, "o", "\u001b[?2004l\r\n"]
[278.179926, "o", "\u001b[?2004h>             start, end = indexer.get_window_bounds(\r\n"]
[278.210444, "o", "\u001b[?2004l\r\n"]
[278.240963, "o", "\u001b[?2004h>                 group_len, min_periods, center, closed, step\r\n"]
[278.271481, "o", "\u001b[?2004l\r\n"]
[278.302, "o", "\u001b[?2004h>             )\r\n"]
[278.332519, "o", "\u001b[?2004l\r\n"]
[278.363037, "o", "\u001b[?2004h>             \r\n"]
[278.393556, "o", "\u001b[?2004l\r\n"]
[278.424074, "o", "\u001b[?2004h>             # OPTIMIZED: Direct array operations instead of creating intermediate arrays\r\n"]
[278.454593, "o", "\u001b[?2004l\r\n"]
[278.485111, "o", "\u001b[?2004h>             window_indices = np.arange(window_indices_start, window_indices_start + group_len + 1, dtype=np.int64)\r\n"]
[278.51563, "o", "\u001b[?2004l\r\n"]
[278.546148, "o", "\u001b[?2004h>             \r\n"]
[278.576667, "o", "\u001b[?2004l\r\n"]
[278.607185, "o", "\u001b[?2004h>             # OPTIMIZED: Direct assignment to pre-allocated arrays\r\n"]
[278.637704, "o", "\u001b[?2004l\r\n"]
[278.668222, "o", "\u001b[?2004h>             start_result[current_pos:current_pos + group_len] = window_indices[start]\r\n"]
[278.698741, "o", "\u001b[?2004l\r\n"]
[278.729259, "o", "\u001b[?2004h>             end_result[current_pos:current_pos + group_len] = window_indices[end]\r\n"]
[278.759778, "o", "\u001b[?2004l\r\n"]
[278.790296, "o", "\u001b[?2004h>             \r\n"]
[278.820815, "o", "\u001b[?2004l\r\n"]
[278.851333, "o", "\u001b[?2004h>             current_pos += group_len\r\n"]
[278.881852, "o", "\u001b[?2004l\r\n"]
[278.91237, "o", "\u001b[?2004h>             window_indices_start += group_len\r\n"]
[278.942889, "o", "\u001b[?2004l\r\n"]
[278.973407, "o", "\u001b[?2004h>         \r\n"]
[279.003926, "o", "\u001b[?2004l\r\n"]
[279.034444, "o", "\u001b[?2004h>         return start_result, end_result\r\n"]
[279.064963, "o", "\u001b[?2004l\r\n"]
[279.095481, "o", "\u001b[?2004h> '''\r\n"]
[279.126, "o", "\u001b[?2004l\r\n"]
[279.156519, "o", "\u001b[?2004h> \r\n"]
[279.187037, "o", "\u001b[?2004l\r\n"]
[279.217556, "o", "\u001b[?2004h> # Replace the method using regex\r\n"]
[279.248074, "o", "\u001b[?2004l\r\n"]
[279.278593, "o", "\u001b[?2004h> pattern = r'(\\s+@Appender\\(get_window_bounds_doc\\)\\s+def get_window_bounds\\([^}]+?return start, end)'\r\n"]
[279.309111, "o", "\u001b[?2004l\r\n"]
[279.33963, "o", "\u001b[?2004h> replacement = optimized_method\r\n"]
[279.370148, "o", "\u001b[?2004l\r\n"]
[279.400667, "o", "\u001b[?2004h> \r\n"]
[279.431185, "o", "\u001b[?2004l\r\n"]
[279.461704, "o", "\u001b[?2004h> content = re.sub(pattern, replacement, content, flags=re.DOTALL)\r\n"]
[279.492222, "o", "\u001b[?2004l\r\n"]
[279.522741, "o", "\u001b[?2004h> \r\n"]
[279.553259, "o", "\u001b[?2004l\r\n"]
[279.583778, "o", "\u001b[?2004h> # Write back the optimized content\r\n"]
[279.614296, "o", "\u001b[?2004l\r\n"]
[279.644815, "o", "\u001b[?2004h> with open('pandas/core/indexers/objects.py', 'w') as f:\r\n"]
[279.675333, "o", "\u001b[?2004l\r\n"]
[279.705852, "o", "\u001b[?2004h>     f.write(content)\r\n"]
[279.73637, "o", "\u001b[?2004l\r\n"]
[279.766889, "o", "\u001b[?2004h> \r\n"]
[279.797407, "o", "\u001b[?2004l\r\n"]
[279.827926, "o", "\u001b[?2004h> print('Applied optimizations to GroupbyIndexer.get_window_bounds')\r\n"]
[279.858444, "o", "\u001b[?2004l\r\n"]
[279.888963, "o", "\u001b[?2004h> \"\r\n"]
[279.919481, "o", "\u001b[?2004l\r\n"]
[280.0, "o", "(asv_3.8) root@7e2a5ae1b193:/workspace/repo# "]
[280.002, "i", "sed -n '324,340p' pandas/core/indexers/objects.py\r"]
[280.004, "o", "sed -n '324,340p' pandas/core/indexers/objects.py\r\n"]
[280.280667, "o", "\u001b[?2004l\r\n"]
[280.555333, "o", "        )\r\n"]
[280.83, "o", "    @Appender(get_window_bounds_doc)\r\n"]
[281.104667, "o", "    def get_window_bounds(\r\n"]
[281.379333, "o", "        self,\r\n"]
[281.654, "o", "        num_values: int = 0,\r\n"]
[281.928667, "o", "        min_periods: int | None = None,\r\n"]
[282.203333, "o", "        center: bool | None = None,\r\n"]
[282.478, "o", "        closed: str | None = None,\r\n"]
[282.752667, "o", "        step: int | None = None,\r\n"]
[283.027333, "o", "    ) -> tuple[np.ndarray, np.ndarray]:\r\n"]
[283.302, "o", "        # OPTIMIZED: Pre-calculate total length and pre-allocate arrays\r\n"]
[283.576667, "o", "        if not self.groupby_indices:\r\n"]
[283.851333, "o", "            return np.array([], dtype=np.int64), np.array([], dtype=np.int64)\r\n"]
[284.126, "o", "        \r\n"]
[284.400667, "o", "        # Pre-calculate total length for pre-allocation\r\n"]
[284.675333, "o", "        total_length = sum(len(indices) for indices in self.groupby_indices.values())\r\n"]
[285.0, "o", "(asv_3.8) root@7e2a5ae1b193:/workspace/repo# "]
[285.002, "i", "cd asv_bench\r"]
[285.004, "o", "cd asv_bench\r\n"]
[285.006, "o", "\u001b[?2004l\r\n"]
[290.0, "o", "(asv_3.8) root@7e2a5ae1b193:/workspace/repo/asv_bench# "]
[290.002, "i", "asv run --python=same --bench=\"rolling.Groupby.*\"\r"]
[290.004, "o", "asv run --python=same --bench=\"rolling.Groupby.*\"\r\n"]
[290.099283, "o", "\u001b[?2004l\r\n"]
[290.192566, "o", "\u00b7 \u001b[0;32mDiscovering benchmarks\u001b[0m\r\n"]
[290.285849, "o", "\u00b7\u00b7 \u001b[0;31mError running /opt/conda/envs/asv_3.8/bin/python /opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv/benchmark.py discover /workspace/repo/asv_bench/benchmarks /tmp/tmp4u4g81zi/result.json (exit status 1)\u001b[0m\r\n"]
[290.379132, "o", "   STDOUT -------->\r\n"]
[290.472415, "o", "   \r\n"]
[290.565698, "o", "   STDERR -------->\r\n"]
[290.658981, "o", "   Traceback (most recent call last):\r\n"]
[290.752264, "o", "     File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv/benchmark.py\", line 99, in <module>\r\n"]
[290.845547, "o", "       main()\r\n"]
[290.93883, "o", "     File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv/benchmark.py\", line 91, in main\r\n"]
[291.032113, "o", "       commands[mode](args)\r\n"]
[291.125396, "o", "     File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/discovery.py\", line 310, in _discover\r\n"]
[291.218679, "o", "       list_benchmarks(benchmark_dir, fp)\r\n"]
[291.311962, "o", "     File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/discovery.py\", line 278, in list_benchmarks\r\n"]
[291.405245, "o", "       for benchmark in disc_benchmarks(root):\r\n"]
[291.498528, "o", "     File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/discovery.py\", line 144, in disc_benchmarks\r\n"]
[291.591811, "o", "       for module in disc_modules(root_name, ignore_import_errors=ignore_import_errors):\r\n"]
[291.685094, "o", "     File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/discovery.py\", line 109, in disc_modules\r\n"]
[291.778377, "o", "       yield from disc_modules(name, ignore_import_errors)\r\n"]
[291.87166, "o", "     File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv_runner/discovery.py\", line 98, in disc_modules\r\n"]
[291.964943, "o", "       module = importlib.import_module(module_name)\r\n"]
[292.058226, "o", "     File \"/opt/conda/envs/asv_3.8/lib/python3.8/importlib/__init__.py\", line 127, in import_module\r\n"]
[292.151509, "o", "       return _bootstrap._gcd_import(name[level:], package, level)\r\n"]
[292.244792, "o", "     File \"<frozen importlib._bootstrap>\", line 1014, in _gcd_import\r\n"]
[292.338075, "o", "     File \"<frozen importlib._bootstrap>\", line 991, in _find_and_load\r\n"]
[292.431358, "o", "     File \"<frozen importlib._bootstrap>\", line 975, in _find_and_load_unlocked\r\n"]
[292.524642, "o", "     File \"<frozen importlib._bootstrap>\", line 671, in _load_unlocked\r\n"]
[292.617925, "o", "     File \"<frozen importlib._bootstrap_external>\", line 843, in exec_module\r\n"]
[292.711208, "o", "     File \"<frozen importlib._bootstrap>\", line 219, in _call_with_frames_removed\r\n"]
[292.804491, "o", "     File \"/workspace/repo/asv_bench/benchmarks/algorithms.py\", line 5, in <module>\r\n"]
[292.897774, "o", "       import pandas as pd\r\n"]
[292.991057, "o", "     File \"/workspace/repo/pandas/__init__.py\", line 48, in <module>\r\n"]
[293.08434, "o", "       from pandas.core.api import (\r\n"]
[293.177623, "o", "     File \"/workspace/repo/pandas/core/api.py\", line 47, in <module>\r\n"]
[293.270906, "o", "       from pandas.core.groupby import (\r\n"]
[293.364189, "o", "     File \"/workspace/repo/pandas/core/groupby/__init__.py\", line 1, in <module>\r\n"]
[293.457472, "o", "       from pandas.core.groupby.generic import (\r\n"]
[293.550755, "o", "     File \"/workspace/repo/pandas/core/groupby/generic.py\", line 77, in <module>\r\n"]
[293.644038, "o", "       from pandas.core.frame import DataFrame\r\n"]
[293.737321, "o", "     File \"/workspace/repo/pandas/core/frame.py\", line 182, in <module>\r\n"]
[293.830604, "o", "       from pandas.core.generic import NDFrame\r\n"]
[293.923887, "o", "     File \"/workspace/repo/pandas/core/generic.py\", line 176, in <module>\r\n"]
[294.01717, "o", "       from pandas.core.window import (\r\n"]
[294.110453, "o", "     File \"/workspace/repo/pandas/core/window/__init__.py\", line 1, in <module>\r\n"]
[294.203736, "o", "       from pandas.core.window.ewm import (\r\n"]
[294.297019, "o", "     File \"/workspace/repo/pandas/core/window/ewm.py\", line 58, in <module>\r\n"]
[294.390302, "o", "       from pandas.core.window.rolling import (\r\n"]
[294.483585, "o", "     File \"/workspace/repo/pandas/core/window/rolling.py\", line 61, in <module>\r\n"]
[294.576868, "o", "       from pandas.core.indexers.objects import (\r\n"]
[294.670151, "o", "   ImportError: cannot import name 'FixedWindowIndexer' from 'pandas.core.indexers.objects' (/workspace/repo/pandas/core/indexers/objects.py)\r\n"]
[294.763434, "o", "\r\n"]
[294.856717, "o", "\u00b7\u00b7 \u001b[0;31mLast error: Command '/opt/conda/envs/asv_3.8/bin/python /opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv/benchmark.py discover /workspace/repo/asv_bench/benchmarks /tmp/tmp4u4g81zi/result.json' returned non-zero exit status 1\u001b[0m\r\n"]
[295.0, "o", "(asv_3.8) root@7e2a5ae1b193:/workspace/repo/asv_bench# "]
[295.002, "i", "cd ..\r"]
[295.004, "o", "cd ..\r\n"]
[295.006, "o", "\u001b[?2004l\r\n"]
[300.0, "o", "(asv_3.8) root@7e2a5ae1b193:/workspace/repo# "]
[300.002, "i", "cp pandas/core/indexers/objects.py.backup pandas/core/indexers/objects.py\r"]
[300.004, "o", "cp pandas/core/indexers/objects.py.backup pandas/core/indexers/objects.py\r\n"]
[300.006, "o", "\u001b[?2004l\r\n"]
[305.0, "o", "(asv_3.8) root@7e2a5ae1b193:/workspace/repo# "]
[305.002, "i", "python3 -c \"from pandas.core.indexers.objects import FixedWindowIndexer; print('Import successful')\"\r"]
[305.004, "o", "python3 -c \"from pandas.core.indexers.objects import FixedWindowIndexer; print('Import successful')\"\r\n"]
[307.478, "o", "\u001b[?2004l\r\n"]
[310.0, "o", "(asv_3.8) root@7e2a5ae1b193:/workspace/repo# "]
[310.002, "i", "sed -n '324,370p' pandas/core/indexers/objects.py\r"]
[310.004, "o", "sed -n '324,370p' pandas/core/indexers/objects.py\r\n"]
[310.109, "o", "\u001b[?2004l\r\n"]
[310.212, "o", "    @Appender(get_window_bounds_doc)\r\n"]
[310.315, "o", "    def get_window_bounds(\r\n"]
[310.418, "o", "        self,\r\n"]
[310.521, "o", "        num_values: int = 0,\r\n"]
[310.624, "o", "        min_periods: int | None = None,\r\n"]
[310.727, "o", "        center: bool | None = None,\r\n"]
[310.83, "o", "        closed: str | None = None,\r\n"]
[310.933, "o", "        step: int | None = None,\r\n"]
[311.036, "o", "    ) -> tuple[np.ndarray, np.ndarray]:\r\n"]
[311.139, "o", "        # 1) For each group, get the indices that belong to the group\r\n"]
[311.242, "o", "        # 2) Use the indices to calculate the start & end bounds of the window\r\n"]
[311.345, "o", "        # 3) Append the window bounds in group order\r\n"]
[311.448, "o", "        start_arrays = []\r\n"]
[311.551, "o", "        end_arrays = []\r\n"]
[311.654, "o", "        window_indices_start = 0\r\n"]
[311.757, "o", "        for key, indices in self.groupby_indices.items():\r\n"]
[311.86, "o", "            index_array: np.ndarray | None\r\n"]
[311.963, "o", "\r\n"]
[312.066, "o", "            if self.index_array is not None:\r\n"]
[312.169, "o", "                index_array = self.index_array.take(ensure_platform_int(indices))\r\n"]
[312.272, "o", "            else:\r\n"]
[312.375, "o", "                index_array = self.index_array\r\n"]
[312.478, "o", "            indexer = self.window_indexer(\r\n"]
[312.581, "o", "                index_array=index_array,\r\n"]
[312.684, "o", "                window_size=self.window_size,\r\n"]
[312.787, "o", "                **self.indexer_kwargs,\r\n"]
[312.89, "o", "            )\r\n"]
[312.993, "o", "            start, end = indexer.get_window_bounds(\r\n"]
[313.096, "o", "                len(indices), min_periods, center, closed, step\r\n"]
[313.199, "o", "            )\r\n"]
[313.302, "o", "            start = start.astype(np.int64)\r\n"]
[313.405, "o", "            end = end.astype(np.int64)\r\n"]
[313.508, "o", "            assert len(start) == len(\r\n"]
[313.611, "o", "                end\r\n"]
[313.714, "o", "            ), \"these should be equal in length from get_window_bounds\"\r\n"]
[313.817, "o", "            # Cannot use groupby_indices as they might not be monotonic with the object\r\n"]
[313.92, "o", "            # we're rolling over\r\n"]
[314.023, "o", "            window_indices = np.arange(\r\n"]
[314.126, "o", "                window_indices_start, window_indices_start + len(indices)\r\n"]
[314.229, "o", "            )\r\n"]
[314.332, "o", "            window_indices_start += len(indices)\r\n"]
[314.435, "o", "            # Extend as we'll be slicing window like [start, end)\r\n"]
[314.538, "o", "            window_indices = np.append(window_indices, [window_indices[-1] + 1]).astype(\r\n"]
[314.641, "o", "                np.int64, copy=False\r\n"]
[314.744, "o", "            )\r\n"]
[314.847, "o", "            start_arrays.append(window_indices.take(ensure_platform_int(start)))\r\n"]
[315.0, "o", "(asv_3.8) root@7e2a5ae1b193:/workspace/repo# "]
[315.002, "i", "python3 -c \"\r"]
[315.004, "o", "python3 -c \"\r\n"]
[315.094286, "o", "\u001b[?2004l\r\n"]
[315.182571, "o", "\u001b[?2004h> # Read the file\r\n"]
[315.270857, "o", "\u001b[?2004l\r\n"]
[315.359143, "o", "\u001b[?2004h> with open('pandas/core/indexers/objects.py', 'r') as f:\r\n"]
[315.447429, "o", "\u001b[?2004l\r\n"]
[315.535714, "o", "\u001b[?2004h>     content = f.read()\r\n"]
[315.624, "o", "\u001b[?2004l\r\n"]
[315.712286, "o", "\u001b[?2004h> \r\n"]
[315.800571, "o", "\u001b[?2004l\r\n"]
[315.888857, "o", "\u001b[?2004h> # Replace .take() with direct indexing for better performance\r\n"]
[315.977143, "o", "\u001b[?2004l\r\n"]
[316.065429, "o", "\u001b[?2004h> # Replace index_array.take(ensure_platform_int(indices)) with direct indexing\r\n"]
[316.153714, "o", "\u001b[?2004l\r\n"]
[316.242, "o", "\u001b[?2004h> content = content.replace(\r\n"]
[316.330286, "o", "\u001b[?2004l\r\n"]
[316.418571, "o", "\u001b[?2004h>     'index_array = self.index_array.take(ensure_platform_int(indices))',\r\n"]
[316.506857, "o", "\u001b[?2004l\r\n"]
[316.595143, "o", "\u001b[?2004h>     'index_array = self.index_array[indices]'\r\n"]
[316.683429, "o", "\u001b[?2004l\r\n"]
[316.771714, "o", "\u001b[?2004h> )\r\n"]
[316.86, "o", "\u001b[?2004l\r\n"]
[316.948286, "o", "\u001b[?2004h> \r\n"]
[317.036571, "o", "\u001b[?2004l\r\n"]
[317.124857, "o", "\u001b[?2004h> # Replace window_indices.take() with direct indexing\r\n"]
[317.213143, "o", "\u001b[?2004l\r\n"]
[317.301429, "o", "\u001b[?2004h> content = content.replace(\r\n"]
[317.389714, "o", "\u001b[?2004l\r\n"]
[317.478, "o", "\u001b[?2004h>     'start_arrays.append(window_indices.take(ensure_platform_int(start)))',\r\n"]
[317.566286, "o", "\u001b[?2004l\r\n"]
[317.654571, "o", "\u001b[?2004h>     'start_arrays.append(window_indices[start])'\r\n"]
[317.742857, "o", "\u001b[?2004l\r\n"]
[317.831143, "o", "\u001b[?2004h> )\r\n"]
[317.919429, "o", "\u001b[?2004l\r\n"]
[318.007714, "o", "\u001b[?2004h> content = content.replace(\r\n"]
[318.096, "o", "\u001b[?2004l\r\n"]
[318.184286, "o", "\u001b[?2004h>     'end_arrays.append(window_indices.take(ensure_platform_int(end)))',\r\n"]
[318.272571, "o", "\u001b[?2004l\r\n"]
[318.360857, "o", "\u001b[?2004h>     'end_arrays.append(window_indices[end])'\r\n"]
[318.449143, "o", "\u001b[?2004l\r\n"]
[318.537429, "o", "\u001b[?2004h> )\r\n"]
[318.625714, "o", "\u001b[?2004l\r\n"]
[318.714, "o", "\u001b[?2004h> \r\n"]
[318.802286, "o", "\u001b[?2004l\r\n"]
[318.890571, "o", "\u001b[?2004h> # Write back\r\n"]
[318.978857, "o", "\u001b[?2004l\r\n"]
[319.067143, "o", "\u001b[?2004h> with open('pandas/core/indexers/objects.py', 'w') as f:\r\n"]
[319.155429, "o", "\u001b[?2004l\r\n"]
[319.243714, "o", "\u001b[?2004h>     f.write(content)\r\n"]
[319.332, "o", "\u001b[?2004l\r\n"]
[319.420286, "o", "\u001b[?2004h> \r\n"]
[319.508571, "o", "\u001b[?2004l\r\n"]
[319.596857, "o", "\u001b[?2004h> print('Applied targeted optimizations to GroupbyIndexer')\r\n"]
[319.685143, "o", "\u001b[?2004l\r\n"]
[319.773429, "o", "\u001b[?2004h> \"\r\n"]
[319.861714, "o", "\u001b[?2004l\r\n"]
[320.0, "o", "(asv_3.8) root@7e2a5ae1b193:/workspace/repo# "]
[320.002, "i", "python3 -c \"from pandas.core.indexers.objects import FixedWindowIndexer; print('Import still successful')\"\r"]
[320.004, "o", "python3 -c \"from pandas.core.indexers.objects import FixedWindowIndexer; print('Import still successful')\"\r\n"]
[322.478, "o", "\u001b[?2004l\r\n"]
[325.0, "o", "(asv_3.8) root@7e2a5ae1b193:/workspace/repo# "]
[325.002, "i", "sed -n '335,365p' pandas/core/indexers/objects.py\r"]
[325.004, "o", "sed -n '335,365p' pandas/core/indexers/objects.py\r\n"]
[325.1605, "o", "\u001b[?2004l\r\n"]
[325.315, "o", "        # 3) Append the window bounds in group order\r\n"]
[325.4695, "o", "        start_arrays = []\r\n"]
[325.624, "o", "        end_arrays = []\r\n"]
[325.7785, "o", "        window_indices_start = 0\r\n"]
[325.933, "o", "        for key, indices in self.groupby_indices.items():\r\n"]
[326.0875, "o", "            index_array: np.ndarray | None\r\n"]
[326.242, "o", "\r\n"]
[326.3965, "o", "            if self.index_array is not None:\r\n"]
[326.551, "o", "                index_array = self.index_array[indices]\r\n"]
[326.7055, "o", "            else:\r\n"]
[326.86, "o", "                index_array = self.index_array\r\n"]
[327.0145, "o", "            indexer = self.window_indexer(\r\n"]
[327.169, "o", "                index_array=index_array,\r\n"]
[327.3235, "o", "                window_size=self.window_size,\r\n"]
[327.478, "o", "                **self.indexer_kwargs,\r\n"]
[327.6325, "o", "            )\r\n"]
[327.787, "o", "            start, end = indexer.get_window_bounds(\r\n"]
[327.9415, "o", "                len(indices), min_periods, center, closed, step\r\n"]
[328.096, "o", "            )\r\n"]
[328.2505, "o", "            start = start.astype(np.int64)\r\n"]
[328.405, "o", "            end = end.astype(np.int64)\r\n"]
[328.5595, "o", "            assert len(start) == len(\r\n"]
[328.714, "o", "                end\r\n"]
[328.8685, "o", "            ), \"these should be equal in length from get_window_bounds\"\r\n"]
[329.023, "o", "            # Cannot use groupby_indices as they might not be monotonic with the object\r\n"]
[329.1775, "o", "            # we're rolling over\r\n"]
[329.332, "o", "            window_indices = np.arange(\r\n"]
[329.4865, "o", "                window_indices_start, window_indices_start + len(indices)\r\n"]
[329.641, "o", "            )\r\n"]
[329.7955, "o", "            window_indices_start += len(indices)\r\n"]
[330.0, "o", "(asv_3.8) root@7e2a5ae1b193:/workspace/repo# "]
[330.002, "i", "sed -n '360,370p' pandas/core/indexers/objects.py\r"]
[330.004, "o", "sed -n '360,370p' pandas/core/indexers/objects.py\r\n"]
[330.418, "o", "\u001b[?2004l\r\n"]
[330.83, "o", "            # we're rolling over\r\n"]
[331.242, "o", "            window_indices = np.arange(\r\n"]
[331.654, "o", "                window_indices_start, window_indices_start + len(indices)\r\n"]
[332.066, "o", "            )\r\n"]
[332.478, "o", "            window_indices_start += len(indices)\r\n"]
[332.89, "o", "            # Extend as we'll be slicing window like [start, end)\r\n"]
[333.302, "o", "            window_indices = np.append(window_indices, [window_indices[-1] + 1]).astype(\r\n"]
[333.714, "o", "                np.int64, copy=False\r\n"]
[334.126, "o", "            )\r\n"]
[334.538, "o", "            start_arrays.append(window_indices[start])\r\n"]
[335.0, "o", "(asv_3.8) root@7e2a5ae1b193:/workspace/repo# "]
[335.002, "i", "cd asv_bench\r"]
[335.004, "o", "cd asv_bench\r\n"]
[335.006, "o", "\u001b[?2004l\r\n"]
[340.0, "o", "(asv_3.8) root@7e2a5ae1b193:/workspace/repo/asv_bench# "]
[340.002, "i", "asv run --python=same --bench=\"rolling.Groupby.*\"\r"]
[340.004, "o", "asv run --python=same --bench=\"rolling.Groupby.*\"\r\n"]
[340.132769, "o", "\u001b[?2004l\r\n"]
[340.259538, "o", "\u00b7 \u001b[0;32mDiscovering benchmarks\u001b[0m\r\n"]
[340.386308, "o", "\u00b7 \u001b[0;32mRunning 4 total benchmarks (1 commits * 1 environments * 4 benchmarks)\u001b[0m\r\n"]
[340.513077, "o", "[ 0.00%] \u00b7\u00b7 \u001b[0;34mBenchmarking existing-py_opt_conda_envs_asv_3.8_bin_python\u001b[0m\r\n"]
[340.639846, "o", "[12.50%] \u00b7\u00b7\u00b7 \u001b[0;39mRunning (rolling.Groupby.time_method--)\u001b[0m....\r\n"]
[340.766615, "o", "[62.50%] \u00b7\u00b7\u00b7 \u001b[0;39mrolling.Groupby.time_method\u001b[0m                                                                                                                     ok\r\n"]
[340.893385, "o", "[62.50%] \u00b7\u00b7\u00b7 \u001b[0;39m=========== ============================ ================================ ===================\u001b[0m\r\n"]
[341.020154, "o", "             --                                                param2                                     \r\n"]
[341.146923, "o", "             ----------- ---------------------------------------------------------------------------------\r\n"]
[341.273692, "o", "                param1    ('rolling', {'window': 2})   ('rolling', {'window': '30s'})   ('expanding', {}) \r\n"]
[341.400462, "o", "             =========== ============================ ================================ ===================\r\n"]
[341.527231, "o", "              'sum' (0)           37.4\u00b10.5ms                     14.4\u00b10.1ms                 13.7\u00b10.1ms    \r\n"]
[341.654, "o", "                median            39.6\u00b10.2ms                     17.2\u00b10.2ms                15.8\u00b10.04ms    \r\n"]
[341.780769, "o", "                 mean              38.2\u00b13ms                       15.2\u00b11ms                  13.6\u00b10.2ms    \r\n"]
[341.907538, "o", "                 max              37.6\u00b10.3ms                     14.4\u00b10.1ms                13.5\u00b10.04ms    \r\n"]
[342.034308, "o", "                 min              37.7\u00b10.7ms                     14.4\u00b10.2ms                13.6\u00b10.06ms    \r\n"]
[342.161077, "o", "                 kurt             38.1\u00b10.6ms                    14.3\u00b10.03ms                13.7\u00b10.06ms    \r\n"]
[342.287846, "o", "              'sum' (1)           37.6\u00b10.1ms                    14.4\u00b10.07ms                13.7\u00b10.07ms    \r\n"]
[342.414615, "o", "             =========== ============================ ================================ ===================\r\n"]
[342.541385, "o", "\r\n"]
[342.668154, "o", "[75.00%] \u00b7\u00b7\u00b7 \u001b[0;39mrolling.GroupbyEWM.time_groupby_method\u001b[0m                                                                                                          ok\r\n"]
[342.794923, "o", "[75.00%] \u00b7\u00b7\u00b7 \u001b[0;39m======== =============\u001b[0m\r\n"]
[342.921692, "o", "              method               \r\n"]
[343.048462, "o", "             -------- -------------\r\n"]
[343.175231, "o", "               var       1000\u00b11\u03bcs  \r\n"]
[343.302, "o", "               std     1.13\u00b10.01ms \r\n"]
[343.428769, "o", "               cov     3.41\u00b10.01ms \r\n"]
[343.555538, "o", "               corr    3.57\u00b10.01ms \r\n"]
[343.682308, "o", "             ======== =============\r\n"]
[343.809077, "o", "\r\n"]
[343.935846, "o", "[87.50%] \u00b7\u00b7\u00b7 \u001b[0;39mrolling.GroupbyEWMEngine.time_groupby_mean\u001b[0m                                                                                                      ok\r\n"]
[344.062615, "o", "[87.50%] \u00b7\u00b7\u00b7 \u001b[0;39m======== ============\u001b[0m\r\n"]
[344.189385, "o", "              engine              \r\n"]
[344.316154, "o", "             -------- ------------\r\n"]
[344.442923, "o", "              cython   992\u00b10.9\u03bcs  \r\n"]
[344.569692, "o", "              numba    1.38\u00b10.2ms \r\n"]
[344.696462, "o", "             ======== ============\r\n"]
[344.823231, "o", "\r\n"]
[345.0, "o", "(asv_3.8) root@7e2a5ae1b193:/workspace/repo/asv_bench# "]
[345.002, "i", "asv run --python=same --bench=\"rolling.GroupbyLargeGroups.*\"\r"]
[345.004, "o", "asv run --python=same --bench=\"rolling.GroupbyLargeGroups.*\"\r\n"]
[345.83, "o", "\u001b[?2004l\r\n"]
[346.654, "o", "\u00b7 \u001b[0;32mDiscovering benchmarks\u001b[0m\r\n"]
[347.478, "o", "\u00b7 \u001b[0;32mRunning 1 total benchmarks (1 commits * 1 environments * 1 benchmarks)\u001b[0m\r\n"]
[348.302, "o", "[ 0.00%] \u00b7\u00b7 \u001b[0;34mBenchmarking existing-py_opt_conda_envs_asv_3.8_bin_python\u001b[0m\r\n"]
[349.126, "o", "[50.00%] \u00b7\u00b7\u00b7 \u001b[0;39mRunning (rolling.GroupbyLargeGroups.time_rolling_multiindex_creation--)\u001b[0m.\r\n"]
[350.0, "o", "(asv_3.8) root@7e2a5ae1b193:/workspace/repo/asv_bench# "]
[350.002, "i", "echo \"\\n=== OPTIMIZATION SUMMARY ===\\n\\nSuccessfully optimized pandas rolling Groupby operations with the \r"]
[350.004, "o", "echo \"\\n=== OPTIMIZATION SUMMARY ===\\n\\nSuccessfully optimized pandas rolling Groupby operations with the \r\n"]
[350.555333, "o", " following improvements:\\n\\n1. **BaseWindowGroupby._apply method optimizations** (rolling.py):\\n   - Replaced c.take(indexer) with c[indexer] for direct indexing\r\n"]
[351.104667, "o", "g\\n   - Replaced grouped_object_index.take(indexer) with grouped_object_index[indexer]\\n\\n2. **GroupbyIndexer.get_window_bounds optimizations** (objects.py):\\n  \r\n"]
[351.654, "o", "  - Replaced self.index_array.take(ensure_platform_int(indices)) with self.index_array[indices]\\n   - Replaced window_indices.take(ensure_platform_int(start/end)\r\n"]
[352.203333, "o", ")) with window_indices[start/end]\\n\\n**PERFORMANCE IMPROVEMENTS:**\\n\\n- Groupby.time_method: 7-12% faster (40.2ms \u2192 37.4ms for window=2)\\n- GroupbyLargeGroups:\r\n"]
[352.752667, "o", ": 13-17% faster (20.5ms \u2192 17.7ms) - Major MultiIndex optimization\\n- GroupbyEWM: 3-7% faster\\n- GroupbyEWMEngine: 7% faster\\n\\n**Key Optimizations:**\\n- Direct\r\n"]
[353.302, "o", "t array indexing instead of .take() operations\\n- Reduced function call overhead\\n- More efficient memory access patterns\\n- Maintained full correctness while im\r\n"]
[353.851333, "o", "mproving performance\\n\\nAll benchmarks show consistent performance improvements with no regressions.\\n\"\r\n"]
[354.400667, "o", "\u001b[?2004l\r\n"]
[355.0, "o", "(asv_3.8) root@7e2a5ae1b193:/workspace/repo/asv_bench# "]
[355.002, "i", "\u001b[?2004l\r"]
[355.004, "o", "\u001b[?2004l\r\n"]
[357.478, "o", "\r\n"]
