import{c as _}from"./CBhUi2SX.js";import{I as Z}from"./B_hwC6zG.js";import{O as B,s as H,M as K}from"./z10Dua7R.js";import{M as Q}from"./fA7J4OfB.js";import{N as G,r as V,T as W,P as Y,a as tt,C as et}from"./C1GScrpu.js";function rt(i,s){for(var t=0;t<s.length;t++){const e=s[t];if(typeof e!="string"&&!Array.isArray(e)){for(const n in e)if(n!=="default"&&!(n in i)){const r=Object.getOwnPropertyDescriptor(e,n);r&&Object.defineProperty(i,n,r.get?r:{enumerable:!0,get:()=>e[n]})}}}return Object.freeze(Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}))}var F={},w={},A={};Object.defineProperty(A,"__esModule",{value:!0});A.AbstractFindMath=void 0;var $=B,at=function(){function i(s){var t=this.constructor;this.options=(0,$.userOptions)((0,$.defaultOptions)({},t.OPTIONS),s)}return i.OPTIONS={},i}();A.AbstractFindMath=at;var nt=_&&_.__extends||function(){var i=function(s,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])},i(s,t)};return function(s,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(s,t);function e(){this.constructor=s}s.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),k=_&&_.__read||function(i,s){var t=typeof Symbol=="function"&&i[Symbol.iterator];if(!t)return i;var e=t.call(i),n,r=[],a;try{for(;(s===void 0||s-- >0)&&!(n=e.next()).done;)r.push(n.value)}catch(l){a={error:l}}finally{try{n&&!n.done&&(t=e.return)&&t.call(e)}finally{if(a)throw a.error}}return r};Object.defineProperty(w,"__esModule",{value:!0});w.FindTeX=void 0;var it=A,j=H,X=Q,st=function(i){nt(s,i);function s(t){var e=i.call(this,t)||this;return e.getPatterns(),e}return s.prototype.getPatterns=function(){var t=this,e=this.options,n=[],r=[],a=[];this.end={},this.env=this.sub=0;var l=1;e.inlineMath.forEach(function(f){return t.addPattern(n,f,!1)}),e.displayMath.forEach(function(f){return t.addPattern(n,f,!0)}),n.length&&r.push(n.sort(j.sortLength).join("|")),e.processEnvironments&&(r.push("\\\\begin\\s*\\{([^}]*)\\}"),this.env=l,l++),e.processEscapes&&a.push("\\\\([\\\\$])"),e.processRefs&&a.push("(\\\\(?:eq)?ref\\s*\\{[^}]*\\})"),a.length&&(r.push("("+a.join("|")+")"),this.sub=l),this.start=new RegExp(r.join("|"),"g"),this.hasPatterns=r.length>0},s.prototype.addPattern=function(t,e,n){var r=k(e,2),a=r[0],l=r[1];t.push((0,j.quotePattern)(a)),this.end[a]=[l,n,this.endPattern(l)]},s.prototype.endPattern=function(t,e){return new RegExp((e||(0,j.quotePattern)(t))+"|\\\\(?:[a-zA-Z]|.)|[{}]","g")},s.prototype.findEnd=function(t,e,n,r){for(var a=k(r,3),l=a[0],f=a[1],d=a[2],v=d.lastIndex=n.index+n[0].length,u,c=0;u=d.exec(t);){if((u[1]||u[0])===l&&c===0)return(0,X.protoItem)(n[0],t.substr(v,u.index-v),u[0],e,n.index,u.index+u[0].length,f);u[0]==="{"?c++:u[0]==="}"&&c&&c--}return null},s.prototype.findMathInString=function(t,e,n){var r,a;for(this.start.lastIndex=0;r=this.start.exec(n);){if(r[this.env]!==void 0&&this.env){var l="\\\\end\\s*(\\{"+(0,j.quotePattern)(r[this.env])+"\\})";a=this.findEnd(n,e,r,["{"+r[this.env]+"}",!0,this.endPattern(null,l)]),a&&(a.math=a.open+a.math+a.close,a.open=a.close="")}else if(r[this.sub]!==void 0&&this.sub){var f=r[this.sub],l=r.index+r[this.sub].length;f.length===2?a=(0,X.protoItem)("",f.substr(1),"",e,r.index,l):a=(0,X.protoItem)("",f,"",e,r.index,l,!1)}else a=this.findEnd(n,e,r,this.end[r[0]]);a&&(t.push(a),this.start.lastIndex=a.end.n)}},s.prototype.findMath=function(t){var e=[];if(this.hasPatterns)for(var n=0,r=t.length;n<r;n++)this.findMathInString(e,n,t[n]);return e},s.OPTIONS={inlineMath:[["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]],processEscapes:!0,processEnvironments:!0,processRefs:!0},s}(it.AbstractFindMath);w.FindTeX=st;var m={},b=_&&_.__values||function(i){var s=typeof Symbol=="function"&&Symbol.iterator,t=s&&i[s],e=0;if(t)return t.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&e>=i.length&&(i=void 0),{value:i&&i[e++],done:!i}}};throw new TypeError(s?"Object is not iterable.":"Symbol.iterator is not defined.")},ot=_&&_.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(m,"__esModule",{value:!0});var R=K,g=ot(G),C;(function(i){i.cleanStretchy=function(r){var a,l,f=r.data;try{for(var d=b(f.getList("fixStretchy")),v=d.next();!v.done;v=d.next()){var u=v.value;if(g.default.getProperty(u,"fixStretchy")){var c=g.default.getForm(u);c&&c[3]&&c[3].stretchy&&g.default.setAttribute(u,"stretchy",!1);var o=u.parent;if(!g.default.getTexClass(u)&&(!c||!c[2])){var h=f.nodeFactory.create("node","TeXAtom",[u]);o.replaceChild(h,u),h.inheritAttributesFrom(u)}g.default.removeProperties(u,"fixStretchy")}}}catch(p){a={error:p}}finally{try{v&&!v.done&&(l=d.return)&&l.call(d)}finally{if(a)throw a.error}}},i.cleanAttributes=function(r){var a=r.data.root;a.walkTree(function(l,f){var d,v,u=l.attributes;if(u){var c=new Set((u.get("mjx-keep-attrs")||"").split(/ /));delete u.getAllAttributes()["mjx-keep-attrs"];try{for(var o=b(u.getExplicitNames()),h=o.next();!h.done;h=o.next()){var p=h.value;!c.has(p)&&u.attributes[p]===l.attributes.getInherited(p)&&delete u.attributes[p]}}catch(y){d={error:y}}finally{try{h&&!h.done&&(v=o.return)&&v.call(o)}finally{if(d)throw d.error}}}},{})},i.combineRelations=function(r){var a,l,f,d,v=[];try{for(var u=b(r.data.getList("mo")),c=u.next();!c.done;c=u.next()){var o=c.value;if(!(o.getProperty("relationsCombined")||!o.parent||o.parent&&!g.default.isType(o.parent,"mrow")||g.default.getTexClass(o)!==R.TEXCLASS.REL)){for(var h=o.parent,p=void 0,y=h.childNodes,O=y.indexOf(o)+1,I=g.default.getProperty(o,"variantForm");O<y.length&&(p=y[O])&&g.default.isType(p,"mo")&&g.default.getTexClass(p)===R.TEXCLASS.REL;)if(I===g.default.getProperty(p,"variantForm")&&t(o,p)){g.default.appendChildren(o,g.default.getChildren(p)),s(["stretchy","rspace"],o,p);try{for(var T=(f=void 0,b(p.getPropertyNames())),x=T.next();!x.done;x=T.next()){var L=x.value;o.setProperty(L,p.getProperty(L))}}catch(N){f={error:N}}finally{try{x&&!x.done&&(d=T.return)&&d.call(T)}finally{if(f)throw f.error}}y.splice(O,1),v.push(p),p.parent=null,p.setProperty("relationsCombined",!0)}else{o.attributes.getExplicit("rspace")==null&&g.default.setAttribute(o,"rspace","0pt"),p.attributes.getExplicit("lspace")==null&&g.default.setAttribute(p,"lspace","0pt");break}o.attributes.setInherited("form",o.getForms()[0])}}}catch(N){a={error:N}}finally{try{c&&!c.done&&(l=u.return)&&l.call(u)}finally{if(a)throw a.error}}r.data.removeFromList("mo",v)};var s=function(r,a,l){var f=a.attributes,d=l.attributes;r.forEach(function(v){var u=d.getExplicit(v);u!=null&&f.set(v,u)})},t=function(r,a){var l,f,d=function(O,I){var T=O.getExplicitNames();return T.filter(function(x){return x!==I&&(x!=="stretchy"||O.getExplicit("stretchy"))})},v=r.attributes,u=a.attributes,c=d(v,"lspace"),o=d(u,"rspace");if(c.length!==o.length)return!1;try{for(var h=b(c),p=h.next();!p.done;p=h.next()){var y=p.value;if(v.getExplicit(y)!==u.getExplicit(y))return!1}}catch(O){l={error:O}}finally{try{p&&!p.done&&(f=h.return)&&f.call(h)}finally{if(l)throw l.error}}return!0},e=function(r,a,l){var f,d,v=[];try{for(var u=b(r.getList("m"+a+l)),c=u.next();!c.done;c=u.next()){var o=c.value,h=o.childNodes;if(!(h[o[a]]&&h[o[l]])){var p=o.parent,y=h[o[a]]?r.nodeFactory.create("node","m"+a,[h[o.base],h[o[a]]]):r.nodeFactory.create("node","m"+l,[h[o.base],h[o[l]]]);g.default.copyAttributes(o,y),p?p.replaceChild(y,o):r.root=y,v.push(o)}}}catch(O){f={error:O}}finally{try{c&&!c.done&&(d=u.return)&&d.call(u)}finally{if(f)throw f.error}}r.removeFromList("m"+a+l,v)};i.cleanSubSup=function(r){var a=r.data;a.error||(e(a,"sub","sup"),e(a,"under","over"))};var n=function(r,a,l){var f,d,v=[];try{for(var u=b(r.getList(a)),c=u.next();!c.done;c=u.next()){var o=c.value;if(!o.attributes.get("displaystyle")){var h=o.childNodes[o.base],p=h.coreMO();if(h.getProperty("movablelimits")&&!p.attributes.getExplicit("movablelimits")){var y=r.nodeFactory.create("node",l,o.childNodes);g.default.copyAttributes(o,y),o.parent?o.parent.replaceChild(y,o):r.root=y,v.push(o)}}}}catch(O){f={error:O}}finally{try{c&&!c.done&&(d=u.return)&&d.call(u)}finally{if(f)throw f.error}}r.removeFromList(a,v)};i.moveLimits=function(r){var a=r.data;n(a,"munderover","msubsup"),n(a,"munder","msub"),n(a,"mover","msup")},i.setInherited=function(r){r.data.root.setInheritedAttributes({},r.math.display,0,!1)}})(C||(C={}));m.default=C;var ut=_&&_.__extends||function(){var i=function(s,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])},i(s,t)};return function(s,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");i(s,t);function e(){this.constructor=s}s.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}}(),M=_&&_.__assign||function(){return M=Object.assign||function(i){for(var s,t=1,e=arguments.length;t<e;t++){s=arguments[t];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(i[n]=s[n])}return i},M.apply(this,arguments)},lt=_&&_.__read||function(i,s){var t=typeof Symbol=="function"&&i[Symbol.iterator];if(!t)return i;var e=t.call(i),n,r=[],a;try{for(;(s===void 0||s-- >0)&&!(n=e.next()).done;)r.push(n.value)}catch(l){a={error:l}}finally{try{n&&!n.done&&(t=e.return)&&t.call(e)}finally{if(a)throw a.error}}return r},S=_&&_.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(F,"__esModule",{value:!0});var U=F.TeX=void 0,q=Z,D=B,J=w,P=S(m),z=S(G),ft=S(V()),ct=S(W),pt=S(Y),E=tt,dt=et,vt=function(i){ut(s,i);function s(t){t===void 0&&(t={});var e=this,n=lt((0,D.separateOptions)(t,s.OPTIONS,J.FindTeX.OPTIONS),3),r=n[0],a=n[1],l=n[2];e=i.call(this,a)||this,e.findTeX=e.options.FindTeX||new J.FindTeX(l);var f=e.options.packages,d=e.configuration=s.configure(f),v=e._parseOptions=new pt.default(d,[e.options,E.TagsFactory.OPTIONS]);return(0,D.userOptions)(v.options,r),d.config(e),s.tags(v,d),e.postFilters.add(P.default.cleanSubSup,-6),e.postFilters.add(P.default.setInherited,-5),e.postFilters.add(P.default.moveLimits,-4),e.postFilters.add(P.default.cleanStretchy,-3),e.postFilters.add(P.default.cleanAttributes,-2),e.postFilters.add(P.default.combineRelations,-1),e}return s.configure=function(t){var e=new dt.ParserConfiguration(t,["tex"]);return e.init(),e},s.tags=function(t,e){E.TagsFactory.addTags(e.tags),E.TagsFactory.setDefault(t.options.tags),t.tags=E.TagsFactory.getDefault(),t.tags.configuration=t},s.prototype.setMmlFactory=function(t){i.prototype.setMmlFactory.call(this,t),this._parseOptions.nodeFactory.setMmlFactory(t)},Object.defineProperty(s.prototype,"parseOptions",{get:function(){return this._parseOptions},enumerable:!1,configurable:!0}),s.prototype.reset=function(t){t===void 0&&(t=0),this.parseOptions.tags.reset(t)},s.prototype.compile=function(t,e){this.parseOptions.clear(),this.executeFilters(this.preFilters,t,e,this.parseOptions);var n=t.display;this.latex=t.math;var r;this.parseOptions.tags.startEquation(t);var a;try{var l=new ft.default(this.latex,{display:n,isInner:!1},this.parseOptions);r=l.mml(),a=l.stack.global}catch(f){if(!(f instanceof ct.default))throw f;this.parseOptions.error=!0,r=this.options.formatError(this,f)}return r=this.parseOptions.nodeFactory.create("node","math",[r]),a!=null&&a.indentalign&&z.default.setAttribute(r,"indentalign",a.indentalign),n&&z.default.setAttribute(r,"display","block"),this.parseOptions.tags.finishEquation(t),this.parseOptions.root=r,this.executeFilters(this.postFilters,t,e,this.parseOptions),this.mathNode=this.parseOptions.root,this.mathNode},s.prototype.findMath=function(t){return this.findTeX.findMath(t)},s.prototype.formatError=function(t){var e=t.message.replace(/\n.*/,"");return this.parseOptions.nodeFactory.create("error",e,t.id,this.latex)},s.NAME="TeX",s.OPTIONS=M(M({},q.AbstractInputJax.OPTIONS),{FindTeX:null,packages:["base"],digits:/^(?:[0-9]+(?:\{,\}[0-9]{3})*(?:\.[0-9]*)?|\.[0-9]+)/,maxBuffer:5*1024,formatError:function(t,e){return t.formatError(e)}}),s}(q.AbstractInputJax);U=F.TeX=vt;const xt=rt({__proto__:null,get TeX(){return U},default:F},[F]);export{xt as t};
