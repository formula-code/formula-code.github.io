{"version": 2, "width": 160, "height": 40, "timestamp": 1762994890, "env": {"SHELL": "/bin/bash", "TERM": "screen"}}
[0.0, "o", "(asv_3.8) root@cb2cc1765c92:/workspace/repo# "]
[0.002, "i", "asciinema rec --stdin /logs/agent.cast\r"]
[0.004, "o", "asciinema rec --stdin /logs/agent.cast\r\n"]
[1.242, "o", "\u001b[?2004l\r\n"]
[2.478, "o", "\u001b[0;31masciinema: /logs/agent.cast already exists, aborting\u001b[0m\r\n"]
[3.714, "o", "\u001b[0;31masciinema: use --overwrite option if you want to overwrite existing recording\u001b[0m\r\n"]
[5.0, "o", "(asv_3.8) root@cb2cc1765c92:/workspace/repo# "]
[5.002, "i", "clear\r"]
[5.004, "o", "clear\r\n"]
[7.478, "o", "\u001b[?2004l\r\n"]
[10.0, "o", "(asv_3.8) root@cb2cc1765c92:/workspace/repo# "]
[10.002, "i", "ls -la\r"]
[10.004, "o", "ls -la\r\n"]
[10.139622, "o", "\u001b[?2004l\r\n"]
[10.273243, "o", "total 208\r\n"]
[10.406865, "o", "drwxr-xr-x 1 root root  4096 Oct  1 18:15 \u001b[0m\u001b[01;34m.\u001b[0m\r\n"]
[10.540486, "o", "drwxr-xr-x 1 root root  4096 Sep 15 17:10 \u001b[01;34m..\u001b[0m\r\n"]
[10.674108, "o", "drwxr-xr-x 2 root root  4096 Sep 12 21:44 \u001b[01;34m.circleci\u001b[0m\r\n"]
[10.80773, "o", "-rw-r--r-- 1 root root  1021 Sep 12 21:44 .devcontainer.json\r\n"]
[10.941351, "o", "drwxr-xr-x 1 root root  4096 Oct  1 18:15 \u001b[01;34m.git\u001b[0m\r\n"]
[11.074973, "o", "-rw-r--r-- 1 root root   229 Sep 12 21:44 .gitattributes\r\n"]
[11.208595, "o", "drwxr-xr-x 1 root root  4096 Sep 12 21:44 \u001b[01;34m.github\u001b[0m\r\n"]
[11.342216, "o", "-rw-r--r-- 1 root root  1740 Sep 12 21:44 .gitignore\r\n"]
[11.475838, "o", "-rw-r--r-- 1 root root  2322 Sep 12 21:44 .gitpod.yml\r\n"]
[11.609459, "o", "-rw-r--r-- 1 root root   761 Sep 12 21:44 .libcst.codemod.yaml\r\n"]
[11.743081, "o", "-rw-r--r-- 1 root root   109 Sep 12 21:44 .pep8speaks.yml\r\n"]
[11.876703, "o", "-rw-r--r-- 1 root root 16108 Sep 12 21:44 .pre-commit-config.yaml\r\n"]
[12.010324, "o", "-rw-r--r-- 1 root root  2284 Sep 12 21:44 AUTHORS.md\r\n"]
[12.143946, "o", "-rw-r--r-- 1 root root   372 Sep 12 21:44 CITATION.cff\r\n"]
[12.277568, "o", "-rw-r--r-- 1 root root   369 Sep 12 21:44 Dockerfile\r\n"]
[12.411189, "o", "-rw-r--r-- 1 root root  1634 Sep 12 21:44 LICENSE\r\n"]
[12.544811, "o", "drwxr-xr-x 1 root root  4096 Sep 12 21:44 \u001b[01;34mLICENSES\u001b[0m\r\n"]
[12.678432, "o", "-rw-r--r-- 1 root root  1228 Sep 12 21:44 MANIFEST.in\r\n"]
[12.812054, "o", "-rw-r--r-- 1 root root 10387 Sep 12 21:44 README.md\r\n"]
[12.945676, "o", "-rw-r--r-- 1 root root   246 Sep 12 21:44 RELEASE.md\r\n"]
[13.079297, "o", "drwxr-xr-x 1 root root  4096 Sep 12 21:44 \u001b[01;34masv_bench\u001b[0m\r\n"]
[13.212919, "o", "drwxr-xr-x 1 root root  4096 Sep 12 21:44 \u001b[01;34mci\u001b[0m\r\n"]
[13.346541, "o", "-rw-r--r-- 1 root root   256 Sep 12 21:41 codecov.yml\r\n"]
[13.480162, "o", "drwxr-xr-x 1 root root  4096 Sep 12 21:44 \u001b[01;34mdoc\u001b[0m\r\n"]
[13.613784, "o", "-rw-r--r-- 1 root root  2116 Sep 12 21:44 environment.yml\r\n"]
[13.747405, "o", "drwxr-xr-x 1 root root  4096 Sep 12 21:44 \u001b[01;34mgitpod\u001b[0m\r\n"]
[13.881027, "o", "drwxr-xr-x 1 root root  4096 Sep 13 21:55 \u001b[01;34mpandas\u001b[0m\r\n"]
[14.014649, "o", "-rw-r--r-- 1 root root 15980 Sep 12 21:44 pyproject.toml\r\n"]
[14.14827, "o", "-rw-r--r-- 1 root root  4429 Sep 12 21:44 pyright_reportGeneralTypeIssues.json\r\n"]
[14.281892, "o", "-rw-r--r-- 1 root root  1103 Sep 12 21:44 requirements-dev.txt\r\n"]
[14.415514, "o", "drwxr-xr-x 1 root root  4096 Sep 12 21:44 \u001b[01;34mscripts\u001b[0m\r\n"]
[14.549135, "o", "-rw-r--r-- 1 root root  2095 Sep 12 21:44 setup.cfg\r\n"]
[14.682757, "o", "-rwxr-xr-x 1 root root 21965 Sep 12 21:44 \u001b[01;32msetup.py\u001b[0m\r\n"]
[14.816378, "o", "drwxr-xr-x 2 root root  4096 Sep 12 21:41 \u001b[01;34mtypings\u001b[0m\r\n"]
[15.0, "o", "(asv_3.8) root@cb2cc1765c92:/workspace/repo# "]
[15.002, "i", "ls -la asv.conf.json .asv\r"]
[15.004, "o", "ls -la asv.conf.json .asv\r\n"]
[16.654, "o", "\u001b[?2004l\r\n"]
[18.302, "o", "ls: cannot access 'asv.conf.json': No such file or directory\r\n"]
[20.0, "o", "(asv_3.8) root@cb2cc1765c92:/workspace/repo# "]
[20.002, "i", "grep -RIl \"class .*Groupby\" -n . || true\r"]
[20.004, "o", "grep -RIl \"class .*Groupby\" -n . || true\r\n"]
[20.241429, "o", "\u001b[?2004l\r\n"]
[20.476857, "o", "\u001b[35m\u001b[K./pandas/tests/extension/test_period.py\u001b[m\u001b[K\r\n"]
[20.712286, "o", "\u001b[35m\u001b[K./pandas/tests/extension/test_numpy.py\u001b[m\u001b[K\r\n"]
[20.947714, "o", "\u001b[35m\u001b[K./pandas/tests/extension/test_arrow.py\u001b[m\u001b[K\r\n"]
[21.183143, "o", "\u001b[35m\u001b[K./pandas/tests/extension/base/groupby.py\u001b[m\u001b[K\r\n"]
[21.418571, "o", "\u001b[35m\u001b[K./pandas/tests/extension/test_interval.py\u001b[m\u001b[K\r\n"]
[21.654, "o", "\u001b[35m\u001b[K./pandas/tests/extension/test_string.py\u001b[m\u001b[K\r\n"]
[21.889429, "o", "\u001b[35m\u001b[K./pandas/tests/extension/test_datetime.py\u001b[m\u001b[K\r\n"]
[22.124857, "o", "\u001b[35m\u001b[K./pandas/tests/extension/decimal/test_decimal.py\u001b[m\u001b[K\r\n"]
[22.360286, "o", "\u001b[35m\u001b[K./pandas/tests/extension/json/test_json.py\u001b[m\u001b[K\r\n"]
[22.595714, "o", "\u001b[35m\u001b[K./pandas/tests/extension/test_boolean.py\u001b[m\u001b[K\r\n"]
[22.831143, "o", "\u001b[35m\u001b[K./pandas/tests/extension/test_integer.py\u001b[m\u001b[K\r\n"]
[23.066571, "o", "\u001b[35m\u001b[K./pandas/tests/extension/test_floating.py\u001b[m\u001b[K\r\n"]
[23.302, "o", "\u001b[35m\u001b[K./pandas/tests/plotting/frame/test_frame_groupby.py\u001b[m\u001b[K\r\n"]
[23.537429, "o", "\u001b[35m\u001b[K./pandas/core/window/rolling.py\u001b[m\u001b[K\r\n"]
[23.772857, "o", "\u001b[35m\u001b[K./pandas/core/window/expanding.py\u001b[m\u001b[K\r\n"]
[24.008286, "o", "\u001b[35m\u001b[K./pandas/core/window/ewm.py\u001b[m\u001b[K\r\n"]
[24.243714, "o", "\u001b[35m\u001b[K./pandas/core/indexers/objects.py\u001b[m\u001b[K\r\n"]
[24.479143, "o", "\u001b[35m\u001b[K./pandas/core/resample.py\u001b[m\u001b[K\r\n"]
[24.714571, "o", "\u001b[35m\u001b[K./asv_bench/benchmarks/rolling.py\u001b[m\u001b[K\r\n"]
[25.0, "o", "(asv_3.8) root@cb2cc1765c92:/workspace/repo# "]
[25.002, "i", "grep -RIn \"rolling.Groupby\" -n . || true\r"]
[25.004, "o", "grep -RIn \"rolling.Groupby\" -n . || true\r\n"]
[25.006, "o", "\u001b[?2004l\r\n"]
[30.0, "o", "(asv_3.8) root@cb2cc1765c92:/workspace/repo# "]
[30.002, "i", "rg -n \"Groupby|rolling\" asv* **/bench* 2>/dev/null || true\r"]
[30.004, "o", "rg -n \"Groupby|rolling\" asv* **/bench* 2>/dev/null || true\r\n"]
[30.006, "o", "\u001b[?2004l\r\n"]
[35.0, "o", "(asv_3.8) root@cb2cc1765c92:/workspace/repo# "]
[35.002, "i", "cat asv.conf.json\r"]
[35.004, "o", "cat asv.conf.json\r\n"]
[37.478, "o", "\u001b[?2004l\r\n"]
[40.0, "o", "(asv_3.8) root@cb2cc1765c92:/workspace/repo# "]
[40.002, "i", "ls -la benchmarks asv_bench asv_benchmarks.txt 2>/dev/null || true\r"]
[40.004, "o", "ls -la benchmarks asv_bench asv_benchmarks.txt 2>/dev/null || true\r\n"]
[40.712286, "o", "\u001b[?2004l\r\n"]
[41.418571, "o", "asv_bench:\r\n"]
[42.124857, "o", "total 24\r\n"]
[42.831143, "o", "drwxr-xr-x 1 root root 4096 Sep 12 21:44 \u001b[0m\u001b[01;34m.\u001b[0m\r\n"]
[43.537429, "o", "drwxr-xr-x 1 root root 4096 Oct  1 18:15 \u001b[01;34m..\u001b[0m\r\n"]
[44.243714, "o", "-rw-r--r-- 1 root root 5217 Sep 12 21:44 asv.conf.json\r\n"]
[45.0, "o", "(asv_3.8) root@cb2cc1765c92:/workspace/repo# "]
[45.002, "i", "cat asv_benchmarks.txt 2>/dev/null || true\r"]
[45.004, "o", "cat asv_benchmarks.txt 2>/dev/null || true\r\n"]
[45.006, "o", "\u001b[?2004l\r\n"]
[50.0, "o", "(asv_3.8) root@cb2cc1765c92:/workspace/repo# "]
[50.002, "i", "asv run --python=same --bench=\"rolling.Groupby.*\"\r"]
[50.004, "o", "asv run --python=same --bench=\"rolling.Groupby.*\"\r\n"]
[52.478, "o", "\u001b[?2004l\r\n"]
[55.0, "o", "(asv_3.8) root@cb2cc1765c92:/workspace/repo# "]
[55.002, "i", "sed -n '1,200p' asv_bench/asv.conf.json\r"]
[55.004, "o", "sed -n '1,200p' asv_bench/asv.conf.json\r\n"]
[55.043455, "o", "\u001b[?2004l\r\n"]
[55.080909, "o", "{\r\n"]
[55.118364, "o", "    // The version of the config file format.  Do not change, unless\r\n"]
[55.155818, "o", "    // you know what you are doing.\r\n"]
[55.193273, "o", "    \"version\": 1,\r\n"]
[55.230727, "o", "\r\n"]
[55.268182, "o", "    // The name of the project being benchmarked\r\n"]
[55.305636, "o", "    \"project\": \"pandas\",\r\n"]
[55.343091, "o", "\r\n"]
[55.380545, "o", "    // The project's homepage\r\n"]
[55.418, "o", "    \"project_url\": \"https://pandas.pydata.org/\",\r\n"]
[55.455455, "o", "\r\n"]
[55.492909, "o", "    // The URL of the source code repository for the project being\r\n"]
[55.530364, "o", "    // benchmarked\r\n"]
[55.567818, "o", "    \"repo\": \"..\",\r\n"]
[55.605273, "o", "\r\n"]
[55.642727, "o", "    // List of branches to benchmark. If not provided, defaults to \"master\"\r\n"]
[55.680182, "o", "    // (for git) or \"default\" (for mercurial).\r\n"]
[55.717636, "o", "    \"branches\": [\"main\"],\r\n"]
[55.755091, "o", "\r\n"]
[55.792545, "o", "    // The tool to use to create environments.  May be \"conda\",\r\n"]
[55.83, "o", "    // \"virtualenv\" or other value depending on the plugins in use.\r\n"]
[55.867455, "o", "    // If missing or the empty string, the tool will be automatically\r\n"]
[55.904909, "o", "    // determined by looking for tools on the PATH environment\r\n"]
[55.942364, "o", "    // variable.\r\n"]
[55.979818, "o", "    \"environment_type\": \"conda\",\r\n"]
[56.017273, "o", "\r\n"]
[56.054727, "o", "    // the base URL to show a commit for the project.\r\n"]
[56.092182, "o", "    \"show_commit_url\": \"https://github.com/pandas-dev/pandas/commit/\",\r\n"]
[56.129636, "o", "\r\n"]
[56.167091, "o", "    // The Pythons you'd like to test against.  If not provided, defaults\r\n"]
[56.204545, "o", "    // to the current version of Python used to run `asv`.\r\n"]
[56.242, "o", "    \"pythons\": [\"3.8\"],\r\n"]
[56.279455, "o", "\r\n"]
[56.316909, "o", "    // The matrix of dependencies to test.  Each key is the name of a\r\n"]
[56.354364, "o", "    // package (in PyPI) and the values are version numbers.  An empty\r\n"]
[56.391818, "o", "    // list or empty string indicates to just test against the default\r\n"]
[56.429273, "o", "    // (latest) version. null indicates that the package is to not be\r\n"]
[56.466727, "o", "    // installed. If the package to be tested is only available from\r\n"]
[56.504182, "o", "    // PyPi, and the 'environment_type' is conda, then you can preface\r\n"]
[56.541636, "o", "    // the package name by 'pip+', and the package will be installed via\r\n"]
[56.579091, "o", "    // pip (with all the conda available packages installed first,\r\n"]
[56.616545, "o", "    // followed by the pip installed packages).\r\n"]
[56.654, "o", "    \"matrix\": {\r\n"]
[56.691455, "o", "        \"numpy\": [],\r\n"]
[56.728909, "o", "        \"Cython\": [\"0.29.32\"],\r\n"]
[56.766364, "o", "        \"matplotlib\": [],\r\n"]
[56.803818, "o", "        \"sqlalchemy\": [],\r\n"]
[56.841273, "o", "        \"scipy\": [],\r\n"]
[56.878727, "o", "        \"numba\": [],\r\n"]
[56.916182, "o", "        \"numexpr\": [],\r\n"]
[56.953636, "o", "        \"pytables\": [null, \"\"],  // platform dependent, see excludes below\r\n"]
[56.991091, "o", "        \"pyarrow\": [],\r\n"]
[57.028545, "o", "        \"tables\": [null, \"\"],\r\n"]
[57.066, "o", "        \"openpyxl\": [],\r\n"]
[57.103455, "o", "        \"xlsxwriter\": [],\r\n"]
[57.140909, "o", "        \"xlrd\": [],\r\n"]
[57.178364, "o", "        \"odfpy\": [],\r\n"]
[57.215818, "o", "        \"jinja2\": [],\r\n"]
[57.253273, "o", "    },\r\n"]
[57.290727, "o", "    \"conda_channels\": [\"conda-forge\"],\r\n"]
[57.328182, "o", "    // Combinations of libraries/python versions can be excluded/included\r\n"]
[57.365636, "o", "    // from the set to test. Each entry is a dictionary containing additional\r\n"]
[57.403091, "o", "    // key-value pairs to include/exclude.\r\n"]
[57.440545, "o", "    //\r\n"]
[57.478, "o", "    // An exclude entry excludes entries where all values match. The\r\n"]
[57.515455, "o", "    // values are regexps that should match the whole string.\r\n"]
[57.552909, "o", "    //\r\n"]
[57.590364, "o", "    // An include entry adds an environment. Only the packages listed\r\n"]
[57.627818, "o", "    // are installed. The 'python' key is required. The exclude rules\r\n"]
[57.665273, "o", "    // do not apply to includes.\r\n"]
[57.702727, "o", "    //\r\n"]
[57.740182, "o", "    // In addition to package names, the following keys are available:\r\n"]
[57.777636, "o", "    //\r\n"]
[57.815091, "o", "    // - python\r\n"]
[57.852545, "o", "    //     Python version, as in the *pythons* variable above.\r\n"]
[57.89, "o", "    // - environment_type\r\n"]
[57.927455, "o", "    //     Environment type, as above.\r\n"]
[57.964909, "o", "    // - sys_platform\r\n"]
[58.002364, "o", "    //     Platform, as in sys.platform. Possible values for the common\r\n"]
[58.039818, "o", "    //     cases: 'linux2', 'win32', 'cygwin', 'darwin'.\r\n"]
[58.077273, "o", "    \"exclude\": [\r\n"]
[58.114727, "o", "        // On conda install pytables, otherwise tables\r\n"]
[58.152182, "o", "        {\"environment_type\": \"conda\", \"tables\": \"\"},\r\n"]
[58.189636, "o", "        {\"environment_type\": \"conda\", \"pytables\": null},\r\n"]
[58.227091, "o", "        {\"environment_type\": \"(?!conda).*\", \"tables\": null},\r\n"]
[58.264545, "o", "        {\"environment_type\": \"(?!conda).*\", \"pytables\": \"\"},\r\n"]
[58.302, "o", "    ],\r\n"]
[58.339455, "o", "    \"include\": [],\r\n"]
[58.376909, "o", "\r\n"]
[58.414364, "o", "    // The directory (relative to the current directory) that benchmarks are\r\n"]
[58.451818, "o", "    // stored in.  If not provided, defaults to \"benchmarks\"\r\n"]
[58.489273, "o", "    // \"benchmark_dir\": \"benchmarks\",\r\n"]
[58.526727, "o", "\r\n"]
[58.564182, "o", "    // The directory (relative to the current directory) to cache the Python\r\n"]
[58.601636, "o", "    // environments in.  If not provided, defaults to \"env\"\r\n"]
[58.639091, "o", "    // \"env_dir\": \"env\",\r\n"]
[58.676545, "o", "\r\n"]
[58.714, "o", "    // The directory (relative to the current directory) that raw benchmark\r\n"]
[58.751455, "o", "    // results are stored in.  If not provided, defaults to \"results\".\r\n"]
[58.788909, "o", "    // \"results_dir\": \"results\",\r\n"]
[58.826364, "o", "\r\n"]
[58.863818, "o", "    // The directory (relative to the current directory) that the html tree\r\n"]
[58.901273, "o", "    // should be written to.  If not provided, defaults to \"html\".\r\n"]
[58.938727, "o", "    // \"html_dir\": \"html\",\r\n"]
[58.976182, "o", "\r\n"]
[59.013636, "o", "    // The number of characters to retain in the commit hashes.\r\n"]
[59.051091, "o", "    // \"hash_length\": 8,\r\n"]
[59.088545, "o", "\r\n"]
[59.126, "o", "    // `asv` will cache wheels of the recent builds in each\r\n"]
[59.163455, "o", "    // environment, making them faster to install next time.  This is\r\n"]
[59.200909, "o", "    // number of builds to keep, per environment.\r\n"]
[59.238364, "o", "    \"build_cache_size\": 8,\r\n"]
[59.275818, "o", "\r\n"]
[59.313273, "o", "    // The commits after which the regression search in `asv publish`\r\n"]
[59.350727, "o", "    // should start looking for regressions. Dictionary whose keys are\r\n"]
[59.388182, "o", "    // regexps matching to benchmark names, and values corresponding to\r\n"]
[59.425636, "o", "    // the commit (exclusive) after which to start looking for\r\n"]
[59.463091, "o", "    // regressions.  The default is to start from the first commit\r\n"]
[59.500545, "o", "    // with results. If the commit is `null`, regression detection is\r\n"]
[59.538, "o", "    // skipped for the matching benchmark.\r\n"]
[59.575455, "o", "    //\r\n"]
[59.612909, "o", "    \"regressions_first_commits\": {\r\n"]
[59.650364, "o", "        \".*\": \"0409521665\"\r\n"]
[59.687818, "o", "    },\r\n"]
[59.725273, "o", "    \"regression_thresholds\": {\r\n"]
[59.762727, "o", "    },\r\n"]
[59.800182, "o", "    \"build_command\":\r\n"]
[59.837636, "o", "    [\"python -m pip install versioneer[toml]\",\r\n"]
[59.875091, "o", "     \"python setup.py build -j4\",\r\n"]
[59.912545, "o", "     \"PIP_NO_BUILD_ISOLATION=false python -mpip wheel --no-deps --no-index -w {build_cache_dir} {build_dir}\"],\r\n"]
[60.0, "o", "(asv_3.8) root@cb2cc1765c92:/workspace/repo# "]
[60.002, "i", "sed -n '1,200p' asv_bench/benchmarks/rolling.py\r"]
[60.004, "o", "sed -n '1,200p' asv_bench/benchmarks/rolling.py\r\n"]
[60.030597, "o", "\u001b[?2004l\r\n"]
[60.055194, "o", "import warnings\r\n"]
[60.079791, "o", "\r\n"]
[60.104388, "o", "import numpy as np\r\n"]
[60.128985, "o", "\r\n"]
[60.153582, "o", "import pandas as pd\r\n"]
[60.178179, "o", "\r\n"]
[60.202776, "o", "\r\n"]
[60.227373, "o", "class Methods:\r\n"]
[60.25197, "o", "    params = (\r\n"]
[60.276567, "o", "        [\"DataFrame\", \"Series\"],\r\n"]
[60.301164, "o", "        [(\"rolling\", {\"window\": 10}), (\"rolling\", {\"window\": 1000}), (\"expanding\", {})],\r\n"]
[60.325761, "o", "        [\"int\", \"float\"],\r\n"]
[60.350358, "o", "        [\"median\", \"mean\", \"max\", \"min\", \"std\", \"count\", \"skew\", \"kurt\", \"sum\", \"sem\"],\r\n"]
[60.374955, "o", "    )\r\n"]
[60.399552, "o", "    param_names = [\"constructor\", \"window_kwargs\", \"dtype\", \"method\"]\r\n"]
[60.424149, "o", "\r\n"]
[60.448746, "o", "    def setup(self, constructor, window_kwargs, dtype, method):\r\n"]
[60.473343, "o", "        N = 10**5\r\n"]
[60.49794, "o", "        window, kwargs = window_kwargs\r\n"]
[60.522537, "o", "        arr = (100 * np.random.random(N)).astype(dtype)\r\n"]
[60.547134, "o", "        obj = getattr(pd, constructor)(arr)\r\n"]
[60.571731, "o", "        self.window = getattr(obj, window)(**kwargs)\r\n"]
[60.596328, "o", "\r\n"]
[60.620925, "o", "    def time_method(self, constructor, window_kwargs, dtype, method):\r\n"]
[60.645522, "o", "        getattr(self.window, method)()\r\n"]
[60.670119, "o", "\r\n"]
[60.694716, "o", "    def peakmem_method(self, constructor, window_kwargs, dtype, method):\r\n"]
[60.719313, "o", "        getattr(self.window, method)()\r\n"]
[60.74391, "o", "\r\n"]
[60.768507, "o", "\r\n"]
[60.793104, "o", "class Apply:\r\n"]
[60.817701, "o", "    params = (\r\n"]
[60.842299, "o", "        [\"DataFrame\", \"Series\"],\r\n"]
[60.866896, "o", "        [3, 300],\r\n"]
[60.891493, "o", "        [\"int\", \"float\"],\r\n"]
[60.91609, "o", "        [sum, np.sum, lambda x: np.sum(x) + 5],\r\n"]
[60.940687, "o", "        [True, False],\r\n"]
[60.965284, "o", "    )\r\n"]
[60.989881, "o", "    param_names = [\"constructor\", \"window\", \"dtype\", \"function\", \"raw\"]\r\n"]
[61.014478, "o", "\r\n"]
[61.039075, "o", "    def setup(self, constructor, window, dtype, function, raw):\r\n"]
[61.063672, "o", "        N = 10**3\r\n"]
[61.088269, "o", "        arr = (100 * np.random.random(N)).astype(dtype)\r\n"]
[61.112866, "o", "        self.roll = getattr(pd, constructor)(arr).rolling(window)\r\n"]
[61.137463, "o", "\r\n"]
[61.16206, "o", "    def time_rolling(self, constructor, window, dtype, function, raw):\r\n"]
[61.186657, "o", "        self.roll.apply(function, raw=raw)\r\n"]
[61.211254, "o", "\r\n"]
[61.235851, "o", "\r\n"]
[61.260448, "o", "class NumbaEngineMethods:\r\n"]
[61.285045, "o", "    params = (\r\n"]
[61.309642, "o", "        [\"DataFrame\", \"Series\"],\r\n"]
[61.334239, "o", "        [\"int\", \"float\"],\r\n"]
[61.358836, "o", "        [(\"rolling\", {\"window\": 10}), (\"expanding\", {})],\r\n"]
[61.383433, "o", "        [\"sum\", \"max\", \"min\", \"median\", \"mean\", \"var\", \"std\"],\r\n"]
[61.40803, "o", "        [True, False],\r\n"]
[61.432627, "o", "        [None, 100],\r\n"]
[61.457224, "o", "    )\r\n"]
[61.481821, "o", "    param_names = [\r\n"]
[61.506418, "o", "        \"constructor\",\r\n"]
[61.531015, "o", "        \"dtype\",\r\n"]
[61.555612, "o", "        \"window_kwargs\",\r\n"]
[61.580209, "o", "        \"method\",\r\n"]
[61.604806, "o", "        \"parallel\",\r\n"]
[61.629403, "o", "        \"cols\",\r\n"]
[61.654, "o", "    ]\r\n"]
[61.678597, "o", "\r\n"]
[61.703194, "o", "    def setup(self, constructor, dtype, window_kwargs, method, parallel, cols):\r\n"]
[61.727791, "o", "        N = 10**3\r\n"]
[61.752388, "o", "        window, kwargs = window_kwargs\r\n"]
[61.776985, "o", "        shape = (N, cols) if cols is not None and constructor != \"Series\" else N\r\n"]
[61.801582, "o", "        arr = (100 * np.random.random(shape)).astype(dtype)\r\n"]
[61.826179, "o", "        data = getattr(pd, constructor)(arr)\r\n"]
[61.850776, "o", "\r\n"]
[61.875373, "o", "        # Warm the cache\r\n"]
[61.89997, "o", "        with warnings.catch_warnings(record=True):\r\n"]
[61.924567, "o", "            # Catch parallel=True not being applicable e.g. 1D data\r\n"]
[61.949164, "o", "            self.window = getattr(data, window)(**kwargs)\r\n"]
[61.973761, "o", "            getattr(self.window, method)(\r\n"]
[61.998358, "o", "                engine=\"numba\", engine_kwargs={\"parallel\": parallel}\r\n"]
[62.022955, "o", "            )\r\n"]
[62.047552, "o", "\r\n"]
[62.072149, "o", "    def test_method(self, constructor, dtype, window_kwargs, method, parallel, cols):\r\n"]
[62.096746, "o", "        with warnings.catch_warnings(record=True):\r\n"]
[62.121343, "o", "            getattr(self.window, method)(\r\n"]
[62.14594, "o", "                engine=\"numba\", engine_kwargs={\"parallel\": parallel}\r\n"]
[62.170537, "o", "            )\r\n"]
[62.195134, "o", "\r\n"]
[62.219731, "o", "\r\n"]
[62.244328, "o", "class NumbaEngineApply:\r\n"]
[62.268925, "o", "    params = (\r\n"]
[62.293522, "o", "        [\"DataFrame\", \"Series\"],\r\n"]
[62.318119, "o", "        [\"int\", \"float\"],\r\n"]
[62.342716, "o", "        [(\"rolling\", {\"window\": 10}), (\"expanding\", {})],\r\n"]
[62.367313, "o", "        [np.sum, lambda x: np.sum(x) + 5],\r\n"]
[62.39191, "o", "        [True, False],\r\n"]
[62.416507, "o", "        [None, 100],\r\n"]
[62.441104, "o", "    )\r\n"]
[62.465701, "o", "    param_names = [\r\n"]
[62.490299, "o", "        \"constructor\",\r\n"]
[62.514896, "o", "        \"dtype\",\r\n"]
[62.539493, "o", "        \"window_kwargs\",\r\n"]
[62.56409, "o", "        \"function\",\r\n"]
[62.588687, "o", "        \"parallel\",\r\n"]
[62.613284, "o", "        \"cols\",\r\n"]
[62.637881, "o", "    ]\r\n"]
[62.662478, "o", "\r\n"]
[62.687075, "o", "    def setup(self, constructor, dtype, window_kwargs, function, parallel, cols):\r\n"]
[62.711672, "o", "        N = 10**3\r\n"]
[62.736269, "o", "        window, kwargs = window_kwargs\r\n"]
[62.760866, "o", "        shape = (N, cols) if cols is not None and constructor != \"Series\" else N\r\n"]
[62.785463, "o", "        arr = (100 * np.random.random(shape)).astype(dtype)\r\n"]
[62.81006, "o", "        data = getattr(pd, constructor)(arr)\r\n"]
[62.834657, "o", "\r\n"]
[62.859254, "o", "        # Warm the cache\r\n"]
[62.883851, "o", "        with warnings.catch_warnings(record=True):\r\n"]
[62.908448, "o", "            # Catch parallel=True not being applicable e.g. 1D data\r\n"]
[62.933045, "o", "            self.window = getattr(data, window)(**kwargs)\r\n"]
[62.957642, "o", "            self.window.apply(\r\n"]
[62.982239, "o", "                function, raw=True, engine=\"numba\", engine_kwargs={\"parallel\": parallel}\r\n"]
[63.006836, "o", "            )\r\n"]
[63.031433, "o", "\r\n"]
[63.05603, "o", "    def test_method(self, constructor, dtype, window_kwargs, function, parallel, cols):\r\n"]
[63.080627, "o", "        with warnings.catch_warnings(record=True):\r\n"]
[63.105224, "o", "            self.window.apply(\r\n"]
[63.129821, "o", "                function, raw=True, engine=\"numba\", engine_kwargs={\"parallel\": parallel}\r\n"]
[63.154418, "o", "            )\r\n"]
[63.179015, "o", "\r\n"]
[63.203612, "o", "\r\n"]
[63.228209, "o", "class EWMMethods:\r\n"]
[63.252806, "o", "    params = (\r\n"]
[63.277403, "o", "        [\"DataFrame\", \"Series\"],\r\n"]
[63.302, "o", "        [\r\n"]
[63.326597, "o", "            ({\"halflife\": 10}, \"mean\"),\r\n"]
[63.351194, "o", "            ({\"halflife\": 10}, \"std\"),\r\n"]
[63.375791, "o", "            ({\"halflife\": 1000}, \"mean\"),\r\n"]
[63.400388, "o", "            ({\"halflife\": 1000}, \"std\"),\r\n"]
[63.424985, "o", "            (\r\n"]
[63.449582, "o", "                {\r\n"]
[63.474179, "o", "                    \"halflife\": \"1 Day\",\r\n"]
[63.498776, "o", "                    \"times\": pd.date_range(\"1900\", periods=10**5, freq=\"23s\"),\r\n"]
[63.523373, "o", "                },\r\n"]
[63.54797, "o", "                \"mean\",\r\n"]
[63.572567, "o", "            ),\r\n"]
[63.597164, "o", "        ],\r\n"]
[63.621761, "o", "        [\"int\", \"float\"],\r\n"]
[63.646358, "o", "    )\r\n"]
[63.670955, "o", "    param_names = [\"constructor\", \"kwargs_method\", \"dtype\"]\r\n"]
[63.695552, "o", "\r\n"]
[63.720149, "o", "    def setup(self, constructor, kwargs_method, dtype):\r\n"]
[63.744746, "o", "        N = 10**5\r\n"]
[63.769343, "o", "        kwargs, method = kwargs_method\r\n"]
[63.79394, "o", "        arr = (100 * np.random.random(N)).astype(dtype)\r\n"]
[63.818537, "o", "        self.method = method\r\n"]
[63.843134, "o", "        self.ewm = getattr(pd, constructor)(arr).ewm(**kwargs)\r\n"]
[63.867731, "o", "\r\n"]
[63.892328, "o", "    def time_ewm(self, constructor, kwargs_method, dtype):\r\n"]
[63.916925, "o", "        getattr(self.ewm, self.method)()\r\n"]
[63.941522, "o", "\r\n"]
[63.966119, "o", "\r\n"]
[63.990716, "o", "class VariableWindowMethods(Methods):\r\n"]
[64.015313, "o", "    params = (\r\n"]
[64.03991, "o", "        [\"DataFrame\", \"Series\"],\r\n"]
[64.064507, "o", "        [\"50s\", \"1h\", \"1d\"],\r\n"]
[64.089104, "o", "        [\"int\", \"float\"],\r\n"]
[64.113701, "o", "        [\"median\", \"mean\", \"max\", \"min\", \"std\", \"count\", \"skew\", \"kurt\", \"sum\", \"sem\"],\r\n"]
[64.138299, "o", "    )\r\n"]
[64.162896, "o", "    param_names = [\"constructor\", \"window\", \"dtype\", \"method\"]\r\n"]
[64.187493, "o", "\r\n"]
[64.21209, "o", "    def setup(self, constructor, window, dtype, method):\r\n"]
[64.236687, "o", "        N = 10**5\r\n"]
[64.261284, "o", "        arr = (100 * np.random.random(N)).astype(dtype)\r\n"]
[64.285881, "o", "        index = pd.date_range(\"2017-01-01\", periods=N, freq=\"5s\")\r\n"]
[64.310478, "o", "        self.window = getattr(pd, constructor)(arr, index=index).rolling(window)\r\n"]
[64.335075, "o", "\r\n"]
[64.359672, "o", "\r\n"]
[64.384269, "o", "class Pairwise:\r\n"]
[64.408866, "o", "    params = (\r\n"]
[64.433463, "o", "        [({\"window\": 10}, \"rolling\"), ({\"window\": 1000}, \"rolling\"), ({}, \"expanding\")],\r\n"]
[64.45806, "o", "        [\"corr\", \"cov\"],\r\n"]
[64.482657, "o", "        [True, False],\r\n"]
[64.507254, "o", "    )\r\n"]
[64.531851, "o", "    param_names = [\"window_kwargs\", \"method\", \"pairwise\"]\r\n"]
[64.556448, "o", "\r\n"]
[64.581045, "o", "    def setup(self, kwargs_window, method, pairwise):\r\n"]
[64.605642, "o", "        N = 10**4\r\n"]
[64.630239, "o", "        n_groups = 20\r\n"]
[64.654836, "o", "        kwargs, window = kwargs_window\r\n"]
[64.679433, "o", "        groups = [i for _ in range(N // n_groups) for i in range(n_groups)]\r\n"]
[64.70403, "o", "        arr = np.random.random(N)\r\n"]
[64.728627, "o", "        self.df = pd.DataFrame(arr)\r\n"]
[64.753224, "o", "        self.window = getattr(self.df, window)(**kwargs)\r\n"]
[64.777821, "o", "        self.window_group = getattr(\r\n"]
[64.802418, "o", "            pd.DataFrame({\"A\": groups, \"B\": arr}).groupby(\"A\"), window\r\n"]
[64.827015, "o", "        )(**kwargs)\r\n"]
[64.851612, "o", "\r\n"]
[64.876209, "o", "    def time_pairwise(self, kwargs_window, method, pairwise):\r\n"]
[64.900806, "o", "        getattr(self.window, method)(self.df, pairwise=pairwise)\r\n"]
[64.925403, "o", "\r\n"]
[65.0, "o", "(asv_3.8) root@cb2cc1765c92:/workspace/repo# "]
[65.002, "i", "asv run --config=asv_bench/asv.conf.json --python=same --bench=\"rolling.*Groupby.*\"\r"]
[65.004, "o", "asv run --config=asv_bench/asv.conf.json --python=same --bench=\"rolling.*Groupby.*\"\r\n"]
[67.478, "o", "\u001b[?2004l\r\n"]
[70.0, "o", "(asv_3.8) root@cb2cc1765c92:/workspace/repo# "]
[70.002, "i", "pwd\r"]
[70.004, "o", "pwd\r\n"]
[72.478, "o", "\u001b[?2004l\r\n"]
[75.0, "o", "(asv_3.8) root@cb2cc1765c92:/workspace/repo# "]
[75.002, "i", "ls -la asv_bench/asv.conf.json\r"]
[75.004, "o", "ls -la asv_bench/asv.conf.json\r\n"]
[77.478, "o", "\u001b[?2004l\r\n"]
[80.0, "o", "(asv_3.8) root@cb2cc1765c92:/workspace/repo# "]
[80.002, "i", "cd asv_bench\r"]
[80.004, "o", "cd asv_bench\r\n"]
[80.006, "o", "\u001b[?2004l\r\n"]
[85.0, "o", "(asv_3.8) root@cb2cc1765c92:/workspace/repo/asv_bench# "]
[85.002, "i", "ls -la\r"]
[85.004, "o", "ls -la\r\n"]
[85.83, "o", "\u001b[?2004l\r\n"]
[86.654, "o", "total 24\r\n"]
[87.478, "o", "drwxr-xr-x 1 root root 4096 Sep 12 21:44 \u001b[0m\u001b[01;34m.\u001b[0m\r\n"]
[88.302, "o", "drwxr-xr-x 1 root root 4096 Oct  1 18:15 \u001b[01;34m..\u001b[0m\r\n"]
[89.126, "o", "-rw-r--r-- 1 root root 5217 Sep 12 21:44 asv.conf.json\r\n"]
[90.0, "o", "(asv_3.8) root@cb2cc1765c92:/workspace/repo/asv_bench# "]
[90.002, "i", "rg -n \"Groupby\" benchmarks/rolling.py || true\r"]
[90.004, "o", "rg -n \"Groupby\" benchmarks/rolling.py || true\r\n"]
[92.478, "o", "\u001b[?2004l\r\n"]
[95.0, "o", "(asv_3.8) root@cb2cc1765c92:/workspace/repo/asv_bench# "]
[95.002, "i", "sed -n '1,240p' benchmarks/rolling.py\r"]
[95.004, "o", "sed -n '1,240p' benchmarks/rolling.py\r\n"]
[95.026515, "o", "\u001b[?2004l\r\n"]
[95.047029, "o", "import warnings\r\n"]
[95.067544, "o", "\r\n"]
[95.088058, "o", "import numpy as np\r\n"]
[95.108573, "o", "\r\n"]
[95.129087, "o", "import pandas as pd\r\n"]
[95.149602, "o", "\r\n"]
[95.170116, "o", "\r\n"]
[95.190631, "o", "class Methods:\r\n"]
[95.211145, "o", "    params = (\r\n"]
[95.23166, "o", "        [\"DataFrame\", \"Series\"],\r\n"]
[95.252174, "o", "        [(\"rolling\", {\"window\": 10}), (\"rolling\", {\"window\": 1000}), (\"expanding\", {})],\r\n"]
[95.272689, "o", "        [\"int\", \"float\"],\r\n"]
[95.293203, "o", "        [\"median\", \"mean\", \"max\", \"min\", \"std\", \"count\", \"skew\", \"kurt\", \"sum\", \"sem\"],\r\n"]
[95.313718, "o", "    )\r\n"]
[95.334232, "o", "    param_names = [\"constructor\", \"window_kwargs\", \"dtype\", \"method\"]\r\n"]
[95.354747, "o", "\r\n"]
[95.375261, "o", "    def setup(self, constructor, window_kwargs, dtype, method):\r\n"]
[95.395776, "o", "        N = 10**5\r\n"]
[95.41629, "o", "        window, kwargs = window_kwargs\r\n"]
[95.436805, "o", "        arr = (100 * np.random.random(N)).astype(dtype)\r\n"]
[95.45732, "o", "        obj = getattr(pd, constructor)(arr)\r\n"]
[95.477834, "o", "        self.window = getattr(obj, window)(**kwargs)\r\n"]
[95.498349, "o", "\r\n"]
[95.518863, "o", "    def time_method(self, constructor, window_kwargs, dtype, method):\r\n"]
[95.539378, "o", "        getattr(self.window, method)()\r\n"]
[95.559892, "o", "\r\n"]
[95.580407, "o", "    def peakmem_method(self, constructor, window_kwargs, dtype, method):\r\n"]
[95.600921, "o", "        getattr(self.window, method)()\r\n"]
[95.621436, "o", "\r\n"]
[95.64195, "o", "\r\n"]
[95.662465, "o", "class Apply:\r\n"]
[95.682979, "o", "    params = (\r\n"]
[95.703494, "o", "        [\"DataFrame\", \"Series\"],\r\n"]
[95.724008, "o", "        [3, 300],\r\n"]
[95.744523, "o", "        [\"int\", \"float\"],\r\n"]
[95.765037, "o", "        [sum, np.sum, lambda x: np.sum(x) + 5],\r\n"]
[95.785552, "o", "        [True, False],\r\n"]
[95.806066, "o", "    )\r\n"]
[95.826581, "o", "    param_names = [\"constructor\", \"window\", \"dtype\", \"function\", \"raw\"]\r\n"]
[95.847095, "o", "\r\n"]
[95.86761, "o", "    def setup(self, constructor, window, dtype, function, raw):\r\n"]
[95.888124, "o", "        N = 10**3\r\n"]
[95.908639, "o", "        arr = (100 * np.random.random(N)).astype(dtype)\r\n"]
[95.929154, "o", "        self.roll = getattr(pd, constructor)(arr).rolling(window)\r\n"]
[95.949668, "o", "\r\n"]
[95.970183, "o", "    def time_rolling(self, constructor, window, dtype, function, raw):\r\n"]
[95.990697, "o", "        self.roll.apply(function, raw=raw)\r\n"]
[96.011212, "o", "\r\n"]
[96.031726, "o", "\r\n"]
[96.052241, "o", "class NumbaEngineMethods:\r\n"]
[96.072755, "o", "    params = (\r\n"]
[96.09327, "o", "        [\"DataFrame\", \"Series\"],\r\n"]
[96.113784, "o", "        [\"int\", \"float\"],\r\n"]
[96.134299, "o", "        [(\"rolling\", {\"window\": 10}), (\"expanding\", {})],\r\n"]
[96.154813, "o", "        [\"sum\", \"max\", \"min\", \"median\", \"mean\", \"var\", \"std\"],\r\n"]
[96.175328, "o", "        [True, False],\r\n"]
[96.195842, "o", "        [None, 100],\r\n"]
[96.216357, "o", "    )\r\n"]
[96.236871, "o", "    param_names = [\r\n"]
[96.257386, "o", "        \"constructor\",\r\n"]
[96.2779, "o", "        \"dtype\",\r\n"]
[96.298415, "o", "        \"window_kwargs\",\r\n"]
[96.318929, "o", "        \"method\",\r\n"]
[96.339444, "o", "        \"parallel\",\r\n"]
[96.359959, "o", "        \"cols\",\r\n"]
[96.380473, "o", "    ]\r\n"]
[96.400988, "o", "\r\n"]
[96.421502, "o", "    def setup(self, constructor, dtype, window_kwargs, method, parallel, cols):\r\n"]
[96.442017, "o", "        N = 10**3\r\n"]
[96.462531, "o", "        window, kwargs = window_kwargs\r\n"]
[96.483046, "o", "        shape = (N, cols) if cols is not None and constructor != \"Series\" else N\r\n"]
[96.50356, "o", "        arr = (100 * np.random.random(shape)).astype(dtype)\r\n"]
[96.524075, "o", "        data = getattr(pd, constructor)(arr)\r\n"]
[96.544589, "o", "\r\n"]
[96.565104, "o", "        # Warm the cache\r\n"]
[96.585618, "o", "        with warnings.catch_warnings(record=True):\r\n"]
[96.606133, "o", "            # Catch parallel=True not being applicable e.g. 1D data\r\n"]
[96.626647, "o", "            self.window = getattr(data, window)(**kwargs)\r\n"]
[96.647162, "o", "            getattr(self.window, method)(\r\n"]
[96.667676, "o", "                engine=\"numba\", engine_kwargs={\"parallel\": parallel}\r\n"]
[96.688191, "o", "            )\r\n"]
[96.708705, "o", "\r\n"]
[96.72922, "o", "    def test_method(self, constructor, dtype, window_kwargs, method, parallel, cols):\r\n"]
[96.749734, "o", "        with warnings.catch_warnings(record=True):\r\n"]
[96.770249, "o", "            getattr(self.window, method)(\r\n"]
[96.790763, "o", "                engine=\"numba\", engine_kwargs={\"parallel\": parallel}\r\n"]
[96.811278, "o", "            )\r\n"]
[96.831793, "o", "\r\n"]
[96.852307, "o", "\r\n"]
[96.872822, "o", "class NumbaEngineApply:\r\n"]
[96.893336, "o", "    params = (\r\n"]
[96.913851, "o", "        [\"DataFrame\", \"Series\"],\r\n"]
[96.934365, "o", "        [\"int\", \"float\"],\r\n"]
[96.95488, "o", "        [(\"rolling\", {\"window\": 10}), (\"expanding\", {})],\r\n"]
[96.975394, "o", "        [np.sum, lambda x: np.sum(x) + 5],\r\n"]
[96.995909, "o", "        [True, False],\r\n"]
[97.016423, "o", "        [None, 100],\r\n"]
[97.036938, "o", "    )\r\n"]
[97.057452, "o", "    param_names = [\r\n"]
[97.077967, "o", "        \"constructor\",\r\n"]
[97.098481, "o", "        \"dtype\",\r\n"]
[97.118996, "o", "        \"window_kwargs\",\r\n"]
[97.13951, "o", "        \"function\",\r\n"]
[97.160025, "o", "        \"parallel\",\r\n"]
[97.180539, "o", "        \"cols\",\r\n"]
[97.201054, "o", "    ]\r\n"]
[97.221568, "o", "\r\n"]
[97.242083, "o", "    def setup(self, constructor, dtype, window_kwargs, function, parallel, cols):\r\n"]
[97.262598, "o", "        N = 10**3\r\n"]
[97.283112, "o", "        window, kwargs = window_kwargs\r\n"]
[97.303627, "o", "        shape = (N, cols) if cols is not None and constructor != \"Series\" else N\r\n"]
[97.324141, "o", "        arr = (100 * np.random.random(shape)).astype(dtype)\r\n"]
[97.344656, "o", "        data = getattr(pd, constructor)(arr)\r\n"]
[97.36517, "o", "\r\n"]
[97.385685, "o", "        # Warm the cache\r\n"]
[97.406199, "o", "        with warnings.catch_warnings(record=True):\r\n"]
[97.426714, "o", "            # Catch parallel=True not being applicable e.g. 1D data\r\n"]
[97.447228, "o", "            self.window = getattr(data, window)(**kwargs)\r\n"]
[97.467743, "o", "            self.window.apply(\r\n"]
[97.488257, "o", "                function, raw=True, engine=\"numba\", engine_kwargs={\"parallel\": parallel}\r\n"]
[97.508772, "o", "            )\r\n"]
[97.529286, "o", "\r\n"]
[97.549801, "o", "    def test_method(self, constructor, dtype, window_kwargs, function, parallel, cols):\r\n"]
[97.570315, "o", "        with warnings.catch_warnings(record=True):\r\n"]
[97.59083, "o", "            self.window.apply(\r\n"]
[97.611344, "o", "                function, raw=True, engine=\"numba\", engine_kwargs={\"parallel\": parallel}\r\n"]
[97.631859, "o", "            )\r\n"]
[97.652373, "o", "\r\n"]
[97.672888, "o", "\r\n"]
[97.693402, "o", "class EWMMethods:\r\n"]
[97.713917, "o", "    params = (\r\n"]
[97.734432, "o", "        [\"DataFrame\", \"Series\"],\r\n"]
[97.754946, "o", "        [\r\n"]
[97.775461, "o", "            ({\"halflife\": 10}, \"mean\"),\r\n"]
[97.795975, "o", "            ({\"halflife\": 10}, \"std\"),\r\n"]
[97.81649, "o", "            ({\"halflife\": 1000}, \"mean\"),\r\n"]
[97.837004, "o", "            ({\"halflife\": 1000}, \"std\"),\r\n"]
[97.857519, "o", "            (\r\n"]
[97.878033, "o", "                {\r\n"]
[97.898548, "o", "                    \"halflife\": \"1 Day\",\r\n"]
[97.919062, "o", "                    \"times\": pd.date_range(\"1900\", periods=10**5, freq=\"23s\"),\r\n"]
[97.939577, "o", "                },\r\n"]
[97.960091, "o", "                \"mean\",\r\n"]
[97.980606, "o", "            ),\r\n"]
[98.00112, "o", "        ],\r\n"]
[98.021635, "o", "        [\"int\", \"float\"],\r\n"]
[98.042149, "o", "    )\r\n"]
[98.062664, "o", "    param_names = [\"constructor\", \"kwargs_method\", \"dtype\"]\r\n"]
[98.083178, "o", "\r\n"]
[98.103693, "o", "    def setup(self, constructor, kwargs_method, dtype):\r\n"]
[98.124207, "o", "        N = 10**5\r\n"]
[98.144722, "o", "        kwargs, method = kwargs_method\r\n"]
[98.165237, "o", "        arr = (100 * np.random.random(N)).astype(dtype)\r\n"]
[98.185751, "o", "        self.method = method\r\n"]
[98.206266, "o", "        self.ewm = getattr(pd, constructor)(arr).ewm(**kwargs)\r\n"]
[98.22678, "o", "\r\n"]
[98.247295, "o", "    def time_ewm(self, constructor, kwargs_method, dtype):\r\n"]
[98.267809, "o", "        getattr(self.ewm, self.method)()\r\n"]
[98.288324, "o", "\r\n"]
[98.308838, "o", "\r\n"]
[98.329353, "o", "class VariableWindowMethods(Methods):\r\n"]
[98.349867, "o", "    params = (\r\n"]
[98.370382, "o", "        [\"DataFrame\", \"Series\"],\r\n"]
[98.390896, "o", "        [\"50s\", \"1h\", \"1d\"],\r\n"]
[98.411411, "o", "        [\"int\", \"float\"],\r\n"]
[98.431925, "o", "        [\"median\", \"mean\", \"max\", \"min\", \"std\", \"count\", \"skew\", \"kurt\", \"sum\", \"sem\"],\r\n"]
[98.45244, "o", "    )\r\n"]
[98.472954, "o", "    param_names = [\"constructor\", \"window\", \"dtype\", \"method\"]\r\n"]
[98.493469, "o", "\r\n"]
[98.513983, "o", "    def setup(self, constructor, window, dtype, method):\r\n"]
[98.534498, "o", "        N = 10**5\r\n"]
[98.555012, "o", "        arr = (100 * np.random.random(N)).astype(dtype)\r\n"]
[98.575527, "o", "        index = pd.date_range(\"2017-01-01\", periods=N, freq=\"5s\")\r\n"]
[98.596041, "o", "        self.window = getattr(pd, constructor)(arr, index=index).rolling(window)\r\n"]
[98.616556, "o", "\r\n"]
[98.637071, "o", "\r\n"]
[98.657585, "o", "class Pairwise:\r\n"]
[98.6781, "o", "    params = (\r\n"]
[98.698614, "o", "        [({\"window\": 10}, \"rolling\"), ({\"window\": 1000}, \"rolling\"), ({}, \"expanding\")],\r\n"]
[98.719129, "o", "        [\"corr\", \"cov\"],\r\n"]
[98.739643, "o", "        [True, False],\r\n"]
[98.760158, "o", "    )\r\n"]
[98.780672, "o", "    param_names = [\"window_kwargs\", \"method\", \"pairwise\"]\r\n"]
[98.801187, "o", "\r\n"]
[98.821701, "o", "    def setup(self, kwargs_window, method, pairwise):\r\n"]
[98.842216, "o", "        N = 10**4\r\n"]
[98.86273, "o", "        n_groups = 20\r\n"]
[98.883245, "o", "        kwargs, window = kwargs_window\r\n"]
[98.903759, "o", "        groups = [i for _ in range(N // n_groups) for i in range(n_groups)]\r\n"]
[98.924274, "o", "        arr = np.random.random(N)\r\n"]
[98.944788, "o", "        self.df = pd.DataFrame(arr)\r\n"]
[98.965303, "o", "        self.window = getattr(self.df, window)(**kwargs)\r\n"]
[98.985817, "o", "        self.window_group = getattr(\r\n"]
[99.006332, "o", "            pd.DataFrame({\"A\": groups, \"B\": arr}).groupby(\"A\"), window\r\n"]
[99.026846, "o", "        )(**kwargs)\r\n"]
[99.047361, "o", "\r\n"]
[99.067876, "o", "    def time_pairwise(self, kwargs_window, method, pairwise):\r\n"]
[99.08839, "o", "        getattr(self.window, method)(self.df, pairwise=pairwise)\r\n"]
[99.108905, "o", "\r\n"]
[99.129419, "o", "    def time_groupby(self, kwargs_window, method, pairwise):\r\n"]
[99.149934, "o", "        getattr(self.window_group, method)(self.df, pairwise=pairwise)\r\n"]
[99.170448, "o", "\r\n"]
[99.190963, "o", "\r\n"]
[99.211477, "o", "class Quantile:\r\n"]
[99.231992, "o", "    params = (\r\n"]
[99.252506, "o", "        [\"DataFrame\", \"Series\"],\r\n"]
[99.273021, "o", "        [10, 1000],\r\n"]
[99.293535, "o", "        [\"int\", \"float\"],\r\n"]
[99.31405, "o", "        [0, 0.5, 1],\r\n"]
[99.334564, "o", "        [\"linear\", \"nearest\", \"lower\", \"higher\", \"midpoint\"],\r\n"]
[99.355079, "o", "    )\r\n"]
[99.375593, "o", "    param_names = [\"constructor\", \"window\", \"dtype\", \"percentile\"]\r\n"]
[99.396108, "o", "\r\n"]
[99.416622, "o", "    def setup(self, constructor, window, dtype, percentile, interpolation):\r\n"]
[99.437137, "o", "        N = 10**5\r\n"]
[99.457651, "o", "        arr = np.random.random(N).astype(dtype)\r\n"]
[99.478166, "o", "        self.roll = getattr(pd, constructor)(arr).rolling(window)\r\n"]
[99.49868, "o", "\r\n"]
[99.519195, "o", "    def time_quantile(self, constructor, window, dtype, percentile, interpolation):\r\n"]
[99.53971, "o", "        self.roll.quantile(percentile, interpolation=interpolation)\r\n"]
[99.560224, "o", "\r\n"]
[99.580739, "o", "\r\n"]
[99.601253, "o", "class Rank:\r\n"]
[99.621768, "o", "    params = (\r\n"]
[99.642282, "o", "        [\"DataFrame\", \"Series\"],\r\n"]
[99.662797, "o", "        [10, 1000],\r\n"]
[99.683311, "o", "        [\"int\", \"float\"],\r\n"]
[99.703826, "o", "        [True, False],\r\n"]
[99.72434, "o", "        [True, False],\r\n"]
[99.744855, "o", "        [\"min\", \"max\", \"average\"],\r\n"]
[99.765369, "o", "    )\r\n"]
[99.785884, "o", "    param_names = [\r\n"]
[99.806398, "o", "        \"constructor\",\r\n"]
[99.826913, "o", "        \"window\",\r\n"]
[99.847427, "o", "        \"dtype\",\r\n"]
[99.867942, "o", "        \"percentile\",\r\n"]
[99.888456, "o", "        \"ascending\",\r\n"]
[99.908971, "o", "        \"method\",\r\n"]
[99.929485, "o", "    ]\r\n"]
[100.0, "o", "(asv_3.8) root@cb2cc1765c92:/workspace/repo/asv_bench# "]
[100.002, "i", "sed -n '240,520p' benchmarks/rolling.py\r"]
[100.004, "o", "sed -n '240,520p' benchmarks/rolling.py\r\n"]
[100.043455, "o", "\u001b[?2004l\r\n"]
[100.080909, "o", "\r\n"]
[100.118364, "o", "    def setup(self, constructor, window, dtype, percentile, ascending, method):\r\n"]
[100.155818, "o", "        N = 10**5\r\n"]
[100.193273, "o", "        arr = np.random.random(N).astype(dtype)\r\n"]
[100.230727, "o", "        self.roll = getattr(pd, constructor)(arr).rolling(window)\r\n"]
[100.268182, "o", "\r\n"]
[100.305636, "o", "    def time_rank(self, constructor, window, dtype, percentile, ascending, method):\r\n"]
[100.343091, "o", "        self.roll.rank(pct=percentile, ascending=ascending, method=method)\r\n"]
[100.380545, "o", "\r\n"]
[100.418, "o", "\r\n"]
[100.455455, "o", "class PeakMemFixedWindowMinMax:\r\n"]
[100.492909, "o", "    params = [\"min\", \"max\"]\r\n"]
[100.530364, "o", "\r\n"]
[100.567818, "o", "    def setup(self, operation):\r\n"]
[100.605273, "o", "        N = 10**6\r\n"]
[100.642727, "o", "        arr = np.random.random(N)\r\n"]
[100.680182, "o", "        self.roll = pd.Series(arr).rolling(2)\r\n"]
[100.717636, "o", "\r\n"]
[100.755091, "o", "    def peakmem_fixed(self, operation):\r\n"]
[100.792545, "o", "        for x in range(5):\r\n"]
[100.83, "o", "            getattr(self.roll, operation)()\r\n"]
[100.867455, "o", "\r\n"]
[100.904909, "o", "\r\n"]
[100.942364, "o", "class ForwardWindowMethods:\r\n"]
[100.979818, "o", "    params = (\r\n"]
[101.017273, "o", "        [\"DataFrame\", \"Series\"],\r\n"]
[101.054727, "o", "        [10, 1000],\r\n"]
[101.092182, "o", "        [\"int\", \"float\"],\r\n"]
[101.129636, "o", "        [\"median\", \"mean\", \"max\", \"min\", \"kurt\", \"sum\"],\r\n"]
[101.167091, "o", "    )\r\n"]
[101.204545, "o", "    param_names = [\"constructor\", \"window_size\", \"dtype\", \"method\"]\r\n"]
[101.242, "o", "\r\n"]
[101.279455, "o", "    def setup(self, constructor, window_size, dtype, method):\r\n"]
[101.316909, "o", "        N = 10**5\r\n"]
[101.354364, "o", "        arr = np.random.random(N).astype(dtype)\r\n"]
[101.391818, "o", "        indexer = pd.api.indexers.FixedForwardWindowIndexer(window_size=window_size)\r\n"]
[101.429273, "o", "        self.roll = getattr(pd, constructor)(arr).rolling(window=indexer)\r\n"]
[101.466727, "o", "\r\n"]
[101.504182, "o", "    def time_rolling(self, constructor, window_size, dtype, method):\r\n"]
[101.541636, "o", "        getattr(self.roll, method)()\r\n"]
[101.579091, "o", "\r\n"]
[101.616545, "o", "    def peakmem_rolling(self, constructor, window_size, dtype, method):\r\n"]
[101.654, "o", "        getattr(self.roll, method)()\r\n"]
[101.691455, "o", "\r\n"]
[101.728909, "o", "\r\n"]
[101.766364, "o", "class Groupby:\r\n"]
[101.803818, "o", "    params = (\r\n"]
[101.841273, "o", "        [\"sum\", \"median\", \"mean\", \"max\", \"min\", \"kurt\", \"sum\"],\r\n"]
[101.878727, "o", "        [\r\n"]
[101.916182, "o", "            (\"rolling\", {\"window\": 2}),\r\n"]
[101.953636, "o", "            (\"rolling\", {\"window\": \"30s\"}),\r\n"]
[101.991091, "o", "            (\"expanding\", {}),\r\n"]
[102.028545, "o", "        ],\r\n"]
[102.066, "o", "    )\r\n"]
[102.103455, "o", "\r\n"]
[102.140909, "o", "    def setup(self, method, window_kwargs):\r\n"]
[102.178364, "o", "        N = 1000\r\n"]
[102.215818, "o", "        window, kwargs = window_kwargs\r\n"]
[102.253273, "o", "        df = pd.DataFrame(\r\n"]
[102.290727, "o", "            {\r\n"]
[102.328182, "o", "                \"A\": [str(i) for i in range(N)] * 10,\r\n"]
[102.365636, "o", "                \"B\": list(range(N)) * 10,\r\n"]
[102.403091, "o", "            }\r\n"]
[102.440545, "o", "        )\r\n"]
[102.478, "o", "        if isinstance(kwargs.get(\"window\", None), str):\r\n"]
[102.515455, "o", "            df.index = pd.date_range(start=\"1900-01-01\", freq=\"1min\", periods=N * 10)\r\n"]
[102.552909, "o", "        self.groupby_window = getattr(df.groupby(\"A\"), window)(**kwargs)\r\n"]
[102.590364, "o", "\r\n"]
[102.627818, "o", "    def time_method(self, method, window_kwargs):\r\n"]
[102.665273, "o", "        getattr(self.groupby_window, method)()\r\n"]
[102.702727, "o", "\r\n"]
[102.740182, "o", "\r\n"]
[102.777636, "o", "class GroupbyLargeGroups:\r\n"]
[102.815091, "o", "    # https://github.com/pandas-dev/pandas/issues/38038\r\n"]
[102.852545, "o", "    # specific example where the rolling operation on a larger dataframe\r\n"]
[102.89, "o", "    # is relatively cheap (few but large groups), but creation of\r\n"]
[102.927455, "o", "    # MultiIndex of result can be expensive\r\n"]
[102.964909, "o", "\r\n"]
[103.002364, "o", "    def setup(self):\r\n"]
[103.039818, "o", "        N = 100000\r\n"]
[103.077273, "o", "        self.df = pd.DataFrame({\"A\": [1, 2] * (N // 2), \"B\": np.random.randn(N)})\r\n"]
[103.114727, "o", "\r\n"]
[103.152182, "o", "    def time_rolling_multiindex_creation(self):\r\n"]
[103.189636, "o", "        self.df.groupby(\"A\").rolling(3).mean()\r\n"]
[103.227091, "o", "\r\n"]
[103.264545, "o", "\r\n"]
[103.302, "o", "class GroupbyEWM:\r\n"]
[103.339455, "o", "    params = [\"var\", \"std\", \"cov\", \"corr\"]\r\n"]
[103.376909, "o", "    param_names = [\"method\"]\r\n"]
[103.414364, "o", "\r\n"]
[103.451818, "o", "    def setup(self, method):\r\n"]
[103.489273, "o", "        df = pd.DataFrame({\"A\": range(50), \"B\": range(50)})\r\n"]
[103.526727, "o", "        self.gb_ewm = df.groupby(\"A\").ewm(com=1.0)\r\n"]
[103.564182, "o", "\r\n"]
[103.601636, "o", "    def time_groupby_method(self, method):\r\n"]
[103.639091, "o", "        getattr(self.gb_ewm, method)()\r\n"]
[103.676545, "o", "\r\n"]
[103.714, "o", "\r\n"]
[103.751455, "o", "class GroupbyEWMEngine:\r\n"]
[103.788909, "o", "    params = [\"cython\", \"numba\"]\r\n"]
[103.826364, "o", "    param_names = [\"engine\"]\r\n"]
[103.863818, "o", "\r\n"]
[103.901273, "o", "    def setup(self, engine):\r\n"]
[103.938727, "o", "        df = pd.DataFrame({\"A\": range(50), \"B\": range(50)})\r\n"]
[103.976182, "o", "        self.gb_ewm = df.groupby(\"A\").ewm(com=1.0)\r\n"]
[104.013636, "o", "\r\n"]
[104.051091, "o", "    def time_groupby_mean(self, engine):\r\n"]
[104.088545, "o", "        self.gb_ewm.mean(engine=engine)\r\n"]
[104.126, "o", "\r\n"]
[104.163455, "o", "\r\n"]
[104.200909, "o", "def table_method_func(x):\r\n"]
[104.238364, "o", "    return np.sum(x, axis=0) + 1\r\n"]
[104.275818, "o", "\r\n"]
[104.313273, "o", "\r\n"]
[104.350727, "o", "class TableMethod:\r\n"]
[104.388182, "o", "    params = [\"single\", \"table\"]\r\n"]
[104.425636, "o", "    param_names = [\"method\"]\r\n"]
[104.463091, "o", "\r\n"]
[104.500545, "o", "    def setup(self, method):\r\n"]
[104.538, "o", "        self.df = pd.DataFrame(np.random.randn(10, 1000))\r\n"]
[104.575455, "o", "\r\n"]
[104.612909, "o", "    def time_apply(self, method):\r\n"]
[104.650364, "o", "        self.df.rolling(2, method=method).apply(\r\n"]
[104.687818, "o", "            table_method_func, raw=True, engine=\"numba\"\r\n"]
[104.725273, "o", "        )\r\n"]
[104.762727, "o", "\r\n"]
[104.800182, "o", "    def time_ewm_mean(self, method):\r\n"]
[104.837636, "o", "        self.df.ewm(1, method=method).mean(engine=\"numba\")\r\n"]
[104.875091, "o", "\r\n"]
[104.912545, "o", "\r\n"]
[105.0, "o", "(asv_3.8) root@cb2cc1765c92:/workspace/repo/asv_bench# "]
[105.002, "i", "sed -n '520,900p' benchmarks/rolling.py\r"]
[105.004, "o", "sed -n '520,900p' benchmarks/rolling.py\r\n"]
[105.006, "o", "\u001b[?2004l\r\n"]
[110.0, "o", "(asv_3.8) root@cb2cc1765c92:/workspace/repo/asv_bench# "]
[110.002, "i", "asv dev -b \".*Groupby.*\" -c asv.conf.json\r"]
[110.004, "o", "asv dev -b \".*Groupby.*\" -c asv.conf.json\r\n"]
[111.242, "o", "\u001b[?2004l\r\n"]
[112.478, "o", "usage: asv [-h] [--verbose] [--config CONFIG] [--version]\r\n"]
[113.714, "o", "           {help,quickstart,machine,setup,run,continuous,find,rm,publish,preview,profile,update,show,compare,check,gh-pages} ...\r\n"]
[115.0, "o", "(asv_3.8) root@cb2cc1765c92:/workspace/repo/asv_bench# "]
[115.002, "i", "asv run -c asv.conf.json --python=same --bench=\"rolling.Groupby.*\" --quick\r"]
[115.004, "o", "asv run -c asv.conf.json --python=same --bench=\"rolling.Groupby.*\" --quick\r\n"]
[116.242, "o", "\u001b[?2004l\r\n"]
[117.478, "o", "usage: asv [-h] [--verbose] [--config CONFIG] [--version]\r\n"]
[118.714, "o", "           {help,quickstart,machine,setup,run,continuous,find,rm,publish,preview,profile,update,show,compare,check,gh-pages} ...\r\n"]
[120.0, "o", "(asv_3.8) root@cb2cc1765c92:/workspace/repo/asv_bench# "]
[120.002, "i", "asv profile --python=same -c asv.conf.json rolling.GroupbyLargeGroups.time_rolling_multiindex_creation\r"]
[120.004, "o", "asv profile --python=same -c asv.conf.json rolling.GroupbyLargeGroups.time_rolling_multiindex_creation\r\n"]
[121.242, "o", "\u001b[?2004l\r\n"]
[122.478, "o", "usage: asv [-h] [--verbose] [--config CONFIG] [--version]\r\n"]
[123.714, "o", "           {help,quickstart,machine,setup,run,continuous,find,rm,publish,preview,profile,update,show,compare,check,gh-pages} ...\r\n"]
[125.0, "o", "(asv_3.8) root@cb2cc1765c92:/workspace/repo/asv_bench# "]
[125.002, "i", "asv profile --python=same -c asv.conf.json rolling.Groupby.time_method\r"]
[125.004, "o", "asv profile --python=same -c asv.conf.json rolling.Groupby.time_method\r\n"]
[126.242, "o", "\u001b[?2004l\r\n"]
[127.478, "o", "usage: asv [-h] [--verbose] [--config CONFIG] [--version]\r\n"]
[128.714, "o", "           {help,quickstart,machine,setup,run,continuous,find,rm,publish,preview,profile,update,show,compare,check,gh-pages} ...\r\n"]
[130.0, "o", "(asv_3.8) root@cb2cc1765c92:/workspace/repo/asv_bench# "]
[130.002, "i", "sed -n '1,240p' ../pandas/core/window/rolling.py\r"]
[130.004, "o", "sed -n '1,240p' ../pandas/core/window/rolling.py\r\n"]
[130.026515, "o", "\u001b[?2004l\r\n"]
[130.047029, "o", "\"\"\"\r\n"]
[130.067544, "o", "Provide a generic structure to support window functions,\r\n"]
[130.088058, "o", "similar to how we have a Groupby object.\r\n"]
[130.108573, "o", "\"\"\"\r\n"]
[130.129087, "o", "from __future__ import annotations\r\n"]
[130.149602, "o", "\r\n"]
[130.170116, "o", "import copy\r\n"]
[130.190631, "o", "from datetime import timedelta\r\n"]
[130.211145, "o", "from functools import partial\r\n"]
[130.23166, "o", "import inspect\r\n"]
[130.252174, "o", "from textwrap import dedent\r\n"]
[130.272689, "o", "from typing import (\r\n"]
[130.293203, "o", "    TYPE_CHECKING,\r\n"]
[130.313718, "o", "    Any,\r\n"]
[130.334232, "o", "    Callable,\r\n"]
[130.354747, "o", "    Hashable,\r\n"]
[130.375261, "o", "    Iterator,\r\n"]
[130.395776, "o", "    Sized,\r\n"]
[130.41629, "o", "    cast,\r\n"]
[130.436805, "o", ")\r\n"]
[130.45732, "o", "\r\n"]
[130.477834, "o", "import numpy as np\r\n"]
[130.498349, "o", "\r\n"]
[130.518863, "o", "from pandas._libs.tslibs import (\r\n"]
[130.539378, "o", "    BaseOffset,\r\n"]
[130.559892, "o", "    to_offset,\r\n"]
[130.580407, "o", ")\r\n"]
[130.600921, "o", "import pandas._libs.window.aggregations as window_aggregations\r\n"]
[130.621436, "o", "from pandas._typing import (\r\n"]
[130.64195, "o", "    ArrayLike,\r\n"]
[130.662465, "o", "    Axis,\r\n"]
[130.682979, "o", "    NDFrameT,\r\n"]
[130.703494, "o", "    QuantileInterpolation,\r\n"]
[130.724008, "o", "    WindowingRankType,\r\n"]
[130.744523, "o", ")\r\n"]
[130.765037, "o", "from pandas.compat._optional import import_optional_dependency\r\n"]
[130.785552, "o", "from pandas.errors import DataError\r\n"]
[130.806066, "o", "from pandas.util._decorators import doc\r\n"]
[130.826581, "o", "\r\n"]
[130.847095, "o", "from pandas.core.dtypes.common import (\r\n"]
[130.86761, "o", "    ensure_float64,\r\n"]
[130.888124, "o", "    is_bool,\r\n"]
[130.908639, "o", "    is_integer,\r\n"]
[130.929154, "o", "    is_list_like,\r\n"]
[130.949668, "o", "    is_numeric_dtype,\r\n"]
[130.970183, "o", "    is_scalar,\r\n"]
[130.990697, "o", "    needs_i8_conversion,\r\n"]
[131.011212, "o", ")\r\n"]
[131.031726, "o", "from pandas.core.dtypes.generic import (\r\n"]
[131.052241, "o", "    ABCDataFrame,\r\n"]
[131.072755, "o", "    ABCSeries,\r\n"]
[131.09327, "o", ")\r\n"]
[131.113784, "o", "from pandas.core.dtypes.missing import notna\r\n"]
[131.134299, "o", "\r\n"]
[131.154813, "o", "from pandas.core._numba import executor\r\n"]
[131.175328, "o", "from pandas.core.algorithms import factorize\r\n"]
[131.195842, "o", "from pandas.core.apply import ResamplerWindowApply\r\n"]
[131.216357, "o", "from pandas.core.arrays import ExtensionArray\r\n"]
[131.236871, "o", "from pandas.core.base import SelectionMixin\r\n"]
[131.257386, "o", "import pandas.core.common as com\r\n"]
[131.2779, "o", "from pandas.core.indexers.objects import (\r\n"]
[131.298415, "o", "    BaseIndexer,\r\n"]
[131.318929, "o", "    FixedWindowIndexer,\r\n"]
[131.339444, "o", "    GroupbyIndexer,\r\n"]
[131.359959, "o", "    VariableWindowIndexer,\r\n"]
[131.380473, "o", ")\r\n"]
[131.400988, "o", "from pandas.core.indexes.api import (\r\n"]
[131.421502, "o", "    DatetimeIndex,\r\n"]
[131.442017, "o", "    Index,\r\n"]
[131.462531, "o", "    MultiIndex,\r\n"]
[131.483046, "o", "    PeriodIndex,\r\n"]
[131.50356, "o", "    TimedeltaIndex,\r\n"]
[131.524075, "o", ")\r\n"]
[131.544589, "o", "from pandas.core.reshape.concat import concat\r\n"]
[131.565104, "o", "from pandas.core.util.numba_ import (\r\n"]
[131.585618, "o", "    get_jit_arguments,\r\n"]
[131.606133, "o", "    maybe_use_numba,\r\n"]
[131.626647, "o", ")\r\n"]
[131.647162, "o", "from pandas.core.window.common import (\r\n"]
[131.667676, "o", "    flex_binary_moment,\r\n"]
[131.688191, "o", "    zsqrt,\r\n"]
[131.708705, "o", ")\r\n"]
[131.72922, "o", "from pandas.core.window.doc import (\r\n"]
[131.749734, "o", "    _shared_docs,\r\n"]
[131.770249, "o", "    create_section_header,\r\n"]
[131.790763, "o", "    kwargs_numeric_only,\r\n"]
[131.811278, "o", "    kwargs_scipy,\r\n"]
[131.831793, "o", "    numba_notes,\r\n"]
[131.852307, "o", "    template_header,\r\n"]
[131.872822, "o", "    template_returns,\r\n"]
[131.893336, "o", "    template_see_also,\r\n"]
[131.913851, "o", "    window_agg_numba_parameters,\r\n"]
[131.934365, "o", "    window_apply_parameters,\r\n"]
[131.95488, "o", ")\r\n"]
[131.975394, "o", "from pandas.core.window.numba_ import (\r\n"]
[131.995909, "o", "    generate_manual_numpy_nan_agg_with_axis,\r\n"]
[132.016423, "o", "    generate_numba_apply_func,\r\n"]
[132.036938, "o", "    generate_numba_table_func,\r\n"]
[132.057452, "o", ")\r\n"]
[132.077967, "o", "\r\n"]
[132.098481, "o", "if TYPE_CHECKING:\r\n"]
[132.118996, "o", "    from pandas import (\r\n"]
[132.13951, "o", "        DataFrame,\r\n"]
[132.160025, "o", "        Series,\r\n"]
[132.180539, "o", "    )\r\n"]
[132.201054, "o", "    from pandas.core.generic import NDFrame\r\n"]
[132.221568, "o", "    from pandas.core.groupby.ops import BaseGrouper\r\n"]
[132.242083, "o", "\r\n"]
[132.262598, "o", "\r\n"]
[132.283112, "o", "class BaseWindow(SelectionMixin):\r\n"]
[132.303627, "o", "    \"\"\"Provides utilities for performing windowing operations.\"\"\"\r\n"]
[132.324141, "o", "\r\n"]
[132.344656, "o", "    _attributes: list[str] = []\r\n"]
[132.36517, "o", "    exclusions: frozenset[Hashable] = frozenset()\r\n"]
[132.385685, "o", "    _on: Index\r\n"]
[132.406199, "o", "\r\n"]
[132.426714, "o", "    def __init__(\r\n"]
[132.447228, "o", "        self,\r\n"]
[132.467743, "o", "        obj: NDFrame,\r\n"]
[132.488257, "o", "        window=None,\r\n"]
[132.508772, "o", "        min_periods: int | None = None,\r\n"]
[132.529286, "o", "        center: bool | None = False,\r\n"]
[132.549801, "o", "        win_type: str | None = None,\r\n"]
[132.570315, "o", "        axis: Axis = 0,\r\n"]
[132.59083, "o", "        on: str | Index | None = None,\r\n"]
[132.611344, "o", "        closed: str | None = None,\r\n"]
[132.631859, "o", "        step: int | None = None,\r\n"]
[132.652373, "o", "        method: str = \"single\",\r\n"]
[132.672888, "o", "        *,\r\n"]
[132.693402, "o", "        selection=None,\r\n"]
[132.713917, "o", "    ) -> None:\r\n"]
[132.734432, "o", "        self.obj = obj\r\n"]
[132.754946, "o", "        self.on = on\r\n"]
[132.775461, "o", "        self.closed = closed\r\n"]
[132.795975, "o", "        self.step = step\r\n"]
[132.81649, "o", "        self.window = window\r\n"]
[132.837004, "o", "        self.min_periods = min_periods\r\n"]
[132.857519, "o", "        self.center = center\r\n"]
[132.878033, "o", "        self.win_type = win_type\r\n"]
[132.898548, "o", "        self.axis = obj._get_axis_number(axis) if axis is not None else None\r\n"]
[132.919062, "o", "        self.method = method\r\n"]
[132.939577, "o", "        self._win_freq_i8: int | None = None\r\n"]
[132.960091, "o", "        if self.on is None:\r\n"]
[132.980606, "o", "            if self.axis == 0:\r\n"]
[133.00112, "o", "                self._on = self.obj.index\r\n"]
[133.021635, "o", "            else:\r\n"]
[133.042149, "o", "                # i.e. self.axis == 1\r\n"]
[133.062664, "o", "                self._on = self.obj.columns\r\n"]
[133.083178, "o", "        elif isinstance(self.on, Index):\r\n"]
[133.103693, "o", "            self._on = self.on\r\n"]
[133.124207, "o", "        elif isinstance(self.obj, ABCDataFrame) and self.on in self.obj.columns:\r\n"]
[133.144722, "o", "            self._on = Index(self.obj[self.on])\r\n"]
[133.165237, "o", "        else:\r\n"]
[133.185751, "o", "            raise ValueError(\r\n"]
[133.206266, "o", "                f\"invalid on specified as {self.on}, \"\r\n"]
[133.22678, "o", "                \"must be a column (of DataFrame), an Index or None\"\r\n"]
[133.247295, "o", "            )\r\n"]
[133.267809, "o", "\r\n"]
[133.288324, "o", "        self._selection = selection\r\n"]
[133.308838, "o", "        self._validate()\r\n"]
[133.329353, "o", "\r\n"]
[133.349867, "o", "    def _validate(self) -> None:\r\n"]
[133.370382, "o", "        if self.center is not None and not is_bool(self.center):\r\n"]
[133.390896, "o", "            raise ValueError(\"center must be a boolean\")\r\n"]
[133.411411, "o", "        if self.min_periods is not None:\r\n"]
[133.431925, "o", "            if not is_integer(self.min_periods):\r\n"]
[133.45244, "o", "                raise ValueError(\"min_periods must be an integer\")\r\n"]
[133.472954, "o", "            if self.min_periods < 0:\r\n"]
[133.493469, "o", "                raise ValueError(\"min_periods must be >= 0\")\r\n"]
[133.513983, "o", "            if is_integer(self.window) and self.min_periods > self.window:\r\n"]
[133.534498, "o", "                raise ValueError(\r\n"]
[133.555012, "o", "                    f\"min_periods {self.min_periods} must be <= window {self.window}\"\r\n"]
[133.575527, "o", "                )\r\n"]
[133.596041, "o", "        if self.closed is not None and self.closed not in [\r\n"]
[133.616556, "o", "            \"right\",\r\n"]
[133.637071, "o", "            \"both\",\r\n"]
[133.657585, "o", "            \"left\",\r\n"]
[133.6781, "o", "            \"neither\",\r\n"]
[133.698614, "o", "        ]:\r\n"]
[133.719129, "o", "            raise ValueError(\"closed must be 'right', 'left', 'both' or 'neither'\")\r\n"]
[133.739643, "o", "        if not isinstance(self.obj, (ABCSeries, ABCDataFrame)):\r\n"]
[133.760158, "o", "            raise TypeError(f\"invalid type: {type(self)}\")\r\n"]
[133.780672, "o", "        if isinstance(self.window, BaseIndexer):\r\n"]
[133.801187, "o", "            # Validate that the passed BaseIndexer subclass has\r\n"]
[133.821701, "o", "            # a get_window_bounds with the correct signature.\r\n"]
[133.842216, "o", "            get_window_bounds_signature = inspect.signature(\r\n"]
[133.86273, "o", "                self.window.get_window_bounds\r\n"]
[133.883245, "o", "            ).parameters.keys()\r\n"]
[133.903759, "o", "            expected_signature = inspect.signature(\r\n"]
[133.924274, "o", "                BaseIndexer().get_window_bounds\r\n"]
[133.944788, "o", "            ).parameters.keys()\r\n"]
[133.965303, "o", "            if get_window_bounds_signature != expected_signature:\r\n"]
[133.985817, "o", "                raise ValueError(\r\n"]
[134.006332, "o", "                    f\"{type(self.window).__name__} does not implement \"\r\n"]
[134.026846, "o", "                    f\"the correct signature for get_window_bounds\"\r\n"]
[134.047361, "o", "                )\r\n"]
[134.067876, "o", "        if self.method not in [\"table\", \"single\"]:\r\n"]
[134.08839, "o", "            raise ValueError(\"method must be 'table' or 'single\")\r\n"]
[134.108905, "o", "        if self.step is not None:\r\n"]
[134.129419, "o", "            if not is_integer(self.step):\r\n"]
[134.149934, "o", "                raise ValueError(\"step must be an integer\")\r\n"]
[134.170448, "o", "            if self.step < 0:\r\n"]
[134.190963, "o", "                raise ValueError(\"step must be >= 0\")\r\n"]
[134.211477, "o", "\r\n"]
[134.231992, "o", "    def _check_window_bounds(\r\n"]
[134.252506, "o", "        self, start: np.ndarray, end: np.ndarray, num_vals: int\r\n"]
[134.273021, "o", "    ) -> None:\r\n"]
[134.293535, "o", "        if len(start) != len(end):\r\n"]
[134.31405, "o", "            raise ValueError(\r\n"]
[134.334564, "o", "                f\"start ({len(start)}) and end ({len(end)}) bounds must be the \"\r\n"]
[134.355079, "o", "                f\"same length\"\r\n"]
[134.375593, "o", "            )\r\n"]
[134.396108, "o", "        if len(start) != (num_vals + (self.step or 1) - 1) // (self.step or 1):\r\n"]
[134.416622, "o", "            raise ValueError(\r\n"]
[134.437137, "o", "                f\"start and end bounds ({len(start)}) must be the same length \"\r\n"]
[134.457651, "o", "                f\"as the object ({num_vals}) divided by the step ({self.step}) \"\r\n"]
[134.478166, "o", "                f\"if given and rounded up\"\r\n"]
[134.49868, "o", "            )\r\n"]
[134.519195, "o", "\r\n"]
[134.53971, "o", "    def _slice_axis_for_step(self, index: Index, result: Sized | None = None) -> Index:\r\n"]
[134.560224, "o", "        \"\"\"\r\n"]
[134.580739, "o", "        Slices the index for a given result and the preset step.\r\n"]
[134.601253, "o", "        \"\"\"\r\n"]
[134.621768, "o", "        return (\r\n"]
[134.642282, "o", "            index\r\n"]
[134.662797, "o", "            if result is None or len(result) == len(index)\r\n"]
[134.683311, "o", "            else index[:: self.step]\r\n"]
[134.703826, "o", "        )\r\n"]
[134.72434, "o", "\r\n"]
[134.744855, "o", "    def _validate_numeric_only(self, name: str, numeric_only: bool) -> None:\r\n"]
[134.765369, "o", "        \"\"\"\r\n"]
[134.785884, "o", "        Validate numeric_only argument, raising if invalid for the input.\r\n"]
[134.806398, "o", "\r\n"]
[134.826913, "o", "        Parameters\r\n"]
[134.847427, "o", "        ----------\r\n"]
[134.867942, "o", "        name : str\r\n"]
[134.888456, "o", "            Name of the operator (kernel).\r\n"]
[134.908971, "o", "        numeric_only : bool\r\n"]
[134.929485, "o", "            Value passed by user.\r\n"]
[135.0, "o", "(asv_3.8) root@cb2cc1765c92:/workspace/repo/asv_bench# "]
[135.002, "i", "sed -n '240,520p' ../pandas/core/window/rolling.py\r"]
[135.004, "o", "sed -n '240,520p' ../pandas/core/window/rolling.py\r\n"]
[135.023532, "o", "\u001b[?2004l\r\n"]
[135.041064, "o", "        \"\"\"\r\n"]
[135.058596, "o", "        if (\r\n"]
[135.076128, "o", "            self._selected_obj.ndim == 1\r\n"]
[135.09366, "o", "            and numeric_only\r\n"]
[135.111191, "o", "            and not is_numeric_dtype(self._selected_obj.dtype)\r\n"]
[135.128723, "o", "        ):\r\n"]
[135.146255, "o", "            raise NotImplementedError(\r\n"]
[135.163787, "o", "                f\"{type(self).__name__}.{name} does not implement numeric_only\"\r\n"]
[135.181319, "o", "            )\r\n"]
[135.198851, "o", "\r\n"]
[135.216383, "o", "    def _make_numeric_only(self, obj: NDFrameT) -> NDFrameT:\r\n"]
[135.233915, "o", "        \"\"\"Subset DataFrame to numeric columns.\r\n"]
[135.251447, "o", "\r\n"]
[135.268979, "o", "        Parameters\r\n"]
[135.286511, "o", "        ----------\r\n"]
[135.304043, "o", "        obj : DataFrame\r\n"]
[135.321574, "o", "\r\n"]
[135.339106, "o", "        Returns\r\n"]
[135.356638, "o", "        -------\r\n"]
[135.37417, "o", "        obj subset to numeric-only columns.\r\n"]
[135.391702, "o", "        \"\"\"\r\n"]
[135.409234, "o", "        result = obj.select_dtypes(include=[\"number\"], exclude=[\"timedelta\"])\r\n"]
[135.426766, "o", "        return result\r\n"]
[135.444298, "o", "\r\n"]
[135.46183, "o", "    def _create_data(self, obj: NDFrameT, numeric_only: bool = False) -> NDFrameT:\r\n"]
[135.479362, "o", "        \"\"\"\r\n"]
[135.496894, "o", "        Split data into blocks & return conformed data.\r\n"]
[135.514426, "o", "        \"\"\"\r\n"]
[135.531957, "o", "        # filter out the on from the object\r\n"]
[135.549489, "o", "        if self.on is not None and not isinstance(self.on, Index) and obj.ndim == 2:\r\n"]
[135.567021, "o", "            obj = obj.reindex(columns=obj.columns.difference([self.on]), copy=False)\r\n"]
[135.584553, "o", "        if obj.ndim > 1 and (numeric_only or self.axis == 1):\r\n"]
[135.602085, "o", "            # GH: 20649 in case of mixed dtype and axis=1 we have to convert everything\r\n"]
[135.619617, "o", "            # to float to calculate the complete row at once. We exclude all non-numeric\r\n"]
[135.637149, "o", "            # dtypes.\r\n"]
[135.654681, "o", "            obj = self._make_numeric_only(obj)\r\n"]
[135.672213, "o", "        if self.axis == 1:\r\n"]
[135.689745, "o", "            obj = obj.astype(\"float64\", copy=False)\r\n"]
[135.707277, "o", "            obj._mgr = obj._mgr.consolidate()\r\n"]
[135.724809, "o", "        return obj\r\n"]
[135.74234, "o", "\r\n"]
[135.759872, "o", "    def _gotitem(self, key, ndim, subset=None):\r\n"]
[135.777404, "o", "        \"\"\"\r\n"]
[135.794936, "o", "        Sub-classes to define. Return a sliced object.\r\n"]
[135.812468, "o", "\r\n"]
[135.83, "o", "        Parameters\r\n"]
[135.847532, "o", "        ----------\r\n"]
[135.865064, "o", "        key : str / list of selections\r\n"]
[135.882596, "o", "        ndim : {1, 2}\r\n"]
[135.900128, "o", "            requested ndim of result\r\n"]
[135.91766, "o", "        subset : object, default None\r\n"]
[135.935191, "o", "            subset to act on\r\n"]
[135.952723, "o", "        \"\"\"\r\n"]
[135.970255, "o", "        # create a new object to prevent aliasing\r\n"]
[135.987787, "o", "        if subset is None:\r\n"]
[136.005319, "o", "            subset = self.obj\r\n"]
[136.022851, "o", "\r\n"]
[136.040383, "o", "        # we need to make a shallow copy of ourselves\r\n"]
[136.057915, "o", "        # with the same groupby\r\n"]
[136.075447, "o", "        kwargs = {attr: getattr(self, attr) for attr in self._attributes}\r\n"]
[136.092979, "o", "\r\n"]
[136.110511, "o", "        selection = None\r\n"]
[136.128043, "o", "        if subset.ndim == 2 and (\r\n"]
[136.145574, "o", "            (is_scalar(key) and key in subset) or is_list_like(key)\r\n"]
[136.163106, "o", "        ):\r\n"]
[136.180638, "o", "            selection = key\r\n"]
[136.19817, "o", "        elif subset.ndim == 1 and is_scalar(key) and key == subset.name:\r\n"]
[136.215702, "o", "            selection = key\r\n"]
[136.233234, "o", "\r\n"]
[136.250766, "o", "        new_win = type(self)(subset, selection=selection, **kwargs)\r\n"]
[136.268298, "o", "        return new_win\r\n"]
[136.28583, "o", "\r\n"]
[136.303362, "o", "    def __getattr__(self, attr: str):\r\n"]
[136.320894, "o", "        if attr in self._internal_names_set:\r\n"]
[136.338426, "o", "            return object.__getattribute__(self, attr)\r\n"]
[136.355957, "o", "        if attr in self.obj:\r\n"]
[136.373489, "o", "            return self[attr]\r\n"]
[136.391021, "o", "\r\n"]
[136.408553, "o", "        raise AttributeError(\r\n"]
[136.426085, "o", "            f\"'{type(self).__name__}' object has no attribute '{attr}'\"\r\n"]
[136.443617, "o", "        )\r\n"]
[136.461149, "o", "\r\n"]
[136.478681, "o", "    def _dir_additions(self):\r\n"]
[136.496213, "o", "        return self.obj._dir_additions()\r\n"]
[136.513745, "o", "\r\n"]
[136.531277, "o", "    def __repr__(self) -> str:\r\n"]
[136.548809, "o", "        \"\"\"\r\n"]
[136.56634, "o", "        Provide a nice str repr of our rolling object.\r\n"]
[136.583872, "o", "        \"\"\"\r\n"]
[136.601404, "o", "        attrs_list = (\r\n"]
[136.618936, "o", "            f\"{attr_name}={getattr(self, attr_name)}\"\r\n"]
[136.636468, "o", "            for attr_name in self._attributes\r\n"]
[136.654, "o", "            if getattr(self, attr_name, None) is not None and attr_name[0] != \"_\"\r\n"]
[136.671532, "o", "        )\r\n"]
[136.689064, "o", "        attrs = \",\".join(attrs_list)\r\n"]
[136.706596, "o", "        return f\"{type(self).__name__} [{attrs}]\"\r\n"]
[136.724128, "o", "\r\n"]
[136.74166, "o", "    def __iter__(self) -> Iterator:\r\n"]
[136.759191, "o", "        obj = self._selected_obj.set_axis(self._on)\r\n"]
[136.776723, "o", "        obj = self._create_data(obj)\r\n"]
[136.794255, "o", "        indexer = self._get_window_indexer()\r\n"]
[136.811787, "o", "\r\n"]
[136.829319, "o", "        start, end = indexer.get_window_bounds(\r\n"]
[136.846851, "o", "            num_values=len(obj),\r\n"]
[136.864383, "o", "            min_periods=self.min_periods,\r\n"]
[136.881915, "o", "            center=self.center,\r\n"]
[136.899447, "o", "            closed=self.closed,\r\n"]
[136.916979, "o", "            step=self.step,\r\n"]
[136.934511, "o", "        )\r\n"]
[136.952043, "o", "        self._check_window_bounds(start, end, len(obj))\r\n"]
[136.969574, "o", "\r\n"]
[136.987106, "o", "        for s, e in zip(start, end):\r\n"]
[137.004638, "o", "            result = obj.iloc[slice(s, e)]\r\n"]
[137.02217, "o", "            yield result\r\n"]
[137.039702, "o", "\r\n"]
[137.057234, "o", "    def _prep_values(self, values: ArrayLike) -> np.ndarray:\r\n"]
[137.074766, "o", "        \"\"\"Convert input to numpy arrays for Cython routines\"\"\"\r\n"]
[137.092298, "o", "        if needs_i8_conversion(values.dtype):\r\n"]
[137.10983, "o", "            raise NotImplementedError(\r\n"]
[137.127362, "o", "                f\"ops for {type(self).__name__} for this \"\r\n"]
[137.144894, "o", "                f\"dtype {values.dtype} are not implemented\"\r\n"]
[137.162426, "o", "            )\r\n"]
[137.179957, "o", "        # GH #12373 : rolling functions error on float32 data\r\n"]
[137.197489, "o", "        # make sure the data is coerced to float64\r\n"]
[137.215021, "o", "        try:\r\n"]
[137.232553, "o", "            if isinstance(values, ExtensionArray):\r\n"]
[137.250085, "o", "                values = values.to_numpy(np.float64, na_value=np.nan)\r\n"]
[137.267617, "o", "            else:\r\n"]
[137.285149, "o", "                values = ensure_float64(values)\r\n"]
[137.302681, "o", "        except (ValueError, TypeError) as err:\r\n"]
[137.320213, "o", "            raise TypeError(f\"cannot handle this type -> {values.dtype}\") from err\r\n"]
[137.337745, "o", "\r\n"]
[137.355277, "o", "        # Convert inf to nan for C funcs\r\n"]
[137.372809, "o", "        inf = np.isinf(values)\r\n"]
[137.39034, "o", "        if inf.any():\r\n"]
[137.407872, "o", "            values = np.where(inf, np.nan, values)\r\n"]
[137.425404, "o", "\r\n"]
[137.442936, "o", "        return values\r\n"]
[137.460468, "o", "\r\n"]
[137.478, "o", "    def _insert_on_column(self, result: DataFrame, obj: DataFrame) -> None:\r\n"]
[137.495532, "o", "        # if we have an 'on' column we want to put it back into\r\n"]
[137.513064, "o", "        # the results in the same location\r\n"]
[137.530596, "o", "        from pandas import Series\r\n"]
[137.548128, "o", "\r\n"]
[137.56566, "o", "        if self.on is not None and not self._on.equals(obj.index):\r\n"]
[137.583191, "o", "            name = self._on.name\r\n"]
[137.600723, "o", "            extra_col = Series(self._on, index=self.obj.index, name=name)\r\n"]
[137.618255, "o", "            if name in result.columns:\r\n"]
[137.635787, "o", "                # TODO: sure we want to overwrite results?\r\n"]
[137.653319, "o", "                result[name] = extra_col\r\n"]
[137.670851, "o", "            elif name in result.index.names:\r\n"]
[137.688383, "o", "                pass\r\n"]
[137.705915, "o", "            elif name in self._selected_obj.columns:\r\n"]
[137.723447, "o", "                # insert in the same location as we had in _selected_obj\r\n"]
[137.740979, "o", "                old_cols = self._selected_obj.columns\r\n"]
[137.758511, "o", "                new_cols = result.columns\r\n"]
[137.776043, "o", "                old_loc = old_cols.get_loc(name)\r\n"]
[137.793574, "o", "                overlap = new_cols.intersection(old_cols[:old_loc])\r\n"]
[137.811106, "o", "                new_loc = len(overlap)\r\n"]
[137.828638, "o", "                result.insert(new_loc, name, extra_col)\r\n"]
[137.84617, "o", "            else:\r\n"]
[137.863702, "o", "                # insert at the end\r\n"]
[137.881234, "o", "                result[name] = extra_col\r\n"]
[137.898766, "o", "\r\n"]
[137.916298, "o", "    @property\r\n"]
[137.93383, "o", "    def _index_array(self):\r\n"]
[137.951362, "o", "        # TODO: why do we get here with e.g. MultiIndex?\r\n"]
[137.968894, "o", "        if needs_i8_conversion(self._on.dtype):\r\n"]
[137.986426, "o", "            idx = cast(\"PeriodIndex | DatetimeIndex | TimedeltaIndex\", self._on)\r\n"]
[138.003957, "o", "            return idx.asi8\r\n"]
[138.021489, "o", "        return None\r\n"]
[138.039021, "o", "\r\n"]
[138.056553, "o", "    def _resolve_output(self, out: DataFrame, obj: DataFrame) -> DataFrame:\r\n"]
[138.074085, "o", "        \"\"\"Validate and finalize result.\"\"\"\r\n"]
[138.091617, "o", "        if out.shape[1] == 0 and obj.shape[1] > 0:\r\n"]
[138.109149, "o", "            raise DataError(\"No numeric types to aggregate\")\r\n"]
[138.126681, "o", "        if out.shape[1] == 0:\r\n"]
[138.144213, "o", "            return obj.astype(\"float64\")\r\n"]
[138.161745, "o", "\r\n"]
[138.179277, "o", "        self._insert_on_column(out, obj)\r\n"]
[138.196809, "o", "        return out\r\n"]
[138.21434, "o", "\r\n"]
[138.231872, "o", "    def _get_window_indexer(self) -> BaseIndexer:\r\n"]
[138.249404, "o", "        \"\"\"\r\n"]
[138.266936, "o", "        Return an indexer class that will compute the window start and end bounds\r\n"]
[138.284468, "o", "        \"\"\"\r\n"]
[138.302, "o", "        if isinstance(self.window, BaseIndexer):\r\n"]
[138.319532, "o", "            return self.window\r\n"]
[138.337064, "o", "        if self._win_freq_i8 is not None:\r\n"]
[138.354596, "o", "            return VariableWindowIndexer(\r\n"]
[138.372128, "o", "                index_array=self._index_array,\r\n"]
[138.38966, "o", "                window_size=self._win_freq_i8,\r\n"]
[138.407191, "o", "                center=self.center,\r\n"]
[138.424723, "o", "            )\r\n"]
[138.442255, "o", "        return FixedWindowIndexer(window_size=self.window)\r\n"]
[138.459787, "o", "\r\n"]
[138.477319, "o", "    def _apply_series(\r\n"]
[138.494851, "o", "        self, homogeneous_func: Callable[..., ArrayLike], name: str | None = None\r\n"]
[138.512383, "o", "    ) -> Series:\r\n"]
[138.529915, "o", "        \"\"\"\r\n"]
[138.547447, "o", "        Series version of _apply_blockwise\r\n"]
[138.564979, "o", "        \"\"\"\r\n"]
[138.582511, "o", "        obj = self._create_data(self._selected_obj)\r\n"]
[138.600043, "o", "\r\n"]
[138.617574, "o", "        if name == \"count\":\r\n"]
[138.635106, "o", "            # GH 12541: Special case for count where we support date-like types\r\n"]
[138.652638, "o", "            obj = notna(obj).astype(int)\r\n"]
[138.67017, "o", "        try:\r\n"]
[138.687702, "o", "            values = self._prep_values(obj._values)\r\n"]
[138.705234, "o", "        except (TypeError, NotImplementedError) as err:\r\n"]
[138.722766, "o", "            raise DataError(\"No numeric types to aggregate\") from err\r\n"]
[138.740298, "o", "\r\n"]
[138.75783, "o", "        result = homogeneous_func(values)\r\n"]
[138.775362, "o", "        index = self._slice_axis_for_step(obj.index, result)\r\n"]
[138.792894, "o", "        return obj._constructor(result, index=index, name=obj.name)\r\n"]
[138.810426, "o", "\r\n"]
[138.827957, "o", "    def _apply_blockwise(\r\n"]
[138.845489, "o", "        self,\r\n"]
[138.863021, "o", "        homogeneous_func: Callable[..., ArrayLike],\r\n"]
[138.880553, "o", "        name: str,\r\n"]
[138.898085, "o", "        numeric_only: bool = False,\r\n"]
[138.915617, "o", "    ) -> DataFrame | Series:\r\n"]
[138.933149, "o", "        \"\"\"\r\n"]
[138.950681, "o", "        Apply the given function to the DataFrame broken down into homogeneous\r\n"]
[138.968213, "o", "        sub-frames.\r\n"]
[138.985745, "o", "        \"\"\"\r\n"]
[139.003277, "o", "        self._validate_numeric_only(name, numeric_only)\r\n"]
[139.020809, "o", "        if self._selected_obj.ndim == 1:\r\n"]
[139.03834, "o", "            return self._apply_series(homogeneous_func, name)\r\n"]
[139.055872, "o", "\r\n"]
[139.073404, "o", "        obj = self._create_data(self._selected_obj, numeric_only)\r\n"]
[139.090936, "o", "        if name == \"count\":\r\n"]
[139.108468, "o", "            # GH 12541: Special case for count where we support date-like types\r\n"]
[139.126, "o", "            obj = notna(obj).astype(int)\r\n"]
[139.143532, "o", "            obj._mgr = obj._mgr.consolidate()\r\n"]
[139.161064, "o", "\r\n"]
[139.178596, "o", "        if self.axis == 1:\r\n"]
[139.196128, "o", "            obj = obj.T\r\n"]
[139.21366, "o", "\r\n"]
[139.231191, "o", "        taker = []\r\n"]
[139.248723, "o", "        res_values = []\r\n"]
[139.266255, "o", "        for i, arr in enumerate(obj._iter_column_arrays()):\r\n"]
[139.283787, "o", "            # GH#42736 operate column-wise instead of block-wise\r\n"]
[139.301319, "o", "            # As of 2.0, hfunc will raise for nuisance columns\r\n"]
[139.318851, "o", "            try:\r\n"]
[139.336383, "o", "                arr = self._prep_values(arr)\r\n"]
[139.353915, "o", "            except (TypeError, NotImplementedError) as err:\r\n"]
[139.371447, "o", "                raise DataError(\r\n"]
[139.388979, "o", "                    f\"Cannot aggregate non-numeric type: {arr.dtype}\"\r\n"]
[139.406511, "o", "                ) from err\r\n"]
[139.424043, "o", "            res = homogeneous_func(arr)\r\n"]
[139.441574, "o", "            res_values.append(res)\r\n"]
[139.459106, "o", "            taker.append(i)\r\n"]
[139.476638, "o", "\r\n"]
[139.49417, "o", "        index = self._slice_axis_for_step(\r\n"]
[139.511702, "o", "            obj.index, res_values[0] if len(res_values) > 0 else None\r\n"]
[139.529234, "o", "        )\r\n"]
[139.546766, "o", "        df = type(obj)._from_arrays(\r\n"]
[139.564298, "o", "            res_values,\r\n"]
[139.58183, "o", "            index=index,\r\n"]
[139.599362, "o", "            columns=obj.columns.take(taker),\r\n"]
[139.616894, "o", "            verify_integrity=False,\r\n"]
[139.634426, "o", "        )\r\n"]
[139.651957, "o", "\r\n"]
[139.669489, "o", "        if self.axis == 1:\r\n"]
[139.687021, "o", "            df = df.T\r\n"]
[139.704553, "o", "\r\n"]
[139.722085, "o", "        return self._resolve_output(df, obj)\r\n"]
[139.739617, "o", "\r\n"]
[139.757149, "o", "    def _apply_tablewise(\r\n"]
[139.774681, "o", "        self,\r\n"]
[139.792213, "o", "        homogeneous_func: Callable[..., ArrayLike],\r\n"]
[139.809745, "o", "        name: str | None = None,\r\n"]
[139.827277, "o", "        numeric_only: bool = False,\r\n"]
[139.844809, "o", "    ) -> DataFrame | Series:\r\n"]
[139.86234, "o", "        \"\"\"\r\n"]
[139.879872, "o", "        Apply the given function to the DataFrame across the entire object\r\n"]
[139.897404, "o", "        \"\"\"\r\n"]
[139.914936, "o", "        if self._selected_obj.ndim == 1:\r\n"]
[139.932468, "o", "            raise ValueError(\"method='table' not applicable for Series objects.\")\r\n"]
[140.0, "o", "(asv_3.8) root@cb2cc1765c92:/workspace/repo/asv_bench# "]
[140.002, "i", "sed -n '520,900p' ../pandas/core/window/rolling.py\r"]
[140.004, "o", "sed -n '520,900p' ../pandas/core/window/rolling.py\r\n"]
[140.018942, "o", "\u001b[?2004l\r\n"]
[140.031885, "o", "        obj = self._create_data(self._selected_obj, numeric_only)\r\n"]
[140.044827, "o", "        values = self._prep_values(obj.to_numpy())\r\n"]
[140.05777, "o", "        values = values.T if self.axis == 1 else values\r\n"]
[140.070712, "o", "        result = homogeneous_func(values)\r\n"]
[140.083654, "o", "        result = result.T if self.axis == 1 else result\r\n"]
[140.096597, "o", "        index = self._slice_axis_for_step(obj.index, result)\r\n"]
[140.109539, "o", "        columns = (\r\n"]
[140.122482, "o", "            obj.columns\r\n"]
[140.135424, "o", "            if result.shape[1] == len(obj.columns)\r\n"]
[140.148366, "o", "            else obj.columns[:: self.step]\r\n"]
[140.161309, "o", "        )\r\n"]
[140.174251, "o", "        out = obj._constructor(result, index=index, columns=columns)\r\n"]
[140.187194, "o", "\r\n"]
[140.200136, "o", "        return self._resolve_output(out, obj)\r\n"]
[140.213079, "o", "\r\n"]
[140.226021, "o", "    def _apply_pairwise(\r\n"]
[140.238963, "o", "        self,\r\n"]
[140.251906, "o", "        target: DataFrame | Series,\r\n"]
[140.264848, "o", "        other: DataFrame | Series | None,\r\n"]
[140.277791, "o", "        pairwise: bool | None,\r\n"]
[140.290733, "o", "        func: Callable[[DataFrame | Series, DataFrame | Series], DataFrame | Series],\r\n"]
[140.303675, "o", "        numeric_only: bool,\r\n"]
[140.316618, "o", "    ) -> DataFrame | Series:\r\n"]
[140.32956, "o", "        \"\"\"\r\n"]
[140.342503, "o", "        Apply the given pairwise function given 2 pandas objects (DataFrame/Series)\r\n"]
[140.355445, "o", "        \"\"\"\r\n"]
[140.368387, "o", "        target = self._create_data(target, numeric_only)\r\n"]
[140.38133, "o", "        if other is None:\r\n"]
[140.394272, "o", "            other = target\r\n"]
[140.407215, "o", "            # only default unset\r\n"]
[140.420157, "o", "            pairwise = True if pairwise is None else pairwise\r\n"]
[140.433099, "o", "        elif not isinstance(other, (ABCDataFrame, ABCSeries)):\r\n"]
[140.446042, "o", "            raise ValueError(\"other must be a DataFrame or Series\")\r\n"]
[140.458984, "o", "        elif other.ndim == 2 and numeric_only:\r\n"]
[140.471927, "o", "            other = self._make_numeric_only(other)\r\n"]
[140.484869, "o", "\r\n"]
[140.497812, "o", "        return flex_binary_moment(target, other, func, pairwise=bool(pairwise))\r\n"]
[140.510754, "o", "\r\n"]
[140.523696, "o", "    def _apply(\r\n"]
[140.536639, "o", "        self,\r\n"]
[140.549581, "o", "        func: Callable[..., Any],\r\n"]
[140.562524, "o", "        name: str,\r\n"]
[140.575466, "o", "        numeric_only: bool = False,\r\n"]
[140.588408, "o", "        numba_args: tuple[Any, ...] = (),\r\n"]
[140.601351, "o", "        **kwargs,\r\n"]
[140.614293, "o", "    ):\r\n"]
[140.627236, "o", "        \"\"\"\r\n"]
[140.640178, "o", "        Rolling statistical measure using supplied function.\r\n"]
[140.65312, "o", "\r\n"]
[140.666063, "o", "        Designed to be used with passed-in Cython array-based functions.\r\n"]
[140.679005, "o", "\r\n"]
[140.691948, "o", "        Parameters\r\n"]
[140.70489, "o", "        ----------\r\n"]
[140.717832, "o", "        func : callable function to apply\r\n"]
[140.730775, "o", "        name : str,\r\n"]
[140.743717, "o", "        numba_args : tuple\r\n"]
[140.75666, "o", "            args to be passed when func is a numba func\r\n"]
[140.769602, "o", "        **kwargs\r\n"]
[140.782545, "o", "            additional arguments for rolling function and window function\r\n"]
[140.795487, "o", "\r\n"]
[140.808429, "o", "        Returns\r\n"]
[140.821372, "o", "        -------\r\n"]
[140.834314, "o", "        y : type of input\r\n"]
[140.847257, "o", "        \"\"\"\r\n"]
[140.860199, "o", "        window_indexer = self._get_window_indexer()\r\n"]
[140.873141, "o", "        min_periods = (\r\n"]
[140.886084, "o", "            self.min_periods\r\n"]
[140.899026, "o", "            if self.min_periods is not None\r\n"]
[140.911969, "o", "            else window_indexer.window_size\r\n"]
[140.924911, "o", "        )\r\n"]
[140.937853, "o", "\r\n"]
[140.950796, "o", "        def homogeneous_func(values: np.ndarray):\r\n"]
[140.963738, "o", "            # calculation function\r\n"]
[140.976681, "o", "\r\n"]
[140.989623, "o", "            if values.size == 0:\r\n"]
[141.002565, "o", "                return values.copy()\r\n"]
[141.015508, "o", "\r\n"]
[141.02845, "o", "            def calc(x):\r\n"]
[141.041393, "o", "                start, end = window_indexer.get_window_bounds(\r\n"]
[141.054335, "o", "                    num_values=len(x),\r\n"]
[141.067277, "o", "                    min_periods=min_periods,\r\n"]
[141.08022, "o", "                    center=self.center,\r\n"]
[141.093162, "o", "                    closed=self.closed,\r\n"]
[141.106105, "o", "                    step=self.step,\r\n"]
[141.119047, "o", "                )\r\n"]
[141.13199, "o", "                self._check_window_bounds(start, end, len(x))\r\n"]
[141.144932, "o", "\r\n"]
[141.157874, "o", "                return func(x, start, end, min_periods, *numba_args)\r\n"]
[141.170817, "o", "\r\n"]
[141.183759, "o", "            with np.errstate(all=\"ignore\"):\r\n"]
[141.196702, "o", "                result = calc(values)\r\n"]
[141.209644, "o", "\r\n"]
[141.222586, "o", "            return result\r\n"]
[141.235529, "o", "\r\n"]
[141.248471, "o", "        if self.method == \"single\":\r\n"]
[141.261414, "o", "            return self._apply_blockwise(homogeneous_func, name, numeric_only)\r\n"]
[141.274356, "o", "        else:\r\n"]
[141.287298, "o", "            return self._apply_tablewise(homogeneous_func, name, numeric_only)\r\n"]
[141.300241, "o", "\r\n"]
[141.313183, "o", "    def _numba_apply(\r\n"]
[141.326126, "o", "        self,\r\n"]
[141.339068, "o", "        func: Callable[..., Any],\r\n"]
[141.35201, "o", "        engine_kwargs: dict[str, bool] | None = None,\r\n"]
[141.364953, "o", "        *func_args,\r\n"]
[141.377895, "o", "    ):\r\n"]
[141.390838, "o", "        window_indexer = self._get_window_indexer()\r\n"]
[141.40378, "o", "        min_periods = (\r\n"]
[141.416723, "o", "            self.min_periods\r\n"]
[141.429665, "o", "            if self.min_periods is not None\r\n"]
[141.442607, "o", "            else window_indexer.window_size\r\n"]
[141.45555, "o", "        )\r\n"]
[141.468492, "o", "        obj = self._create_data(self._selected_obj)\r\n"]
[141.481435, "o", "        if self.axis == 1:\r\n"]
[141.494377, "o", "            obj = obj.T\r\n"]
[141.507319, "o", "        values = self._prep_values(obj.to_numpy())\r\n"]
[141.520262, "o", "        if values.ndim == 1:\r\n"]
[141.533204, "o", "            values = values.reshape(-1, 1)\r\n"]
[141.546147, "o", "        start, end = window_indexer.get_window_bounds(\r\n"]
[141.559089, "o", "            num_values=len(values),\r\n"]
[141.572031, "o", "            min_periods=min_periods,\r\n"]
[141.584974, "o", "            center=self.center,\r\n"]
[141.597916, "o", "            closed=self.closed,\r\n"]
[141.610859, "o", "            step=self.step,\r\n"]
[141.623801, "o", "        )\r\n"]
[141.636743, "o", "        self._check_window_bounds(start, end, len(values))\r\n"]
[141.649686, "o", "        aggregator = executor.generate_shared_aggregator(\r\n"]
[141.662628, "o", "            func, **get_jit_arguments(engine_kwargs)\r\n"]
[141.675571, "o", "        )\r\n"]
[141.688513, "o", "        result = aggregator(values, start, end, min_periods, *func_args)\r\n"]
[141.701455, "o", "        result = result.T if self.axis == 1 else result\r\n"]
[141.714398, "o", "        index = self._slice_axis_for_step(obj.index, result)\r\n"]
[141.72734, "o", "        if obj.ndim == 1:\r\n"]
[141.740283, "o", "            result = result.squeeze()\r\n"]
[141.753225, "o", "            out = obj._constructor(result, index=index, name=obj.name)\r\n"]
[141.766168, "o", "            return out\r\n"]
[141.77911, "o", "        else:\r\n"]
[141.792052, "o", "            columns = self._slice_axis_for_step(obj.columns, result.T)\r\n"]
[141.804995, "o", "            out = obj._constructor(result, index=index, columns=columns)\r\n"]
[141.817937, "o", "            return self._resolve_output(out, obj)\r\n"]
[141.83088, "o", "\r\n"]
[141.843822, "o", "    def aggregate(self, func, *args, **kwargs):\r\n"]
[141.856764, "o", "        result = ResamplerWindowApply(self, func, args=args, kwargs=kwargs).agg()\r\n"]
[141.869707, "o", "        if result is None:\r\n"]
[141.882649, "o", "            return self.apply(func, raw=False, args=args, kwargs=kwargs)\r\n"]
[141.895592, "o", "        return result\r\n"]
[141.908534, "o", "\r\n"]
[141.921476, "o", "    agg = aggregate\r\n"]
[141.934419, "o", "\r\n"]
[141.947361, "o", "\r\n"]
[141.960304, "o", "class BaseWindowGroupby(BaseWindow):\r\n"]
[141.973246, "o", "    \"\"\"\r\n"]
[141.986188, "o", "    Provide the groupby windowing facilities.\r\n"]
[141.999131, "o", "    \"\"\"\r\n"]
[142.012073, "o", "\r\n"]
[142.025016, "o", "    _grouper: BaseGrouper\r\n"]
[142.037958, "o", "    _as_index: bool\r\n"]
[142.050901, "o", "    _attributes: list[str] = [\"_grouper\"]\r\n"]
[142.063843, "o", "\r\n"]
[142.076785, "o", "    def __init__(\r\n"]
[142.089728, "o", "        self,\r\n"]
[142.10267, "o", "        obj: DataFrame | Series,\r\n"]
[142.115613, "o", "        *args,\r\n"]
[142.128555, "o", "        _grouper: BaseGrouper,\r\n"]
[142.141497, "o", "        _as_index: bool = True,\r\n"]
[142.15444, "o", "        **kwargs,\r\n"]
[142.167382, "o", "    ) -> None:\r\n"]
[142.180325, "o", "        from pandas.core.groupby.ops import BaseGrouper\r\n"]
[142.193267, "o", "\r\n"]
[142.206209, "o", "        if not isinstance(_grouper, BaseGrouper):\r\n"]
[142.219152, "o", "            raise ValueError(\"Must pass a BaseGrouper object.\")\r\n"]
[142.232094, "o", "        self._grouper = _grouper\r\n"]
[142.245037, "o", "        self._as_index = _as_index\r\n"]
[142.257979, "o", "        # GH 32262: It's convention to keep the grouping column in\r\n"]
[142.270921, "o", "        # groupby.<agg_func>, but unexpected to users in\r\n"]
[142.283864, "o", "        # groupby.rolling.<agg_func>\r\n"]
[142.296806, "o", "        obj = obj.drop(columns=self._grouper.names, errors=\"ignore\")\r\n"]
[142.309749, "o", "        # GH 15354\r\n"]
[142.322691, "o", "        if kwargs.get(\"step\") is not None:\r\n"]
[142.335634, "o", "            raise NotImplementedError(\"step not implemented for groupby\")\r\n"]
[142.348576, "o", "        super().__init__(obj, *args, **kwargs)\r\n"]
[142.361518, "o", "\r\n"]
[142.374461, "o", "    def _apply(\r\n"]
[142.387403, "o", "        self,\r\n"]
[142.400346, "o", "        func: Callable[..., Any],\r\n"]
[142.413288, "o", "        name: str,\r\n"]
[142.42623, "o", "        numeric_only: bool = False,\r\n"]
[142.439173, "o", "        numba_args: tuple[Any, ...] = (),\r\n"]
[142.452115, "o", "        **kwargs,\r\n"]
[142.465058, "o", "    ) -> DataFrame | Series:\r\n"]
[142.478, "o", "        result = super()._apply(\r\n"]
[142.490942, "o", "            func,\r\n"]
[142.503885, "o", "            name,\r\n"]
[142.516827, "o", "            numeric_only,\r\n"]
[142.52977, "o", "            numba_args,\r\n"]
[142.542712, "o", "            **kwargs,\r\n"]
[142.555654, "o", "        )\r\n"]
[142.568597, "o", "        # Reconstruct the resulting MultiIndex\r\n"]
[142.581539, "o", "        # 1st set of levels = group by labels\r\n"]
[142.594482, "o", "        # 2nd set of levels = original DataFrame/Series index\r\n"]
[142.607424, "o", "        grouped_object_index = self.obj.index\r\n"]
[142.620366, "o", "        grouped_index_name = [*grouped_object_index.names]\r\n"]
[142.633309, "o", "        groupby_keys = copy.copy(self._grouper.names)\r\n"]
[142.646251, "o", "        result_index_names = groupby_keys + grouped_index_name\r\n"]
[142.659194, "o", "\r\n"]
[142.672136, "o", "        drop_columns = [\r\n"]
[142.685079, "o", "            key\r\n"]
[142.698021, "o", "            for key in self._grouper.names\r\n"]
[142.710963, "o", "            if key not in self.obj.index.names or key is None\r\n"]
[142.723906, "o", "        ]\r\n"]
[142.736848, "o", "\r\n"]
[142.749791, "o", "        if len(drop_columns) != len(groupby_keys):\r\n"]
[142.762733, "o", "            # Our result will have still kept the column in the result\r\n"]
[142.775675, "o", "            result = result.drop(columns=drop_columns, errors=\"ignore\")\r\n"]
[142.788618, "o", "\r\n"]
[142.80156, "o", "        codes = self._grouper.codes\r\n"]
[142.814503, "o", "        levels = copy.copy(self._grouper.levels)\r\n"]
[142.827445, "o", "\r\n"]
[142.840387, "o", "        group_indices = self._grouper.indices.values()\r\n"]
[142.85333, "o", "        if group_indices:\r\n"]
[142.866272, "o", "            indexer = np.concatenate(list(group_indices))\r\n"]
[142.879215, "o", "        else:\r\n"]
[142.892157, "o", "            indexer = np.array([], dtype=np.intp)\r\n"]
[142.905099, "o", "        codes = [c.take(indexer) for c in codes]\r\n"]
[142.918042, "o", "\r\n"]
[142.930984, "o", "        # if the index of the original dataframe needs to be preserved, append\r\n"]
[142.943927, "o", "        # this index (but reordered) to the codes/levels from the groupby\r\n"]
[142.956869, "o", "        if grouped_object_index is not None:\r\n"]
[142.969812, "o", "            idx = grouped_object_index.take(indexer)\r\n"]
[142.982754, "o", "            if not isinstance(idx, MultiIndex):\r\n"]
[142.995696, "o", "                idx = MultiIndex.from_arrays([idx])\r\n"]
[143.008639, "o", "            codes.extend(list(idx.codes))\r\n"]
[143.021581, "o", "            levels.extend(list(idx.levels))\r\n"]
[143.034524, "o", "\r\n"]
[143.047466, "o", "        result_index = MultiIndex(\r\n"]
[143.060408, "o", "            levels, codes, names=result_index_names, verify_integrity=False\r\n"]
[143.073351, "o", "        )\r\n"]
[143.086293, "o", "\r\n"]
[143.099236, "o", "        result.index = result_index\r\n"]
[143.112178, "o", "        if not self._as_index:\r\n"]
[143.12512, "o", "            result = result.reset_index(level=list(range(len(groupby_keys))))\r\n"]
[143.138063, "o", "        return result\r\n"]
[143.151005, "o", "\r\n"]
[143.163948, "o", "    def _apply_pairwise(\r\n"]
[143.17689, "o", "        self,\r\n"]
[143.189832, "o", "        target: DataFrame | Series,\r\n"]
[143.202775, "o", "        other: DataFrame | Series | None,\r\n"]
[143.215717, "o", "        pairwise: bool | None,\r\n"]
[143.22866, "o", "        func: Callable[[DataFrame | Series, DataFrame | Series], DataFrame | Series],\r\n"]
[143.241602, "o", "        numeric_only: bool,\r\n"]
[143.254545, "o", "    ) -> DataFrame | Series:\r\n"]
[143.267487, "o", "        \"\"\"\r\n"]
[143.280429, "o", "        Apply the given pairwise function given 2 pandas objects (DataFrame/Series)\r\n"]
[143.293372, "o", "        \"\"\"\r\n"]
[143.306314, "o", "        # Manually drop the grouping column first\r\n"]
[143.319257, "o", "        target = target.drop(columns=self._grouper.names, errors=\"ignore\")\r\n"]
[143.332199, "o", "        result = super()._apply_pairwise(target, other, pairwise, func, numeric_only)\r\n"]
[143.345141, "o", "        # 1) Determine the levels + codes of the groupby levels\r\n"]
[143.358084, "o", "        if other is not None and not all(\r\n"]
[143.371026, "o", "            len(group) == len(other) for group in self._grouper.indices.values()\r\n"]
[143.383969, "o", "        ):\r\n"]
[143.396911, "o", "            # GH 42915\r\n"]
[143.409853, "o", "            # len(other) != len(any group), so must reindex (expand) the result\r\n"]
[143.422796, "o", "            # from flex_binary_moment to a \"transform\"-like result\r\n"]
[143.435738, "o", "            # per groupby combination\r\n"]
[143.448681, "o", "            old_result_len = len(result)\r\n"]
[143.461623, "o", "            result = concat(\r\n"]
[143.474565, "o", "                [\r\n"]
[143.487508, "o", "                    result.take(gb_indices).reindex(result.index)\r\n"]
[143.50045, "o", "                    for gb_indices in self._grouper.indices.values()\r\n"]
[143.513393, "o", "                ]\r\n"]
[143.526335, "o", "            )\r\n"]
[143.539277, "o", "\r\n"]
[143.55222, "o", "            gb_pairs = (\r\n"]
[143.565162, "o", "                com.maybe_make_list(pair) for pair in self._grouper.indices.keys()\r\n"]
[143.578105, "o", "            )\r\n"]
[143.591047, "o", "            groupby_codes = []\r\n"]
[143.60399, "o", "            groupby_levels = []\r\n"]
[143.616932, "o", "            # e.g. [[1, 2], [4, 5]] as [[1, 4], [2, 5]]\r\n"]
[143.629874, "o", "            for gb_level_pair in map(list, zip(*gb_pairs)):\r\n"]
[143.642817, "o", "                labels = np.repeat(np.array(gb_level_pair), old_result_len)\r\n"]
[143.655759, "o", "                codes, levels = factorize(labels)\r\n"]
[143.668702, "o", "                groupby_codes.append(codes)\r\n"]
[143.681644, "o", "                groupby_levels.append(levels)\r\n"]
[143.694586, "o", "        else:\r\n"]
[143.707529, "o", "            # pairwise=True or len(other) == len(each group), so repeat\r\n"]
[143.720471, "o", "            # the groupby labels by the number of columns in the original object\r\n"]
[143.733414, "o", "            groupby_codes = self._grouper.codes\r\n"]
[143.746356, "o", "            # error: Incompatible types in assignment (expression has type\r\n"]
[143.759298, "o", "            # \"List[Index]\", variable has type \"List[Union[ndarray, Index]]\")\r\n"]
[143.772241, "o", "            groupby_levels = self._grouper.levels  # type: ignore[assignment]\r\n"]
[143.785183, "o", "\r\n"]
[143.798126, "o", "            group_indices = self._grouper.indices.values()\r\n"]
[143.811068, "o", "            if group_indices:\r\n"]
[143.82401, "o", "                indexer = np.concatenate(list(group_indices))\r\n"]
[143.836953, "o", "            else:\r\n"]
[143.849895, "o", "                indexer = np.array([], dtype=np.intp)\r\n"]
[143.862838, "o", "\r\n"]
[143.87578, "o", "            if target.ndim == 1:\r\n"]
[143.888723, "o", "                repeat_by = 1\r\n"]
[143.901665, "o", "            else:\r\n"]
[143.914607, "o", "                repeat_by = len(target.columns)\r\n"]
[143.92755, "o", "            groupby_codes = [\r\n"]
[143.940492, "o", "                np.repeat(c.take(indexer), repeat_by) for c in groupby_codes\r\n"]
[143.953435, "o", "            ]\r\n"]
[143.966377, "o", "        # 2) Determine the levels + codes of the result from super()._apply_pairwise\r\n"]
[143.979319, "o", "        if isinstance(result.index, MultiIndex):\r\n"]
[143.992262, "o", "            result_codes = list(result.index.codes)\r\n"]
[144.005204, "o", "            result_levels = list(result.index.levels)\r\n"]
[144.018147, "o", "            result_names = list(result.index.names)\r\n"]
[144.031089, "o", "        else:\r\n"]
[144.044031, "o", "            idx_codes, idx_levels = factorize(result.index)\r\n"]
[144.056974, "o", "            result_codes = [idx_codes]\r\n"]
[144.069916, "o", "            result_levels = [idx_levels]\r\n"]
[144.082859, "o", "            result_names = [result.index.name]\r\n"]
[144.095801, "o", "\r\n"]
[144.108743, "o", "        # 3) Create the resulting index by combining 1) + 2)\r\n"]
[144.121686, "o", "        result_codes = groupby_codes + result_codes\r\n"]
[144.134628, "o", "        result_levels = groupby_levels + result_levels\r\n"]
[144.147571, "o", "        result_names = self._grouper.names + result_names\r\n"]
[144.160513, "o", "\r\n"]
[144.173455, "o", "        result_index = MultiIndex(\r\n"]
[144.186398, "o", "            result_levels, result_codes, names=result_names, verify_integrity=False\r\n"]
[144.19934, "o", "        )\r\n"]
[144.212283, "o", "        result.index = result_index\r\n"]
[144.225225, "o", "        return result\r\n"]
[144.238168, "o", "\r\n"]
[144.25111, "o", "    def _create_data(self, obj: NDFrameT, numeric_only: bool = False) -> NDFrameT:\r\n"]
[144.264052, "o", "        \"\"\"\r\n"]
[144.276995, "o", "        Split data into blocks & return conformed data.\r\n"]
[144.289937, "o", "        \"\"\"\r\n"]
[144.30288, "o", "        # Ensure the object we're rolling over is monotonically sorted relative\r\n"]
[144.315822, "o", "        # to the groups\r\n"]
[144.328764, "o", "        # GH 36197\r\n"]
[144.341707, "o", "        if not obj.empty:\r\n"]
[144.354649, "o", "            groupby_order = np.concatenate(list(self._grouper.indices.values())).astype(\r\n"]
[144.367592, "o", "                np.int64\r\n"]
[144.380534, "o", "            )\r\n"]
[144.393476, "o", "            obj = obj.take(groupby_order)\r\n"]
[144.406419, "o", "        return super()._create_data(obj, numeric_only)\r\n"]
[144.419361, "o", "\r\n"]
[144.432304, "o", "    def _gotitem(self, key, ndim, subset=None):\r\n"]
[144.445246, "o", "        # we are setting the index on the actual object\r\n"]
[144.458188, "o", "        # here so our index is carried through to the selected obj\r\n"]
[144.471131, "o", "        # when we do the splitting for the groupby\r\n"]
[144.484073, "o", "        if self.on is not None:\r\n"]
[144.497016, "o", "            # GH 43355\r\n"]
[144.509958, "o", "            subset = self.obj.set_index(self._on)\r\n"]
[144.522901, "o", "        return super()._gotitem(key, ndim, subset=subset)\r\n"]
[144.535843, "o", "\r\n"]
[144.548785, "o", "\r\n"]
[144.561728, "o", "class Window(BaseWindow):\r\n"]
[144.57467, "o", "    \"\"\"\r\n"]
[144.587613, "o", "    Provide rolling window calculations.\r\n"]
[144.600555, "o", "\r\n"]
[144.613497, "o", "    Parameters\r\n"]
[144.62644, "o", "    ----------\r\n"]
[144.639382, "o", "    window : int, timedelta, str, offset, or BaseIndexer subclass\r\n"]
[144.652325, "o", "        Size of the moving window.\r\n"]
[144.665267, "o", "\r\n"]
[144.678209, "o", "        If an integer, the fixed number of observations used for\r\n"]
[144.691152, "o", "        each window.\r\n"]
[144.704094, "o", "\r\n"]
[144.717037, "o", "        If a timedelta, str, or offset, the time period of each window. Each\r\n"]
[144.729979, "o", "        window will be a variable sized based on the observations included in\r\n"]
[144.742921, "o", "        the time-period. This is only valid for datetimelike indexes.\r\n"]
[144.755864, "o", "        To learn more about the offsets & frequency strings, please see `this link\r\n"]
[144.768806, "o", "        <https://pandas.pydata.org/pandas-docs/stable/user_guide/timeseries.html#offset-aliases>`__.\r\n"]
[144.781749, "o", "\r\n"]
[144.794691, "o", "        If a BaseIndexer subclass, the window boundaries\r\n"]
[144.807634, "o", "        based on the defined ``get_window_bounds`` method. Additional rolling\r\n"]
[144.820576, "o", "        keyword arguments, namely ``min_periods``, ``center``, ``closed`` and\r\n"]
[144.833518, "o", "        ``step`` will be passed to ``get_window_bounds``.\r\n"]
[144.846461, "o", "\r\n"]
[144.859403, "o", "    min_periods : int, default None\r\n"]
[144.872346, "o", "        Minimum number of observations in window required to have a value;\r\n"]
[144.885288, "o", "        otherwise, result is ``np.nan``.\r\n"]
[144.89823, "o", "\r\n"]
[144.911173, "o", "        For a window that is specified by an offset, ``min_periods`` will default to 1.\r\n"]
[144.924115, "o", "\r\n"]
[144.937058, "o", "        For a window that is specified by an integer, ``min_periods`` will default\r\n"]
[145.0, "o", "(asv_3.8) root@cb2cc1765c92:/workspace/repo/asv_bench# "]
[145.002, "i", "asv run --config=asv.conf.json --python=same --bench=\"rolling.Groupby.*\"\r"]
[145.004, "o", "asv run --config=asv.conf.json --python=same --bench=\"rolling.Groupby.*\"\r\n"]
[145.132769, "o", "\u001b[?2004l\r\n"]
[145.259538, "o", "\u00b7 \u001b[0;32mDiscovering benchmarks\u001b[0m\r\n"]
[145.386308, "o", "\u00b7 \u001b[0;32mRunning 4 total benchmarks (1 commits * 1 environments * 4 benchmarks)\u001b[0m\r\n"]
[145.513077, "o", "[ 0.00%] \u00b7\u00b7 \u001b[0;34mBenchmarking existing-py_opt_conda_envs_asv_3.8_bin_python\u001b[0m\r\n"]
[145.639846, "o", "[12.50%] \u00b7\u00b7\u00b7 \u001b[0;39mRunning (rolling.Groupby.time_method--)\u001b[0m....\r\n"]
[145.766615, "o", "[62.50%] \u00b7\u00b7\u00b7 \u001b[0;39mrolling.Groupby.time_method\u001b[0m                                                                                                                     ok\r\n"]
[145.893385, "o", "[62.50%] \u00b7\u00b7\u00b7 \u001b[0;39m=========== ============================ ================================ ===================\u001b[0m\r\n"]
[146.020154, "o", "             --                                                param2                                     \r\n"]
[146.146923, "o", "             ----------- ---------------------------------------------------------------------------------\r\n"]
[146.273692, "o", "                param1    ('rolling', {'window': 2})   ('rolling', {'window': '30s'})   ('expanding', {}) \r\n"]
[146.400462, "o", "             =========== ============================ ================================ ===================\r\n"]
[146.527231, "o", "              'sum' (0)           40.3\u00b10.3ms                     16.3\u00b10.2ms                 14.9\u00b10.2ms    \r\n"]
[146.654, "o", "                median            41.2\u00b10.5ms                     19.6\u00b10.4ms                 16.9\u00b10.4ms    \r\n"]
[146.780769, "o", "                 mean             39.5\u00b10.8ms                     16.1\u00b10.2ms                 14.6\u00b10.1ms    \r\n"]
[146.907538, "o", "                 max              39.8\u00b10.5ms                     16.3\u00b10.4ms                 14.7\u00b10.2ms    \r\n"]
[147.034308, "o", "                 min              40.2\u00b10.3ms                     16.3\u00b10.2ms                 14.8\u00b10.1ms    \r\n"]
[147.161077, "o", "                 kurt             40.1\u00b10.4ms                     16.2\u00b10.3ms                 14.9\u00b10.1ms    \r\n"]
[147.287846, "o", "              'sum' (1)           40.1\u00b10.3ms                     16.3\u00b10.2ms                 14.9\u00b10.1ms    \r\n"]
[147.414615, "o", "             =========== ============================ ================================ ===================\r\n"]
[147.541385, "o", "\r\n"]
[147.668154, "o", "[75.00%] \u00b7\u00b7\u00b7 \u001b[0;39mrolling.GroupbyEWM.time_groupby_method\u001b[0m                                                                                                          ok\r\n"]
[147.794923, "o", "[75.00%] \u00b7\u00b7\u00b7 \u001b[0;39m======== =============\u001b[0m\r\n"]
[147.921692, "o", "              method               \r\n"]
[148.048462, "o", "             -------- -------------\r\n"]
[148.175231, "o", "               var       1.05\u00b10ms  \r\n"]
[148.302, "o", "               std     1.20\u00b10.01ms \r\n"]
[148.428769, "o", "               cov     3.67\u00b10.07ms \r\n"]
[148.555538, "o", "               corr    3.80\u00b10.02ms \r\n"]
[148.682308, "o", "             ======== =============\r\n"]
[148.809077, "o", "\r\n"]
[148.935846, "o", "[87.50%] \u00b7\u00b7\u00b7 \u001b[0;39mrolling.GroupbyEWMEngine.time_groupby_mean\u001b[0m                                                                                                      ok\r\n"]
[149.062615, "o", "[87.50%] \u00b7\u00b7\u00b7 \u001b[0;39m======== =============\u001b[0m\r\n"]
[149.189385, "o", "              engine               \r\n"]
[149.316154, "o", "             -------- -------------\r\n"]
[149.442923, "o", "              cython   1.06\u00b10.01ms \r\n"]
[149.569692, "o", "              numba    1.26\u00b10.05ms \r\n"]
[149.696462, "o", "             ======== =============\r\n"]
[149.823231, "o", "\r\n"]
[150.0, "o", "(asv_3.8) root@cb2cc1765c92:/workspace/repo/asv_bench# "]
[150.002, "i", "asv profile --python=same --config=asv.conf.json rolling.GroupbyLargeGroups.time_rolling_multiindex_creati\r"]
[150.004, "o", "asv profile --python=same --config=asv.conf.json rolling.GroupbyLargeGroups.time_rolling_multiindex_creati\r\n"]
[150.016564, "o", "ion\r\n"]
[150.027128, "o", "\u001b[?2004l\r\n"]
[150.037692, "o", "\u00b7 \u001b[0;32mDiscovering benchmarks\u001b[0m\r\n"]
[150.048256, "o", "\u00b7 \u001b[0;32mProfile data does not already exist. Running profiler now.\u001b[0m\r\n"]
[150.058821, "o", "\u00b7\u00b7 \u001b[0;34mBenchmarking existing-py_opt_conda_envs_asv_3.8_bin_python\u001b[0m\r\n"]
[150.069385, "o", "\u00b7\u00b7\u00b7 \u001b[0;39mRunning (rolling.GroupbyLargeGroups.time_rolling_multiindex_creation--)\u001b[0m.\r\n"]
[150.079949, "o", "\u00b7\u00b7\u00b7 \u001b[0;39mrolling.GroupbyLargeGroups.time_rolling_multiindex_creation\u001b[0m                                                                            18.3\u00b10.08ms\r\n"]
[150.090513, "o", "\r\n"]
[150.101077, "o", "Wed Oct  1 18:26:21 2025    /tmp/tmpy1_x7uby\r\n"]
[150.111641, "o", "\r\n"]
[150.122205, "o", "         2358 function calls (2304 primitive calls) in 0.019 seconds\r\n"]
[150.132769, "o", "\r\n"]
[150.143333, "o", "   Ordered by: cumulative time\r\n"]
[150.153897, "o", "\r\n"]
[150.164462, "o", "   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\r\n"]
[150.175026, "o", "        1    0.000    0.000    0.019    0.019 {built-in method builtins.exec}\r\n"]
[150.18559, "o", "        1    0.000    0.000    0.019    0.019 _base.py:689(method_caller)\r\n"]
[150.196154, "o", "        1    0.000    0.000    0.019    0.019 rolling.py:322(time_rolling_multiindex_creation)\r\n"]
[150.206718, "o", "        1    0.000    0.000    0.018    0.018 rolling.py:2070(mean)\r\n"]
[150.217282, "o", "        1    0.000    0.000    0.018    0.018 rolling.py:1489(mean)\r\n"]
[150.227846, "o", "        1    0.000    0.000    0.018    0.018 rolling.py:701(_apply)\r\n"]
[150.23841, "o", "        1    0.000    0.000    0.012    0.012 multi.py:445(from_arrays)\r\n"]
[150.248974, "o", "        1    0.000    0.000    0.012    0.012 categorical.py:2586(factorize_from_iterables)\r\n"]
[150.259538, "o", "        2    0.000    0.000    0.012    0.006 categorical.py:2607(<genexpr>)\r\n"]
[150.270103, "o", "        1    0.000    0.000    0.012    0.012 categorical.py:2545(factorize_from_iterable)\r\n"]
[150.280667, "o", "        1    0.000    0.000    0.012    0.012 categorical.py:359(__init__)\r\n"]
[150.291231, "o", "      3/2    0.000    0.000    0.012    0.006 algorithms.py:610(factorize)\r\n"]
[150.301795, "o", "        1    0.000    0.000    0.011    0.011 base.py:1143(factorize)\r\n"]
[150.312359, "o", "        2    0.000    0.000    0.010    0.005 algorithms.py:1702(safe_sort)\r\n"]
[150.322923, "o", "        4    0.010    0.002    0.010    0.002 {method 'argsort' of 'numpy.ndarray' objects}\r\n"]
[150.333487, "o", "        1    0.000    0.000    0.005    0.005 rolling.py:558(_apply)\r\n"]
[150.344051, "o", "        1    0.000    0.000    0.003    0.003 rolling.py:456(_apply_blockwise)\r\n"]
[150.354615, "o", "        1    0.000    0.000    0.002    0.002 rolling.py:591(homogeneous_func)\r\n"]
[150.365179, "o", "        1    0.000    0.000    0.002    0.002 rolling.py:597(calc)\r\n"]
[150.375744, "o", "        2    0.000    0.000    0.002    0.001 algorithms.py:548(factorize_array)\r\n"]
[150.386308, "o", "        2    0.002    0.001    0.002    0.001 {method 'factorize' of 'pandas._libs.hashtable.Int64HashTable' objects}\r\n"]
[150.396872, "o", "        1    0.000    0.000    0.002    0.002 rolling.py:2695(_get_window_indexer)\r\n"]
[150.407436, "o", "        1    0.000    0.000    0.002    0.002 ops.py:784(indices)\r\n"]
[150.418, "o", "        1    0.001    0.001    0.001    0.001 {pandas._libs.window.aggregations.roll_mean}\r\n"]
[150.428564, "o", "        1    0.000    0.000    0.001    0.001 objects.py:324(get_window_bounds)\r\n"]
[150.439128, "o", "        1    0.000    0.000    0.001    0.001 sorting.py:599(get_indexer_dict)\r\n"]
[150.449692, "o", "        1    0.000    0.000    0.001    0.001 groupby.py:2649(rolling)\r\n"]
[150.460256, "o", "        1    0.000    0.000    0.001    0.001 rolling.py:678(__init__)\r\n"]
[150.470821, "o", "        1    0.000    0.000    0.001    0.001 frame.py:5087(drop)\r\n"]
[150.481385, "o", "        1    0.000    0.000    0.001    0.001 generic.py:4505(drop)\r\n"]
[150.491949, "o", "       12    0.001    0.000    0.001    0.000 {method 'take' of 'numpy.ndarray' objects}\r\n"]
[150.502513, "o", "        1    0.000    0.000    0.001    0.001 generic.py:4544(_drop_axis)\r\n"]
[150.513077, "o", "        4    0.000    0.000    0.001    0.000 dtypes.py:186(__init__)\r\n"]
[150.523641, "o", "        4    0.000    0.000    0.001    0.000 dtypes.py:339(_finalize)\r\n"]
[150.534205, "o", "        2    0.000    0.000    0.001    0.000 dtypes.py:511(validate_categories)\r\n"]
[150.544769, "o", "        1    0.000    0.000    0.001    0.001 ops.py:910(result_index)\r\n"]
[150.555333, "o", "        2    0.001    0.000    0.001    0.000 base.py:2168(is_unique)\r\n"]
[150.565897, "o", "        1    0.000    0.000    0.001    0.001 rolling.py:846(_create_data)\r\n"]
[150.576462, "o", "        1    0.000    0.000    0.001    0.001 grouper.py:688(result_index)\r\n"]
[150.587026, "o", "        1    0.000    0.000    0.001    0.001 grouper.py:700(group_index)\r\n"]
[150.59759, "o", "        6    0.000    0.000    0.001    0.000 take.py:58(take_nd)\r\n"]
[150.608154, "o", "        6    0.000    0.000    0.001    0.000 take.py:120(_take_nd_ndarray)\r\n"]
[150.618718, "o", "        1    0.000    0.000    0.001    0.001 grouper.py:722(_codes_and_uniques)\r\n"]
[150.629282, "o", "        1    0.000    0.000    0.001    0.001 generic.py:3819(take)\r\n"]
[150.639846, "o", "        2    0.000    0.000    0.001    0.000 managers.py:641(reindex_indexer)\r\n"]
[150.65041, "o", "    27/15    0.000    0.000    0.001    0.000 {built-in method numpy.core._multiarray_umath.implement_array_function}\r\n"]
[150.660974, "o", "        1    0.000    0.000    0.001    0.001 generic.py:3898(_take)\r\n"]
[150.671538, "o", "        1    0.000    0.000    0.001    0.001 managers.py:886(take)\r\n"]
[150.682103, "o", "        2    0.000    0.000    0.001    0.000 blocks.py:858(take_nd)\r\n"]
[150.692667, "o", "        2    0.000    0.000    0.000    0.000 objects.py:76(get_window_bounds)\r\n"]
[150.703231, "o", "        1    0.000    0.000    0.000    0.000 sorting.py:632(get_group_index_sorter)\r\n"]
[150.713795, "o", "        1    0.000    0.000    0.000    0.000 {pandas._libs.algos.groupsort_indexer}\r\n"]
[150.724359, "o", "        2    0.000    0.000    0.000    0.000 base.py:3676(get_indexer)\r\n"]
[150.734923, "o", "        1    0.000    0.000    0.000    0.000 base.py:6610(drop)\r\n"]
[150.745487, "o", "        1    0.000    0.000    0.000    0.000 managers.py:705(<listcomp>)\r\n"]
[150.756051, "o", "        3    0.000    0.000    0.000    0.000 base.py:1033(take)\r\n"]
[150.766615, "o", "        4    0.000    0.000    0.000    0.000 <__array_function__ internals>:177(clip)\r\n"]
[150.777179, "o", "        4    0.000    0.000    0.000    0.000 fromnumeric.py:2111(clip)\r\n"]
[150.787744, "o", "        4    0.000    0.000    0.000    0.000 fromnumeric.py:51(_wrapfunc)\r\n"]
[150.798308, "o", "        1    0.000    0.000    0.000    0.000 managers.py:726(_slice_take_blocks_ax0)\r\n"]
[150.808872, "o", "        4    0.000    0.000    0.000    0.000 {method 'clip' of 'numpy.ndarray' objects}\r\n"]
[150.819436, "o", "        4    0.000    0.000    0.000    0.000 _methods.py:127(_clip)\r\n"]
[150.83, "o", "        1    0.000    0.000    0.000    0.000 {pandas._libs.algos.take_2d_axis0_float64_float64}\r\n"]
[150.840564, "o", "        1    0.000    0.000    0.000    0.000 frame.py:8104(groupby)\r\n"]
[150.851128, "o", "        6    0.000    0.000    0.000    0.000 <__array_function__ internals>:177(concatenate)\r\n"]
[150.861692, "o", "        1    0.000    0.000    0.000    0.000 base.py:5777(get_indexer_for)\r\n"]
[150.872256, "o", "        1    0.000    0.000    0.000    0.000 groupby.py:896(__init__)\r\n"]
[150.882821, "o", "        1    0.000    0.000    0.000    0.000 grouper.py:790(get_grouper)\r\n"]
[150.893385, "o", "        3    0.000    0.000    0.000    0.000 algorithms.py:1396(take)\r\n"]
[150.903949, "o", "        4    0.000    0.000    0.000    0.000 _methods.py:108(_clip_dep_invoke_with_casting)\r\n"]
[150.914513, "o", "  392/382    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}\r\n"]
[150.925077, "o", "        4    0.000    0.000    0.000    0.000 {pandas._libs.algos.take_1d_int64_int64}\r\n"]
[150.935641, "o", "        3    0.000    0.000    0.000    0.000 base.py:449(__new__)\r\n"]
[150.946205, "o", "        1    0.000    0.000    0.000    0.000 {pandas._libs.algos.take_2d_axis1_float64_float64}\r\n"]
[150.956769, "o", "        1    0.000    0.000    0.000    0.000 frame.py:2459(_from_arrays)\r\n"]
[150.967333, "o", "        2    0.000    0.000    0.000    0.000 multi.py:313(__new__)\r\n"]
[150.977897, "o", "        5    0.000    0.000    0.000    0.000 {built-in method numpy.arange}\r\n"]
[150.988462, "o", "        1    0.000    0.000    0.000    0.000 sorting.py:109(get_group_index)\r\n"]
[150.999026, "o", "        1    0.000    0.000    0.000    0.000 {pandas._libs.lib.indices_fast}\r\n"]
[151.00959, "o", "        1    0.000    0.000    0.000    0.000 rolling.py:742(<listcomp>)\r\n"]
[151.020154, "o", "        1    0.000    0.000    0.000    0.000 construction.py:96(arrays_to_mgr)\r\n"]
[151.030718, "o", "        1    0.000    0.000    0.000    0.000 frame.py:3689(__getitem__)\r\n"]
[151.041282, "o", "        4    0.000    0.000    0.000    0.000 cast.py:971(coerce_indexer_dtype)\r\n"]
[151.051846, "o", "        9    0.000    0.000    0.000    0.000 base.py:7014(ensure_index)\r\n"]
[151.06241, "o", "        1    0.000    0.000    0.000    0.000 sorting.py:622(<listcomp>)\r\n"]
[151.072974, "o", "        1    0.000    0.000    0.000    0.000 utils.py:241(maybe_convert_indices)\r\n"]
[151.083538, "o", "       12    0.000    0.000    0.000    0.000 {method 'astype' of 'numpy.ndarray' objects}\r\n"]
[151.094103, "o", "        2    0.000    0.000    0.000    0.000 base.py:6305(_maybe_cast_listlike_indexer)\r\n"]
[151.104667, "o", "        2    0.000    0.000    0.000    0.000 base.py:6029(_should_compare)\r\n"]
[151.115231, "o", "        1    0.000    0.000    0.000    0.000 frame.py:4220(_get_item_cache)\r\n"]
[151.125795, "o", "      117    0.000    0.000    0.000    0.000 generic.py:42(_instancecheck)\r\n"]
[151.136359, "o", "        2    0.000    0.000    0.000    0.000 algorithms.py:265(_get_hashtable_algo)\r\n"]
[151.146923, "o", "        1    0.000    0.000    0.000    0.000 managers.py:2069(create_block_manager_from_column_arrays)\r\n"]
[151.157487, "o", "        9    0.000    0.000    0.000    0.000 {method 'reduce' of 'numpy.ufunc' objects}\r\n"]
[151.168051, "o", "        3    0.000    0.000    0.000    0.000 construction.py:500(sanitize_array)\r\n"]
[151.178615, "o", "        1    0.000    0.000    0.000    0.000 managers.py:2141(_form_blocks)\r\n"]
[151.189179, "o", "        1    0.000    0.000    0.000    0.000 frame.py:3615(_ixs)\r\n"]
[151.199744, "o", "        2    0.000    0.000    0.000    0.000 <__array_function__ internals>:177(append)\r\n"]
[151.210308, "o", "        2    0.000    0.000    0.000    0.000 multi.py:982(_set_codes)\r\n"]
[151.220872, "o", "        2    0.000    0.000    0.000    0.000 function_base.py:5444(append)\r\n"]
[151.231436, "o", "        5    0.000    0.000    0.000    0.000 {method 'any' of 'numpy.ndarray' objects}\r\n"]
[151.242, "o", "        6    0.000    0.000    0.000    0.000 common.py:1241(is_bool_dtype)\r\n"]
[151.252564, "o", "        5    0.000    0.000    0.000    0.000 multi.py:998(<genexpr>)\r\n"]
[151.263128, "o", "       17    0.000    0.000    0.000    0.000 base.py:286(is_dtype)\r\n"]
[151.273692, "o", "        5    0.000    0.000    0.000    0.000 _methods.py:55(_any)\r\n"]
[151.284256, "o", "        3    0.000    0.000    0.000    0.000 multi.py:3871(_coerce_indexer_frozen)\r\n"]
[151.294821, "o", "       13    0.000    0.000    0.000    0.000 common.py:458(is_categorical_dtype)\r\n"]
[151.305385, "o", "   130/99    0.000    0.000    0.000    0.000 {built-in method builtins.len}\r\n"]
[151.315949, "o", "        2    0.000    0.000    0.000    0.000 base.py:3809(_check_indexing_method)\r\n"]
[151.326513, "o", "        1    0.000    0.000    0.000    0.000 {pandas._libs.algos.ensure_int8}\r\n"]
[151.337077, "o", "      117    0.000    0.000    0.000    0.000 generic.py:37(_check)\r\n"]
[151.347641, "o", "        1    0.000    0.000    0.000    0.000 rolling.py:355(_prep_values)\r\n"]
[151.358205, "o", "        8    0.000    0.000    0.000    0.000 _methods.py:93(_clip_dep_is_scalar_nan)\r\n"]
[151.368769, "o", "        2    0.000    0.000    0.000    0.000 base.py:791(_engine)\r\n"]
[151.379333, "o", "       27    0.000    0.000    0.000    0.000 base.py:4892(_values)\r\n"]
[151.389897, "o", "        2    0.000    0.000    0.000    0.000 algorithms.py:113(_ensure_data)\r\n"]
[151.400462, "o", "        2    0.000    0.000    0.000    0.000 common.py:229(asarray_tuplesafe)\r\n"]
[151.411026, "o", "        1    0.000    0.000    0.000    0.000 generic.py:1916(__contains__)\r\n"]
[151.42159, "o", "        2    0.000    0.000    0.000    0.000 base.py:5052(__contains__)\r\n"]
[151.432154, "o", "        1    0.000    0.000    0.000    0.000 range.py:201(_data)\r\n"]
[151.442718, "o", "        1    0.000    0.000    0.000    0.000 managers.py:2199(_stack_arrays)\r\n"]
[151.453282, "o", "        3    0.000    0.000    0.000    0.000 base.py:2599(inferred_type)\r\n"]
[151.463846, "o", "        2    0.000    0.000    0.000    0.000 base.py:3764(_get_indexer)\r\n"]
[151.47441, "o", "        5    0.000    0.000    0.000    0.000 {pandas._libs.lib.infer_dtype}\r\n"]
[151.484974, "o", "        2    0.000    0.000    0.000    0.000 algorithms.py:283(_check_object_for_strings)\r\n"]
[151.495538, "o", "        3    0.000    0.000    0.000    0.000 {pandas._libs.algos.ensure_int32}\r\n"]
[151.506103, "o", "        5    0.000    0.000    0.000    0.000 _dtype.py:344(_name_get)\r\n"]
[151.516667, "o", "        3    0.000    0.000    0.000    0.000 generic.py:5975(__setattr__)\r\n"]
[151.527231, "o", "        1    0.000    0.000    0.000    0.000 cast.py:1129(maybe_infer_to_datetimelike)\r\n"]
[151.537795, "o", "        1    0.000    0.000    0.000    0.000 managers.py:1039(iget)\r\n"]
[151.548359, "o", "        2    0.000    0.000    0.000    0.000 common.py:420(is_interval_dtype)\r\n"]
[151.558923, "o", "        1    0.000    0.000    0.000    0.000 rolling.py:117(__init__)\r\n"]
[151.569487, "o", "        1    0.000    0.000    0.000    0.000 base.py:636(_with_infer)\r\n"]
[151.580051, "o", "        1    0.000    0.000    0.000    0.000 common.py:261(index_labels_to_array)\r\n"]
[151.590615, "o", "        2    0.000    0.000    0.000    0.000 <__array_function__ internals>:177(prod)\r\n"]
[151.601179, "o", "        4    0.000    0.000    0.000    0.000 algorithms.py:193(_reconstruct_data)\r\n"]
[151.611744, "o", "        2    0.000    0.000    0.000    0.000 dtypes.py:1241(is_dtype)\r\n"]
[151.622308, "o", "        3    0.000    0.000    0.000    0.000 fromnumeric.py:69(_wrapreduction)\r\n"]
[151.632872, "o", "        1    0.000    0.000    0.000    0.000 {pandas._libs.lib.maybe_convert_objects}\r\n"]
[151.643436, "o", "       12    0.000    0.000    0.000    0.000 base.py:616(_simple_new)\r\n"]
[151.654, "o", "        2    0.000    0.000    0.000    0.000 multi.py:807(_set_levels)\r\n"]
[151.664564, "o", "        1    0.000    0.000    0.000    0.000 base.py:6518(delete)\r\n"]
[151.675128, "o", "        1    0.000    0.000    0.000    0.000 rolling.py:1752(_validate)\r\n"]
[151.685692, "o", "        4    0.000    0.000    0.000    0.000 managers.py:163(blknos)\r\n"]
[151.696256, "o", "        2    0.000    0.000    0.000    0.000 fromnumeric.py:2955(prod)\r\n"]
[151.706821, "o", "        2    0.000    0.000    0.000    0.000 base.py:5255(equals)\r\n"]
[151.717385, "o", "        1    0.000    0.000    0.000    0.000 generic.py:720(_set_axis)\r\n"]
[151.727949, "o", "       16    0.000    0.000    0.000    0.000 common.py:1491(_is_dtype_type)\r\n"]
[151.738513, "o", "        1    0.000    0.000    0.000    0.000 frame.py:4203(_box_col_values)\r\n"]
[151.749077, "o", "        2    0.000    0.000    0.000    0.000 typing.py:868(__new__)\r\n"]
[151.759641, "o", "        1    0.000    0.000    0.000    0.000 base.py:1786(rename)\r\n"]
[151.770205, "o", "        6    0.000    0.000    0.000    0.000 construction.py:402(extract_array)\r\n"]
[151.780769, "o", "        4    0.000    0.000    0.000    0.000 base.py:4918(_get_engine_target)\r\n"]
[151.791333, "o", "        7    0.000    0.000    0.000    0.000 {built-in method builtins.any}\r\n"]
[151.801897, "o", "        8    0.000    0.000    0.000    0.000 <__array_function__ internals>:177(ndim)\r\n"]
[151.812462, "o", "        3    0.000    0.000    0.000    0.000 generic.py:5915(__finalize__)\r\n"]
[151.823026, "o", "      152    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}\r\n"]
[151.83359, "o", "        2    0.000    0.000    0.000    0.000 {method '_rebuild_blknos_and_blklocs' of 'pandas._libs.internals.BlockManager' objects}\r\n"]
[151.844154, "o", "        3    0.000    0.000    0.000    0.000 frame.py:640(__init__)\r\n"]
[151.854718, "o", "        1    0.000    0.000    0.000    0.000 base.py:1679(set_names)\r\n"]
[151.865282, "o", "        2    0.000    0.000    0.000    0.000 generic.py:1921(empty)\r\n"]
[151.875846, "o", "        4    0.000    0.000    0.000    0.000 base.py:54(shape)\r\n"]
[151.88641, "o", "        2    0.000    0.000    0.000    0.000 _ufunc_config.py:33(seterr)\r\n"]
[151.896974, "o", "        4    0.000    0.000    0.000    0.000 common.py:1124(is_numeric_dtype)\r\n"]
[151.907538, "o", "       20    0.000    0.000    0.000    0.000 common.py:1456(get_dtype)\r\n"]
[151.918103, "o", "        8    0.000    0.000    0.000    0.000 common.py:157(is_object_dtype)\r\n"]
[151.928667, "o", "        1    0.000    0.000    0.000    0.000 managers.py:219(set_axis)\r\n"]
[151.939231, "o", "        4    0.000    0.000    0.000    0.000 generic.py:262(__init__)\r\n"]
[151.949795, "o", "        1    0.000    0.000    0.000    0.000 dtypes.py:547(update_dtype)\r\n"]
[151.960359, "o", "        1    0.000    0.000    0.000    0.000 <__array_function__ internals>:177(delete)\r\n"]
[151.970923, "o", "        2    0.000    0.000    0.000    0.000 {method 'get_indexer' of 'pandas._libs.index.IndexEngine' objects}\r\n"]
[151.981487, "o", "        2    0.000    0.000    0.000    0.000 blocks.py:190(fill_value)\r\n"]
[151.992051, "o", "        2    0.000    0.000    0.000    0.000 blocks.py:228(make_block_same_class)\r\n"]
[152.002615, "o", "        6    0.000    0.000    0.000    0.000 take.py:564(_take_preprocess_indexer_and_fill_value)\r\n"]
[152.013179, "o", "        1    0.000    0.000    0.000    0.000 numeric.py:290(full)\r\n"]
[152.023744, "o", "        1    0.000    0.000    0.000    0.000 base.py:58(_validate_set_axis)\r\n"]
[152.034308, "o", "        5    0.000    0.000    0.000    0.000 base.py:731(_view)\r\n"]
[152.044872, "o", "        1    0.000    0.000    0.000    0.000 grouper.py:508(__init__)\r\n"]
[152.055436, "o", "        1    0.000    0.000    0.000    0.000 function_base.py:5054(delete)\r\n"]
[152.066, "o", "        1    0.000    0.000    0.000    0.000 config.py:260(__call__)\r\n"]
[152.076564, "o", "        5    0.000    0.000    0.000    0.000 multi.py:828(<genexpr>)\r\n"]
[152.087128, "o", "        5    0.000    0.000    0.000    0.000 _dtype.py:330(_name_includes_bit_suffix)\r\n"]
[152.097692, "o", "        1    0.000    0.000    0.000    0.000 _ufunc_config.py:430(__enter__)\r\n"]
[152.108256, "o", "        1    0.000    0.000    0.000    0.000 config.py:134(_get_option)\r\n"]
[152.118821, "o", "        6    0.000    0.000    0.000    0.000 common.py:549(is_dtype_equal)\r\n"]
[152.129385, "o", "        1    0.000    0.000    0.000    0.000 rolling.py:412(_resolve_output)\r\n"]
[152.139949, "o", "        1    0.000    0.000    0.000    0.000 dtypes.py:209(_from_values_or_dtype)\r\n"]
[152.150513, "o", "        4    0.000    0.000    0.000    0.000 base.py:5102(__getitem__)\r\n"]
[152.161077, "o", "        3    0.000    0.000    0.000    0.000 _weakrefset.py:36(__init__)\r\n"]
[152.171641, "o", "        2    0.000    0.000    0.000    0.000 multi.py:1398(_set_names)\r\n"]
[152.182205, "o", "        2    0.000    0.000    0.000    0.000 missing.py:625(na_value_for_dtype)\r\n"]
[152.192769, "o", "        3    0.000    0.000    0.000    0.000 base.py:559(_dtype_to_subclass)\r\n"]
[152.203333, "o", "        2    0.000    0.000    0.000    0.000 base.py:6047(_is_comparable_dtype)\r\n"]
[152.213897, "o", "        6    0.000    0.000    0.000    0.000 generic.py:1979(<genexpr>)\r\n"]
[152.224462, "o", "        2    0.000    0.000    0.000    0.000 warnings.py:165(simplefilter)\r\n"]
[152.235026, "o", "        1    0.000    0.000    0.000    0.000 <__array_function__ internals>:177(all)\r\n"]
[152.24559, "o", "        8    0.000    0.000    0.000    0.000 fromnumeric.py:3152(ndim)\r\n"]
[152.256154, "o", "       33    0.000    0.000    0.000    0.000 {built-in method numpy.asarray}\r\n"]
[152.266718, "o", "        7    0.000    0.000    0.000    0.000 abc.py:96(__instancecheck__)\r\n"]
[152.277282, "o", "       25    0.000    0.000    0.000    0.000 {pandas._libs.lib.is_list_like}\r\n"]
[152.287846, "o", "        2    0.000    0.000    0.000    0.000 <__array_function__ internals>:177(ravel)\r\n"]
[152.29841, "o", "       12    0.000    0.000    0.000    0.000 base.py:56(<genexpr>)\r\n"]
[152.308974, "o", "        4    0.000    0.000    0.000    0.000 ops.py:830(names)\r\n"]
[152.319538, "o", "        2    0.000    0.000    0.000    0.000 base.py:5949(_maybe_promote)\r\n"]
[152.330103, "o", "       24    0.000    0.000    0.000    0.000 base.py:842(__len__)\r\n"]
[152.340667, "o", "        1    0.000    0.000    0.000    0.000 multi.py:782(__len__)\r\n"]
[152.351231, "o", "        1    0.000    0.000    0.000    0.000 generic.py:1685(_check_label_or_level_ambiguity)\r\n"]
[152.361795, "o", "        1    0.000    0.000    0.000    0.000 <__array_function__ internals>:177(copyto)\r\n"]
[152.372359, "o", "        9    0.000    0.000    0.000    0.000 {built-in method numpy.empty}\r\n"]
[152.382923, "o", "        2    0.000    0.000    0.000    0.000 numerictypes.py:356(issubdtype)\r\n"]
[152.393487, "o", "        2    0.000    0.000    0.000    0.000 warnings.py:181(_add_filter)\r\n"]
[152.404051, "o", "        3    0.000    0.000    0.000    0.000 base.py:7109(maybe_extract_name)\r\n"]
[152.414615, "o", "        1    0.000    0.000    0.000    0.000 _asarray.py:31(require)\r\n"]
[152.425179, "o", "        1    0.000    0.000    0.000    0.000 fromnumeric.py:2432(all)\r\n"]
[152.435744, "o", "        2    0.000    0.000    0.000    0.000 base.py:7144(unpack_nested_dtype)\r\n"]
[152.446308, "o", "       41    0.000    0.000    0.000    0.000 {built-in method builtins.issubclass}\r\n"]
[152.456872, "o", "        1    0.000    0.000    0.000    0.000 construction.py:128(<listcomp>)\r\n"]
[152.467436, "o", "        1    0.000    0.000    0.000    0.000 _ufunc_config.py:435(__exit__)\r\n"]
[152.478, "o", "        2    0.000    0.000    0.000    0.000 frame.py:3659(_iter_column_arrays)\r\n"]
[152.488564, "o", "        1    0.000    0.000    0.000    0.000 config.py:116(_get_single_key)\r\n"]
[152.499128, "o", "        1    0.000    0.000    0.000    0.000 series.py:367(__init__)\r\n"]
[152.509692, "o", "        1    0.000    0.000    0.000    0.000 {method 'max' of 'numpy.ndarray' objects}\r\n"]
[152.520256, "o", "        5    0.000    0.000    0.000    0.000 cast.py:559(maybe_promote)\r\n"]
[152.530821, "o", "        7    0.000    0.000    0.000    0.000 {built-in method _abc._abc_instancecheck}\r\n"]
[152.541385, "o", "        2    0.000    0.000    0.000    0.000 fromnumeric.py:1781(ravel)\r\n"]
[152.551949, "o", "        1    0.000    0.000    0.000    0.000 grouper.py:1021(_convert_grouper)\r\n"]
[152.562513, "o", "        1    0.000    0.000    0.000    0.000 frozen.py:73(__getitem__)\r\n"]
[152.573077, "o", "        6    0.000    0.000    0.000    0.000 base.py:120(_reset_cache)\r\n"]
[152.583641, "o", "        1    0.000    0.000    0.000    0.000 categorical.py:733(codes)\r\n"]
[152.594205, "o", "        6    0.000    0.000    0.000    0.000 generic.py:520(_get_axis)\r\n"]
[152.604769, "o", "       24    0.000    0.000    0.000    0.000 {pandas._libs.algos.ensure_platform_int}\r\n"]
[152.615333, "o", "        1    0.000    0.000    0.000    0.000 objects.py:288(__init__)\r\n"]
[152.625897, "o", "       28    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}\r\n"]
[152.636462, "o", "        1    0.000    0.000    0.000    0.000 rolling.py:230(_validate_numeric_only)\r\n"]
[152.647026, "o", "        2    0.000    0.000    0.000    0.000 common.py:651(is_integer_dtype)\r\n"]
[152.65759, "o", "        2    0.000    0.000    0.000    0.000 common.py:1206(is_float_dtype)\r\n"]
[152.668154, "o", "        1    0.000    0.000    0.000    0.000 multi.py:796(levels)\r\n"]
[152.678718, "o", "        1    0.000    0.000    0.000    0.000 _methods.py:39(_amax)\r\n"]
[152.689282, "o", "        2    0.000    0.000    0.000    0.000 base.py:432(_engine_type)\r\n"]
[152.699846, "o", "        7    0.000    0.000    0.000    0.000 inference.py:189(is_array_like)\r\n"]
[152.71041, "o", "        2    0.000    0.000    0.000    0.000 inference.py:267(is_dict_like)\r\n"]
[152.720974, "o", "        3    0.000    0.000    0.000    0.000 _weakrefset.py:38(_remove)\r\n"]
[152.731538, "o", "        1    0.000    0.000    0.000    0.000 grouper.py:619(_passed_categorical)\r\n"]
[152.742103, "o", "        2    0.000    0.000    0.000    0.000 _ufunc_config.py:132(geterr)\r\n"]
[152.752667, "o", "        6    0.000    0.000    0.000    0.000 common.py:151(<lambda>)\r\n"]
[152.763231, "o", "       14    0.000    0.000    0.000    0.000 base.py:780(_reset_identity)\r\n"]
[152.773795, "o", "        3    0.000    0.000    0.000    0.000 _weakrefset.py:116(update)\r\n"]
[152.784359, "o", "        2    0.000    0.000    0.000    0.000 warnings.py:458(__enter__)\r\n"]
[152.794923, "o", "        1    0.000    0.000    0.000    0.000 rolling.py:162(_validate)\r\n"]
[152.805487, "o", "        6    0.000    0.000    0.000    0.000 common.py:1074(needs_i8_conversion)\r\n"]
[152.816051, "o", "        1    0.000    0.000    0.000    0.000 rolling.py:379(_insert_on_column)\r\n"]
[152.826615, "o", "        2    0.000    0.000    0.000    0.000 base.py:2641(_na_value)\r\n"]
[152.837179, "o", "        4    0.000    0.000    0.000    0.000 ops.py:832(<listcomp>)\r\n"]
[152.847744, "o", "        6    0.000    0.000    0.000    0.000 common.py:1386(is_ea_or_datetimelike_dtype)\r\n"]
[152.858308, "o", "        4    0.000    0.000    0.000    0.000 numerictypes.py:282(issubclass_)\r\n"]
[152.868872, "o", "        1    0.000    0.000    0.000    0.000 base.py:1634(_set_names)\r\n"]
[152.879436, "o", "        3    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:1017(_handle_fromlist)\r\n"]
[152.89, "o", "        4    0.000    0.000    0.000    0.000 _weakrefset.py:81(add)\r\n"]
[152.900564, "o", "        8    0.000    0.000    0.000    0.000 _methods.py:103(_clip_dep_is_byte_swapped)\r\n"]
[152.911128, "o", "        1    0.000    0.000    0.000    0.000 series.py:1262(_set_as_cached)\r\n"]
[152.921692, "o", "        2    0.000    0.000    0.000    0.000 managers.py:974(from_blocks)\r\n"]
[152.932256, "o", "        1    0.000    0.000    0.000    0.000 multi.py:801(<listcomp>)\r\n"]
[152.942821, "o", "        6    0.000    0.000    0.000    0.000 take.py:325(_get_take_nd_function)\r\n"]
[152.953385, "o", "        7    0.000    0.000    0.000    0.000 inference.py:328(is_hashable)\r\n"]
[152.963949, "o", "        4    0.000    0.000    0.000    0.000 common.py:1332(is_extension_array_dtype)\r\n"]
[152.974513, "o", "       16    0.000    0.000    0.000    0.000 {built-in method __new__ of type object at 0x55edbfb9c680}\r\n"]
[152.985077, "o", "        1    0.000    0.000    0.000    0.000 frame.py:3649(_get_column_array)\r\n"]
[152.995641, "o", "       10    0.000    0.000    0.000    0.000 common.py:143(<lambda>)\r\n"]
[153.006205, "o", "        1    0.000    0.000    0.000    0.000 rolling.py:404(_index_array)\r\n"]
[153.016769, "o", "        3    0.000    0.000    0.000    0.000 {built-in method builtins.all}\r\n"]
[153.027333, "o", "        3    0.000    0.000    0.000    0.000 base.py:1631(_get_names)\r\n"]
[153.037897, "o", "       12    0.000    0.000    0.000    0.000 generic.py:506(_get_axis_number)\r\n"]
[153.048462, "o", "        2    0.000    0.000    0.000    0.000 frame.py:903(shape)\r\n"]
[153.059026, "o", "        1    0.000    0.000    0.000    0.000 managers.py:1775(_consolidate_inplace)\r\n"]
[153.06959, "o", "        2    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}\r\n"]
[153.080154, "o", "        3    0.000    0.000    0.000    0.000 base.py:2623(_is_multi)\r\n"]
[153.090718, "o", "        3    0.000    0.000    0.000    0.000 construction.py:650(_sanitize_ndim)\r\n"]
[153.101282, "o", "        1    0.000    0.000    0.000    0.000 managers.py:1053(iget_values)\r\n"]
[153.111846, "o", "        1    0.000    0.000    0.000    0.000 base.py:3585(get_loc)\r\n"]
[153.12241, "o", "        1    0.000    0.000    0.000    0.000 base.py:740(_rename)\r\n"]
[153.132974, "o", "        2    0.000    0.000    0.000    0.000 algorithms.py:231(_ensure_arraylike)\r\n"]
[153.143538, "o", "        1    0.000    0.000    0.000    0.000 base.py:2664(hasnans)\r\n"]
[153.154103, "o", "        1    0.000    0.000    0.000    0.000 series.py:691(_values)\r\n"]
[153.164667, "o", "        3    0.000    0.000    0.000    0.000 objects.py:46(__init__)\r\n"]
[153.175231, "o", "        4    0.000    0.000    0.000    0.000 flags.py:49(__init__)\r\n"]
[153.185795, "o", "        5    0.000    0.000    0.000    0.000 {built-in method numpy.asanyarray}\r\n"]
[153.196359, "o", "        2    0.000    0.000    0.000    0.000 copy.py:66(copy)\r\n"]
[153.206923, "o", "        3    0.000    0.000    0.000    0.000 base.py:541(_ensure_array)\r\n"]
[153.217487, "o", "        4    0.000    0.000    0.000    0.000 common.py:150(cast_scalar_indexer)\r\n"]
[153.228051, "o", "        6    0.000    0.000    0.000    0.000 range.py:889(__len__)\r\n"]
[153.238615, "o", "        2    0.000    0.000    0.000    0.000 {method 'remove' of 'list' objects}\r\n"]
[153.249179, "o", "        1    0.000    0.000    0.000    0.000 config.py:595(_get_root)\r\n"]
[153.259744, "o", "        4    0.000    0.000    0.000    0.000 common.py:1649(pandas_dtype)\r\n"]
[153.270308, "o", "        6    0.000    0.000    0.000    0.000 __init__.py:33(using_copy_on_write)\r\n"]
[153.280872, "o", "        2    0.000    0.000    0.000    0.000 missing.py:455(array_equivalent)\r\n"]
[153.291436, "o", "        3    0.000    0.000    0.000    0.000 flags.py:85(allows_duplicate_labels)\r\n"]
[153.302, "o", "        2    0.000    0.000    0.000    0.000 {built-in method numpy.array}\r\n"]
[153.312564, "o", "        4    0.000    0.000    0.000    0.000 common.py:274(is_datetime64_dtype)\r\n"]
[153.323128, "o", "        1    0.000    0.000    0.000    0.000 managers.py:1757(is_consolidated)\r\n"]
[153.333692, "o", "        2    0.000    0.000    0.000    0.000 common.py:1432(_is_dtype)\r\n"]
[153.344256, "o", "        2    0.000    0.000    0.000    0.000 missing.py:949(clean_reindex_fill_method)\r\n"]
[153.354821, "o", "        2    0.000    0.000    0.000    0.000 range.py:307(dtype)\r\n"]
[153.365385, "o", "        1    0.000    0.000    0.000    0.000 managers.py:2125(_grouping_func)\r\n"]
[153.375949, "o", "        1    0.000    0.000    0.000    0.000 categorical.py:697(categories)\r\n"]
[153.386513, "o", "        1    0.000    0.000    0.000    0.000 blocks.py:2211(get_block_type)\r\n"]
[153.397077, "o", "        4    0.000    0.000    0.000    0.000 dtypes.py:492(validate_ordered)\r\n"]
[153.407641, "o", "        1    0.000    0.000    0.000    0.000 _asarray.py:112(<setcomp>)\r\n"]
[153.418205, "o", "        1    0.000    0.000    0.000    0.000 rolling.py:220(_slice_axis_for_step)\r\n"]
[153.428769, "o", "        1    0.000    0.000    0.000    0.000 config.py:648(_warn_if_deprecated)\r\n"]
[153.439333, "o", "        1    0.000    0.000    0.000    0.000 ops.py:821(codes)\r\n"]
[153.449897, "o", "        5    0.000    0.000    0.000    0.000 _dtype.py:24(_kind_name)\r\n"]
[153.460462, "o", "        3    0.000    0.000    0.000    0.000 construction.py:689(_sanitize_str_dtypes)\r\n"]
[153.471026, "o", "       10    0.000    0.000    0.000    0.000 common.py:141(classes)\r\n"]
[153.48159, "o", "        8    0.000    0.000    0.000    0.000 base.py:1545(name)\r\n"]
[153.492154, "o", "        2    0.000    0.000    0.000    0.000 warnings.py:437(__init__)\r\n"]
[153.502718, "o", "        2    0.000    0.000    0.000    0.000 warnings.py:477(__exit__)\r\n"]
[153.513282, "o", "        6    0.000    0.000    0.000    0.000 inference.py:294(<genexpr>)\r\n"]
[153.523846, "o", "        1    0.000    0.000    0.000    0.000 common.py:1624(validate_all_hashable)\r\n"]
[153.53441, "o", "        1    0.000    0.000    0.000    0.000 managers.py:2273(_preprocess_slice_or_indexer)\r\n"]
[153.544974, "o", "        6    0.000    0.000    0.000    0.000 common.py:146(classes_and_not_datetimelike)\r\n"]
[153.555538, "o", "        1    0.000    0.000    0.000    0.000 rolling.py:724(<listcomp>)\r\n"]
[153.566103, "o", "        2    0.000    0.000    0.000    0.000 grouper.py:891(<genexpr>)\r\n"]
[153.576667, "o", "        1    0.000    0.000    0.000    0.000 ops.py:685(__init__)\r\n"]
[153.587231, "o", "       11    0.000    0.000    0.000    0.000 ops.py:699(groupings)\r\n"]
[153.597795, "o", "        4    0.000    0.000    0.000    0.000 common.py:350(is_timedelta64_dtype)\r\n"]
[153.608359, "o", "        1    0.000    0.000    0.000    0.000 grouper.py:623(name)\r\n"]
[153.618923, "o", "        1    0.000    0.000    0.000    0.000 rolling.py:312(__getattr__)\r\n"]
[153.629487, "o", "        2    0.000    0.000    0.000    0.000 blocks.py:824(iget)\r\n"]
[153.640051, "o", "        1    0.000    0.000    0.000    0.000 base.py:2070(_can_hold_na)\r\n"]
[153.650615, "o", "        1    0.000    0.000    0.000    0.000 managers.py:1961(internal_values)\r\n"]
[153.661179, "o", "        2    0.000    0.000    0.000    0.000 {built-in method numpy.seterrobj}\r\n"]
[153.671744, "o", "        9    0.000    0.000    0.000    0.000 {built-in method builtins.hash}\r\n"]
[153.682308, "o", "        6    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}\r\n"]
[153.692872, "o", "        7    0.000    0.000    0.000    0.000 generic.py:620(ndim)\r\n"]
[153.703436, "o", "        3    0.000    0.000    0.000    0.000 construction.py:464(ensure_wrapped_if_datetimelike)\r\n"]
[153.714, "o", "        2    0.000    0.000    0.000    0.000 {method 'copy' of 'numpy.ndarray' objects}\r\n"]
[153.724564, "o", "        1    0.000    0.000    0.000    0.000 multi.py:506(<listcomp>)\r\n"]
[153.735128, "o", "       11    0.000    0.000    0.000    0.000 base.py:324(ndim)\r\n"]
[153.745692, "o", "        1    0.000    0.000    0.000    0.000 indexing.py:2606(check_dict_or_set_indexers)\r\n"]
[153.756256, "o", "        1    0.000    0.000    0.000    0.000 rolling.py:264(_create_data)\r\n"]
[153.766821, "o", "        1    0.000    0.000    0.000    0.000 generic.py:526(_get_block_manager_axis)\r\n"]
[153.777385, "o", "        3    0.000    0.000    0.000    0.000 fromnumeric.py:70(<dictcomp>)\r\n"]
[153.787949, "o", "        1    0.000    0.000    0.000    0.000 generic.py:596(_info_axis)\r\n"]
[153.798513, "o", "        2    0.000    0.000    0.000    0.000 base.py:749(is_)\r\n"]
[153.809077, "o", "        2    0.000    0.000    0.000    0.000 config.py:609(_get_deprecated_option)\r\n"]
[153.819641, "o", "        2    0.000    0.000    0.000    0.000 {method 'ravel' of 'numpy.ndarray' objects}\r\n"]
[153.830205, "o", "        1    0.000    0.000    0.000    0.000 rolling.py:205(_check_window_bounds)\r\n"]
[153.840769, "o", "        3    0.000    0.000    0.000    0.000 base.py:654(_constructor)\r\n"]
[153.851333, "o", "        2    0.000    0.000    0.000    0.000 sorting.py:608(<genexpr>)\r\n"]
[153.861897, "o", "        4    0.000    0.000    0.000    0.000 {method 'view' of 'numpy.ndarray' objects}\r\n"]
[153.872462, "o", "        4    0.000    0.000    0.000    0.000 {built-in method numpy.geterrobj}\r\n"]
[153.883026, "o", "        1    0.000    0.000    0.000    0.000 grouper.py:943(is_in_obj)\r\n"]
[153.89359, "o", "        6    0.000    0.000    0.000    0.000 base.py:898(dtype)\r\n"]
[153.904154, "o", "        1    0.000    0.000    0.000    0.000 _ufunc_config.py:426(__init__)\r\n"]
[153.914718, "o", "        1    0.000    0.000    0.000    0.000 sorting.py:157(<listcomp>)\r\n"]
[153.925282, "o", "        1    0.000    0.000    0.000    0.000 ops.py:824(<listcomp>)\r\n"]
[153.935846, "o", "        1    0.000    0.000    0.000    0.000 sorting.py:144(_int64_cut_off)\r\n"]
[153.94641, "o", "        9    0.000    0.000    0.000    0.000 {method 'append' of 'list' objects}\r\n"]
[153.956974, "o", "        2    0.000    0.000    0.000    0.000 grouper.py:893(<genexpr>)\r\n"]
[153.967538, "o", "        1    0.000    0.000    0.000    0.000 _validators.py:222(validate_bool_kwarg)\r\n"]
[153.978103, "o", "        4    0.000    0.000    0.000    0.000 multi.py:943(nlevels)\r\n"]
[153.988667, "o", "        2    0.000    0.000    0.000    0.000 multi.py:1395(_get_names)\r\n"]
[153.999231, "o", "        8    0.000    0.000    0.000    0.000 fromnumeric.py:3148(_ndim_dispatcher)\r\n"]
[154.009795, "o", "        6    0.000    0.000    0.000    0.000 multiarray.py:152(concatenate)\r\n"]
[154.020359, "o", "        1    0.000    0.000    0.000    0.000 managers.py:1765(_consolidate_check)\r\n"]
[154.030923, "o", "        1    0.000    0.000    0.000    0.000 ops.py:790(<listcomp>)\r\n"]
[154.041487, "o", "        1    0.000    0.000    0.000    0.000 ops.py:826(levels)\r\n"]
[154.052051, "o", "        1    0.000    0.000    0.000    0.000 grouper.py:927(is_in_axis)\r\n"]
[154.062615, "o", "        8    0.000    0.000    0.000    0.000 {method 'items' of 'dict' objects}\r\n"]
[154.073179, "o", "        1    0.000    0.000    0.000    0.000 groupby.py:720(_selected_obj)\r\n"]
[154.083744, "o", "        6    0.000    0.000    0.000    0.000 {pandas._libs.lib.is_bool}\r\n"]
[154.094308, "o", "        4    0.000    0.000    0.000    0.000 managers.py:179(blklocs)\r\n"]
[154.104872, "o", "        1    0.000    0.000    0.000    0.000 groupby.py:945(__getattr__)\r\n"]
[154.115436, "o", "        1    0.000    0.000    0.000    0.000 numba_.py:18(maybe_use_numba)\r\n"]
[154.126, "o", "        1    0.000    0.000    0.000    0.000 frame.py:4217(_clear_item_cache)\r\n"]
[154.136564, "o", "        7    0.000    0.000    0.000    0.000 {method 'clear' of 'dict' objects}\r\n"]
[154.147128, "o", "        3    0.000    0.000    0.000    0.000 {method 'discard' of 'set' objects}\r\n"]
[154.157692, "o", "        3    0.000    0.000    0.000    0.000 {pandas._libs.lib.is_scalar}\r\n"]
[154.168256, "o", "        5    0.000    0.000    0.000    0.000 {method 'add' of 'set' objects}\r\n"]
[154.178821, "o", "        2    0.000    0.000    0.000    0.000 missing.py:121(clean_fill_method)\r\n"]
[154.189385, "o", "        2    0.000    0.000    0.000    0.000 frame.py:631(_constructor)\r\n"]
[154.199949, "o", "        1    0.000    0.000    0.000    0.000 categorical.py:459(dtype)\r\n"]
[154.210513, "o", "        7    0.000    0.000    0.000    0.000 typing.py:1149(cast)\r\n"]
[154.221077, "o", "        1    0.000    0.000    0.000    0.000 config.py:577(_select_options)\r\n"]
[154.231641, "o", "        3    0.000    0.000    0.000    0.000 generic.py:335(attrs)\r\n"]
[154.242205, "o", "        3    0.000    0.000    0.000    0.000 base.py:1064(_maybe_disallow_fill)\r\n"]
[154.252769, "o", "        2    0.000    0.000    0.000    0.000 common.py:1643(<genexpr>)\r\n"]
[154.263333, "o", "        1    0.000    0.000    0.000    0.000 {built-in method builtins.max}\r\n"]
[154.273897, "o", "        1    0.000    0.000    0.000    0.000 range.py:482(equals)\r\n"]
[154.284462, "o", "        5    0.000    0.000    0.000    0.000 {pandas._libs.lib.is_integer}\r\n"]
[154.295026, "o", "        2    0.000    0.000    0.000    0.000 grouper.py:669(codes)\r\n"]
[154.30559, "o", "        6    0.000    0.000    0.000    0.000 {built-in method _warnings._filters_mutated}\r\n"]
[154.316154, "o", "        1    0.000    0.000    0.000    0.000 {pandas._libs.internals.get_blkno_placements}\r\n"]
[154.326718, "o", "        5    0.000    0.000    0.000    0.000 dtypes.py:580(categories)\r\n"]
[154.337282, "o", "        3    0.000    0.000    0.000    0.000 base.py:5937(_index_as_unique)\r\n"]
[154.347846, "o", "        1    0.000    0.000    0.000    0.000 config.py:636(_translate_key)\r\n"]
[154.35841, "o", "        6    0.000    0.000    0.000    0.000 generic.py:356(flags)\r\n"]
[154.368974, "o", "        4    0.000    0.000    0.000    0.000 fromnumeric.py:2107(_clip_dispatcher)\r\n"]
[154.379538, "o", "        2    0.000    0.000    0.000    0.000 grouper.py:892(<genexpr>)\r\n"]
[154.390103, "o", "        3    0.000    0.000    0.000    0.000 flags.py:53(allows_duplicate_labels)\r\n"]
[154.400667, "o", "        1    0.000    0.000    0.000    0.000 managers.py:224(is_single_block)\r\n"]
[154.411231, "o", "        3    0.000    0.000    0.000    0.000 managers.py:939(__init__)\r\n"]
[154.421795, "o", "        1    0.000    0.000    0.000    0.000 managers.py:1799(__init__)\r\n"]
[154.432359, "o", "        2    0.000    0.000    0.000    0.000 {method 'insert' of 'list' objects}\r\n"]
[154.442923, "o", "        2    0.000    0.000    0.000    0.000 common.py:1165(<lambda>)\r\n"]
[154.453487, "o", "        1    0.000    0.000    0.000    0.000 sorting.py:227(is_int64_overflow_possible)\r\n"]
[154.464051, "o", "        3    0.000    0.000    0.000    0.000 dtypes.py:587(ordered)\r\n"]
[154.474615, "o", "        4    0.000    0.000    0.000    0.000 {pandas._libs.lib.is_float}\r\n"]
[154.485179, "o", "        1    0.000    0.000    0.000    0.000 base.py:200(_selected_obj)\r\n"]
[154.495744, "o", "        1    0.000    0.000    0.000    0.000 categorical.py:1768(_codes)\r\n"]
[154.506308, "o", "        1    0.000    0.000    0.000    0.000 range.py:248(start)\r\n"]
[154.516872, "o", "        1    0.000    0.000    0.000    0.000 grouper.py:1017(_is_label_like)\r\n"]
[154.527436, "o", "        1    0.000    0.000    0.000    0.000 common.py:367(apply_if_callable)\r\n"]
[154.538, "o", "        1    0.000    0.000    0.000    0.000 common.py:1319(is_1d_only_ea_dtype)\r\n"]
[154.548564, "o", "        3    0.000    0.000    0.000    0.000 {pandas._libs.lib.is_iterator}\r\n"]
[154.559128, "o", "        1    0.000    0.000    0.000    0.000 blocks.py:476(dtype)\r\n"]
[154.569692, "o", "        1    0.000    0.000    0.000    0.000 {method 'item' of 'numpy.ndarray' objects}\r\n"]
[154.580256, "o", "        2    0.000    0.000    0.000    0.000 {method 'values' of 'dict' objects}\r\n"]
[154.590821, "o", "        1    0.000    0.000    0.000    0.000 frame.py:886(axes)\r\n"]
[154.601385, "o", "        1    0.000    0.000    0.000    0.000 ops.py:828(<listcomp>)\r\n"]
[154.611949, "o", "        1    0.000    0.000    0.000    0.000 {method 'get_loc' of 'pandas._libs.index.IndexEngine' objects}\r\n"]
[154.622513, "o", "        3    0.000    0.000    0.000    0.000 construction.py:709(_maybe_repeat)\r\n"]
[154.633077, "o", "        1    0.000    0.000    0.000    0.000 ops.py:791(<listcomp>)\r\n"]
[154.643641, "o", "        1    0.000    0.000    0.000    0.000 function.py:60(__call__)\r\n"]
[154.654205, "o", "        2    0.000    0.000    0.000    0.000 {method 'extend' of 'list' objects}\r\n"]
[154.664769, "o", "        2    0.000    0.000    0.000    0.000 function_base.py:5440(_append_dispatcher)\r\n"]
[154.675333, "o", "        1    0.000    0.000    0.000    0.000 {method 'upper' of 'str' objects}\r\n"]
[154.685897, "o", "        1    0.000    0.000    0.000    0.000 grouper.py:641(_ilevel)\r\n"]
[154.696462, "o", "        1    0.000    0.000    0.000    0.000 managers.py:229(items)\r\n"]
[154.707026, "o", "        2    0.000    0.000    0.000    0.000 multi.py:978(codes)\r\n"]
[154.71759, "o", "        2    0.000    0.000    0.000    0.000 fromnumeric.py:1777(_ravel_dispatcher)\r\n"]
[154.728154, "o", "        2    0.000    0.000    0.000    0.000 fromnumeric.py:2950(_prod_dispatcher)\r\n"]
[154.738718, "o", "        1    0.000    0.000    0.000    0.000 range.py:195(_constructor)\r\n"]
[154.749282, "o", "        1    0.000    0.000    0.000    0.000 {method 'split' of 'str' objects}\r\n"]
[154.759846, "o", "        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}\r\n"]
[154.77041, "o", "        1    0.000    0.000    0.000    0.000 {pandas._libs.lib.item_from_zerodim}\r\n"]
[154.780974, "o", "        1    0.000    0.000    0.000    0.000 managers.py:1894(_block)\r\n"]
[154.791538, "o", "        1    0.000    0.000    0.000    0.000 {pandas._libs.algos.ensure_float64}\r\n"]
[154.802103, "o", "        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}\r\n"]
[154.812667, "o", "        1    0.000    0.000    0.000    0.000 range.py:263(step)\r\n"]
[154.823231, "o", "        1    0.000    0.000    0.000    0.000 {pandas._libs.algos.ensure_int64}\r\n"]
[154.833795, "o", "        1    0.000    0.000    0.000    0.000 series.py:594(name)\r\n"]
[154.844359, "o", "        1    0.000    0.000    0.000    0.000 fromnumeric.py:2427(_all_dispatcher)\r\n"]
[154.854923, "o", "        1    0.000    0.000    0.000    0.000 multiarray.py:1079(copyto)\r\n"]
[154.865487, "o", "        2    0.000    0.000    0.000    0.000 {method 'copy' of 'list' objects}\r\n"]
[154.876051, "o", "        1    0.000    0.000    0.000    0.000 function_base.py:5050(_delete_dispatcher)\r\n"]
[154.886615, "o", "        1    0.000    0.000    0.000    0.000 base.py:6298(_maybe_cast_indexer)\r\n"]
[154.897179, "o", "        1    0.000    0.000    0.000    0.000 {method 'pop' of 'dict' objects}\r\n"]
[154.907744, "o", "        1    0.000    0.000    0.000    0.000 generic.py:1706(<genexpr>)\r\n"]
[154.918308, "o", "        1    0.000    0.000    0.000    0.000 range.py:256(stop)\r\n"]
[154.928872, "o", "        1    0.000    0.000    0.000    0.000 {function FrozenList.__getitem__ at 0x7fcbe8b6d280}\r\n"]
[154.939436, "o", "\r\n"]
[155.0, "o", "(asv_3.8) root@cb2cc1765c92:/workspace/repo/asv_bench# "]
[155.002, "i", "asv profile --python=same --config=asv.conf.json rolling.Groupby.time_method\r"]
[155.004, "o", "asv profile --python=same --config=asv.conf.json rolling.Groupby.time_method\r\n"]
[156.654, "o", "\u001b[?2004l\r\n"]
[158.302, "o", "\u00b7 \u001b[0;32mDiscovering benchmarks\u001b[0m\r\n"]
[160.0, "o", "(asv_3.8) root@cb2cc1765c92:/workspace/repo/asv_bench# "]
[160.002, "i", "asv profile --python=same --config=asv.conf.json rolling.GroupbyLargeGroups.time_rolling_multiindex_creati\r"]
[160.004, "o", "asv profile --python=same --config=asv.conf.json rolling.GroupbyLargeGroups.time_rolling_multiindex_creati\r\n"]
[160.016564, "o", "ion\r\n"]
[160.027128, "o", "\u001b[?2004l\r\n"]
[160.037692, "o", "\u00b7 \u001b[0;32mDiscovering benchmarks\u001b[0m\r\n"]
[160.048256, "o", "\u00b7 \u001b[0;32mProfile data does not already exist. Running profiler now.\u001b[0m\r\n"]
[160.058821, "o", "\u00b7\u00b7 \u001b[0;34mBenchmarking existing-py_opt_conda_envs_asv_3.8_bin_python\u001b[0m\r\n"]
[160.069385, "o", "\u00b7\u00b7\u00b7 \u001b[0;39mRunning (rolling.GroupbyLargeGroups.time_rolling_multiindex_creation--)\u001b[0m.\r\n"]
[160.079949, "o", "\u00b7\u00b7\u00b7 \u001b[0;39mrolling.GroupbyLargeGroups.time_rolling_multiindex_creation\u001b[0m                                                                             18.7\u00b10.2ms\r\n"]
[160.090513, "o", "\r\n"]
[160.101077, "o", "Wed Oct  1 18:28:18 2025    /tmp/tmp72ogkcsg\r\n"]
[160.111641, "o", "\r\n"]
[160.122205, "o", "         2358 function calls (2304 primitive calls) in 0.019 seconds\r\n"]
[160.132769, "o", "\r\n"]
[160.143333, "o", "   Ordered by: cumulative time\r\n"]
[160.153897, "o", "\r\n"]
[160.164462, "o", "   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\r\n"]
[160.175026, "o", "        1    0.000    0.000    0.019    0.019 {built-in method builtins.exec}\r\n"]
[160.18559, "o", "        1    0.000    0.000    0.019    0.019 _base.py:689(method_caller)\r\n"]
[160.196154, "o", "        1    0.000    0.000    0.019    0.019 rolling.py:322(time_rolling_multiindex_creation)\r\n"]
[160.206718, "o", "        1    0.000    0.000    0.018    0.018 rolling.py:2070(mean)\r\n"]
[160.217282, "o", "        1    0.000    0.000    0.018    0.018 rolling.py:1489(mean)\r\n"]
[160.227846, "o", "        1    0.000    0.000    0.018    0.018 rolling.py:701(_apply)\r\n"]
[160.23841, "o", "        1    0.000    0.000    0.013    0.013 multi.py:445(from_arrays)\r\n"]
[160.248974, "o", "        1    0.000    0.000    0.013    0.013 categorical.py:2586(factorize_from_iterables)\r\n"]
[160.259538, "o", "        2    0.000    0.000    0.013    0.006 categorical.py:2607(<genexpr>)\r\n"]
[160.270103, "o", "        1    0.000    0.000    0.013    0.013 categorical.py:2545(factorize_from_iterable)\r\n"]
[160.280667, "o", "        1    0.000    0.000    0.013    0.013 categorical.py:359(__init__)\r\n"]
[160.291231, "o", "      3/2    0.000    0.000    0.012    0.006 algorithms.py:610(factorize)\r\n"]
[160.301795, "o", "        1    0.000    0.000    0.012    0.012 base.py:1143(factorize)\r\n"]
[160.312359, "o", "        2    0.000    0.000    0.010    0.005 algorithms.py:1702(safe_sort)\r\n"]
[160.322923, "o", "        4    0.010    0.002    0.010    0.002 {method 'argsort' of 'numpy.ndarray' objects}\r\n"]
[160.333487, "o", "        1    0.000    0.000    0.005    0.005 rolling.py:558(_apply)\r\n"]
[160.344051, "o", "        1    0.000    0.000    0.003    0.003 rolling.py:456(_apply_blockwise)\r\n"]
[160.354615, "o", "        1    0.000    0.000    0.002    0.002 rolling.py:591(homogeneous_func)\r\n"]
[160.365179, "o", "        1    0.000    0.000    0.002    0.002 rolling.py:597(calc)\r\n"]
[160.375744, "o", "        2    0.000    0.000    0.002    0.001 algorithms.py:548(factorize_array)\r\n"]
[160.386308, "o", "        2    0.002    0.001    0.002    0.001 {method 'factorize' of 'pandas._libs.hashtable.Int64HashTable' objects}\r\n"]
[160.396872, "o", "        1    0.000    0.000    0.002    0.002 rolling.py:2695(_get_window_indexer)\r\n"]
[160.407436, "o", "        1    0.000    0.000    0.002    0.002 ops.py:784(indices)\r\n"]
[160.418, "o", "        1    0.001    0.001    0.001    0.001 {pandas._libs.window.aggregations.roll_mean}\r\n"]
[160.428564, "o", "        1    0.000    0.000    0.001    0.001 sorting.py:599(get_indexer_dict)\r\n"]
[160.439128, "o", "        1    0.000    0.000    0.001    0.001 objects.py:324(get_window_bounds)\r\n"]
[160.449692, "o", "        1    0.000    0.000    0.001    0.001 groupby.py:2649(rolling)\r\n"]
[160.460256, "o", "        4    0.000    0.000    0.001    0.000 dtypes.py:186(__init__)\r\n"]
[160.470821, "o", "        4    0.000    0.000    0.001    0.000 dtypes.py:339(_finalize)\r\n"]
[160.481385, "o", "        1    0.000    0.000    0.001    0.001 rolling.py:678(__init__)\r\n"]
[160.491949, "o", "        2    0.000    0.000    0.001    0.000 dtypes.py:511(validate_categories)\r\n"]
[160.502513, "o", "        2    0.001    0.000    0.001    0.000 base.py:2168(is_unique)\r\n"]
[160.513077, "o", "       12    0.001    0.000    0.001    0.000 {method 'take' of 'numpy.ndarray' objects}\r\n"]
[160.523641, "o", "        1    0.000    0.000    0.001    0.001 frame.py:5087(drop)\r\n"]
[160.534205, "o", "        1    0.000    0.000    0.001    0.001 generic.py:4505(drop)\r\n"]
[160.544769, "o", "        1    0.000    0.000    0.001    0.001 generic.py:4544(_drop_axis)\r\n"]
[160.555333, "o", "        1    0.000    0.000    0.001    0.001 ops.py:910(result_index)\r\n"]
[160.565897, "o", "        1    0.000    0.000    0.001    0.001 grouper.py:688(result_index)\r\n"]
[160.576462, "o", "        1    0.000    0.000    0.001    0.001 grouper.py:700(group_index)\r\n"]
[160.587026, "o", "        1    0.000    0.000    0.001    0.001 rolling.py:846(_create_data)\r\n"]
[160.59759, "o", "        6    0.000    0.000    0.001    0.000 take.py:58(take_nd)\r\n"]
[160.608154, "o", "        6    0.000    0.000    0.001    0.000 take.py:120(_take_nd_ndarray)\r\n"]
[160.618718, "o", "        1    0.000    0.000    0.001    0.001 grouper.py:722(_codes_and_uniques)\r\n"]
[160.629282, "o", "        2    0.000    0.000    0.001    0.000 managers.py:641(reindex_indexer)\r\n"]
[160.639846, "o", "        1    0.000    0.000    0.001    0.001 generic.py:3819(take)\r\n"]
[160.65041, "o", "        1    0.000    0.000    0.001    0.001 generic.py:3898(_take)\r\n"]
[160.660974, "o", "    27/15    0.000    0.000    0.001    0.000 {built-in method numpy.core._multiarray_umath.implement_array_function}\r\n"]
[160.671538, "o", "        1    0.000    0.000    0.001    0.001 managers.py:886(take)\r\n"]
[160.682103, "o", "        2    0.000    0.000    0.000    0.000 blocks.py:858(take_nd)\r\n"]
[160.692667, "o", "        1    0.000    0.000    0.000    0.000 sorting.py:632(get_group_index_sorter)\r\n"]
[160.703231, "o", "        1    0.000    0.000    0.000    0.000 {pandas._libs.algos.groupsort_indexer}\r\n"]
[160.713795, "o", "        2    0.000    0.000    0.000    0.000 objects.py:76(get_window_bounds)\r\n"]
[160.724359, "o", "        1    0.000    0.000    0.000    0.000 base.py:6610(drop)\r\n"]
[160.734923, "o", "        2    0.000    0.000    0.000    0.000 base.py:3676(get_indexer)\r\n"]
[160.745487, "o", "        1    0.000    0.000    0.000    0.000 managers.py:705(<listcomp>)\r\n"]
[160.756051, "o", "        3    0.000    0.000    0.000    0.000 base.py:1033(take)\r\n"]
[160.766615, "o", "        1    0.000    0.000    0.000    0.000 managers.py:726(_slice_take_blocks_ax0)\r\n"]
[160.777179, "o", "        1    0.000    0.000    0.000    0.000 frame.py:8104(groupby)\r\n"]
[160.787744, "o", "        4    0.000    0.000    0.000    0.000 <__array_function__ internals>:177(clip)\r\n"]
[160.798308, "o", "        4    0.000    0.000    0.000    0.000 fromnumeric.py:2111(clip)\r\n"]
[160.808872, "o", "        4    0.000    0.000    0.000    0.000 fromnumeric.py:51(_wrapfunc)\r\n"]
[160.819436, "o", "        4    0.000    0.000    0.000    0.000 {method 'clip' of 'numpy.ndarray' objects}\r\n"]
[160.83, "o", "        1    0.000    0.000    0.000    0.000 {pandas._libs.algos.take_2d_axis0_float64_float64}\r\n"]
[160.840564, "o", "        4    0.000    0.000    0.000    0.000 _methods.py:127(_clip)\r\n"]
[160.851128, "o", "        6    0.000    0.000    0.000    0.000 <__array_function__ internals>:177(concatenate)\r\n"]
[160.861692, "o", "        1    0.000    0.000    0.000    0.000 groupby.py:896(__init__)\r\n"]
[160.872256, "o", "        1    0.000    0.000    0.000    0.000 base.py:5777(get_indexer_for)\r\n"]
[160.882821, "o", "        1    0.000    0.000    0.000    0.000 grouper.py:790(get_grouper)\r\n"]
[160.893385, "o", "  392/382    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}\r\n"]
[160.903949, "o", "        3    0.000    0.000    0.000    0.000 algorithms.py:1396(take)\r\n"]
[160.914513, "o", "        4    0.000    0.000    0.000    0.000 _methods.py:108(_clip_dep_invoke_with_casting)\r\n"]
[160.925077, "o", "        4    0.000    0.000    0.000    0.000 {pandas._libs.algos.take_1d_int64_int64}\r\n"]
[160.935641, "o", "        3    0.000    0.000    0.000    0.000 base.py:449(__new__)\r\n"]
[160.946205, "o", "        1    0.000    0.000    0.000    0.000 {pandas._libs.algos.take_2d_axis1_float64_float64}\r\n"]
[160.956769, "o", "        1    0.000    0.000    0.000    0.000 frame.py:2459(_from_arrays)\r\n"]
[160.967333, "o", "        2    0.000    0.000    0.000    0.000 multi.py:313(__new__)\r\n"]
[160.977897, "o", "        5    0.000    0.000    0.000    0.000 {built-in method numpy.arange}\r\n"]
[160.988462, "o", "        1    0.000    0.000    0.000    0.000 {pandas._libs.lib.indices_fast}\r\n"]
[160.999026, "o", "        1    0.000    0.000    0.000    0.000 frame.py:3689(__getitem__)\r\n"]
[161.00959, "o", "        1    0.000    0.000    0.000    0.000 construction.py:96(arrays_to_mgr)\r\n"]
[161.020154, "o", "        1    0.000    0.000    0.000    0.000 sorting.py:109(get_group_index)\r\n"]
[161.030718, "o", "        2    0.000    0.000    0.000    0.000 algorithms.py:265(_get_hashtable_algo)\r\n"]
[161.041282, "o", "        1    0.000    0.000    0.000    0.000 rolling.py:742(<listcomp>)\r\n"]
[161.051846, "o", "        1    0.000    0.000    0.000    0.000 utils.py:241(maybe_convert_indices)\r\n"]
[161.06241, "o", "        9    0.000    0.000    0.000    0.000 base.py:7014(ensure_index)\r\n"]
[161.072974, "o", "        4    0.000    0.000    0.000    0.000 cast.py:971(coerce_indexer_dtype)\r\n"]
[161.083538, "o", "        1    0.000    0.000    0.000    0.000 frame.py:4220(_get_item_cache)\r\n"]
[161.094103, "o", "        2    0.000    0.000    0.000    0.000 base.py:6305(_maybe_cast_listlike_indexer)\r\n"]
[161.104667, "o", "      117    0.000    0.000    0.000    0.000 generic.py:42(_instancecheck)\r\n"]
[161.115231, "o", "       12    0.000    0.000    0.000    0.000 {method 'astype' of 'numpy.ndarray' objects}\r\n"]
[161.125795, "o", "        1    0.000    0.000    0.000    0.000 managers.py:2069(create_block_manager_from_column_arrays)\r\n"]
[161.136359, "o", "        1    0.000    0.000    0.000    0.000 sorting.py:622(<listcomp>)\r\n"]
[161.146923, "o", "        2    0.000    0.000    0.000    0.000 base.py:6029(_should_compare)\r\n"]
[161.157487, "o", "        3    0.000    0.000    0.000    0.000 construction.py:500(sanitize_array)\r\n"]
[161.168051, "o", "        1    0.000    0.000    0.000    0.000 managers.py:2141(_form_blocks)\r\n"]
[161.178615, "o", "        9    0.000    0.000    0.000    0.000 {method 'reduce' of 'numpy.ufunc' objects}\r\n"]
[161.189179, "o", "        2    0.000    0.000    0.000    0.000 <__array_function__ internals>:177(append)\r\n"]
[161.199744, "o", "        1    0.000    0.000    0.000    0.000 frame.py:3615(_ixs)\r\n"]
[161.210308, "o", "        2    0.000    0.000    0.000    0.000 function_base.py:5444(append)\r\n"]
[161.220872, "o", "        2    0.000    0.000    0.000    0.000 multi.py:982(_set_codes)\r\n"]
[161.231436, "o", "        6    0.000    0.000    0.000    0.000 common.py:1241(is_bool_dtype)\r\n"]
[161.242, "o", "        5    0.000    0.000    0.000    0.000 {method 'any' of 'numpy.ndarray' objects}\r\n"]
[161.252564, "o", "       17    0.000    0.000    0.000    0.000 base.py:286(is_dtype)\r\n"]
[161.263128, "o", "        5    0.000    0.000    0.000    0.000 multi.py:998(<genexpr>)\r\n"]
[161.273692, "o", "        2    0.000    0.000    0.000    0.000 algorithms.py:113(_ensure_data)\r\n"]
[161.284256, "o", "        5    0.000    0.000    0.000    0.000 _methods.py:55(_any)\r\n"]
[161.294821, "o", "       13    0.000    0.000    0.000    0.000 common.py:458(is_categorical_dtype)\r\n"]
[161.305385, "o", "        3    0.000    0.000    0.000    0.000 multi.py:3871(_coerce_indexer_frozen)\r\n"]
[161.315949, "o", "   130/99    0.000    0.000    0.000    0.000 {built-in method builtins.len}\r\n"]
[161.326513, "o", "      117    0.000    0.000    0.000    0.000 generic.py:37(_check)\r\n"]
[161.337077, "o", "        1    0.000    0.000    0.000    0.000 {pandas._libs.algos.ensure_int8}\r\n"]
[161.347641, "o", "        1    0.000    0.000    0.000    0.000 rolling.py:355(_prep_values)\r\n"]
[161.358205, "o", "       27    0.000    0.000    0.000    0.000 base.py:4892(_values)\r\n"]
[161.368769, "o", "        8    0.000    0.000    0.000    0.000 _methods.py:93(_clip_dep_is_scalar_nan)\r\n"]
[161.379333, "o", "        2    0.000    0.000    0.000    0.000 base.py:791(_engine)\r\n"]
[161.389897, "o", "        1    0.000    0.000    0.000    0.000 managers.py:2199(_stack_arrays)\r\n"]
[161.400462, "o", "        2    0.000    0.000    0.000    0.000 common.py:229(asarray_tuplesafe)\r\n"]
[161.411026, "o", "        1    0.000    0.000    0.000    0.000 generic.py:1916(__contains__)\r\n"]
[161.42159, "o", "        2    0.000    0.000    0.000    0.000 algorithms.py:283(_check_object_for_strings)\r\n"]
[161.432154, "o", "        2    0.000    0.000    0.000    0.000 base.py:5052(__contains__)\r\n"]
[161.442718, "o", "        5    0.000    0.000    0.000    0.000 _dtype.py:344(_name_get)\r\n"]
[161.453282, "o", "        1    0.000    0.000    0.000    0.000 range.py:201(_data)\r\n"]
[161.463846, "o", "        1    0.000    0.000    0.000    0.000 cast.py:1129(maybe_infer_to_datetimelike)\r\n"]
[161.47441, "o", "        3    0.000    0.000    0.000    0.000 {pandas._libs.algos.ensure_int32}\r\n"]
[161.484974, "o", "        3    0.000    0.000    0.000    0.000 base.py:2599(inferred_type)\r\n"]
[161.495538, "o", "        1    0.000    0.000    0.000    0.000 managers.py:1039(iget)\r\n"]
[161.506103, "o", "        2    0.000    0.000    0.000    0.000 base.py:3764(_get_indexer)\r\n"]
[161.516667, "o", "        5    0.000    0.000    0.000    0.000 {pandas._libs.lib.infer_dtype}\r\n"]
[161.527231, "o", "        3    0.000    0.000    0.000    0.000 generic.py:5975(__setattr__)\r\n"]
[161.537795, "o", "        1    0.000    0.000    0.000    0.000 common.py:261(index_labels_to_array)\r\n"]
[161.548359, "o", "        1    0.000    0.000    0.000    0.000 base.py:636(_with_infer)\r\n"]
[161.558923, "o", "        1    0.000    0.000    0.000    0.000 rolling.py:117(__init__)\r\n"]
[161.569487, "o", "        6    0.000    0.000    0.000    0.000 take.py:564(_take_preprocess_indexer_and_fill_value)\r\n"]
[161.580051, "o", "        1    0.000    0.000    0.000    0.000 {pandas._libs.lib.maybe_convert_objects}\r\n"]
[161.590615, "o", "        2    0.000    0.000    0.000    0.000 base.py:3809(_check_indexing_method)\r\n"]
[161.601179, "o", "        2    0.000    0.000    0.000    0.000 <__array_function__ internals>:177(prod)\r\n"]
[161.611744, "o", "        4    0.000    0.000    0.000    0.000 algorithms.py:193(_reconstruct_data)\r\n"]
[161.622308, "o", "       16    0.000    0.000    0.000    0.000 common.py:1491(_is_dtype_type)\r\n"]
[161.632872, "o", "       12    0.000    0.000    0.000    0.000 base.py:616(_simple_new)\r\n"]
[161.643436, "o", "        2    0.000    0.000    0.000    0.000 multi.py:807(_set_levels)\r\n"]
[161.654, "o", "        3    0.000    0.000    0.000    0.000 fromnumeric.py:69(_wrapreduction)\r\n"]
[161.664564, "o", "        4    0.000    0.000    0.000    0.000 managers.py:163(blknos)\r\n"]
[161.675128, "o", "        1    0.000    0.000    0.000    0.000 base.py:6518(delete)\r\n"]
[161.685692, "o", "        6    0.000    0.000    0.000    0.000 construction.py:402(extract_array)\r\n"]
[161.696256, "o", "        2    0.000    0.000    0.000    0.000 base.py:5255(equals)\r\n"]
[161.706821, "o", "        1    0.000    0.000    0.000    0.000 rolling.py:1752(_validate)\r\n"]
[161.717385, "o", "        2    0.000    0.000    0.000    0.000 fromnumeric.py:2955(prod)\r\n"]
[161.727949, "o", "        1    0.000    0.000    0.000    0.000 generic.py:720(_set_axis)\r\n"]
[161.738513, "o", "        5    0.000    0.000    0.000    0.000 cast.py:559(maybe_promote)\r\n"]
[161.749077, "o", "        2    0.000    0.000    0.000    0.000 {method '_rebuild_blknos_and_blklocs' of 'pandas._libs.internals.BlockManager' objects}\r\n"]
[161.759641, "o", "        1    0.000    0.000    0.000    0.000 frame.py:4203(_box_col_values)\r\n"]
[161.770205, "o", "      152    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}\r\n"]
[161.780769, "o", "        2    0.000    0.000    0.000    0.000 typing.py:868(__new__)\r\n"]
[161.791333, "o", "        1    0.000    0.000    0.000    0.000 base.py:1786(rename)\r\n"]
[161.801897, "o", "        4    0.000    0.000    0.000    0.000 base.py:4918(_get_engine_target)\r\n"]
[161.812462, "o", "        8    0.000    0.000    0.000    0.000 common.py:157(is_object_dtype)\r\n"]
[161.823026, "o", "        8    0.000    0.000    0.000    0.000 <__array_function__ internals>:177(ndim)\r\n"]
[161.83359, "o", "        7    0.000    0.000    0.000    0.000 {built-in method builtins.any}\r\n"]
[161.844154, "o", "        4    0.000    0.000    0.000    0.000 common.py:1124(is_numeric_dtype)\r\n"]
[161.854718, "o", "        1    0.000    0.000    0.000    0.000 base.py:1679(set_names)\r\n"]
[161.865282, "o", "        3    0.000    0.000    0.000    0.000 generic.py:5915(__finalize__)\r\n"]
[161.875846, "o", "        2    0.000    0.000    0.000    0.000 _ufunc_config.py:33(seterr)\r\n"]
[161.88641, "o", "        2    0.000    0.000    0.000    0.000 generic.py:1921(empty)\r\n"]
[161.896974, "o", "       20    0.000    0.000    0.000    0.000 common.py:1456(get_dtype)\r\n"]
[161.907538, "o", "        1    0.000    0.000    0.000    0.000 dtypes.py:547(update_dtype)\r\n"]
[161.918103, "o", "        4    0.000    0.000    0.000    0.000 base.py:54(shape)\r\n"]
[161.928667, "o", "        1    0.000    0.000    0.000    0.000 <__array_function__ internals>:177(delete)\r\n"]
[161.939231, "o", "        1    0.000    0.000    0.000    0.000 managers.py:219(set_axis)\r\n"]
[161.949795, "o", "        3    0.000    0.000    0.000    0.000 frame.py:640(__init__)\r\n"]
[161.960359, "o", "        1    0.000    0.000    0.000    0.000 numeric.py:290(full)\r\n"]
[161.970923, "o", "        1    0.000    0.000    0.000    0.000 base.py:58(_validate_set_axis)\r\n"]
[161.981487, "o", "        4    0.000    0.000    0.000    0.000 generic.py:262(__init__)\r\n"]
[161.992051, "o", "        1    0.000    0.000    0.000    0.000 grouper.py:508(__init__)\r\n"]
[162.002615, "o", "        1    0.000    0.000    0.000    0.000 function_base.py:5054(delete)\r\n"]
[162.013179, "o", "        2    0.000    0.000    0.000    0.000 {method 'get_indexer' of 'pandas._libs.index.IndexEngine' objects}\r\n"]
[162.023744, "o", "        1    0.000    0.000    0.000    0.000 config.py:260(__call__)\r\n"]
[162.034308, "o", "        5    0.000    0.000    0.000    0.000 _dtype.py:330(_name_includes_bit_suffix)\r\n"]
[162.044872, "o", "        2    0.000    0.000    0.000    0.000 common.py:420(is_interval_dtype)\r\n"]
[162.055436, "o", "        1    0.000    0.000    0.000    0.000 _ufunc_config.py:430(__enter__)\r\n"]
[162.066, "o", "        5    0.000    0.000    0.000    0.000 base.py:731(_view)\r\n"]
[162.076564, "o", "        2    0.000    0.000    0.000    0.000 blocks.py:190(fill_value)\r\n"]
[162.087128, "o", "        3    0.000    0.000    0.000    0.000 base.py:559(_dtype_to_subclass)\r\n"]
[162.097692, "o", "        1    0.000    0.000    0.000    0.000 config.py:134(_get_option)\r\n"]
[162.108256, "o", "        5    0.000    0.000    0.000    0.000 multi.py:828(<genexpr>)\r\n"]
[162.118821, "o", "        4    0.000    0.000    0.000    0.000 base.py:5102(__getitem__)\r\n"]
[162.129385, "o", "        2    0.000    0.000    0.000    0.000 multi.py:1398(_set_names)\r\n"]
[162.139949, "o", "        2    0.000    0.000    0.000    0.000 blocks.py:228(make_block_same_class)\r\n"]
[162.150513, "o", "        1    0.000    0.000    0.000    0.000 rolling.py:412(_resolve_output)\r\n"]
[162.161077, "o", "       25    0.000    0.000    0.000    0.000 {pandas._libs.lib.is_list_like}\r\n"]
[162.171641, "o", "        1    0.000    0.000    0.000    0.000 dtypes.py:209(_from_values_or_dtype)\r\n"]
[162.182205, "o", "        6    0.000    0.000    0.000    0.000 common.py:549(is_dtype_equal)\r\n"]
[162.192769, "o", "        2    0.000    0.000    0.000    0.000 base.py:6047(_is_comparable_dtype)\r\n"]
[162.203333, "o", "       33    0.000    0.000    0.000    0.000 {built-in method numpy.asarray}\r\n"]
[162.213897, "o", "        6    0.000    0.000    0.000    0.000 generic.py:1979(<genexpr>)\r\n"]
[162.224462, "o", "        2    0.000    0.000    0.000    0.000 warnings.py:165(simplefilter)\r\n"]
[162.235026, "o", "       24    0.000    0.000    0.000    0.000 base.py:842(__len__)\r\n"]
[162.24559, "o", "        2    0.000    0.000    0.000    0.000 <__array_function__ internals>:177(ravel)\r\n"]
[162.256154, "o", "        8    0.000    0.000    0.000    0.000 fromnumeric.py:3152(ndim)\r\n"]
[162.266718, "o", "        1    0.000    0.000    0.000    0.000 <__array_function__ internals>:177(all)\r\n"]
[162.277282, "o", "        1    0.000    0.000    0.000    0.000 generic.py:1685(_check_label_or_level_ambiguity)\r\n"]
[162.287846, "o", "        2    0.000    0.000    0.000    0.000 dtypes.py:1241(is_dtype)\r\n"]
[162.29841, "o", "        2    0.000    0.000    0.000    0.000 missing.py:625(na_value_for_dtype)\r\n"]
[162.308974, "o", "        3    0.000    0.000    0.000    0.000 _weakrefset.py:36(__init__)\r\n"]
[162.319538, "o", "        2    0.000    0.000    0.000    0.000 base.py:5949(_maybe_promote)\r\n"]
[162.330103, "o", "       12    0.000    0.000    0.000    0.000 base.py:56(<genexpr>)\r\n"]
[162.340667, "o", "        4    0.000    0.000    0.000    0.000 ops.py:830(names)\r\n"]
[162.351231, "o", "        7    0.000    0.000    0.000    0.000 abc.py:96(__instancecheck__)\r\n"]
[162.361795, "o", "        2    0.000    0.000    0.000    0.000 numerictypes.py:356(issubdtype)\r\n"]
[162.372359, "o", "        1    0.000    0.000    0.000    0.000 multi.py:782(__len__)\r\n"]
[162.382923, "o", "        1    0.000    0.000    0.000    0.000 base.py:3585(get_loc)\r\n"]
[162.393487, "o", "        1    0.000    0.000    0.000    0.000 <__array_function__ internals>:177(copyto)\r\n"]
[162.404051, "o", "        9    0.000    0.000    0.000    0.000 {built-in method numpy.empty}\r\n"]
[162.414615, "o", "        1    0.000    0.000    0.000    0.000 construction.py:128(<listcomp>)\r\n"]
[162.425179, "o", "        1    0.000    0.000    0.000    0.000 _asarray.py:31(require)\r\n"]
[162.435744, "o", "        2    0.000    0.000    0.000    0.000 common.py:651(is_integer_dtype)\r\n"]
[162.446308, "o", "        1    0.000    0.000    0.000    0.000 _ufunc_config.py:435(__exit__)\r\n"]
[162.456872, "o", "        3    0.000    0.000    0.000    0.000 base.py:7109(maybe_extract_name)\r\n"]
[162.467436, "o", "        1    0.000    0.000    0.000    0.000 config.py:116(_get_single_key)\r\n"]
[162.478, "o", "       41    0.000    0.000    0.000    0.000 {built-in method builtins.issubclass}\r\n"]
[162.488564, "o", "        2    0.000    0.000    0.000    0.000 warnings.py:181(_add_filter)\r\n"]
[162.499128, "o", "        1    0.000    0.000    0.000    0.000 fromnumeric.py:2432(all)\r\n"]
[162.509692, "o", "        2    0.000    0.000    0.000    0.000 base.py:7144(unpack_nested_dtype)\r\n"]
[162.520256, "o", "        1    0.000    0.000    0.000    0.000 categorical.py:733(codes)\r\n"]
[162.530821, "o", "        2    0.000    0.000    0.000    0.000 fromnumeric.py:1781(ravel)\r\n"]
[162.541385, "o", "        1    0.000    0.000    0.000    0.000 grouper.py:1021(_convert_grouper)\r\n"]
[162.551949, "o", "        1    0.000    0.000    0.000    0.000 frozen.py:73(__getitem__)\r\n"]
[162.562513, "o", "       24    0.000    0.000    0.000    0.000 {pandas._libs.algos.ensure_platform_int}\r\n"]
[162.573077, "o", "        1    0.000    0.000    0.000    0.000 {method 'max' of 'numpy.ndarray' objects}\r\n"]
[162.583641, "o", "        2    0.000    0.000    0.000    0.000 frame.py:3659(_iter_column_arrays)\r\n"]
[162.594205, "o", "        7    0.000    0.000    0.000    0.000 inference.py:189(is_array_like)\r\n"]
[162.604769, "o", "       28    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}\r\n"]
[162.615333, "o", "        6    0.000    0.000    0.000    0.000 base.py:120(_reset_cache)\r\n"]
[162.625897, "o", "        6    0.000    0.000    0.000    0.000 generic.py:520(_get_axis)\r\n"]
[162.636462, "o", "        6    0.000    0.000    0.000    0.000 common.py:151(<lambda>)\r\n"]
[162.647026, "o", "        1    0.000    0.000    0.000    0.000 multi.py:796(levels)\r\n"]
[162.65759, "o", "        2    0.000    0.000    0.000    0.000 _ufunc_config.py:132(geterr)\r\n"]
[162.668154, "o", "        7    0.000    0.000    0.000    0.000 {built-in method _abc._abc_instancecheck}\r\n"]
[162.678718, "o", "        1    0.000    0.000    0.000    0.000 series.py:367(__init__)\r\n"]
[162.689282, "o", "        3    0.000    0.000    0.000    0.000 _weakrefset.py:38(_remove)\r\n"]
[162.699846, "o", "        1    0.000    0.000    0.000    0.000 objects.py:288(__init__)\r\n"]
[162.71041, "o", "        1    0.000    0.000    0.000    0.000 _methods.py:39(_amax)\r\n"]
[162.720974, "o", "        2    0.000    0.000    0.000    0.000 inference.py:267(is_dict_like)\r\n"]
[162.731538, "o", "        2    0.000    0.000    0.000    0.000 common.py:1206(is_float_dtype)\r\n"]
[162.742103, "o", "        1    0.000    0.000    0.000    0.000 grouper.py:619(_passed_categorical)\r\n"]
[162.752667, "o", "        6    0.000    0.000    0.000    0.000 common.py:1074(needs_i8_conversion)\r\n"]
[162.763231, "o", "        1    0.000    0.000    0.000    0.000 rolling.py:230(_validate_numeric_only)\r\n"]
[162.773795, "o", "       14    0.000    0.000    0.000    0.000 base.py:780(_reset_identity)\r\n"]
[162.784359, "o", "        1    0.000    0.000    0.000    0.000 rolling.py:379(_insert_on_column)\r\n"]
[162.794923, "o", "        2    0.000    0.000    0.000    0.000 base.py:432(_engine_type)\r\n"]
[162.805487, "o", "        3    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:1017(_handle_fromlist)\r\n"]
[162.816051, "o", "        1    0.000    0.000    0.000    0.000 rolling.py:162(_validate)\r\n"]
[162.826615, "o", "        6    0.000    0.000    0.000    0.000 common.py:1386(is_ea_or_datetimelike_dtype)\r\n"]
[162.837179, "o", "        4    0.000    0.000    0.000    0.000 numerictypes.py:282(issubclass_)\r\n"]
[162.847744, "o", "        8    0.000    0.000    0.000    0.000 _methods.py:103(_clip_dep_is_byte_swapped)\r\n"]
[162.858308, "o", "        1    0.000    0.000    0.000    0.000 base.py:1634(_set_names)\r\n"]
[162.868872, "o", "        1    0.000    0.000    0.000    0.000 series.py:1262(_set_as_cached)\r\n"]
[162.879436, "o", "        4    0.000    0.000    0.000    0.000 _weakrefset.py:81(add)\r\n"]
[162.89, "o", "        2    0.000    0.000    0.000    0.000 warnings.py:458(__enter__)\r\n"]
[162.900564, "o", "        3    0.000    0.000    0.000    0.000 _weakrefset.py:116(update)\r\n"]
[162.911128, "o", "        3    0.000    0.000    0.000    0.000 base.py:2623(_is_multi)\r\n"]
[162.921692, "o", "        6    0.000    0.000    0.000    0.000 take.py:325(_get_take_nd_function)\r\n"]
[162.932256, "o", "       10    0.000    0.000    0.000    0.000 common.py:143(<lambda>)\r\n"]
[162.942821, "o", "        2    0.000    0.000    0.000    0.000 base.py:2641(_na_value)\r\n"]
[162.953385, "o", "        4    0.000    0.000    0.000    0.000 ops.py:832(<listcomp>)\r\n"]
[162.963949, "o", "        3    0.000    0.000    0.000    0.000 base.py:1631(_get_names)\r\n"]
[162.974513, "o", "        1    0.000    0.000    0.000    0.000 multi.py:801(<listcomp>)\r\n"]
[162.985077, "o", "       16    0.000    0.000    0.000    0.000 {built-in method __new__ of type object at 0x55cac2099680}\r\n"]
[162.995641, "o", "        7    0.000    0.000    0.000    0.000 inference.py:328(is_hashable)\r\n"]
[163.006205, "o", "        4    0.000    0.000    0.000    0.000 common.py:1332(is_extension_array_dtype)\r\n"]
[163.016769, "o", "        3    0.000    0.000    0.000    0.000 {built-in method builtins.all}\r\n"]
[163.027333, "o", "        1    0.000    0.000    0.000    0.000 frame.py:3649(_get_column_array)\r\n"]
[163.037897, "o", "        2    0.000    0.000    0.000    0.000 frame.py:903(shape)\r\n"]
[163.048462, "o", "        2    0.000    0.000    0.000    0.000 algorithms.py:231(_ensure_arraylike)\r\n"]
[163.059026, "o", "        3    0.000    0.000    0.000    0.000 construction.py:650(_sanitize_ndim)\r\n"]
[163.06959, "o", "       12    0.000    0.000    0.000    0.000 generic.py:506(_get_axis_number)\r\n"]
[163.080154, "o", "        2    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}\r\n"]
[163.090718, "o", "        1    0.000    0.000    0.000    0.000 rolling.py:404(_index_array)\r\n"]
[163.101282, "o", "        2    0.000    0.000    0.000    0.000 managers.py:974(from_blocks)\r\n"]
[163.111846, "o", "        1    0.000    0.000    0.000    0.000 managers.py:1775(_consolidate_inplace)\r\n"]
[163.12241, "o", "        1    0.000    0.000    0.000    0.000 series.py:691(_values)\r\n"]
[163.132974, "o", "        1    0.000    0.000    0.000    0.000 base.py:2664(hasnans)\r\n"]
[163.143538, "o", "        5    0.000    0.000    0.000    0.000 {built-in method numpy.asanyarray}\r\n"]
[163.154103, "o", "        4    0.000    0.000    0.000    0.000 common.py:150(cast_scalar_indexer)\r\n"]
[163.164667, "o", "        2    0.000    0.000    0.000    0.000 copy.py:66(copy)\r\n"]
[163.175231, "o", "        1    0.000    0.000    0.000    0.000 managers.py:1053(iget_values)\r\n"]
[163.185795, "o", "        4    0.000    0.000    0.000    0.000 flags.py:49(__init__)\r\n"]
[163.196359, "o", "        1    0.000    0.000    0.000    0.000 config.py:595(_get_root)\r\n"]
[163.206923, "o", "        6    0.000    0.000    0.000    0.000 __init__.py:33(using_copy_on_write)\r\n"]
[163.217487, "o", "        4    0.000    0.000    0.000    0.000 dtypes.py:492(validate_ordered)\r\n"]
[163.228051, "o", "        1    0.000    0.000    0.000    0.000 base.py:740(_rename)\r\n"]
[163.238615, "o", "        4    0.000    0.000    0.000    0.000 common.py:274(is_datetime64_dtype)\r\n"]
[163.249179, "o", "        3    0.000    0.000    0.000    0.000 objects.py:46(__init__)\r\n"]
[163.259744, "o", "        4    0.000    0.000    0.000    0.000 common.py:1649(pandas_dtype)\r\n"]
[163.270308, "o", "        6    0.000    0.000    0.000    0.000 range.py:889(__len__)\r\n"]
[163.280872, "o", "        3    0.000    0.000    0.000    0.000 flags.py:85(allows_duplicate_labels)\r\n"]
[163.291436, "o", "        3    0.000    0.000    0.000    0.000 base.py:541(_ensure_array)\r\n"]
[163.302, "o", "        2    0.000    0.000    0.000    0.000 common.py:1432(_is_dtype)\r\n"]
[163.312564, "o", "        1    0.000    0.000    0.000    0.000 blocks.py:2211(get_block_type)\r\n"]
[163.323128, "o", "        2    0.000    0.000    0.000    0.000 missing.py:455(array_equivalent)\r\n"]
[163.333692, "o", "        2    0.000    0.000    0.000    0.000 {method 'remove' of 'list' objects}\r\n"]
[163.344256, "o", "        3    0.000    0.000    0.000    0.000 construction.py:689(_sanitize_str_dtypes)\r\n"]
[163.354821, "o", "        1    0.000    0.000    0.000    0.000 categorical.py:697(categories)\r\n"]
[163.365385, "o", "        1    0.000    0.000    0.000    0.000 ops.py:821(codes)\r\n"]
[163.375949, "o", "        6    0.000    0.000    0.000    0.000 common.py:146(classes_and_not_datetimelike)\r\n"]
[163.386513, "o", "        2    0.000    0.000    0.000    0.000 {built-in method numpy.array}\r\n"]
[163.397077, "o", "        1    0.000    0.000    0.000    0.000 managers.py:2125(_grouping_func)\r\n"]
[163.407641, "o", "        2    0.000    0.000    0.000    0.000 warnings.py:437(__init__)\r\n"]
[163.418205, "o", "        5    0.000    0.000    0.000    0.000 _dtype.py:24(_kind_name)\r\n"]
[163.428769, "o", "       11    0.000    0.000    0.000    0.000 ops.py:699(groupings)\r\n"]
[163.439333, "o", "        1    0.000    0.000    0.000    0.000 _asarray.py:112(<setcomp>)\r\n"]
[163.449897, "o", "        1    0.000    0.000    0.000    0.000 rolling.py:220(_slice_axis_for_step)\r\n"]
[163.460462, "o", "       10    0.000    0.000    0.000    0.000 common.py:141(classes)\r\n"]
[163.471026, "o", "        1    0.000    0.000    0.000    0.000 managers.py:1757(is_consolidated)\r\n"]
[163.48159, "o", "        1    0.000    0.000    0.000    0.000 common.py:1624(validate_all_hashable)\r\n"]
[163.492154, "o", "        1    0.000    0.000    0.000    0.000 config.py:648(_warn_if_deprecated)\r\n"]
[163.502718, "o", "        2    0.000    0.000    0.000    0.000 range.py:307(dtype)\r\n"]
[163.513282, "o", "        2    0.000    0.000    0.000    0.000 missing.py:949(clean_reindex_fill_method)\r\n"]
[163.523846, "o", "       11    0.000    0.000    0.000    0.000 base.py:324(ndim)\r\n"]
[163.53441, "o", "        1    0.000    0.000    0.000    0.000 managers.py:1961(internal_values)\r\n"]
[163.544974, "o", "        6    0.000    0.000    0.000    0.000 inference.py:294(<genexpr>)\r\n"]
[163.555538, "o", "        1    0.000    0.000    0.000    0.000 base.py:2070(_can_hold_na)\r\n"]
[163.566103, "o", "        8    0.000    0.000    0.000    0.000 base.py:1545(name)\r\n"]
[163.576667, "o", "        1    0.000    0.000    0.000    0.000 managers.py:2273(_preprocess_slice_or_indexer)\r\n"]
[163.587231, "o", "        2    0.000    0.000    0.000    0.000 grouper.py:891(<genexpr>)\r\n"]
[163.597795, "o", "        2    0.000    0.000    0.000    0.000 warnings.py:477(__exit__)\r\n"]
[163.608359, "o", "        1    0.000    0.000    0.000    0.000 indexing.py:2606(check_dict_or_set_indexers)\r\n"]
[163.618923, "o", "        1    0.000    0.000    0.000    0.000 rolling.py:724(<listcomp>)\r\n"]
[163.629487, "o", "        3    0.000    0.000    0.000    0.000 construction.py:464(ensure_wrapped_if_datetimelike)\r\n"]
[163.640051, "o", "        2    0.000    0.000    0.000    0.000 {built-in method numpy.seterrobj}\r\n"]
[163.650615, "o", "        4    0.000    0.000    0.000    0.000 common.py:350(is_timedelta64_dtype)\r\n"]
[163.661179, "o", "        1    0.000    0.000    0.000    0.000 multi.py:506(<listcomp>)\r\n"]
[163.671744, "o", "        1    0.000    0.000    0.000    0.000 grouper.py:623(name)\r\n"]
[163.682308, "o", "        1    0.000    0.000    0.000    0.000 ops.py:685(__init__)\r\n"]
[163.692872, "o", "        7    0.000    0.000    0.000    0.000 generic.py:620(ndim)\r\n"]
[163.703436, "o", "        6    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}\r\n"]
[163.714, "o", "        1    0.000    0.000    0.000    0.000 generic.py:596(_info_axis)\r\n"]
[163.724564, "o", "        2    0.000    0.000    0.000    0.000 {method 'copy' of 'numpy.ndarray' objects}\r\n"]
[163.735128, "o", "        1    0.000    0.000    0.000    0.000 ops.py:824(<listcomp>)\r\n"]
[163.745692, "o", "        2    0.000    0.000    0.000    0.000 config.py:609(_get_deprecated_option)\r\n"]
[163.756256, "o", "        6    0.000    0.000    0.000    0.000 base.py:898(dtype)\r\n"]
[163.766821, "o", "        1    0.000    0.000    0.000    0.000 ops.py:790(<listcomp>)\r\n"]
[163.777385, "o", "        2    0.000    0.000    0.000    0.000 blocks.py:824(iget)\r\n"]
[163.787949, "o", "        1    0.000    0.000    0.000    0.000 rolling.py:264(_create_data)\r\n"]
[163.798513, "o", "        9    0.000    0.000    0.000    0.000 {built-in method builtins.hash}\r\n"]
[163.809077, "o", "        1    0.000    0.000    0.000    0.000 rolling.py:312(__getattr__)\r\n"]
[163.819641, "o", "        2    0.000    0.000    0.000    0.000 base.py:749(is_)\r\n"]
[163.830205, "o", "        1    0.000    0.000    0.000    0.000 sorting.py:144(_int64_cut_off)\r\n"]
[163.840769, "o", "        4    0.000    0.000    0.000    0.000 {method 'view' of 'numpy.ndarray' objects}\r\n"]
[163.851333, "o", "        4    0.000    0.000    0.000    0.000 {built-in method numpy.geterrobj}\r\n"]
[163.861897, "o", "        1    0.000    0.000    0.000    0.000 ops.py:826(levels)\r\n"]
[163.872462, "o", "        4    0.000    0.000    0.000    0.000 multi.py:943(nlevels)\r\n"]
[163.883026, "o", "        1    0.000    0.000    0.000    0.000 generic.py:526(_get_block_manager_axis)\r\n"]
[163.89359, "o", "        3    0.000    0.000    0.000    0.000 fromnumeric.py:70(<dictcomp>)\r\n"]
[163.904154, "o", "        1    0.000    0.000    0.000    0.000 grouper.py:943(is_in_obj)\r\n"]
[163.914718, "o", "        1    0.000    0.000    0.000    0.000 rolling.py:205(_check_window_bounds)\r\n"]
[163.925282, "o", "        1    0.000    0.000    0.000    0.000 _validators.py:222(validate_bool_kwarg)\r\n"]
[163.935846, "o", "        2    0.000    0.000    0.000    0.000 sorting.py:608(<genexpr>)\r\n"]
[163.94641, "o", "        9    0.000    0.000    0.000    0.000 {method 'append' of 'list' objects}\r\n"]
[163.956974, "o", "        2    0.000    0.000    0.000    0.000 grouper.py:893(<genexpr>)\r\n"]
[163.967538, "o", "        1    0.000    0.000    0.000    0.000 groupby.py:945(__getattr__)\r\n"]
[163.978103, "o", "        6    0.000    0.000    0.000    0.000 {pandas._libs.lib.is_bool}\r\n"]
[163.988667, "o", "        2    0.000    0.000    0.000    0.000 {method 'ravel' of 'numpy.ndarray' objects}\r\n"]
[163.999231, "o", "        1    0.000    0.000    0.000    0.000 config.py:636(_translate_key)\r\n"]
[164.009795, "o", "        1    0.000    0.000    0.000    0.000 {pandas._libs.internals.get_blkno_placements}\r\n"]
[164.020359, "o", "        1    0.000    0.000    0.000    0.000 sorting.py:157(<listcomp>)\r\n"]
[164.030923, "o", "        3    0.000    0.000    0.000    0.000 {method 'discard' of 'set' objects}\r\n"]
[164.041487, "o", "        3    0.000    0.000    0.000    0.000 {pandas._libs.lib.is_scalar}\r\n"]
[164.052051, "o", "        8    0.000    0.000    0.000    0.000 {method 'items' of 'dict' objects}\r\n"]
[164.062615, "o", "        2    0.000    0.000    0.000    0.000 grouper.py:669(codes)\r\n"]
[164.073179, "o", "        2    0.000    0.000    0.000    0.000 multi.py:1395(_get_names)\r\n"]
[164.083744, "o", "        1    0.000    0.000    0.000    0.000 groupby.py:720(_selected_obj)\r\n"]
[164.094308, "o", "        1    0.000    0.000    0.000    0.000 frame.py:4217(_clear_item_cache)\r\n"]
[164.104872, "o", "        1    0.000    0.000    0.000    0.000 managers.py:1765(_consolidate_check)\r\n"]
[164.115436, "o", "        7    0.000    0.000    0.000    0.000 typing.py:1149(cast)\r\n"]
[164.126, "o", "        1    0.000    0.000    0.000    0.000 grouper.py:927(is_in_axis)\r\n"]
[164.136564, "o", "        3    0.000    0.000    0.000    0.000 base.py:1064(_maybe_disallow_fill)\r\n"]
[164.147128, "o", "        8    0.000    0.000    0.000    0.000 fromnumeric.py:3148(_ndim_dispatcher)\r\n"]
[164.157692, "o", "        1    0.000    0.000    0.000    0.000 _ufunc_config.py:426(__init__)\r\n"]
[164.168256, "o", "        7    0.000    0.000    0.000    0.000 {method 'clear' of 'dict' objects}\r\n"]
[164.178821, "o", "        1    0.000    0.000    0.000    0.000 categorical.py:459(dtype)\r\n"]
[164.189385, "o", "        3    0.000    0.000    0.000    0.000 generic.py:335(attrs)\r\n"]
[164.199949, "o", "        2    0.000    0.000    0.000    0.000 common.py:1643(<genexpr>)\r\n"]
[164.210513, "o", "        6    0.000    0.000    0.000    0.000 multiarray.py:152(concatenate)\r\n"]
[164.221077, "o", "        1    0.000    0.000    0.000    0.000 numba_.py:18(maybe_use_numba)\r\n"]
[164.231641, "o", "        4    0.000    0.000    0.000    0.000 managers.py:179(blklocs)\r\n"]
[164.242205, "o", "        5    0.000    0.000    0.000    0.000 {method 'add' of 'set' objects}\r\n"]
[164.252769, "o", "        5    0.000    0.000    0.000    0.000 {pandas._libs.lib.is_integer}\r\n"]
[164.263333, "o", "        1    0.000    0.000    0.000    0.000 {built-in method builtins.max}\r\n"]
[164.273897, "o", "        1    0.000    0.000    0.000    0.000 categorical.py:1768(_codes)\r\n"]
[164.284462, "o", "        3    0.000    0.000    0.000    0.000 base.py:654(_constructor)\r\n"]
[164.295026, "o", "        2    0.000    0.000    0.000    0.000 frame.py:631(_constructor)\r\n"]
[164.30559, "o", "        4    0.000    0.000    0.000    0.000 {pandas._libs.lib.is_float}\r\n"]
[164.316154, "o", "        5    0.000    0.000    0.000    0.000 dtypes.py:580(categories)\r\n"]
[164.326718, "o", "        2    0.000    0.000    0.000    0.000 {method 'insert' of 'list' objects}\r\n"]
[164.337282, "o", "        3    0.000    0.000    0.000    0.000 base.py:5937(_index_as_unique)\r\n"]
[164.347846, "o", "        1    0.000    0.000    0.000    0.000 config.py:577(_select_options)\r\n"]
[164.35841, "o", "        6    0.000    0.000    0.000    0.000 generic.py:356(flags)\r\n"]
[164.368974, "o", "        6    0.000    0.000    0.000    0.000 {built-in method _warnings._filters_mutated}\r\n"]
[164.379538, "o", "        2    0.000    0.000    0.000    0.000 grouper.py:892(<genexpr>)\r\n"]
[164.390103, "o", "        1    0.000    0.000    0.000    0.000 range.py:482(equals)\r\n"]
[164.400667, "o", "        3    0.000    0.000    0.000    0.000 dtypes.py:587(ordered)\r\n"]
[164.411231, "o", "        1    0.000    0.000    0.000    0.000 frame.py:886(axes)\r\n"]
[164.421795, "o", "        4    0.000    0.000    0.000    0.000 fromnumeric.py:2107(_clip_dispatcher)\r\n"]
[164.432359, "o", "        1    0.000    0.000    0.000    0.000 common.py:367(apply_if_callable)\r\n"]
[164.442923, "o", "        2    0.000    0.000    0.000    0.000 missing.py:121(clean_fill_method)\r\n"]
[164.453487, "o", "        2    0.000    0.000    0.000    0.000 common.py:1165(<lambda>)\r\n"]
[164.464051, "o", "        1    0.000    0.000    0.000    0.000 managers.py:1799(__init__)\r\n"]
[164.474615, "o", "        1    0.000    0.000    0.000    0.000 sorting.py:227(is_int64_overflow_possible)\r\n"]
[164.485179, "o", "        1    0.000    0.000    0.000    0.000 {method 'get_loc' of 'pandas._libs.index.IndexEngine' objects}\r\n"]
[164.495744, "o", "        1    0.000    0.000    0.000    0.000 common.py:1319(is_1d_only_ea_dtype)\r\n"]
[164.506308, "o", "        3    0.000    0.000    0.000    0.000 flags.py:53(allows_duplicate_labels)\r\n"]
[164.516872, "o", "        3    0.000    0.000    0.000    0.000 managers.py:939(__init__)\r\n"]
[164.527436, "o", "        1    0.000    0.000    0.000    0.000 managers.py:224(is_single_block)\r\n"]
[164.538, "o", "        1    0.000    0.000    0.000    0.000 base.py:200(_selected_obj)\r\n"]
[164.548564, "o", "        1    0.000    0.000    0.000    0.000 range.py:248(start)\r\n"]
[164.559128, "o", "        1    0.000    0.000    0.000    0.000 ops.py:828(<listcomp>)\r\n"]
[164.569692, "o", "        3    0.000    0.000    0.000    0.000 construction.py:709(_maybe_repeat)\r\n"]
[164.580256, "o", "        1    0.000    0.000    0.000    0.000 grouper.py:1017(_is_label_like)\r\n"]
[164.590821, "o", "        1    0.000    0.000    0.000    0.000 {method 'item' of 'numpy.ndarray' objects}\r\n"]
[164.601385, "o", "        2    0.000    0.000    0.000    0.000 function_base.py:5440(_append_dispatcher)\r\n"]
[164.611949, "o", "        3    0.000    0.000    0.000    0.000 {pandas._libs.lib.is_iterator}\r\n"]
[164.622513, "o", "        2    0.000    0.000    0.000    0.000 {method 'values' of 'dict' objects}\r\n"]
[164.633077, "o", "        2    0.000    0.000    0.000    0.000 {method 'extend' of 'list' objects}\r\n"]
[164.643641, "o", "        1    0.000    0.000    0.000    0.000 function.py:60(__call__)\r\n"]
[164.654205, "o", "        1    0.000    0.000    0.000    0.000 managers.py:1894(_block)\r\n"]
[164.664769, "o", "        1    0.000    0.000    0.000    0.000 {pandas._libs.lib.item_from_zerodim}\r\n"]
[164.675333, "o", "        1    0.000    0.000    0.000    0.000 ops.py:791(<listcomp>)\r\n"]
[164.685897, "o", "        1    0.000    0.000    0.000    0.000 grouper.py:641(_ilevel)\r\n"]
[164.696462, "o", "        2    0.000    0.000    0.000    0.000 fromnumeric.py:1777(_ravel_dispatcher)\r\n"]
[164.707026, "o", "        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}\r\n"]
[164.71759, "o", "        2    0.000    0.000    0.000    0.000 fromnumeric.py:2950(_prod_dispatcher)\r\n"]
[164.728154, "o", "        1    0.000    0.000    0.000    0.000 range.py:195(_constructor)\r\n"]
[164.738718, "o", "        1    0.000    0.000    0.000    0.000 blocks.py:476(dtype)\r\n"]
[164.749282, "o", "        2    0.000    0.000    0.000    0.000 multi.py:978(codes)\r\n"]
[164.759846, "o", "        1    0.000    0.000    0.000    0.000 {method 'upper' of 'str' objects}\r\n"]
[164.77041, "o", "        1    0.000    0.000    0.000    0.000 {method 'split' of 'str' objects}\r\n"]
[164.780974, "o", "        1    0.000    0.000    0.000    0.000 managers.py:229(items)\r\n"]
[164.791538, "o", "        1    0.000    0.000    0.000    0.000 {pandas._libs.algos.ensure_float64}\r\n"]
[164.802103, "o", "        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}\r\n"]
[164.812667, "o", "        1    0.000    0.000    0.000    0.000 range.py:263(step)\r\n"]
[164.823231, "o", "        1    0.000    0.000    0.000    0.000 series.py:594(name)\r\n"]
[164.833795, "o", "        1    0.000    0.000    0.000    0.000 function_base.py:5050(_delete_dispatcher)\r\n"]
[164.844359, "o", "        1    0.000    0.000    0.000    0.000 generic.py:1706(<genexpr>)\r\n"]
[164.854923, "o", "        1    0.000    0.000    0.000    0.000 fromnumeric.py:2427(_all_dispatcher)\r\n"]
[164.865487, "o", "        2    0.000    0.000    0.000    0.000 {method 'copy' of 'list' objects}\r\n"]
[164.876051, "o", "        1    0.000    0.000    0.000    0.000 range.py:256(stop)\r\n"]
[164.886615, "o", "        1    0.000    0.000    0.000    0.000 base.py:6298(_maybe_cast_indexer)\r\n"]
[164.897179, "o", "        1    0.000    0.000    0.000    0.000 {method 'pop' of 'dict' objects}\r\n"]
[164.907744, "o", "        1    0.000    0.000    0.000    0.000 {pandas._libs.algos.ensure_int64}\r\n"]
[164.918308, "o", "        1    0.000    0.000    0.000    0.000 multiarray.py:1079(copyto)\r\n"]
[164.928872, "o", "        1    0.000    0.000    0.000    0.000 {function FrozenList.__getitem__ at 0x7f24aba84280}\r\n"]
[164.939436, "o", "\r\n"]
[165.0, "o", "(asv_3.8) root@cb2cc1765c92:/workspace/repo/asv_bench# "]
[165.002, "i", "grep -n \"_create_data\\|_grouper\\|MultiIndex\\|indices.values\\|np.concatenate\" ../pandas/core/window/rolling\r"]
[165.004, "o", "grep -n \"_create_data\\|_grouper\\|MultiIndex\\|indices.values\\|np.concatenate\" ../pandas/core/window/rolling\r\n"]
[165.111191, "o", "g.py\r\n"]
[165.216383, "o", "\u001b[?2004l\r\n"]
[165.321574, "o", "\u001b[32m\u001b[K70\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K    \u001b[01;31m\u001b[KMultiIndex\u001b[m\u001b[K,\r\n"]
[165.426766, "o", "\u001b[32m\u001b[K264\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K    def \u001b[01;31m\u001b[K_create_data\u001b[m\u001b[K(self, obj: NDFrameT, numeric_only: bool = False) -> NDFrameT:\r\n"]
[165.531957, "o", "\u001b[32m\u001b[K339\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K        obj = self.\u001b[01;31m\u001b[K_create_data\u001b[m\u001b[K(obj)\r\n"]
[165.637149, "o", "\u001b[32m\u001b[K406\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K        # TODO: why do we get here with e.g. \u001b[01;31m\u001b[KMultiIndex\u001b[m\u001b[K?\r\n"]
[165.74234, "o", "\u001b[32m\u001b[K442\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K        obj = self.\u001b[01;31m\u001b[K_create_data\u001b[m\u001b[K(self._selected_obj)\r\n"]
[165.847532, "o", "\u001b[32m\u001b[K470\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K        obj = self.\u001b[01;31m\u001b[K_create_data\u001b[m\u001b[K(self._selected_obj, numeric_only)\r\n"]
[165.952723, "o", "\u001b[32m\u001b[K520\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K        obj = self.\u001b[01;31m\u001b[K_create_data\u001b[m\u001b[K(self._selected_obj, numeric_only)\r\n"]
[166.057915, "o", "\u001b[32m\u001b[K546\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K        target = self.\u001b[01;31m\u001b[K_create_data\u001b[m\u001b[K(target, numeric_only)\r\n"]
[166.163106, "o", "\u001b[32m\u001b[K631\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K        obj = self.\u001b[01;31m\u001b[K_create_data\u001b[m\u001b[K(self._selected_obj)\r\n"]
[166.268298, "o", "\u001b[32m\u001b[K674\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K    \u001b[01;31m\u001b[K_grouper\u001b[m\u001b[K: BaseGrouper\r\n"]
[166.373489, "o", "\u001b[32m\u001b[K676\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K    _attributes: list[str] = [\"\u001b[01;31m\u001b[K_grouper\u001b[m\u001b[K\"]\r\n"]
[166.478681, "o", "\u001b[32m\u001b[K682\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K        \u001b[01;31m\u001b[K_grouper\u001b[m\u001b[K: BaseGrouper,\r\n"]
[166.583872, "o", "\u001b[32m\u001b[K688\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K        if not isinstance(\u001b[01;31m\u001b[K_grouper\u001b[m\u001b[K, BaseGrouper):\r\n"]
[166.689064, "o", "\u001b[32m\u001b[K690\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K        self.\u001b[01;31m\u001b[K_grouper\u001b[m\u001b[K = \u001b[01;31m\u001b[K_grouper\u001b[m\u001b[K\r\n"]
[166.794255, "o", "\u001b[32m\u001b[K695\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K        obj = obj.drop(columns=self.\u001b[01;31m\u001b[K_grouper\u001b[m\u001b[K.names, errors=\"ignore\")\r\n"]
[166.899447, "o", "\u001b[32m\u001b[K716\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K        # Reconstruct the resulting \u001b[01;31m\u001b[KMultiIndex\u001b[m\u001b[K\r\n"]
[167.004638, "o", "\u001b[32m\u001b[K721\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K        groupby_keys = copy.copy(self.\u001b[01;31m\u001b[K_grouper\u001b[m\u001b[K.names)\r\n"]
[167.10983, "o", "\u001b[32m\u001b[K726\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K            for key in self.\u001b[01;31m\u001b[K_grouper\u001b[m\u001b[K.names\r\n"]
[167.215021, "o", "\u001b[32m\u001b[K734\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K        codes = self.\u001b[01;31m\u001b[K_grouper\u001b[m\u001b[K.codes\r\n"]
[167.320213, "o", "\u001b[32m\u001b[K735\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K        levels = copy.copy(self.\u001b[01;31m\u001b[K_grouper\u001b[m\u001b[K.levels)\r\n"]
[167.425404, "o", "\u001b[32m\u001b[K737\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K        group_indices = self.\u001b[01;31m\u001b[K_grouper\u001b[m\u001b[K.\u001b[01;31m\u001b[Kindices.values\u001b[m\u001b[K()\r\n"]
[167.530596, "o", "\u001b[32m\u001b[K739\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K            indexer = \u001b[01;31m\u001b[Knp.concatenate\u001b[m\u001b[K(list(group_indices))\r\n"]
[167.635787, "o", "\u001b[32m\u001b[K748\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K            if not isinstance(idx, \u001b[01;31m\u001b[KMultiIndex\u001b[m\u001b[K):\r\n"]
[167.740979, "o", "\u001b[32m\u001b[K749\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K                idx = \u001b[01;31m\u001b[KMultiIndex\u001b[m\u001b[K.from_arrays([idx])\r\n"]
[167.84617, "o", "\u001b[32m\u001b[K753\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K        result_index = \u001b[01;31m\u001b[KMultiIndex\u001b[m\u001b[K(\r\n"]
[167.951362, "o", "\u001b[32m\u001b[K774\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K        target = target.drop(columns=self.\u001b[01;31m\u001b[K_grouper\u001b[m\u001b[K.names, errors=\"ignore\")\r\n"]
[168.056553, "o", "\u001b[32m\u001b[K778\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K            len(group) == len(other) for group in self.\u001b[01;31m\u001b[K_grouper\u001b[m\u001b[K.\u001b[01;31m\u001b[Kindices.values\u001b[m\u001b[K()\r\n"]
[168.161745, "o", "\u001b[32m\u001b[K788\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K                    for gb_indices in self.\u001b[01;31m\u001b[K_grouper\u001b[m\u001b[K.\u001b[01;31m\u001b[Kindices.values\u001b[m\u001b[K()\r\n"]
[168.266936, "o", "\u001b[32m\u001b[K793\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K                com.maybe_make_list(pair) for pair in self.\u001b[01;31m\u001b[K_grouper\u001b[m\u001b[K.indices.keys()\r\n"]
[168.372128, "o", "\u001b[32m\u001b[K806\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K            groupby_codes = self.\u001b[01;31m\u001b[K_grouper\u001b[m\u001b[K.codes\r\n"]
[168.477319, "o", "\u001b[32m\u001b[K809\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K            groupby_levels = self.\u001b[01;31m\u001b[K_grouper\u001b[m\u001b[K.levels  # type: ignore[assignment]\r\n"]
[168.582511, "o", "\u001b[32m\u001b[K811\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K            group_indices = self.\u001b[01;31m\u001b[K_grouper\u001b[m\u001b[K.\u001b[01;31m\u001b[Kindices.values\u001b[m\u001b[K()\r\n"]
[168.687702, "o", "\u001b[32m\u001b[K813\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K                indexer = \u001b[01;31m\u001b[Knp.concatenate\u001b[m\u001b[K(list(group_indices))\r\n"]
[168.792894, "o", "\u001b[32m\u001b[K825\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K        if isinstance(result.index, \u001b[01;31m\u001b[KMultiIndex\u001b[m\u001b[K):\r\n"]
[168.898085, "o", "\u001b[32m\u001b[K838\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K        result_names = self.\u001b[01;31m\u001b[K_grouper\u001b[m\u001b[K.names + result_names\r\n"]
[169.003277, "o", "\u001b[32m\u001b[K840\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K        result_index = \u001b[01;31m\u001b[KMultiIndex\u001b[m\u001b[K(\r\n"]
[169.108468, "o", "\u001b[32m\u001b[K846\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K    def \u001b[01;31m\u001b[K_create_data\u001b[m\u001b[K(self, obj: NDFrameT, numeric_only: bool = False) -> NDFrameT:\r\n"]
[169.21366, "o", "\u001b[32m\u001b[K854\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K            groupby_order = \u001b[01;31m\u001b[Knp.concatenate\u001b[m\u001b[K(list(self.\u001b[01;31m\u001b[K_grouper\u001b[m\u001b[K.\u001b[01;31m\u001b[Kindices.values\u001b[m\u001b[K())).astype(\r\n"]
[169.318851, "o", "\u001b[32m\u001b[K858\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K        return super().\u001b[01;31m\u001b[K_create_data\u001b[m\u001b[K(obj, numeric_only)\r\n"]
[169.424043, "o", "\u001b[32m\u001b[K1206\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K                x = \u001b[01;31m\u001b[Knp.concatenate\u001b[m\u001b[K((x, additional_nans))\r\n"]
[169.529234, "o", "\u001b[32m\u001b[K2523\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K            output will be a \u001b[01;31m\u001b[KMultiIndex\u001b[m\u001b[Ked DataFrame in the case of DataFrame\r\n"]
[169.634426, "o", "\u001b[32m\u001b[K2566\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K            output will be a \u001b[01;31m\u001b[KMultiIndex\u001b[m\u001b[Ked DataFrame in the case of DataFrame\r\n"]
[169.739617, "o", "\u001b[32m\u001b[K2601\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K        When `pairwise` is set to `True`, the output will be a \u001b[01;31m\u001b[KMultiIndex\u001b[m\u001b[K DataFrame\r\n"]
[169.844809, "o", "\u001b[32m\u001b[K2724\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K            groupby_indices=self.\u001b[01;31m\u001b[K_grouper\u001b[m\u001b[K.indices,\r\n"]
[170.0, "o", "(asv_3.8) root@cb2cc1765c92:/workspace/repo/asv_bench# "]
[170.002, "i", "sed -n '1,260p' ../pandas/core/window/rolling.py\r"]
[170.004, "o", "sed -n '1,260p' ../pandas/core/window/rolling.py\r\n"]
[170.024943, "o", "\u001b[?2004l\r\n"]
[170.043885, "o", "\"\"\"\r\n"]
[170.062828, "o", "Provide a generic structure to support window functions,\r\n"]
[170.08177, "o", "similar to how we have a Groupby object.\r\n"]
[170.100713, "o", "\"\"\"\r\n"]
[170.119655, "o", "from __future__ import annotations\r\n"]
[170.138598, "o", "\r\n"]
[170.15754, "o", "import copy\r\n"]
[170.176483, "o", "from datetime import timedelta\r\n"]
[170.195425, "o", "from functools import partial\r\n"]
[170.214368, "o", "import inspect\r\n"]
[170.23331, "o", "from textwrap import dedent\r\n"]
[170.252253, "o", "from typing import (\r\n"]
[170.271195, "o", "    TYPE_CHECKING,\r\n"]
[170.290138, "o", "    Any,\r\n"]
[170.30908, "o", "    Callable,\r\n"]
[170.328023, "o", "    Hashable,\r\n"]
[170.346966, "o", "    Iterator,\r\n"]
[170.365908, "o", "    Sized,\r\n"]
[170.384851, "o", "    cast,\r\n"]
[170.403793, "o", ")\r\n"]
[170.422736, "o", "\r\n"]
[170.441678, "o", "import numpy as np\r\n"]
[170.460621, "o", "\r\n"]
[170.479563, "o", "from pandas._libs.tslibs import (\r\n"]
[170.498506, "o", "    BaseOffset,\r\n"]
[170.517448, "o", "    to_offset,\r\n"]
[170.536391, "o", ")\r\n"]
[170.555333, "o", "import pandas._libs.window.aggregations as window_aggregations\r\n"]
[170.574276, "o", "from pandas._typing import (\r\n"]
[170.593218, "o", "    ArrayLike,\r\n"]
[170.612161, "o", "    Axis,\r\n"]
[170.631103, "o", "    NDFrameT,\r\n"]
[170.650046, "o", "    QuantileInterpolation,\r\n"]
[170.668989, "o", "    WindowingRankType,\r\n"]
[170.687931, "o", ")\r\n"]
[170.706874, "o", "from pandas.compat._optional import import_optional_dependency\r\n"]
[170.725816, "o", "from pandas.errors import DataError\r\n"]
[170.744759, "o", "from pandas.util._decorators import doc\r\n"]
[170.763701, "o", "\r\n"]
[170.782644, "o", "from pandas.core.dtypes.common import (\r\n"]
[170.801586, "o", "    ensure_float64,\r\n"]
[170.820529, "o", "    is_bool,\r\n"]
[170.839471, "o", "    is_integer,\r\n"]
[170.858414, "o", "    is_list_like,\r\n"]
[170.877356, "o", "    is_numeric_dtype,\r\n"]
[170.896299, "o", "    is_scalar,\r\n"]
[170.915241, "o", "    needs_i8_conversion,\r\n"]
[170.934184, "o", ")\r\n"]
[170.953126, "o", "from pandas.core.dtypes.generic import (\r\n"]
[170.972069, "o", "    ABCDataFrame,\r\n"]
[170.991011, "o", "    ABCSeries,\r\n"]
[171.009954, "o", ")\r\n"]
[171.028897, "o", "from pandas.core.dtypes.missing import notna\r\n"]
[171.047839, "o", "\r\n"]
[171.066782, "o", "from pandas.core._numba import executor\r\n"]
[171.085724, "o", "from pandas.core.algorithms import factorize\r\n"]
[171.104667, "o", "from pandas.core.apply import ResamplerWindowApply\r\n"]
[171.123609, "o", "from pandas.core.arrays import ExtensionArray\r\n"]
[171.142552, "o", "from pandas.core.base import SelectionMixin\r\n"]
[171.161494, "o", "import pandas.core.common as com\r\n"]
[171.180437, "o", "from pandas.core.indexers.objects import (\r\n"]
[171.199379, "o", "    BaseIndexer,\r\n"]
[171.218322, "o", "    FixedWindowIndexer,\r\n"]
[171.237264, "o", "    GroupbyIndexer,\r\n"]
[171.256207, "o", "    VariableWindowIndexer,\r\n"]
[171.275149, "o", ")\r\n"]
[171.294092, "o", "from pandas.core.indexes.api import (\r\n"]
[171.313034, "o", "    DatetimeIndex,\r\n"]
[171.331977, "o", "    Index,\r\n"]
[171.35092, "o", "    MultiIndex,\r\n"]
[171.369862, "o", "    PeriodIndex,\r\n"]
[171.388805, "o", "    TimedeltaIndex,\r\n"]
[171.407747, "o", ")\r\n"]
[171.42669, "o", "from pandas.core.reshape.concat import concat\r\n"]
[171.445632, "o", "from pandas.core.util.numba_ import (\r\n"]
[171.464575, "o", "    get_jit_arguments,\r\n"]
[171.483517, "o", "    maybe_use_numba,\r\n"]
[171.50246, "o", ")\r\n"]
[171.521402, "o", "from pandas.core.window.common import (\r\n"]
[171.540345, "o", "    flex_binary_moment,\r\n"]
[171.559287, "o", "    zsqrt,\r\n"]
[171.57823, "o", ")\r\n"]
[171.597172, "o", "from pandas.core.window.doc import (\r\n"]
[171.616115, "o", "    _shared_docs,\r\n"]
[171.635057, "o", "    create_section_header,\r\n"]
[171.654, "o", "    kwargs_numeric_only,\r\n"]
[171.672943, "o", "    kwargs_scipy,\r\n"]
[171.691885, "o", "    numba_notes,\r\n"]
[171.710828, "o", "    template_header,\r\n"]
[171.72977, "o", "    template_returns,\r\n"]
[171.748713, "o", "    template_see_also,\r\n"]
[171.767655, "o", "    window_agg_numba_parameters,\r\n"]
[171.786598, "o", "    window_apply_parameters,\r\n"]
[171.80554, "o", ")\r\n"]
[171.824483, "o", "from pandas.core.window.numba_ import (\r\n"]
[171.843425, "o", "    generate_manual_numpy_nan_agg_with_axis,\r\n"]
[171.862368, "o", "    generate_numba_apply_func,\r\n"]
[171.88131, "o", "    generate_numba_table_func,\r\n"]
[171.900253, "o", ")\r\n"]
[171.919195, "o", "\r\n"]
[171.938138, "o", "if TYPE_CHECKING:\r\n"]
[171.95708, "o", "    from pandas import (\r\n"]
[171.976023, "o", "        DataFrame,\r\n"]
[171.994966, "o", "        Series,\r\n"]
[172.013908, "o", "    )\r\n"]
[172.032851, "o", "    from pandas.core.generic import NDFrame\r\n"]
[172.051793, "o", "    from pandas.core.groupby.ops import BaseGrouper\r\n"]
[172.070736, "o", "\r\n"]
[172.089678, "o", "\r\n"]
[172.108621, "o", "class BaseWindow(SelectionMixin):\r\n"]
[172.127563, "o", "    \"\"\"Provides utilities for performing windowing operations.\"\"\"\r\n"]
[172.146506, "o", "\r\n"]
[172.165448, "o", "    _attributes: list[str] = []\r\n"]
[172.184391, "o", "    exclusions: frozenset[Hashable] = frozenset()\r\n"]
[172.203333, "o", "    _on: Index\r\n"]
[172.222276, "o", "\r\n"]
[172.241218, "o", "    def __init__(\r\n"]
[172.260161, "o", "        self,\r\n"]
[172.279103, "o", "        obj: NDFrame,\r\n"]
[172.298046, "o", "        window=None,\r\n"]
[172.316989, "o", "        min_periods: int | None = None,\r\n"]
[172.335931, "o", "        center: bool | None = False,\r\n"]
[172.354874, "o", "        win_type: str | None = None,\r\n"]
[172.373816, "o", "        axis: Axis = 0,\r\n"]
[172.392759, "o", "        on: str | Index | None = None,\r\n"]
[172.411701, "o", "        closed: str | None = None,\r\n"]
[172.430644, "o", "        step: int | None = None,\r\n"]
[172.449586, "o", "        method: str = \"single\",\r\n"]
[172.468529, "o", "        *,\r\n"]
[172.487471, "o", "        selection=None,\r\n"]
[172.506414, "o", "    ) -> None:\r\n"]
[172.525356, "o", "        self.obj = obj\r\n"]
[172.544299, "o", "        self.on = on\r\n"]
[172.563241, "o", "        self.closed = closed\r\n"]
[172.582184, "o", "        self.step = step\r\n"]
[172.601126, "o", "        self.window = window\r\n"]
[172.620069, "o", "        self.min_periods = min_periods\r\n"]
[172.639011, "o", "        self.center = center\r\n"]
[172.657954, "o", "        self.win_type = win_type\r\n"]
[172.676897, "o", "        self.axis = obj._get_axis_number(axis) if axis is not None else None\r\n"]
[172.695839, "o", "        self.method = method\r\n"]
[172.714782, "o", "        self._win_freq_i8: int | None = None\r\n"]
[172.733724, "o", "        if self.on is None:\r\n"]
[172.752667, "o", "            if self.axis == 0:\r\n"]
[172.771609, "o", "                self._on = self.obj.index\r\n"]
[172.790552, "o", "            else:\r\n"]
[172.809494, "o", "                # i.e. self.axis == 1\r\n"]
[172.828437, "o", "                self._on = self.obj.columns\r\n"]
[172.847379, "o", "        elif isinstance(self.on, Index):\r\n"]
[172.866322, "o", "            self._on = self.on\r\n"]
[172.885264, "o", "        elif isinstance(self.obj, ABCDataFrame) and self.on in self.obj.columns:\r\n"]
[172.904207, "o", "            self._on = Index(self.obj[self.on])\r\n"]
[172.923149, "o", "        else:\r\n"]
[172.942092, "o", "            raise ValueError(\r\n"]
[172.961034, "o", "                f\"invalid on specified as {self.on}, \"\r\n"]
[172.979977, "o", "                \"must be a column (of DataFrame), an Index or None\"\r\n"]
[172.99892, "o", "            )\r\n"]
[173.017862, "o", "\r\n"]
[173.036805, "o", "        self._selection = selection\r\n"]
[173.055747, "o", "        self._validate()\r\n"]
[173.07469, "o", "\r\n"]
[173.093632, "o", "    def _validate(self) -> None:\r\n"]
[173.112575, "o", "        if self.center is not None and not is_bool(self.center):\r\n"]
[173.131517, "o", "            raise ValueError(\"center must be a boolean\")\r\n"]
[173.15046, "o", "        if self.min_periods is not None:\r\n"]
[173.169402, "o", "            if not is_integer(self.min_periods):\r\n"]
[173.188345, "o", "                raise ValueError(\"min_periods must be an integer\")\r\n"]
[173.207287, "o", "            if self.min_periods < 0:\r\n"]
[173.22623, "o", "                raise ValueError(\"min_periods must be >= 0\")\r\n"]
[173.245172, "o", "            if is_integer(self.window) and self.min_periods > self.window:\r\n"]
[173.264115, "o", "                raise ValueError(\r\n"]
[173.283057, "o", "                    f\"min_periods {self.min_periods} must be <= window {self.window}\"\r\n"]
[173.302, "o", "                )\r\n"]
[173.320943, "o", "        if self.closed is not None and self.closed not in [\r\n"]
[173.339885, "o", "            \"right\",\r\n"]
[173.358828, "o", "            \"both\",\r\n"]
[173.37777, "o", "            \"left\",\r\n"]
[173.396713, "o", "            \"neither\",\r\n"]
[173.415655, "o", "        ]:\r\n"]
[173.434598, "o", "            raise ValueError(\"closed must be 'right', 'left', 'both' or 'neither'\")\r\n"]
[173.45354, "o", "        if not isinstance(self.obj, (ABCSeries, ABCDataFrame)):\r\n"]
[173.472483, "o", "            raise TypeError(f\"invalid type: {type(self)}\")\r\n"]
[173.491425, "o", "        if isinstance(self.window, BaseIndexer):\r\n"]
[173.510368, "o", "            # Validate that the passed BaseIndexer subclass has\r\n"]
[173.52931, "o", "            # a get_window_bounds with the correct signature.\r\n"]
[173.548253, "o", "            get_window_bounds_signature = inspect.signature(\r\n"]
[173.567195, "o", "                self.window.get_window_bounds\r\n"]
[173.586138, "o", "            ).parameters.keys()\r\n"]
[173.60508, "o", "            expected_signature = inspect.signature(\r\n"]
[173.624023, "o", "                BaseIndexer().get_window_bounds\r\n"]
[173.642966, "o", "            ).parameters.keys()\r\n"]
[173.661908, "o", "            if get_window_bounds_signature != expected_signature:\r\n"]
[173.680851, "o", "                raise ValueError(\r\n"]
[173.699793, "o", "                    f\"{type(self.window).__name__} does not implement \"\r\n"]
[173.718736, "o", "                    f\"the correct signature for get_window_bounds\"\r\n"]
[173.737678, "o", "                )\r\n"]
[173.756621, "o", "        if self.method not in [\"table\", \"single\"]:\r\n"]
[173.775563, "o", "            raise ValueError(\"method must be 'table' or 'single\")\r\n"]
[173.794506, "o", "        if self.step is not None:\r\n"]
[173.813448, "o", "            if not is_integer(self.step):\r\n"]
[173.832391, "o", "                raise ValueError(\"step must be an integer\")\r\n"]
[173.851333, "o", "            if self.step < 0:\r\n"]
[173.870276, "o", "                raise ValueError(\"step must be >= 0\")\r\n"]
[173.889218, "o", "\r\n"]
[173.908161, "o", "    def _check_window_bounds(\r\n"]
[173.927103, "o", "        self, start: np.ndarray, end: np.ndarray, num_vals: int\r\n"]
[173.946046, "o", "    ) -> None:\r\n"]
[173.964989, "o", "        if len(start) != len(end):\r\n"]
[173.983931, "o", "            raise ValueError(\r\n"]
[174.002874, "o", "                f\"start ({len(start)}) and end ({len(end)}) bounds must be the \"\r\n"]
[174.021816, "o", "                f\"same length\"\r\n"]
[174.040759, "o", "            )\r\n"]
[174.059701, "o", "        if len(start) != (num_vals + (self.step or 1) - 1) // (self.step or 1):\r\n"]
[174.078644, "o", "            raise ValueError(\r\n"]
[174.097586, "o", "                f\"start and end bounds ({len(start)}) must be the same length \"\r\n"]
[174.116529, "o", "                f\"as the object ({num_vals}) divided by the step ({self.step}) \"\r\n"]
[174.135471, "o", "                f\"if given and rounded up\"\r\n"]
[174.154414, "o", "            )\r\n"]
[174.173356, "o", "\r\n"]
[174.192299, "o", "    def _slice_axis_for_step(self, index: Index, result: Sized | None = None) -> Index:\r\n"]
[174.211241, "o", "        \"\"\"\r\n"]
[174.230184, "o", "        Slices the index for a given result and the preset step.\r\n"]
[174.249126, "o", "        \"\"\"\r\n"]
[174.268069, "o", "        return (\r\n"]
[174.287011, "o", "            index\r\n"]
[174.305954, "o", "            if result is None or len(result) == len(index)\r\n"]
[174.324897, "o", "            else index[:: self.step]\r\n"]
[174.343839, "o", "        )\r\n"]
[174.362782, "o", "\r\n"]
[174.381724, "o", "    def _validate_numeric_only(self, name: str, numeric_only: bool) -> None:\r\n"]
[174.400667, "o", "        \"\"\"\r\n"]
[174.419609, "o", "        Validate numeric_only argument, raising if invalid for the input.\r\n"]
[174.438552, "o", "\r\n"]
[174.457494, "o", "        Parameters\r\n"]
[174.476437, "o", "        ----------\r\n"]
[174.495379, "o", "        name : str\r\n"]
[174.514322, "o", "            Name of the operator (kernel).\r\n"]
[174.533264, "o", "        numeric_only : bool\r\n"]
[174.552207, "o", "            Value passed by user.\r\n"]
[174.571149, "o", "        \"\"\"\r\n"]
[174.590092, "o", "        if (\r\n"]
[174.609034, "o", "            self._selected_obj.ndim == 1\r\n"]
[174.627977, "o", "            and numeric_only\r\n"]
[174.64692, "o", "            and not is_numeric_dtype(self._selected_obj.dtype)\r\n"]
[174.665862, "o", "        ):\r\n"]
[174.684805, "o", "            raise NotImplementedError(\r\n"]
[174.703747, "o", "                f\"{type(self).__name__}.{name} does not implement numeric_only\"\r\n"]
[174.72269, "o", "            )\r\n"]
[174.741632, "o", "\r\n"]
[174.760575, "o", "    def _make_numeric_only(self, obj: NDFrameT) -> NDFrameT:\r\n"]
[174.779517, "o", "        \"\"\"Subset DataFrame to numeric columns.\r\n"]
[174.79846, "o", "\r\n"]
[174.817402, "o", "        Parameters\r\n"]
[174.836345, "o", "        ----------\r\n"]
[174.855287, "o", "        obj : DataFrame\r\n"]
[174.87423, "o", "\r\n"]
[174.893172, "o", "        Returns\r\n"]
[174.912115, "o", "        -------\r\n"]
[174.931057, "o", "        obj subset to numeric-only columns.\r\n"]
[175.0, "o", "(asv_3.8) root@cb2cc1765c92:/workspace/repo/asv_bench# "]
[175.002, "i", "sed -n '260,640p' ../pandas/core/window/rolling.py\r"]
[175.004, "o", "sed -n '260,640p' ../pandas/core/window/rolling.py\r\n"]
[175.018942, "o", "\u001b[?2004l\r\n"]
[175.031885, "o", "        \"\"\"\r\n"]
[175.044827, "o", "        result = obj.select_dtypes(include=[\"number\"], exclude=[\"timedelta\"])\r\n"]
[175.05777, "o", "        return result\r\n"]
[175.070712, "o", "\r\n"]
[175.083654, "o", "    def _create_data(self, obj: NDFrameT, numeric_only: bool = False) -> NDFrameT:\r\n"]
[175.096597, "o", "        \"\"\"\r\n"]
[175.109539, "o", "        Split data into blocks & return conformed data.\r\n"]
[175.122482, "o", "        \"\"\"\r\n"]
[175.135424, "o", "        # filter out the on from the object\r\n"]
[175.148366, "o", "        if self.on is not None and not isinstance(self.on, Index) and obj.ndim == 2:\r\n"]
[175.161309, "o", "            obj = obj.reindex(columns=obj.columns.difference([self.on]), copy=False)\r\n"]
[175.174251, "o", "        if obj.ndim > 1 and (numeric_only or self.axis == 1):\r\n"]
[175.187194, "o", "            # GH: 20649 in case of mixed dtype and axis=1 we have to convert everything\r\n"]
[175.200136, "o", "            # to float to calculate the complete row at once. We exclude all non-numeric\r\n"]
[175.213079, "o", "            # dtypes.\r\n"]
[175.226021, "o", "            obj = self._make_numeric_only(obj)\r\n"]
[175.238963, "o", "        if self.axis == 1:\r\n"]
[175.251906, "o", "            obj = obj.astype(\"float64\", copy=False)\r\n"]
[175.264848, "o", "            obj._mgr = obj._mgr.consolidate()\r\n"]
[175.277791, "o", "        return obj\r\n"]
[175.290733, "o", "\r\n"]
[175.303675, "o", "    def _gotitem(self, key, ndim, subset=None):\r\n"]
[175.316618, "o", "        \"\"\"\r\n"]
[175.32956, "o", "        Sub-classes to define. Return a sliced object.\r\n"]
[175.342503, "o", "\r\n"]
[175.355445, "o", "        Parameters\r\n"]
[175.368387, "o", "        ----------\r\n"]
[175.38133, "o", "        key : str / list of selections\r\n"]
[175.394272, "o", "        ndim : {1, 2}\r\n"]
[175.407215, "o", "            requested ndim of result\r\n"]
[175.420157, "o", "        subset : object, default None\r\n"]
[175.433099, "o", "            subset to act on\r\n"]
[175.446042, "o", "        \"\"\"\r\n"]
[175.458984, "o", "        # create a new object to prevent aliasing\r\n"]
[175.471927, "o", "        if subset is None:\r\n"]
[175.484869, "o", "            subset = self.obj\r\n"]
[175.497812, "o", "\r\n"]
[175.510754, "o", "        # we need to make a shallow copy of ourselves\r\n"]
[175.523696, "o", "        # with the same groupby\r\n"]
[175.536639, "o", "        kwargs = {attr: getattr(self, attr) for attr in self._attributes}\r\n"]
[175.549581, "o", "\r\n"]
[175.562524, "o", "        selection = None\r\n"]
[175.575466, "o", "        if subset.ndim == 2 and (\r\n"]
[175.588408, "o", "            (is_scalar(key) and key in subset) or is_list_like(key)\r\n"]
[175.601351, "o", "        ):\r\n"]
[175.614293, "o", "            selection = key\r\n"]
[175.627236, "o", "        elif subset.ndim == 1 and is_scalar(key) and key == subset.name:\r\n"]
[175.640178, "o", "            selection = key\r\n"]
[175.65312, "o", "\r\n"]
[175.666063, "o", "        new_win = type(self)(subset, selection=selection, **kwargs)\r\n"]
[175.679005, "o", "        return new_win\r\n"]
[175.691948, "o", "\r\n"]
[175.70489, "o", "    def __getattr__(self, attr: str):\r\n"]
[175.717832, "o", "        if attr in self._internal_names_set:\r\n"]
[175.730775, "o", "            return object.__getattribute__(self, attr)\r\n"]
[175.743717, "o", "        if attr in self.obj:\r\n"]
[175.75666, "o", "            return self[attr]\r\n"]
[175.769602, "o", "\r\n"]
[175.782545, "o", "        raise AttributeError(\r\n"]
[175.795487, "o", "            f\"'{type(self).__name__}' object has no attribute '{attr}'\"\r\n"]
[175.808429, "o", "        )\r\n"]
[175.821372, "o", "\r\n"]
[175.834314, "o", "    def _dir_additions(self):\r\n"]
[175.847257, "o", "        return self.obj._dir_additions()\r\n"]
[175.860199, "o", "\r\n"]
[175.873141, "o", "    def __repr__(self) -> str:\r\n"]
[175.886084, "o", "        \"\"\"\r\n"]
[175.899026, "o", "        Provide a nice str repr of our rolling object.\r\n"]
[175.911969, "o", "        \"\"\"\r\n"]
[175.924911, "o", "        attrs_list = (\r\n"]
[175.937853, "o", "            f\"{attr_name}={getattr(self, attr_name)}\"\r\n"]
[175.950796, "o", "            for attr_name in self._attributes\r\n"]
[175.963738, "o", "            if getattr(self, attr_name, None) is not None and attr_name[0] != \"_\"\r\n"]
[175.976681, "o", "        )\r\n"]
[175.989623, "o", "        attrs = \",\".join(attrs_list)\r\n"]
[176.002565, "o", "        return f\"{type(self).__name__} [{attrs}]\"\r\n"]
[176.015508, "o", "\r\n"]
[176.02845, "o", "    def __iter__(self) -> Iterator:\r\n"]
[176.041393, "o", "        obj = self._selected_obj.set_axis(self._on)\r\n"]
[176.054335, "o", "        obj = self._create_data(obj)\r\n"]
[176.067277, "o", "        indexer = self._get_window_indexer()\r\n"]
[176.08022, "o", "\r\n"]
[176.093162, "o", "        start, end = indexer.get_window_bounds(\r\n"]
[176.106105, "o", "            num_values=len(obj),\r\n"]
[176.119047, "o", "            min_periods=self.min_periods,\r\n"]
[176.13199, "o", "            center=self.center,\r\n"]
[176.144932, "o", "            closed=self.closed,\r\n"]
[176.157874, "o", "            step=self.step,\r\n"]
[176.170817, "o", "        )\r\n"]
[176.183759, "o", "        self._check_window_bounds(start, end, len(obj))\r\n"]
[176.196702, "o", "\r\n"]
[176.209644, "o", "        for s, e in zip(start, end):\r\n"]
[176.222586, "o", "            result = obj.iloc[slice(s, e)]\r\n"]
[176.235529, "o", "            yield result\r\n"]
[176.248471, "o", "\r\n"]
[176.261414, "o", "    def _prep_values(self, values: ArrayLike) -> np.ndarray:\r\n"]
[176.274356, "o", "        \"\"\"Convert input to numpy arrays for Cython routines\"\"\"\r\n"]
[176.287298, "o", "        if needs_i8_conversion(values.dtype):\r\n"]
[176.300241, "o", "            raise NotImplementedError(\r\n"]
[176.313183, "o", "                f\"ops for {type(self).__name__} for this \"\r\n"]
[176.326126, "o", "                f\"dtype {values.dtype} are not implemented\"\r\n"]
[176.339068, "o", "            )\r\n"]
[176.35201, "o", "        # GH #12373 : rolling functions error on float32 data\r\n"]
[176.364953, "o", "        # make sure the data is coerced to float64\r\n"]
[176.377895, "o", "        try:\r\n"]
[176.390838, "o", "            if isinstance(values, ExtensionArray):\r\n"]
[176.40378, "o", "                values = values.to_numpy(np.float64, na_value=np.nan)\r\n"]
[176.416723, "o", "            else:\r\n"]
[176.429665, "o", "                values = ensure_float64(values)\r\n"]
[176.442607, "o", "        except (ValueError, TypeError) as err:\r\n"]
[176.45555, "o", "            raise TypeError(f\"cannot handle this type -> {values.dtype}\") from err\r\n"]
[176.468492, "o", "\r\n"]
[176.481435, "o", "        # Convert inf to nan for C funcs\r\n"]
[176.494377, "o", "        inf = np.isinf(values)\r\n"]
[176.507319, "o", "        if inf.any():\r\n"]
[176.520262, "o", "            values = np.where(inf, np.nan, values)\r\n"]
[176.533204, "o", "\r\n"]
[176.546147, "o", "        return values\r\n"]
[176.559089, "o", "\r\n"]
[176.572031, "o", "    def _insert_on_column(self, result: DataFrame, obj: DataFrame) -> None:\r\n"]
[176.584974, "o", "        # if we have an 'on' column we want to put it back into\r\n"]
[176.597916, "o", "        # the results in the same location\r\n"]
[176.610859, "o", "        from pandas import Series\r\n"]
[176.623801, "o", "\r\n"]
[176.636743, "o", "        if self.on is not None and not self._on.equals(obj.index):\r\n"]
[176.649686, "o", "            name = self._on.name\r\n"]
[176.662628, "o", "            extra_col = Series(self._on, index=self.obj.index, name=name)\r\n"]
[176.675571, "o", "            if name in result.columns:\r\n"]
[176.688513, "o", "                # TODO: sure we want to overwrite results?\r\n"]
[176.701455, "o", "                result[name] = extra_col\r\n"]
[176.714398, "o", "            elif name in result.index.names:\r\n"]
[176.72734, "o", "                pass\r\n"]
[176.740283, "o", "            elif name in self._selected_obj.columns:\r\n"]
[176.753225, "o", "                # insert in the same location as we had in _selected_obj\r\n"]
[176.766168, "o", "                old_cols = self._selected_obj.columns\r\n"]
[176.77911, "o", "                new_cols = result.columns\r\n"]
[176.792052, "o", "                old_loc = old_cols.get_loc(name)\r\n"]
[176.804995, "o", "                overlap = new_cols.intersection(old_cols[:old_loc])\r\n"]
[176.817937, "o", "                new_loc = len(overlap)\r\n"]
[176.83088, "o", "                result.insert(new_loc, name, extra_col)\r\n"]
[176.843822, "o", "            else:\r\n"]
[176.856764, "o", "                # insert at the end\r\n"]
[176.869707, "o", "                result[name] = extra_col\r\n"]
[176.882649, "o", "\r\n"]
[176.895592, "o", "    @property\r\n"]
[176.908534, "o", "    def _index_array(self):\r\n"]
[176.921476, "o", "        # TODO: why do we get here with e.g. MultiIndex?\r\n"]
[176.934419, "o", "        if needs_i8_conversion(self._on.dtype):\r\n"]
[176.947361, "o", "            idx = cast(\"PeriodIndex | DatetimeIndex | TimedeltaIndex\", self._on)\r\n"]
[176.960304, "o", "            return idx.asi8\r\n"]
[176.973246, "o", "        return None\r\n"]
[176.986188, "o", "\r\n"]
[176.999131, "o", "    def _resolve_output(self, out: DataFrame, obj: DataFrame) -> DataFrame:\r\n"]
[177.012073, "o", "        \"\"\"Validate and finalize result.\"\"\"\r\n"]
[177.025016, "o", "        if out.shape[1] == 0 and obj.shape[1] > 0:\r\n"]
[177.037958, "o", "            raise DataError(\"No numeric types to aggregate\")\r\n"]
[177.050901, "o", "        if out.shape[1] == 0:\r\n"]
[177.063843, "o", "            return obj.astype(\"float64\")\r\n"]
[177.076785, "o", "\r\n"]
[177.089728, "o", "        self._insert_on_column(out, obj)\r\n"]
[177.10267, "o", "        return out\r\n"]
[177.115613, "o", "\r\n"]
[177.128555, "o", "    def _get_window_indexer(self) -> BaseIndexer:\r\n"]
[177.141497, "o", "        \"\"\"\r\n"]
[177.15444, "o", "        Return an indexer class that will compute the window start and end bounds\r\n"]
[177.167382, "o", "        \"\"\"\r\n"]
[177.180325, "o", "        if isinstance(self.window, BaseIndexer):\r\n"]
[177.193267, "o", "            return self.window\r\n"]
[177.206209, "o", "        if self._win_freq_i8 is not None:\r\n"]
[177.219152, "o", "            return VariableWindowIndexer(\r\n"]
[177.232094, "o", "                index_array=self._index_array,\r\n"]
[177.245037, "o", "                window_size=self._win_freq_i8,\r\n"]
[177.257979, "o", "                center=self.center,\r\n"]
[177.270921, "o", "            )\r\n"]
[177.283864, "o", "        return FixedWindowIndexer(window_size=self.window)\r\n"]
[177.296806, "o", "\r\n"]
[177.309749, "o", "    def _apply_series(\r\n"]
[177.322691, "o", "        self, homogeneous_func: Callable[..., ArrayLike], name: str | None = None\r\n"]
[177.335634, "o", "    ) -> Series:\r\n"]
[177.348576, "o", "        \"\"\"\r\n"]
[177.361518, "o", "        Series version of _apply_blockwise\r\n"]
[177.374461, "o", "        \"\"\"\r\n"]
[177.387403, "o", "        obj = self._create_data(self._selected_obj)\r\n"]
[177.400346, "o", "\r\n"]
[177.413288, "o", "        if name == \"count\":\r\n"]
[177.42623, "o", "            # GH 12541: Special case for count where we support date-like types\r\n"]
[177.439173, "o", "            obj = notna(obj).astype(int)\r\n"]
[177.452115, "o", "        try:\r\n"]
[177.465058, "o", "            values = self._prep_values(obj._values)\r\n"]
[177.478, "o", "        except (TypeError, NotImplementedError) as err:\r\n"]
[177.490942, "o", "            raise DataError(\"No numeric types to aggregate\") from err\r\n"]
[177.503885, "o", "\r\n"]
[177.516827, "o", "        result = homogeneous_func(values)\r\n"]
[177.52977, "o", "        index = self._slice_axis_for_step(obj.index, result)\r\n"]
[177.542712, "o", "        return obj._constructor(result, index=index, name=obj.name)\r\n"]
[177.555654, "o", "\r\n"]
[177.568597, "o", "    def _apply_blockwise(\r\n"]
[177.581539, "o", "        self,\r\n"]
[177.594482, "o", "        homogeneous_func: Callable[..., ArrayLike],\r\n"]
[177.607424, "o", "        name: str,\r\n"]
[177.620366, "o", "        numeric_only: bool = False,\r\n"]
[177.633309, "o", "    ) -> DataFrame | Series:\r\n"]
[177.646251, "o", "        \"\"\"\r\n"]
[177.659194, "o", "        Apply the given function to the DataFrame broken down into homogeneous\r\n"]
[177.672136, "o", "        sub-frames.\r\n"]
[177.685079, "o", "        \"\"\"\r\n"]
[177.698021, "o", "        self._validate_numeric_only(name, numeric_only)\r\n"]
[177.710963, "o", "        if self._selected_obj.ndim == 1:\r\n"]
[177.723906, "o", "            return self._apply_series(homogeneous_func, name)\r\n"]
[177.736848, "o", "\r\n"]
[177.749791, "o", "        obj = self._create_data(self._selected_obj, numeric_only)\r\n"]
[177.762733, "o", "        if name == \"count\":\r\n"]
[177.775675, "o", "            # GH 12541: Special case for count where we support date-like types\r\n"]
[177.788618, "o", "            obj = notna(obj).astype(int)\r\n"]
[177.80156, "o", "            obj._mgr = obj._mgr.consolidate()\r\n"]
[177.814503, "o", "\r\n"]
[177.827445, "o", "        if self.axis == 1:\r\n"]
[177.840387, "o", "            obj = obj.T\r\n"]
[177.85333, "o", "\r\n"]
[177.866272, "o", "        taker = []\r\n"]
[177.879215, "o", "        res_values = []\r\n"]
[177.892157, "o", "        for i, arr in enumerate(obj._iter_column_arrays()):\r\n"]
[177.905099, "o", "            # GH#42736 operate column-wise instead of block-wise\r\n"]
[177.918042, "o", "            # As of 2.0, hfunc will raise for nuisance columns\r\n"]
[177.930984, "o", "            try:\r\n"]
[177.943927, "o", "                arr = self._prep_values(arr)\r\n"]
[177.956869, "o", "            except (TypeError, NotImplementedError) as err:\r\n"]
[177.969812, "o", "                raise DataError(\r\n"]
[177.982754, "o", "                    f\"Cannot aggregate non-numeric type: {arr.dtype}\"\r\n"]
[177.995696, "o", "                ) from err\r\n"]
[178.008639, "o", "            res = homogeneous_func(arr)\r\n"]
[178.021581, "o", "            res_values.append(res)\r\n"]
[178.034524, "o", "            taker.append(i)\r\n"]
[178.047466, "o", "\r\n"]
[178.060408, "o", "        index = self._slice_axis_for_step(\r\n"]
[178.073351, "o", "            obj.index, res_values[0] if len(res_values) > 0 else None\r\n"]
[178.086293, "o", "        )\r\n"]
[178.099236, "o", "        df = type(obj)._from_arrays(\r\n"]
[178.112178, "o", "            res_values,\r\n"]
[178.12512, "o", "            index=index,\r\n"]
[178.138063, "o", "            columns=obj.columns.take(taker),\r\n"]
[178.151005, "o", "            verify_integrity=False,\r\n"]
[178.163948, "o", "        )\r\n"]
[178.17689, "o", "\r\n"]
[178.189832, "o", "        if self.axis == 1:\r\n"]
[178.202775, "o", "            df = df.T\r\n"]
[178.215717, "o", "\r\n"]
[178.22866, "o", "        return self._resolve_output(df, obj)\r\n"]
[178.241602, "o", "\r\n"]
[178.254545, "o", "    def _apply_tablewise(\r\n"]
[178.267487, "o", "        self,\r\n"]
[178.280429, "o", "        homogeneous_func: Callable[..., ArrayLike],\r\n"]
[178.293372, "o", "        name: str | None = None,\r\n"]
[178.306314, "o", "        numeric_only: bool = False,\r\n"]
[178.319257, "o", "    ) -> DataFrame | Series:\r\n"]
[178.332199, "o", "        \"\"\"\r\n"]
[178.345141, "o", "        Apply the given function to the DataFrame across the entire object\r\n"]
[178.358084, "o", "        \"\"\"\r\n"]
[178.371026, "o", "        if self._selected_obj.ndim == 1:\r\n"]
[178.383969, "o", "            raise ValueError(\"method='table' not applicable for Series objects.\")\r\n"]
[178.396911, "o", "        obj = self._create_data(self._selected_obj, numeric_only)\r\n"]
[178.409853, "o", "        values = self._prep_values(obj.to_numpy())\r\n"]
[178.422796, "o", "        values = values.T if self.axis == 1 else values\r\n"]
[178.435738, "o", "        result = homogeneous_func(values)\r\n"]
[178.448681, "o", "        result = result.T if self.axis == 1 else result\r\n"]
[178.461623, "o", "        index = self._slice_axis_for_step(obj.index, result)\r\n"]
[178.474565, "o", "        columns = (\r\n"]
[178.487508, "o", "            obj.columns\r\n"]
[178.50045, "o", "            if result.shape[1] == len(obj.columns)\r\n"]
[178.513393, "o", "            else obj.columns[:: self.step]\r\n"]
[178.526335, "o", "        )\r\n"]
[178.539277, "o", "        out = obj._constructor(result, index=index, columns=columns)\r\n"]
[178.55222, "o", "\r\n"]
[178.565162, "o", "        return self._resolve_output(out, obj)\r\n"]
[178.578105, "o", "\r\n"]
[178.591047, "o", "    def _apply_pairwise(\r\n"]
[178.60399, "o", "        self,\r\n"]
[178.616932, "o", "        target: DataFrame | Series,\r\n"]
[178.629874, "o", "        other: DataFrame | Series | None,\r\n"]
[178.642817, "o", "        pairwise: bool | None,\r\n"]
[178.655759, "o", "        func: Callable[[DataFrame | Series, DataFrame | Series], DataFrame | Series],\r\n"]
[178.668702, "o", "        numeric_only: bool,\r\n"]
[178.681644, "o", "    ) -> DataFrame | Series:\r\n"]
[178.694586, "o", "        \"\"\"\r\n"]
[178.707529, "o", "        Apply the given pairwise function given 2 pandas objects (DataFrame/Series)\r\n"]
[178.720471, "o", "        \"\"\"\r\n"]
[178.733414, "o", "        target = self._create_data(target, numeric_only)\r\n"]
[178.746356, "o", "        if other is None:\r\n"]
[178.759298, "o", "            other = target\r\n"]
[178.772241, "o", "            # only default unset\r\n"]
[178.785183, "o", "            pairwise = True if pairwise is None else pairwise\r\n"]
[178.798126, "o", "        elif not isinstance(other, (ABCDataFrame, ABCSeries)):\r\n"]
[178.811068, "o", "            raise ValueError(\"other must be a DataFrame or Series\")\r\n"]
[178.82401, "o", "        elif other.ndim == 2 and numeric_only:\r\n"]
[178.836953, "o", "            other = self._make_numeric_only(other)\r\n"]
[178.849895, "o", "\r\n"]
[178.862838, "o", "        return flex_binary_moment(target, other, func, pairwise=bool(pairwise))\r\n"]
[178.87578, "o", "\r\n"]
[178.888723, "o", "    def _apply(\r\n"]
[178.901665, "o", "        self,\r\n"]
[178.914607, "o", "        func: Callable[..., Any],\r\n"]
[178.92755, "o", "        name: str,\r\n"]
[178.940492, "o", "        numeric_only: bool = False,\r\n"]
[178.953435, "o", "        numba_args: tuple[Any, ...] = (),\r\n"]
[178.966377, "o", "        **kwargs,\r\n"]
[178.979319, "o", "    ):\r\n"]
[178.992262, "o", "        \"\"\"\r\n"]
[179.005204, "o", "        Rolling statistical measure using supplied function.\r\n"]
[179.018147, "o", "\r\n"]
[179.031089, "o", "        Designed to be used with passed-in Cython array-based functions.\r\n"]
[179.044031, "o", "\r\n"]
[179.056974, "o", "        Parameters\r\n"]
[179.069916, "o", "        ----------\r\n"]
[179.082859, "o", "        func : callable function to apply\r\n"]
[179.095801, "o", "        name : str,\r\n"]
[179.108743, "o", "        numba_args : tuple\r\n"]
[179.121686, "o", "            args to be passed when func is a numba func\r\n"]
[179.134628, "o", "        **kwargs\r\n"]
[179.147571, "o", "            additional arguments for rolling function and window function\r\n"]
[179.160513, "o", "\r\n"]
[179.173455, "o", "        Returns\r\n"]
[179.186398, "o", "        -------\r\n"]
[179.19934, "o", "        y : type of input\r\n"]
[179.212283, "o", "        \"\"\"\r\n"]
[179.225225, "o", "        window_indexer = self._get_window_indexer()\r\n"]
[179.238168, "o", "        min_periods = (\r\n"]
[179.25111, "o", "            self.min_periods\r\n"]
[179.264052, "o", "            if self.min_periods is not None\r\n"]
[179.276995, "o", "            else window_indexer.window_size\r\n"]
[179.289937, "o", "        )\r\n"]
[179.30288, "o", "\r\n"]
[179.315822, "o", "        def homogeneous_func(values: np.ndarray):\r\n"]
[179.328764, "o", "            # calculation function\r\n"]
[179.341707, "o", "\r\n"]
[179.354649, "o", "            if values.size == 0:\r\n"]
[179.367592, "o", "                return values.copy()\r\n"]
[179.380534, "o", "\r\n"]
[179.393476, "o", "            def calc(x):\r\n"]
[179.406419, "o", "                start, end = window_indexer.get_window_bounds(\r\n"]
[179.419361, "o", "                    num_values=len(x),\r\n"]
[179.432304, "o", "                    min_periods=min_periods,\r\n"]
[179.445246, "o", "                    center=self.center,\r\n"]
[179.458188, "o", "                    closed=self.closed,\r\n"]
[179.471131, "o", "                    step=self.step,\r\n"]
[179.484073, "o", "                )\r\n"]
[179.497016, "o", "                self._check_window_bounds(start, end, len(x))\r\n"]
[179.509958, "o", "\r\n"]
[179.522901, "o", "                return func(x, start, end, min_periods, *numba_args)\r\n"]
[179.535843, "o", "\r\n"]
[179.548785, "o", "            with np.errstate(all=\"ignore\"):\r\n"]
[179.561728, "o", "                result = calc(values)\r\n"]
[179.57467, "o", "\r\n"]
[179.587613, "o", "            return result\r\n"]
[179.600555, "o", "\r\n"]
[179.613497, "o", "        if self.method == \"single\":\r\n"]
[179.62644, "o", "            return self._apply_blockwise(homogeneous_func, name, numeric_only)\r\n"]
[179.639382, "o", "        else:\r\n"]
[179.652325, "o", "            return self._apply_tablewise(homogeneous_func, name, numeric_only)\r\n"]
[179.665267, "o", "\r\n"]
[179.678209, "o", "    def _numba_apply(\r\n"]
[179.691152, "o", "        self,\r\n"]
[179.704094, "o", "        func: Callable[..., Any],\r\n"]
[179.717037, "o", "        engine_kwargs: dict[str, bool] | None = None,\r\n"]
[179.729979, "o", "        *func_args,\r\n"]
[179.742921, "o", "    ):\r\n"]
[179.755864, "o", "        window_indexer = self._get_window_indexer()\r\n"]
[179.768806, "o", "        min_periods = (\r\n"]
[179.781749, "o", "            self.min_periods\r\n"]
[179.794691, "o", "            if self.min_periods is not None\r\n"]
[179.807634, "o", "            else window_indexer.window_size\r\n"]
[179.820576, "o", "        )\r\n"]
[179.833518, "o", "        obj = self._create_data(self._selected_obj)\r\n"]
[179.846461, "o", "        if self.axis == 1:\r\n"]
[179.859403, "o", "            obj = obj.T\r\n"]
[179.872346, "o", "        values = self._prep_values(obj.to_numpy())\r\n"]
[179.885288, "o", "        if values.ndim == 1:\r\n"]
[179.89823, "o", "            values = values.reshape(-1, 1)\r\n"]
[179.911173, "o", "        start, end = window_indexer.get_window_bounds(\r\n"]
[179.924115, "o", "            num_values=len(values),\r\n"]
[179.937058, "o", "            min_periods=min_periods,\r\n"]
[180.0, "o", "(asv_3.8) root@cb2cc1765c92:/workspace/repo/asv_bench# "]
[180.002, "i", "asv profile --python=same rolling.GroupbyLargeGroups.time_rolling_multiindex_creation\r"]
[180.004, "o", "asv profile --python=same rolling.GroupbyLargeGroups.time_rolling_multiindex_creation\r\n"]
[180.016587, "o", "\u001b[?2004l\r\n"]
[180.027173, "o", "\u00b7 \u001b[0;32mDiscovering benchmarks\u001b[0m\r\n"]
[180.03776, "o", "\u00b7 \u001b[0;32mProfile data does not already exist. Running profiler now.\u001b[0m\r\n"]
[180.048347, "o", "\u00b7\u00b7 \u001b[0;34mBenchmarking existing-py_opt_conda_envs_asv_3.8_bin_python\u001b[0m\r\n"]
[180.058934, "o", "\u00b7\u00b7\u00b7 \u001b[0;39mRunning (rolling.GroupbyLargeGroups.time_rolling_multiindex_creation--)\u001b[0m.\r\n"]
[180.06952, "o", "\u00b7\u00b7\u00b7 \u001b[0;39mrolling.GroupbyLargeGroups.time_rolling_multiindex_creation\u001b[0m                                                                             22.7\u00b10.5ms\r\n"]
[180.080107, "o", "\r\n"]
[180.090694, "o", "Wed Oct  1 18:30:23 2025    /tmp/tmp6utptk0g\r\n"]
[180.101281, "o", "\r\n"]
[180.111867, "o", "         2358 function calls (2304 primitive calls) in 0.025 seconds\r\n"]
[180.122454, "o", "\r\n"]
[180.133041, "o", "   Ordered by: cumulative time\r\n"]
[180.143627, "o", "\r\n"]
[180.154214, "o", "   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\r\n"]
[180.164801, "o", "        1    0.000    0.000    0.025    0.025 {built-in method builtins.exec}\r\n"]
[180.175388, "o", "        1    0.000    0.000    0.025    0.025 _base.py:689(method_caller)\r\n"]
[180.185974, "o", "        1    0.000    0.000    0.025    0.025 rolling.py:322(time_rolling_multiindex_creation)\r\n"]
[180.196561, "o", "        1    0.000    0.000    0.024    0.024 rolling.py:2070(mean)\r\n"]
[180.207148, "o", "        1    0.000    0.000    0.024    0.024 rolling.py:1489(mean)\r\n"]
[180.217734, "o", "        1    0.000    0.000    0.024    0.024 rolling.py:701(_apply)\r\n"]
[180.228321, "o", "        1    0.000    0.000    0.016    0.016 multi.py:445(from_arrays)\r\n"]
[180.238908, "o", "        1    0.000    0.000    0.016    0.016 categorical.py:2586(factorize_from_iterables)\r\n"]
[180.249495, "o", "        2    0.000    0.000    0.016    0.008 categorical.py:2607(<genexpr>)\r\n"]
[180.260081, "o", "        1    0.000    0.000    0.016    0.016 categorical.py:2545(factorize_from_iterable)\r\n"]
[180.270668, "o", "        1    0.000    0.000    0.016    0.016 categorical.py:359(__init__)\r\n"]
[180.281255, "o", "      3/2    0.000    0.000    0.015    0.008 algorithms.py:610(factorize)\r\n"]
[180.291842, "o", "        1    0.000    0.000    0.014    0.014 base.py:1143(factorize)\r\n"]
[180.302428, "o", "        2    0.000    0.000    0.011    0.006 algorithms.py:1702(safe_sort)\r\n"]
[180.313015, "o", "        4    0.010    0.003    0.010    0.003 {method 'argsort' of 'numpy.ndarray' objects}\r\n"]
[180.323602, "o", "        1    0.000    0.000    0.007    0.007 rolling.py:558(_apply)\r\n"]
[180.334188, "o", "        1    0.000    0.000    0.004    0.004 rolling.py:456(_apply_blockwise)\r\n"]
[180.344775, "o", "        2    0.000    0.000    0.004    0.002 algorithms.py:548(factorize_array)\r\n"]
[180.355362, "o", "        2    0.004    0.002    0.004    0.002 {method 'factorize' of 'pandas._libs.hashtable.Int64HashTable' objects}\r\n"]
[180.365949, "o", "        1    0.000    0.000    0.003    0.003 rolling.py:591(homogeneous_func)\r\n"]
[180.376535, "o", "        1    0.000    0.000    0.003    0.003 rolling.py:597(calc)\r\n"]
[180.387122, "o", "        1    0.000    0.000    0.002    0.002 rolling.py:2695(_get_window_indexer)\r\n"]
[180.397709, "o", "        1    0.000    0.000    0.002    0.002 ops.py:784(indices)\r\n"]
[180.408296, "o", "        4    0.000    0.000    0.002    0.000 dtypes.py:186(__init__)\r\n"]
[180.418882, "o", "        4    0.000    0.000    0.001    0.000 dtypes.py:339(_finalize)\r\n"]
[180.429469, "o", "        2    0.000    0.000    0.001    0.001 dtypes.py:511(validate_categories)\r\n"]
[180.440056, "o", "        2    0.001    0.001    0.001    0.001 base.py:2168(is_unique)\r\n"]
[180.450642, "o", "        1    0.001    0.001    0.001    0.001 {pandas._libs.window.aggregations.roll_mean}\r\n"]
[180.461229, "o", "        1    0.000    0.000    0.001    0.001 objects.py:324(get_window_bounds)\r\n"]
[180.471816, "o", "       12    0.001    0.000    0.001    0.000 {method 'take' of 'numpy.ndarray' objects}\r\n"]
[180.482403, "o", "        1    0.000    0.000    0.001    0.001 sorting.py:599(get_indexer_dict)\r\n"]
[180.492989, "o", "        1    0.000    0.000    0.001    0.001 rolling.py:846(_create_data)\r\n"]
[180.503576, "o", "        1    0.000    0.000    0.001    0.001 groupby.py:2649(rolling)\r\n"]
[180.514163, "o", "        1    0.000    0.000    0.001    0.001 rolling.py:678(__init__)\r\n"]
[180.524749, "o", "    27/15    0.001    0.000    0.001    0.000 {built-in method numpy.core._multiarray_umath.implement_array_function}\r\n"]
[180.535336, "o", "        1    0.000    0.000    0.001    0.001 ops.py:910(result_index)\r\n"]
[180.545923, "o", "        1    0.000    0.000    0.001    0.001 frame.py:5087(drop)\r\n"]
[180.55651, "o", "        1    0.000    0.000    0.001    0.001 generic.py:4505(drop)\r\n"]
[180.567096, "o", "        1    0.000    0.000    0.001    0.001 grouper.py:688(result_index)\r\n"]
[180.577683, "o", "        6    0.000    0.000    0.001    0.000 take.py:58(take_nd)\r\n"]
[180.58827, "o", "        1    0.000    0.000    0.001    0.001 grouper.py:700(group_index)\r\n"]
[180.598857, "o", "        1    0.000    0.000    0.001    0.001 generic.py:4544(_drop_axis)\r\n"]
[180.609443, "o", "        1    0.000    0.000    0.001    0.001 generic.py:3819(take)\r\n"]
[180.62003, "o", "        6    0.000    0.000    0.001    0.000 take.py:120(_take_nd_ndarray)\r\n"]
[180.630617, "o", "        1    0.000    0.000    0.001    0.001 generic.py:3898(_take)\r\n"]
[180.641203, "o", "        1    0.000    0.000    0.001    0.001 grouper.py:722(_codes_and_uniques)\r\n"]
[180.65179, "o", "        1    0.000    0.000    0.001    0.001 managers.py:886(take)\r\n"]
[180.662377, "o", "        2    0.000    0.000    0.001    0.000 managers.py:641(reindex_indexer)\r\n"]
[180.672964, "o", "        2    0.000    0.000    0.001    0.000 blocks.py:858(take_nd)\r\n"]
[180.68355, "o", "        6    0.000    0.000    0.001    0.000 <__array_function__ internals>:177(concatenate)\r\n"]
[180.694137, "o", "        3    0.000    0.000    0.001    0.000 base.py:1033(take)\r\n"]
[180.704724, "o", "        1    0.000    0.000    0.001    0.001 sorting.py:632(get_group_index_sorter)\r\n"]
[180.71531, "o", "        1    0.001    0.001    0.001    0.001 {pandas._libs.algos.groupsort_indexer}\r\n"]
[180.725897, "o", "        2    0.000    0.000    0.001    0.000 objects.py:76(get_window_bounds)\r\n"]
[180.736484, "o", "        1    0.000    0.000    0.000    0.000 frame.py:8104(groupby)\r\n"]
[180.747071, "o", "        1    0.000    0.000    0.000    0.000 base.py:6610(drop)\r\n"]
[180.757657, "o", "        1    0.000    0.000    0.000    0.000 groupby.py:896(__init__)\r\n"]
[180.768244, "o", "        1    0.000    0.000    0.000    0.000 managers.py:705(<listcomp>)\r\n"]
[180.778831, "o", "        2    0.000    0.000    0.000    0.000 base.py:3676(get_indexer)\r\n"]
[180.789418, "o", "        1    0.000    0.000    0.000    0.000 grouper.py:790(get_grouper)\r\n"]
[180.800004, "o", "        1    0.000    0.000    0.000    0.000 frame.py:2459(_from_arrays)\r\n"]
[180.810591, "o", "        1    0.000    0.000    0.000    0.000 managers.py:726(_slice_take_blocks_ax0)\r\n"]
[180.821178, "o", "        3    0.000    0.000    0.000    0.000 algorithms.py:1396(take)\r\n"]
[180.831764, "o", "        4    0.000    0.000    0.000    0.000 <__array_function__ internals>:177(clip)\r\n"]
[180.842351, "o", "        1    0.000    0.000    0.000    0.000 construction.py:96(arrays_to_mgr)\r\n"]
[180.852938, "o", "        4    0.000    0.000    0.000    0.000 fromnumeric.py:2111(clip)\r\n"]
[180.863525, "o", "        4    0.000    0.000    0.000    0.000 fromnumeric.py:51(_wrapfunc)\r\n"]
[180.874111, "o", "        1    0.000    0.000    0.000    0.000 base.py:5777(get_indexer_for)\r\n"]
[180.884698, "o", "        4    0.000    0.000    0.000    0.000 {method 'clip' of 'numpy.ndarray' objects}\r\n"]
[180.895285, "o", "        4    0.000    0.000    0.000    0.000 _methods.py:127(_clip)\r\n"]
[180.905872, "o", "        1    0.000    0.000    0.000    0.000 {pandas._libs.algos.take_2d_axis0_float64_float64}\r\n"]
[180.916458, "o", "        1    0.000    0.000    0.000    0.000 managers.py:2069(create_block_manager_from_column_arrays)\r\n"]
[180.927045, "o", "        4    0.000    0.000    0.000    0.000 {pandas._libs.algos.take_1d_int64_int64}\r\n"]
[180.937632, "o", "  392/382    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}\r\n"]
[180.948218, "o", "        1    0.000    0.000    0.000    0.000 managers.py:2141(_form_blocks)\r\n"]
[180.958805, "o", "        3    0.000    0.000    0.000    0.000 base.py:449(__new__)\r\n"]
[180.969392, "o", "        4    0.000    0.000    0.000    0.000 _methods.py:108(_clip_dep_invoke_with_casting)\r\n"]
[180.979979, "o", "        1    0.000    0.000    0.000    0.000 {pandas._libs.algos.take_2d_axis1_float64_float64}\r\n"]
[180.990565, "o", "        1    0.000    0.000    0.000    0.000 rolling.py:742(<listcomp>)\r\n"]
[181.001152, "o", "        1    0.000    0.000    0.000    0.000 managers.py:2199(_stack_arrays)\r\n"]
[181.011739, "o", "        1    0.000    0.000    0.000    0.000 frame.py:3689(__getitem__)\r\n"]
[181.022325, "o", "        2    0.000    0.000    0.000    0.000 multi.py:313(__new__)\r\n"]
[181.032912, "o", "        5    0.000    0.000    0.000    0.000 {built-in method numpy.arange}\r\n"]
[181.043499, "o", "        4    0.000    0.000    0.000    0.000 cast.py:971(coerce_indexer_dtype)\r\n"]
[181.054086, "o", "        1    0.000    0.000    0.000    0.000 sorting.py:109(get_group_index)\r\n"]
[181.064672, "o", "        1    0.000    0.000    0.000    0.000 utils.py:241(maybe_convert_indices)\r\n"]
[181.075259, "o", "        1    0.000    0.000    0.000    0.000 frame.py:4220(_get_item_cache)\r\n"]
[181.085846, "o", "        2    0.000    0.000    0.000    0.000 algorithms.py:265(_get_hashtable_algo)\r\n"]
[181.096433, "o", "        9    0.000    0.000    0.000    0.000 {method 'reduce' of 'numpy.ufunc' objects}\r\n"]
[181.107019, "o", "        1    0.000    0.000    0.000    0.000 {pandas._libs.lib.indices_fast}\r\n"]
[181.117606, "o", "        9    0.000    0.000    0.000    0.000 base.py:7014(ensure_index)\r\n"]
[181.128193, "o", "        1    0.000    0.000    0.000    0.000 frame.py:3615(_ixs)\r\n"]
[181.138779, "o", "      117    0.000    0.000    0.000    0.000 generic.py:42(_instancecheck)\r\n"]
[181.149366, "o", "        2    0.000    0.000    0.000    0.000 base.py:6305(_maybe_cast_listlike_indexer)\r\n"]
[181.159953, "o", "        3    0.000    0.000    0.000    0.000 construction.py:500(sanitize_array)\r\n"]
[181.17054, "o", "       12    0.000    0.000    0.000    0.000 {method 'astype' of 'numpy.ndarray' objects}\r\n"]
[181.181126, "o", "        1    0.000    0.000    0.000    0.000 sorting.py:622(<listcomp>)\r\n"]
[181.191713, "o", "        2    0.000    0.000    0.000    0.000 <__array_function__ internals>:177(append)\r\n"]
[181.2023, "o", "        2    0.000    0.000    0.000    0.000 function_base.py:5444(append)\r\n"]
[181.212887, "o", "        5    0.000    0.000    0.000    0.000 {method 'any' of 'numpy.ndarray' objects}\r\n"]
[181.223473, "o", "        2    0.000    0.000    0.000    0.000 base.py:6029(_should_compare)\r\n"]
[181.23406, "o", "        2    0.000    0.000    0.000    0.000 multi.py:982(_set_codes)\r\n"]
[181.244647, "o", "        5    0.000    0.000    0.000    0.000 _methods.py:55(_any)\r\n"]
[181.255233, "o", "       27    0.000    0.000    0.000    0.000 base.py:4892(_values)\r\n"]
[181.26582, "o", "        1    0.000    0.000    0.000    0.000 generic.py:1916(__contains__)\r\n"]
[181.276407, "o", "        5    0.000    0.000    0.000    0.000 multi.py:998(<genexpr>)\r\n"]
[181.286994, "o", "        4    0.000    0.000    0.000    0.000 algorithms.py:193(_reconstruct_data)\r\n"]
[181.29758, "o", "       17    0.000    0.000    0.000    0.000 base.py:286(is_dtype)\r\n"]
[181.308167, "o", "        2    0.000    0.000    0.000    0.000 base.py:5052(__contains__)\r\n"]
[181.318754, "o", "        3    0.000    0.000    0.000    0.000 multi.py:3871(_coerce_indexer_frozen)\r\n"]
[181.32934, "o", "        2    0.000    0.000    0.000    0.000 base.py:791(_engine)\r\n"]
[181.339927, "o", "        6    0.000    0.000    0.000    0.000 common.py:1241(is_bool_dtype)\r\n"]
[181.350514, "o", "   130/99    0.000    0.000    0.000    0.000 {built-in method builtins.len}\r\n"]
[181.361101, "o", "       13    0.000    0.000    0.000    0.000 common.py:458(is_categorical_dtype)\r\n"]
[181.371687, "o", "        3    0.000    0.000    0.000    0.000 {pandas._libs.algos.ensure_int32}\r\n"]
[181.382274, "o", "        1    0.000    0.000    0.000    0.000 range.py:201(_data)\r\n"]
[181.392861, "o", "        1    0.000    0.000    0.000    0.000 base.py:636(_with_infer)\r\n"]
[181.403448, "o", "        1    0.000    0.000    0.000    0.000 {pandas._libs.algos.ensure_int8}\r\n"]
[181.414034, "o", "      117    0.000    0.000    0.000    0.000 generic.py:37(_check)\r\n"]
[181.424621, "o", "        2    0.000    0.000    0.000    0.000 algorithms.py:113(_ensure_data)\r\n"]
[181.435208, "o", "        2    0.000    0.000    0.000    0.000 algorithms.py:283(_check_object_for_strings)\r\n"]
[181.445794, "o", "        8    0.000    0.000    0.000    0.000 _methods.py:93(_clip_dep_is_scalar_nan)\r\n"]
[181.456381, "o", "        1    0.000    0.000    0.000    0.000 managers.py:1039(iget)\r\n"]
[181.466968, "o", "        5    0.000    0.000    0.000    0.000 _dtype.py:344(_name_get)\r\n"]
[181.477555, "o", "        5    0.000    0.000    0.000    0.000 {pandas._libs.lib.infer_dtype}\r\n"]
[181.488141, "o", "        2    0.000    0.000    0.000    0.000 common.py:229(asarray_tuplesafe)\r\n"]
[181.498728, "o", "       12    0.000    0.000    0.000    0.000 base.py:616(_simple_new)\r\n"]
[181.509315, "o", "        3    0.000    0.000    0.000    0.000 generic.py:5975(__setattr__)\r\n"]
[181.519901, "o", "        2    0.000    0.000    0.000    0.000 <__array_function__ internals>:177(prod)\r\n"]
[181.530488, "o", "        1    0.000    0.000    0.000    0.000 rolling.py:355(_prep_values)\r\n"]
[181.541075, "o", "        1    0.000    0.000    0.000    0.000 cast.py:1129(maybe_infer_to_datetimelike)\r\n"]
[181.551662, "o", "        3    0.000    0.000    0.000    0.000 fromnumeric.py:69(_wrapreduction)\r\n"]
[181.562248, "o", "        4    0.000    0.000    0.000    0.000 managers.py:163(blknos)\r\n"]
[181.572835, "o", "        1    0.000    0.000    0.000    0.000 rolling.py:117(__init__)\r\n"]
[181.583422, "o", "        2    0.000    0.000    0.000    0.000 typing.py:868(__new__)\r\n"]
[181.594009, "o", "        1    0.000    0.000    0.000    0.000 common.py:261(index_labels_to_array)\r\n"]
[181.604595, "o", "        3    0.000    0.000    0.000    0.000 base.py:2599(inferred_type)\r\n"]
[181.615182, "o", "        2    0.000    0.000    0.000    0.000 fromnumeric.py:2955(prod)\r\n"]
[181.625769, "o", "        2    0.000    0.000    0.000    0.000 blocks.py:190(fill_value)\r\n"]
[181.636355, "o", "        2    0.000    0.000    0.000    0.000 base.py:3764(_get_indexer)\r\n"]
[181.646942, "o", "        2    0.000    0.000    0.000    0.000 multi.py:807(_set_levels)\r\n"]
[181.657529, "o", "        2    0.000    0.000    0.000    0.000 {method '_rebuild_blknos_and_blklocs' of 'pandas._libs.internals.BlockManager' objects}\r\n"]
[181.668116, "o", "        1    0.000    0.000    0.000    0.000 {pandas._libs.lib.maybe_convert_objects}\r\n"]
[181.678702, "o", "        3    0.000    0.000    0.000    0.000 frame.py:640(__init__)\r\n"]
[181.689289, "o", "        2    0.000    0.000    0.000    0.000 _ufunc_config.py:33(seterr)\r\n"]
[181.699876, "o", "        6    0.000    0.000    0.000    0.000 construction.py:402(extract_array)\r\n"]
[181.710463, "o", "        1    0.000    0.000    0.000    0.000 frame.py:4203(_box_col_values)\r\n"]
[181.721049, "o", "        7    0.000    0.000    0.000    0.000 {built-in method builtins.any}\r\n"]
[181.731636, "o", "        4    0.000    0.000    0.000    0.000 base.py:4918(_get_engine_target)\r\n"]
[181.742223, "o", "        1    0.000    0.000    0.000    0.000 rolling.py:1752(_validate)\r\n"]
[181.752809, "o", "        1    0.000    0.000    0.000    0.000 generic.py:720(_set_axis)\r\n"]
[181.763396, "o", "        2    0.000    0.000    0.000    0.000 base.py:3809(_check_indexing_method)\r\n"]
[181.773983, "o", "        1    0.000    0.000    0.000    0.000 base.py:6518(delete)\r\n"]
[181.78457, "o", "        4    0.000    0.000    0.000    0.000 generic.py:262(__init__)\r\n"]
[181.795156, "o", "        2    0.000    0.000    0.000    0.000 generic.py:1921(empty)\r\n"]
[181.805743, "o", "        3    0.000    0.000    0.000    0.000 generic.py:5915(__finalize__)\r\n"]
[181.81633, "o", "        6    0.000    0.000    0.000    0.000 take.py:564(_take_preprocess_indexer_and_fill_value)\r\n"]
[181.826916, "o", "        1    0.000    0.000    0.000    0.000 dtypes.py:547(update_dtype)\r\n"]
[181.837503, "o", "        1    0.000    0.000    0.000    0.000 base.py:1786(rename)\r\n"]
[181.84809, "o", "       16    0.000    0.000    0.000    0.000 common.py:1491(_is_dtype_type)\r\n"]
[181.858677, "o", "        2    0.000    0.000    0.000    0.000 missing.py:625(na_value_for_dtype)\r\n"]
[181.869263, "o", "      152    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}\r\n"]
[181.87985, "o", "        1    0.000    0.000    0.000    0.000 base.py:1679(set_names)\r\n"]
[181.890437, "o", "        3    0.000    0.000    0.000    0.000 _weakrefset.py:36(__init__)\r\n"]
[181.901024, "o", "        2    0.000    0.000    0.000    0.000 base.py:5255(equals)\r\n"]
[181.91161, "o", "        4    0.000    0.000    0.000    0.000 base.py:54(shape)\r\n"]
[181.922197, "o", "        1    0.000    0.000    0.000    0.000 config.py:260(__call__)\r\n"]
[181.932784, "o", "        4    0.000    0.000    0.000    0.000 common.py:1124(is_numeric_dtype)\r\n"]
[181.94337, "o", "        2    0.000    0.000    0.000    0.000 blocks.py:228(make_block_same_class)\r\n"]
[181.953957, "o", "        1    0.000    0.000    0.000    0.000 _ufunc_config.py:435(__exit__)\r\n"]
[181.964544, "o", "        1    0.000    0.000    0.000    0.000 _asarray.py:31(require)\r\n"]
[181.975131, "o", "        1    0.000    0.000    0.000    0.000 managers.py:219(set_axis)\r\n"]
[181.985717, "o", "        8    0.000    0.000    0.000    0.000 <__array_function__ internals>:177(ndim)\r\n"]
[181.996304, "o", "        1    0.000    0.000    0.000    0.000 config.py:134(_get_option)\r\n"]
[182.006891, "o", "        1    0.000    0.000    0.000    0.000 grouper.py:508(__init__)\r\n"]
[182.017478, "o", "        1    0.000    0.000    0.000    0.000 rolling.py:412(_resolve_output)\r\n"]
[182.028064, "o", "        1    0.000    0.000    0.000    0.000 generic.py:1685(_check_label_or_level_ambiguity)\r\n"]
[182.038651, "o", "        8    0.000    0.000    0.000    0.000 common.py:157(is_object_dtype)\r\n"]
[182.049238, "o", "        1    0.000    0.000    0.000    0.000 <__array_function__ internals>:177(delete)\r\n"]
[182.059824, "o", "        1    0.000    0.000    0.000    0.000 base.py:58(_validate_set_axis)\r\n"]
[182.070411, "o", "        4    0.000    0.000    0.000    0.000 base.py:5102(__getitem__)\r\n"]
[182.080998, "o", "        5    0.000    0.000    0.000    0.000 base.py:731(_view)\r\n"]
[182.091585, "o", "        3    0.000    0.000    0.000    0.000 base.py:559(_dtype_to_subclass)\r\n"]
[182.102171, "o", "       25    0.000    0.000    0.000    0.000 {pandas._libs.lib.is_list_like}\r\n"]
[182.112758, "o", "        5    0.000    0.000    0.000    0.000 _dtype.py:330(_name_includes_bit_suffix)\r\n"]
[182.123345, "o", "        5    0.000    0.000    0.000    0.000 multi.py:828(<genexpr>)\r\n"]
[182.133931, "o", "       20    0.000    0.000    0.000    0.000 common.py:1456(get_dtype)\r\n"]
[182.144518, "o", "        6    0.000    0.000    0.000    0.000 generic.py:1979(<genexpr>)\r\n"]
[182.155105, "o", "        1    0.000    0.000    0.000    0.000 function_base.py:5054(delete)\r\n"]
[182.165692, "o", "       24    0.000    0.000    0.000    0.000 {pandas._libs.algos.ensure_platform_int}\r\n"]
[182.176278, "o", "       33    0.000    0.000    0.000    0.000 {built-in method numpy.asarray}\r\n"]
[182.186865, "o", "        1    0.000    0.000    0.000    0.000 numeric.py:290(full)\r\n"]
[182.197452, "o", "        4    0.000    0.000    0.000    0.000 ops.py:830(names)\r\n"]
[182.208039, "o", "        5    0.000    0.000    0.000    0.000 cast.py:559(maybe_promote)\r\n"]
[182.218625, "o", "        1    0.000    0.000    0.000    0.000 _ufunc_config.py:430(__enter__)\r\n"]
[182.229212, "o", "        7    0.000    0.000    0.000    0.000 abc.py:96(__instancecheck__)\r\n"]
[182.239799, "o", "        9    0.000    0.000    0.000    0.000 {built-in method numpy.empty}\r\n"]
[182.250385, "o", "        2    0.000    0.000    0.000    0.000 {method 'get_indexer' of 'pandas._libs.index.IndexEngine' objects}\r\n"]
[182.260972, "o", "        2    0.000    0.000    0.000    0.000 common.py:420(is_interval_dtype)\r\n"]
[182.271559, "o", "        2    0.000    0.000    0.000    0.000 <__array_function__ internals>:177(ravel)\r\n"]
[182.282146, "o", "        2    0.000    0.000    0.000    0.000 common.py:1206(is_float_dtype)\r\n"]
[182.292732, "o", "        2    0.000    0.000    0.000    0.000 multi.py:1398(_set_names)\r\n"]
[182.303319, "o", "        2    0.000    0.000    0.000    0.000 base.py:2641(_na_value)\r\n"]
[182.313906, "o", "        2    0.000    0.000    0.000    0.000 base.py:6047(_is_comparable_dtype)\r\n"]
[182.324493, "o", "        2    0.000    0.000    0.000    0.000 base.py:5949(_maybe_promote)\r\n"]
[182.335079, "o", "        1    0.000    0.000    0.000    0.000 construction.py:128(<listcomp>)\r\n"]
[182.345666, "o", "        1    0.000    0.000    0.000    0.000 <__array_function__ internals>:177(all)\r\n"]
[182.356253, "o", "        8    0.000    0.000    0.000    0.000 fromnumeric.py:3152(ndim)\r\n"]
[182.366839, "o", "       24    0.000    0.000    0.000    0.000 base.py:842(__len__)\r\n"]
[182.377426, "o", "        2    0.000    0.000    0.000    0.000 numerictypes.py:356(issubdtype)\r\n"]
[182.388013, "o", "        7    0.000    0.000    0.000    0.000 inference.py:189(is_array_like)\r\n"]
[182.3986, "o", "       12    0.000    0.000    0.000    0.000 base.py:56(<genexpr>)\r\n"]
[182.409186, "o", "        1    0.000    0.000    0.000    0.000 multi.py:782(__len__)\r\n"]
[182.419773, "o", "        6    0.000    0.000    0.000    0.000 common.py:549(is_dtype_equal)\r\n"]
[182.43036, "o", "        1    0.000    0.000    0.000    0.000 dtypes.py:209(_from_values_or_dtype)\r\n"]
[182.440946, "o", "        2    0.000    0.000    0.000    0.000 warnings.py:165(simplefilter)\r\n"]
[182.451533, "o", "        6    0.000    0.000    0.000    0.000 generic.py:520(_get_axis)\r\n"]
[182.46212, "o", "        1    0.000    0.000    0.000    0.000 categorical.py:733(codes)\r\n"]
[182.472707, "o", "        3    0.000    0.000    0.000    0.000 base.py:7109(maybe_extract_name)\r\n"]
[182.483293, "o", "        2    0.000    0.000    0.000    0.000 dtypes.py:1241(is_dtype)\r\n"]
[182.49388, "o", "        2    0.000    0.000    0.000    0.000 fromnumeric.py:1781(ravel)\r\n"]
[182.504467, "o", "        4    0.000    0.000    0.000    0.000 _weakrefset.py:81(add)\r\n"]
[182.515054, "o", "        1    0.000    0.000    0.000    0.000 config.py:116(_get_single_key)\r\n"]
[182.52564, "o", "        7    0.000    0.000    0.000    0.000 {built-in method _abc._abc_instancecheck}\r\n"]
[182.536227, "o", "        1    0.000    0.000    0.000    0.000 rolling.py:379(_insert_on_column)\r\n"]
[182.546814, "o", "        1    0.000    0.000    0.000    0.000 rolling.py:230(_validate_numeric_only)\r\n"]
[182.5574, "o", "        1    0.000    0.000    0.000    0.000 grouper.py:1021(_convert_grouper)\r\n"]
[182.567987, "o", "        3    0.000    0.000    0.000    0.000 _weakrefset.py:38(_remove)\r\n"]
[182.578574, "o", "        2    0.000    0.000    0.000    0.000 _ufunc_config.py:132(geterr)\r\n"]
[182.589161, "o", "        1    0.000    0.000    0.000    0.000 fromnumeric.py:2432(all)\r\n"]
[182.599747, "o", "        3    0.000    0.000    0.000    0.000 _weakrefset.py:116(update)\r\n"]
[182.610334, "o", "        1    0.000    0.000    0.000    0.000 series.py:367(__init__)\r\n"]
[182.620921, "o", "        1    0.000    0.000    0.000    0.000 frozen.py:73(__getitem__)\r\n"]
[182.631507, "o", "        2    0.000    0.000    0.000    0.000 frame.py:3659(_iter_column_arrays)\r\n"]
[182.642094, "o", "        1    0.000    0.000    0.000    0.000 objects.py:288(__init__)\r\n"]
[182.652681, "o", "        6    0.000    0.000    0.000    0.000 common.py:1074(needs_i8_conversion)\r\n"]
[182.663268, "o", "       41    0.000    0.000    0.000    0.000 {built-in method builtins.issubclass}\r\n"]
[182.673854, "o", "        2    0.000    0.000    0.000    0.000 base.py:7144(unpack_nested_dtype)\r\n"]
[182.684441, "o", "        2    0.000    0.000    0.000    0.000 warnings.py:181(_add_filter)\r\n"]
[182.695028, "o", "        1    0.000    0.000    0.000    0.000 base.py:3585(get_loc)\r\n"]
[182.705615, "o", "        1    0.000    0.000    0.000    0.000 <__array_function__ internals>:177(copyto)\r\n"]
[182.716201, "o", "       28    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}\r\n"]
[182.726788, "o", "        3    0.000    0.000    0.000    0.000 base.py:1631(_get_names)\r\n"]
[182.737375, "o", "        2    0.000    0.000    0.000    0.000 inference.py:267(is_dict_like)\r\n"]
[182.747961, "o", "       14    0.000    0.000    0.000    0.000 base.py:780(_reset_identity)\r\n"]
[182.758548, "o", "        1    0.000    0.000    0.000    0.000 config.py:595(_get_root)\r\n"]
[182.769135, "o", "        2    0.000    0.000    0.000    0.000 base.py:432(_engine_type)\r\n"]
[182.779722, "o", "        1    0.000    0.000    0.000    0.000 {method 'max' of 'numpy.ndarray' objects}\r\n"]
[182.790308, "o", "        3    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:1017(_handle_fromlist)\r\n"]
[182.800895, "o", "        6    0.000    0.000    0.000    0.000 base.py:120(_reset_cache)\r\n"]
[182.811482, "o", "        6    0.000    0.000    0.000    0.000 take.py:325(_get_take_nd_function)\r\n"]
[182.822069, "o", "        2    0.000    0.000    0.000    0.000 common.py:651(is_integer_dtype)\r\n"]
[182.832655, "o", "        4    0.000    0.000    0.000    0.000 common.py:274(is_datetime64_dtype)\r\n"]
[182.843242, "o", "        4    0.000    0.000    0.000    0.000 ops.py:832(<listcomp>)\r\n"]
[182.853829, "o", "        2    0.000    0.000    0.000    0.000 {built-in method numpy.array}\r\n"]
[182.864415, "o", "        4    0.000    0.000    0.000    0.000 numerictypes.py:282(issubclass_)\r\n"]
[182.875002, "o", "        1    0.000    0.000    0.000    0.000 managers.py:1775(_consolidate_inplace)\r\n"]
[182.885589, "o", "        1    0.000    0.000    0.000    0.000 rolling.py:162(_validate)\r\n"]
[182.896176, "o", "        1    0.000    0.000    0.000    0.000 series.py:1262(_set_as_cached)\r\n"]
[182.906762, "o", "        6    0.000    0.000    0.000    0.000 common.py:1386(is_ea_or_datetimelike_dtype)\r\n"]
[182.917349, "o", "        1    0.000    0.000    0.000    0.000 _methods.py:39(_amax)\r\n"]
[182.927936, "o", "        2    0.000    0.000    0.000    0.000 managers.py:974(from_blocks)\r\n"]
[182.938522, "o", "       16    0.000    0.000    0.000    0.000 {built-in method __new__ of type object at 0x5626dff2c680}\r\n"]
[182.949109, "o", "        8    0.000    0.000    0.000    0.000 _methods.py:103(_clip_dep_is_byte_swapped)\r\n"]
[182.959696, "o", "        5    0.000    0.000    0.000    0.000 {built-in method numpy.asanyarray}\r\n"]
[182.970283, "o", "        1    0.000    0.000    0.000    0.000 _asarray.py:112(<setcomp>)\r\n"]
[182.980869, "o", "        1    0.000    0.000    0.000    0.000 rolling.py:220(_slice_axis_for_step)\r\n"]
[182.991456, "o", "        4    0.000    0.000    0.000    0.000 common.py:1332(is_extension_array_dtype)\r\n"]
[183.002043, "o", "        4    0.000    0.000    0.000    0.000 flags.py:49(__init__)\r\n"]
[183.01263, "o", "        2    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}\r\n"]
[183.023216, "o", "        1    0.000    0.000    0.000    0.000 multi.py:796(levels)\r\n"]
[183.033803, "o", "        6    0.000    0.000    0.000    0.000 common.py:151(<lambda>)\r\n"]
[183.04439, "o", "        1    0.000    0.000    0.000    0.000 base.py:1634(_set_names)\r\n"]
[183.054976, "o", "        2    0.000    0.000    0.000    0.000 warnings.py:458(__enter__)\r\n"]
[183.065563, "o", "        1    0.000    0.000    0.000    0.000 grouper.py:619(_passed_categorical)\r\n"]
[183.07615, "o", "        6    0.000    0.000    0.000    0.000 __init__.py:33(using_copy_on_write)\r\n"]
[183.086737, "o", "        7    0.000    0.000    0.000    0.000 inference.py:328(is_hashable)\r\n"]
[183.097323, "o", "        2    0.000    0.000    0.000    0.000 copy.py:66(copy)\r\n"]
[183.10791, "o", "       12    0.000    0.000    0.000    0.000 generic.py:506(_get_axis_number)\r\n"]
[183.118497, "o", "        1    0.000    0.000    0.000    0.000 frame.py:3649(_get_column_array)\r\n"]
[183.129084, "o", "        1    0.000    0.000    0.000    0.000 managers.py:1757(is_consolidated)\r\n"]
[183.13967, "o", "        3    0.000    0.000    0.000    0.000 {built-in method builtins.all}\r\n"]
[183.150257, "o", "        1    0.000    0.000    0.000    0.000 series.py:691(_values)\r\n"]
[183.160844, "o", "        3    0.000    0.000    0.000    0.000 construction.py:650(_sanitize_ndim)\r\n"]
[183.17143, "o", "       10    0.000    0.000    0.000    0.000 common.py:143(<lambda>)\r\n"]
[183.182017, "o", "        3    0.000    0.000    0.000    0.000 base.py:541(_ensure_array)\r\n"]
[183.192604, "o", "        2    0.000    0.000    0.000    0.000 frame.py:903(shape)\r\n"]
[183.203191, "o", "        2    0.000    0.000    0.000    0.000 range.py:307(dtype)\r\n"]
[183.213777, "o", "        1    0.000    0.000    0.000    0.000 base.py:2664(hasnans)\r\n"]
[183.224364, "o", "        1    0.000    0.000    0.000    0.000 rolling.py:404(_index_array)\r\n"]
[183.234951, "o", "        3    0.000    0.000    0.000    0.000 flags.py:85(allows_duplicate_labels)\r\n"]
[183.245537, "o", "        1    0.000    0.000    0.000    0.000 ops.py:821(codes)\r\n"]
[183.256124, "o", "       10    0.000    0.000    0.000    0.000 common.py:141(classes)\r\n"]
[183.266711, "o", "        1    0.000    0.000    0.000    0.000 managers.py:1053(iget_values)\r\n"]
[183.277298, "o", "        1    0.000    0.000    0.000    0.000 multi.py:801(<listcomp>)\r\n"]
[183.287884, "o", "        6    0.000    0.000    0.000    0.000 range.py:889(__len__)\r\n"]
[183.298471, "o", "        1    0.000    0.000    0.000    0.000 blocks.py:2211(get_block_type)\r\n"]
[183.309058, "o", "        4    0.000    0.000    0.000    0.000 common.py:150(cast_scalar_indexer)\r\n"]
[183.319645, "o", "        2    0.000    0.000    0.000    0.000 algorithms.py:231(_ensure_arraylike)\r\n"]
[183.330231, "o", "        8    0.000    0.000    0.000    0.000 base.py:1545(name)\r\n"]
[183.340818, "o", "        4    0.000    0.000    0.000    0.000 dtypes.py:492(validate_ordered)\r\n"]
[183.351405, "o", "        1    0.000    0.000    0.000    0.000 config.py:648(_warn_if_deprecated)\r\n"]
[183.361991, "o", "        4    0.000    0.000    0.000    0.000 {built-in method numpy.geterrobj}\r\n"]
[183.372578, "o", "        3    0.000    0.000    0.000    0.000 base.py:2623(_is_multi)\r\n"]
[183.383165, "o", "        3    0.000    0.000    0.000    0.000 objects.py:46(__init__)\r\n"]
[183.393752, "o", "        1    0.000    0.000    0.000    0.000 managers.py:2125(_grouping_func)\r\n"]
[183.404338, "o", "        3    0.000    0.000    0.000    0.000 {pandas._libs.lib.is_scalar}\r\n"]
[183.414925, "o", "        2    0.000    0.000    0.000    0.000 common.py:1432(_is_dtype)\r\n"]
[183.425512, "o", "        1    0.000    0.000    0.000    0.000 rolling.py:264(_create_data)\r\n"]
[183.436099, "o", "        5    0.000    0.000    0.000    0.000 _dtype.py:24(_kind_name)\r\n"]
[183.446685, "o", "        2    0.000    0.000    0.000    0.000 grouper.py:891(<genexpr>)\r\n"]
[183.457272, "o", "        2    0.000    0.000    0.000    0.000 {built-in method numpy.seterrobj}\r\n"]
[183.467859, "o", "        2    0.000    0.000    0.000    0.000 missing.py:455(array_equivalent)\r\n"]
[183.478445, "o", "        1    0.000    0.000    0.000    0.000 managers.py:1961(internal_values)\r\n"]
[183.489032, "o", "        2    0.000    0.000    0.000    0.000 {method 'remove' of 'list' objects}\r\n"]
[183.499619, "o", "        6    0.000    0.000    0.000    0.000 common.py:146(classes_and_not_datetimelike)\r\n"]
[183.510206, "o", "        1    0.000    0.000    0.000    0.000 rolling.py:312(__getattr__)\r\n"]
[183.520792, "o", "        1    0.000    0.000    0.000    0.000 base.py:2070(_can_hold_na)\r\n"]
[183.531379, "o", "        1    0.000    0.000    0.000    0.000 generic.py:526(_get_block_manager_axis)\r\n"]
[183.541966, "o", "        1    0.000    0.000    0.000    0.000 generic.py:596(_info_axis)\r\n"]
[183.552552, "o", "        4    0.000    0.000    0.000    0.000 common.py:1649(pandas_dtype)\r\n"]
[183.563139, "o", "        1    0.000    0.000    0.000    0.000 rolling.py:724(<listcomp>)\r\n"]
[183.573726, "o", "        2    0.000    0.000    0.000    0.000 grouper.py:893(<genexpr>)\r\n"]
[183.584313, "o", "        4    0.000    0.000    0.000    0.000 common.py:350(is_timedelta64_dtype)\r\n"]
[183.594899, "o", "        7    0.000    0.000    0.000    0.000 generic.py:620(ndim)\r\n"]
[183.605486, "o", "        2    0.000    0.000    0.000    0.000 config.py:609(_get_deprecated_option)\r\n"]
[183.616073, "o", "        1    0.000    0.000    0.000    0.000 base.py:740(_rename)\r\n"]
[183.62666, "o", "        3    0.000    0.000    0.000    0.000 construction.py:689(_sanitize_str_dtypes)\r\n"]
[183.637246, "o", "       11    0.000    0.000    0.000    0.000 ops.py:699(groupings)\r\n"]
[183.647833, "o", "        1    0.000    0.000    0.000    0.000 ops.py:824(<listcomp>)\r\n"]
[183.65842, "o", "        1    0.000    0.000    0.000    0.000 multi.py:506(<listcomp>)\r\n"]
[183.669006, "o", "        1    0.000    0.000    0.000    0.000 ops.py:685(__init__)\r\n"]
[183.679593, "o", "        6    0.000    0.000    0.000    0.000 inference.py:294(<genexpr>)\r\n"]
[183.69018, "o", "        1    0.000    0.000    0.000    0.000 categorical.py:697(categories)\r\n"]
[183.700767, "o", "        1    0.000    0.000    0.000    0.000 common.py:1624(validate_all_hashable)\r\n"]
[183.711353, "o", "        2    0.000    0.000    0.000    0.000 blocks.py:824(iget)\r\n"]
[183.72194, "o", "        2    0.000    0.000    0.000    0.000 warnings.py:437(__init__)\r\n"]
[183.732527, "o", "        2    0.000    0.000    0.000    0.000 missing.py:949(clean_reindex_fill_method)\r\n"]
[183.743113, "o", "        3    0.000    0.000    0.000    0.000 construction.py:464(ensure_wrapped_if_datetimelike)\r\n"]
[183.7537, "o", "        1    0.000    0.000    0.000    0.000 indexing.py:2606(check_dict_or_set_indexers)\r\n"]
[183.764287, "o", "        1    0.000    0.000    0.000    0.000 managers.py:2273(_preprocess_slice_or_indexer)\r\n"]
[183.774874, "o", "       11    0.000    0.000    0.000    0.000 base.py:324(ndim)\r\n"]
[183.78546, "o", "        1    0.000    0.000    0.000    0.000 ops.py:826(levels)\r\n"]
[183.796047, "o", "        4    0.000    0.000    0.000    0.000 {method 'view' of 'numpy.ndarray' objects}\r\n"]
[183.806634, "o", "        1    0.000    0.000    0.000    0.000 grouper.py:623(name)\r\n"]
[183.817221, "o", "        1    0.000    0.000    0.000    0.000 rolling.py:205(_check_window_bounds)\r\n"]
[183.827807, "o", "        6    0.000    0.000    0.000    0.000 base.py:898(dtype)\r\n"]
[183.838394, "o", "        5    0.000    0.000    0.000    0.000 {method 'add' of 'set' objects}\r\n"]
[183.848981, "o", "        1    0.000    0.000    0.000    0.000 _ufunc_config.py:426(__init__)\r\n"]
[183.859567, "o", "        2    0.000    0.000    0.000    0.000 {method 'copy' of 'numpy.ndarray' objects}\r\n"]
[183.870154, "o", "        1    0.000    0.000    0.000    0.000 grouper.py:943(is_in_obj)\r\n"]
[183.880741, "o", "        9    0.000    0.000    0.000    0.000 {built-in method builtins.hash}\r\n"]
[183.891328, "o", "        6    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}\r\n"]
[183.901914, "o", "        3    0.000    0.000    0.000    0.000 {method 'discard' of 'set' objects}\r\n"]
[183.912501, "o", "        1    0.000    0.000    0.000    0.000 managers.py:1765(_consolidate_check)\r\n"]
[183.923088, "o", "        2    0.000    0.000    0.000    0.000 {method 'ravel' of 'numpy.ndarray' objects}\r\n"]
[183.933675, "o", "        2    0.000    0.000    0.000    0.000 warnings.py:477(__exit__)\r\n"]
[183.944261, "o", "        1    0.000    0.000    0.000    0.000 grouper.py:927(is_in_axis)\r\n"]
[183.954848, "o", "        1    0.000    0.000    0.000    0.000 sorting.py:144(_int64_cut_off)\r\n"]
[183.965435, "o", "        3    0.000    0.000    0.000    0.000 fromnumeric.py:70(<dictcomp>)\r\n"]
[183.976021, "o", "        2    0.000    0.000    0.000    0.000 frame.py:631(_constructor)\r\n"]
[183.986608, "o", "        1    0.000    0.000    0.000    0.000 sorting.py:157(<listcomp>)\r\n"]
[183.997195, "o", "        3    0.000    0.000    0.000    0.000 base.py:1064(_maybe_disallow_fill)\r\n"]
[184.007782, "o", "        2    0.000    0.000    0.000    0.000 sorting.py:608(<genexpr>)\r\n"]
[184.018368, "o", "        2    0.000    0.000    0.000    0.000 grouper.py:669(codes)\r\n"]
[184.028955, "o", "        3    0.000    0.000    0.000    0.000 base.py:654(_constructor)\r\n"]
[184.039542, "o", "        3    0.000    0.000    0.000    0.000 generic.py:335(attrs)\r\n"]
[184.050128, "o", "        1    0.000    0.000    0.000    0.000 groupby.py:945(__getattr__)\r\n"]
[184.060715, "o", "        1    0.000    0.000    0.000    0.000 groupby.py:720(_selected_obj)\r\n"]
[184.071302, "o", "        6    0.000    0.000    0.000    0.000 multiarray.py:152(concatenate)\r\n"]
[184.081889, "o", "        3    0.000    0.000    0.000    0.000 managers.py:939(__init__)\r\n"]
[184.092475, "o", "        1    0.000    0.000    0.000    0.000 range.py:248(start)\r\n"]
[184.103062, "o", "        1    0.000    0.000    0.000    0.000 config.py:577(_select_options)\r\n"]
[184.113649, "o", "        1    0.000    0.000    0.000    0.000 _validators.py:222(validate_bool_kwarg)\r\n"]
[184.124236, "o", "        9    0.000    0.000    0.000    0.000 {method 'append' of 'list' objects}\r\n"]
[184.134822, "o", "        2    0.000    0.000    0.000    0.000 base.py:749(is_)\r\n"]
[184.145409, "o", "        1    0.000    0.000    0.000    0.000 ops.py:790(<listcomp>)\r\n"]
[184.155996, "o", "        4    0.000    0.000    0.000    0.000 multi.py:943(nlevels)\r\n"]
[184.166582, "o", "        7    0.000    0.000    0.000    0.000 typing.py:1149(cast)\r\n"]
[184.177169, "o", "        1    0.000    0.000    0.000    0.000 blocks.py:476(dtype)\r\n"]
[184.187756, "o", "        1    0.000    0.000    0.000    0.000 frame.py:4217(_clear_item_cache)\r\n"]
[184.198343, "o", "        8    0.000    0.000    0.000    0.000 {method 'items' of 'dict' objects}\r\n"]
[184.208929, "o", "        1    0.000    0.000    0.000    0.000 ops.py:828(<listcomp>)\r\n"]
[184.219516, "o", "        1    0.000    0.000    0.000    0.000 {method 'upper' of 'str' objects}\r\n"]
[184.230103, "o", "        1    0.000    0.000    0.000    0.000 frame.py:886(axes)\r\n"]
[184.24069, "o", "        5    0.000    0.000    0.000    0.000 {pandas._libs.lib.is_integer}\r\n"]
[184.251276, "o", "        7    0.000    0.000    0.000    0.000 {method 'clear' of 'dict' objects}\r\n"]
[184.261863, "o", "        4    0.000    0.000    0.000    0.000 managers.py:179(blklocs)\r\n"]
[184.27245, "o", "        1    0.000    0.000    0.000    0.000 range.py:482(equals)\r\n"]
[184.283036, "o", "        3    0.000    0.000    0.000    0.000 flags.py:53(allows_duplicate_labels)\r\n"]
[184.293623, "o", "        2    0.000    0.000    0.000    0.000 common.py:1643(<genexpr>)\r\n"]
[184.30421, "o", "        1    0.000    0.000    0.000    0.000 {pandas._libs.internals.get_blkno_placements}\r\n"]
[184.314797, "o", "        1    0.000    0.000    0.000    0.000 common.py:1319(is_1d_only_ea_dtype)\r\n"]
[184.325383, "o", "        2    0.000    0.000    0.000    0.000 multi.py:1395(_get_names)\r\n"]
[184.33597, "o", "        3    0.000    0.000    0.000    0.000 dtypes.py:587(ordered)\r\n"]
[184.346557, "o", "        6    0.000    0.000    0.000    0.000 {pandas._libs.lib.is_bool}\r\n"]
[184.357143, "o", "        8    0.000    0.000    0.000    0.000 fromnumeric.py:3148(_ndim_dispatcher)\r\n"]
[184.36773, "o", "        2    0.000    0.000    0.000    0.000 grouper.py:892(<genexpr>)\r\n"]
[184.378317, "o", "        1    0.000    0.000    0.000    0.000 config.py:636(_translate_key)\r\n"]
[184.388904, "o", "        1    0.000    0.000    0.000    0.000 managers.py:1799(__init__)\r\n"]
[184.39949, "o", "        1    0.000    0.000    0.000    0.000 categorical.py:1768(_codes)\r\n"]
[184.410077, "o", "        1    0.000    0.000    0.000    0.000 categorical.py:459(dtype)\r\n"]
[184.420664, "o", "        2    0.000    0.000    0.000    0.000 common.py:1165(<lambda>)\r\n"]
[184.431251, "o", "        1    0.000    0.000    0.000    0.000 range.py:195(_constructor)\r\n"]
[184.441837, "o", "        5    0.000    0.000    0.000    0.000 dtypes.py:580(categories)\r\n"]
[184.452424, "o", "        2    0.000    0.000    0.000    0.000 {method 'insert' of 'list' objects}\r\n"]
[184.463011, "o", "        1    0.000    0.000    0.000    0.000 numba_.py:18(maybe_use_numba)\r\n"]
[184.473597, "o", "        1    0.000    0.000    0.000    0.000 {built-in method builtins.max}\r\n"]
[184.484184, "o", "        6    0.000    0.000    0.000    0.000 {built-in method _warnings._filters_mutated}\r\n"]
[184.494771, "o", "        3    0.000    0.000    0.000    0.000 base.py:5937(_index_as_unique)\r\n"]
[184.505358, "o", "        2    0.000    0.000    0.000    0.000 missing.py:121(clean_fill_method)\r\n"]
[184.515944, "o", "        6    0.000    0.000    0.000    0.000 generic.py:356(flags)\r\n"]
[184.526531, "o", "        1    0.000    0.000    0.000    0.000 range.py:256(stop)\r\n"]
[184.537118, "o", "        4    0.000    0.000    0.000    0.000 fromnumeric.py:2107(_clip_dispatcher)\r\n"]
[184.547704, "o", "        4    0.000    0.000    0.000    0.000 {pandas._libs.lib.is_float}\r\n"]
[184.558291, "o", "        1    0.000    0.000    0.000    0.000 {method 'split' of 'str' objects}\r\n"]
[184.568878, "o", "        1    0.000    0.000    0.000    0.000 common.py:367(apply_if_callable)\r\n"]
[184.579465, "o", "        1    0.000    0.000    0.000    0.000 {method 'item' of 'numpy.ndarray' objects}\r\n"]
[184.590051, "o", "        1    0.000    0.000    0.000    0.000 range.py:263(step)\r\n"]
[184.600638, "o", "        1    0.000    0.000    0.000    0.000 managers.py:224(is_single_block)\r\n"]
[184.611225, "o", "        1    0.000    0.000    0.000    0.000 base.py:200(_selected_obj)\r\n"]
[184.621812, "o", "        1    0.000    0.000    0.000    0.000 function.py:60(__call__)\r\n"]
[184.632398, "o", "        3    0.000    0.000    0.000    0.000 construction.py:709(_maybe_repeat)\r\n"]
[184.642985, "o", "        2    0.000    0.000    0.000    0.000 {method 'values' of 'dict' objects}\r\n"]
[184.653572, "o", "        1    0.000    0.000    0.000    0.000 sorting.py:227(is_int64_overflow_possible)\r\n"]
[184.664158, "o", "        3    0.000    0.000    0.000    0.000 {pandas._libs.lib.is_iterator}\r\n"]
[184.674745, "o", "        1    0.000    0.000    0.000    0.000 {method 'get_loc' of 'pandas._libs.index.IndexEngine' objects}\r\n"]
[184.685332, "o", "        1    0.000    0.000    0.000    0.000 grouper.py:1017(_is_label_like)\r\n"]
[184.695919, "o", "        1    0.000    0.000    0.000    0.000 managers.py:229(items)\r\n"]
[184.706505, "o", "        2    0.000    0.000    0.000    0.000 function_base.py:5440(_append_dispatcher)\r\n"]
[184.717092, "o", "        2    0.000    0.000    0.000    0.000 {method 'extend' of 'list' objects}\r\n"]
[184.727679, "o", "        1    0.000    0.000    0.000    0.000 managers.py:1894(_block)\r\n"]
[184.738266, "o", "        1    0.000    0.000    0.000    0.000 ops.py:791(<listcomp>)\r\n"]
[184.748852, "o", "        1    0.000    0.000    0.000    0.000 grouper.py:641(_ilevel)\r\n"]
[184.759439, "o", "        2    0.000    0.000    0.000    0.000 multi.py:978(codes)\r\n"]
[184.770026, "o", "        1    0.000    0.000    0.000    0.000 {pandas._libs.lib.item_from_zerodim}\r\n"]
[184.780612, "o", "        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}\r\n"]
[184.791199, "o", "        1    0.000    0.000    0.000    0.000 generic.py:1706(<genexpr>)\r\n"]
[184.801786, "o", "        2    0.000    0.000    0.000    0.000 fromnumeric.py:1777(_ravel_dispatcher)\r\n"]
[184.812373, "o", "        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}\r\n"]
[184.822959, "o", "        2    0.000    0.000    0.000    0.000 fromnumeric.py:2950(_prod_dispatcher)\r\n"]
[184.833546, "o", "        1    0.000    0.000    0.000    0.000 multiarray.py:1079(copyto)\r\n"]
[184.844133, "o", "        1    0.000    0.000    0.000    0.000 series.py:594(name)\r\n"]
[184.854719, "o", "        1    0.000    0.000    0.000    0.000 base.py:6298(_maybe_cast_indexer)\r\n"]
[184.865306, "o", "        1    0.000    0.000    0.000    0.000 {pandas._libs.algos.ensure_float64}\r\n"]
[184.875893, "o", "        2    0.000    0.000    0.000    0.000 {method 'copy' of 'list' objects}\r\n"]
[184.88648, "o", "        1    0.000    0.000    0.000    0.000 function_base.py:5050(_delete_dispatcher)\r\n"]
[184.897066, "o", "        1    0.000    0.000    0.000    0.000 fromnumeric.py:2427(_all_dispatcher)\r\n"]
[184.907653, "o", "        1    0.000    0.000    0.000    0.000 {pandas._libs.algos.ensure_int64}\r\n"]
[184.91824, "o", "        1    0.000    0.000    0.000    0.000 {method 'pop' of 'dict' objects}\r\n"]
[184.928827, "o", "        1    0.000    0.000    0.000    0.000 {function FrozenList.__getitem__ at 0x7fb917736280}\r\n"]
[184.939413, "o", "\r\n"]
[185.0, "o", "(asv_3.8) root@cb2cc1765c92:/workspace/repo/asv_bench# "]
[185.002, "i", "grep -n \"MultiIndex\\(|_grouper|indices.values|_create_data\" ../pandas/core/window/rolling.py\r"]
[185.004, "o", "grep -n \"MultiIndex\\(|_grouper|indices.values|_create_data\" ../pandas/core/window/rolling.py\r\n"]
[187.478, "o", "\u001b[?2004l\r\n"]
[190.0, "o", "(asv_3.8) root@cb2cc1765c92:/workspace/repo/asv_bench# "]
[190.002, "i", "applypatch << 'PATCH'\r"]
[190.004, "o", "applypatch << 'PATCH'\r\n"]
[190.097556, "o", "\u001b[?2004l\r\n"]
[190.189111, "o", "\u001b[?2004h> *** Begin Patch\r\n"]
[190.280667, "o", "\u001b[?2004l\r\n"]
[190.372222, "o", "\u001b[?2004h> *** Update File: pandas/core/window/rolling.py\r\n"]
[190.463778, "o", "\u001b[?2004l\r\n"]
[190.555333, "o", "\u001b[?2004h> @@\r\n"]
[190.646889, "o", "\u001b[?2004l\r\n"]
[190.738444, "o", "\u001b[?2004h> -        if not obj.empty:\r\n"]
[190.83, "o", "\u001b[?2004l\r\n"]
[190.921556, "o", "\u001b[?2004h> -            groupby_order = np.concatenate(list(self._grouper.indices.values())).astype(\r\n"]
[191.013111, "o", "\u001b[?2004l\r\n"]
[191.104667, "o", "\u001b[?2004h> -                np.int64\r\n"]
[191.196222, "o", "\u001b[?2004l\r\n"]
[191.287778, "o", "\u001b[?2004h> -            )\r\n"]
[191.379333, "o", "\u001b[?2004l\r\n"]
[191.470889, "o", "\u001b[?2004h> -            obj = obj.take(groupby_order)\r\n"]
[191.562444, "o", "\u001b[?2004l\r\n"]
[191.654, "o", "\u001b[?2004h> +        if not obj.empty:\r\n"]
[191.745556, "o", "\u001b[?2004l\r\n"]
[191.837111, "o", "\u001b[?2004h> +            # Construct the take indexer in group order. Avoid creating\r\n"]
[191.928667, "o", "\u001b[?2004l\r\n"]
[192.020222, "o", "\u001b[?2004h> +            # unnecessary copies: keep the platform-native integer dtype\r\n"]
[192.111778, "o", "\u001b[?2004l\r\n"]
[192.203333, "o", "\u001b[?2004h> +            # (np.intp) and avoid an extra cast to int64 which would allocate\r\n"]
[192.294889, "o", "\u001b[?2004l\r\n"]
[192.386444, "o", "\u001b[?2004h> +            # a new array. This is a hot path for GroupBy.rolling on few but\r\n"]
[192.478, "o", "\u001b[?2004l\r\n"]
[192.569556, "o", "\u001b[?2004h> +            # large groups (see asv rolling.GroupbyLargeGroups).\r\n"]
[192.661111, "o", "\u001b[?2004l\r\n"]
[192.752667, "o", "\u001b[?2004h> +            group_indices = self._grouper.indices.values()\r\n"]
[192.844222, "o", "\u001b[?2004l\r\n"]
[192.935778, "o", "\u001b[?2004h> +            if group_indices:\r\n"]
[193.027333, "o", "\u001b[?2004l\r\n"]
[193.118889, "o", "\u001b[?2004h> +                groupby_order = np.concatenate(list(group_indices))\r\n"]
[193.210444, "o", "\u001b[?2004l\r\n"]
[193.302, "o", "\u001b[?2004h> +                # Ensure correct dtype without forcing a copy\r\n"]
[193.393556, "o", "\u001b[?2004l\r\n"]
[193.485111, "o", "\u001b[?2004h> +                if groupby_order.dtype != np.intp:\r\n"]
[193.576667, "o", "\u001b[?2004l\r\n"]
[193.668222, "o", "\u001b[?2004h> +                    groupby_order = groupby_order.astype(np.intp, copy=False)\r\n"]
[193.759778, "o", "\u001b[?2004l\r\n"]
[193.851333, "o", "\u001b[?2004h> +            else:\r\n"]
[193.942889, "o", "\u001b[?2004l\r\n"]
[194.034444, "o", "\u001b[?2004h> +                # Empty groupby -> empty indexer\r\n"]
[194.126, "o", "\u001b[?2004l\r\n"]
[194.217556, "o", "\u001b[?2004h> +                groupby_order = np.array([], dtype=np.intp)\r\n"]
[194.309111, "o", "\u001b[?2004l\r\n"]
[194.400667, "o", "\u001b[?2004h> +            obj = obj.take(groupby_order)\r\n"]
[194.492222, "o", "\u001b[?2004l\r\n"]
[194.583778, "o", "\u001b[?2004h> *** End Patch\r\n"]
[194.675333, "o", "\u001b[?2004l\r\n"]
[194.766889, "o", "\u001b[?2004h> PATCH\r\n"]
[194.858444, "o", "\u001b[?2004l\r\n"]
[195.0, "o", "(asv_3.8) root@cb2cc1765c92:/workspace/repo/asv_bench# "]
[195.002, "i", "git -C .. diff -- pandas/core/window/rolling.py | sed -n '1,200p'\r"]
[195.004, "o", "git -C .. diff -- pandas/core/window/rolling.py | sed -n '1,200p'\r\n"]
[195.006, "o", "\u001b[?2004l\r\n"]
[200.0, "o", "(asv_3.8) root@cb2cc1765c92:/workspace/repo/asv_bench# "]
[200.002, "i", "asv profile --python=same rolling.GroupbyLargeGroups.time_rolling_multiindex_creation\r"]
[200.004, "o", "asv profile --python=same rolling.GroupbyLargeGroups.time_rolling_multiindex_creation\r\n"]
[200.016587, "o", "\u001b[?2004l\r\n"]
[200.027173, "o", "\u00b7 \u001b[0;32mDiscovering benchmarks\u001b[0m\r\n"]
[200.03776, "o", "\u00b7 \u001b[0;32mProfile data does not already exist. Running profiler now.\u001b[0m\r\n"]
[200.048347, "o", "\u00b7\u00b7 \u001b[0;34mBenchmarking existing-py_opt_conda_envs_asv_3.8_bin_python\u001b[0m\r\n"]
[200.058934, "o", "\u00b7\u00b7\u00b7 \u001b[0;39mRunning (rolling.GroupbyLargeGroups.time_rolling_multiindex_creation--)\u001b[0m.\r\n"]
[200.06952, "o", "\u00b7\u00b7\u00b7 \u001b[0;39mrolling.GroupbyLargeGroups.time_rolling_multiindex_creation\u001b[0m                                                                             19.7\u00b10.2ms\r\n"]
[200.080107, "o", "\r\n"]
[200.090694, "o", "Wed Oct  1 18:30:59 2025    /tmp/tmpr94rqkwo\r\n"]
[200.101281, "o", "\r\n"]
[200.111867, "o", "         2358 function calls (2304 primitive calls) in 0.020 seconds\r\n"]
[200.122454, "o", "\r\n"]
[200.133041, "o", "   Ordered by: cumulative time\r\n"]
[200.143627, "o", "\r\n"]
[200.154214, "o", "   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\r\n"]
[200.164801, "o", "        1    0.000    0.000    0.020    0.020 {built-in method builtins.exec}\r\n"]
[200.175388, "o", "        1    0.000    0.000    0.020    0.020 _base.py:689(method_caller)\r\n"]
[200.185974, "o", "        1    0.000    0.000    0.020    0.020 rolling.py:322(time_rolling_multiindex_creation)\r\n"]
[200.196561, "o", "        1    0.000    0.000    0.019    0.019 rolling.py:2070(mean)\r\n"]
[200.207148, "o", "        1    0.000    0.000    0.019    0.019 rolling.py:1489(mean)\r\n"]
[200.217734, "o", "        1    0.000    0.000    0.019    0.019 rolling.py:701(_apply)\r\n"]
[200.228321, "o", "        1    0.000    0.000    0.013    0.013 multi.py:445(from_arrays)\r\n"]
[200.238908, "o", "        1    0.000    0.000    0.013    0.013 categorical.py:2586(factorize_from_iterables)\r\n"]
[200.249495, "o", "        2    0.000    0.000    0.013    0.006 categorical.py:2607(<genexpr>)\r\n"]
[200.260081, "o", "        1    0.000    0.000    0.013    0.013 categorical.py:2545(factorize_from_iterable)\r\n"]
[200.270668, "o", "        1    0.000    0.000    0.013    0.013 categorical.py:359(__init__)\r\n"]
[200.281255, "o", "      3/2    0.000    0.000    0.013    0.006 algorithms.py:610(factorize)\r\n"]
[200.291842, "o", "        1    0.000    0.000    0.012    0.012 base.py:1143(factorize)\r\n"]
[200.302428, "o", "        2    0.000    0.000    0.010    0.005 algorithms.py:1702(safe_sort)\r\n"]
[200.313015, "o", "        4    0.010    0.002    0.010    0.002 {method 'argsort' of 'numpy.ndarray' objects}\r\n"]
[200.323602, "o", "        1    0.000    0.000    0.005    0.005 rolling.py:558(_apply)\r\n"]
[200.334188, "o", "        1    0.000    0.000    0.003    0.003 rolling.py:456(_apply_blockwise)\r\n"]
[200.344775, "o", "        1    0.000    0.000    0.002    0.002 rolling.py:591(homogeneous_func)\r\n"]
[200.355362, "o", "        1    0.000    0.000    0.002    0.002 rolling.py:597(calc)\r\n"]
[200.365949, "o", "        2    0.000    0.000    0.002    0.001 algorithms.py:548(factorize_array)\r\n"]
[200.376535, "o", "        2    0.002    0.001    0.002    0.001 {method 'factorize' of 'pandas._libs.hashtable.Int64HashTable' objects}\r\n"]
[200.387122, "o", "        1    0.000    0.000    0.002    0.002 rolling.py:2695(_get_window_indexer)\r\n"]
[200.397709, "o", "        1    0.000    0.000    0.002    0.002 ops.py:784(indices)\r\n"]
[200.408296, "o", "        1    0.001    0.001    0.001    0.001 {pandas._libs.window.aggregations.roll_mean}\r\n"]
[200.418882, "o", "        1    0.000    0.000    0.001    0.001 sorting.py:599(get_indexer_dict)\r\n"]
[200.429469, "o", "        1    0.000    0.000    0.001    0.001 objects.py:324(get_window_bounds)\r\n"]
[200.440056, "o", "        1    0.000    0.000    0.001    0.001 groupby.py:2649(rolling)\r\n"]
[200.450642, "o", "        1    0.000    0.000    0.001    0.001 rolling.py:678(__init__)\r\n"]
[200.461229, "o", "       12    0.001    0.000    0.001    0.000 {method 'take' of 'numpy.ndarray' objects}\r\n"]
[200.471816, "o", "        1    0.000    0.000    0.001    0.001 frame.py:5087(drop)\r\n"]
[200.482403, "o", "        1    0.000    0.000    0.001    0.001 generic.py:4505(drop)\r\n"]
[200.492989, "o", "        1    0.000    0.000    0.001    0.001 generic.py:4544(_drop_axis)\r\n"]
[200.503576, "o", "        1    0.000    0.000    0.001    0.001 ops.py:910(result_index)\r\n"]
[200.514163, "o", "        1    0.000    0.000    0.001    0.001 grouper.py:688(result_index)\r\n"]
[200.524749, "o", "        1    0.000    0.000    0.001    0.001 grouper.py:700(group_index)\r\n"]
[200.535336, "o", "        4    0.000    0.000    0.001    0.000 dtypes.py:186(__init__)\r\n"]
[200.545923, "o", "        4    0.000    0.000    0.001    0.000 dtypes.py:339(_finalize)\r\n"]
[200.55651, "o", "        2    0.000    0.000    0.001    0.000 dtypes.py:511(validate_categories)\r\n"]
[200.567096, "o", "        2    0.001    0.000    0.001    0.000 base.py:2168(is_unique)\r\n"]
[200.577683, "o", "        1    0.000    0.000    0.001    0.001 rolling.py:846(_create_data)\r\n"]
[200.58827, "o", "        1    0.000    0.000    0.001    0.001 grouper.py:722(_codes_and_uniques)\r\n"]
[200.598857, "o", "        6    0.000    0.000    0.001    0.000 take.py:58(take_nd)\r\n"]
[200.609443, "o", "        6    0.000    0.000    0.001    0.000 take.py:120(_take_nd_ndarray)\r\n"]
[200.62003, "o", "    27/15    0.000    0.000    0.001    0.000 {built-in method numpy.core._multiarray_umath.implement_array_function}\r\n"]
[200.630617, "o", "        2    0.000    0.000    0.001    0.000 managers.py:641(reindex_indexer)\r\n"]
[200.641203, "o", "        1    0.000    0.000    0.001    0.001 generic.py:3819(take)\r\n"]
[200.65179, "o", "        1    0.000    0.000    0.001    0.001 generic.py:3898(_take)\r\n"]
[200.662377, "o", "        1    0.000    0.000    0.001    0.001 managers.py:886(take)\r\n"]
[200.672964, "o", "        1    0.000    0.000    0.000    0.000 sorting.py:632(get_group_index_sorter)\r\n"]
[200.68355, "o", "        2    0.000    0.000    0.000    0.000 blocks.py:858(take_nd)\r\n"]
[200.694137, "o", "        1    0.000    0.000    0.000    0.000 {pandas._libs.algos.groupsort_indexer}\r\n"]
[200.704724, "o", "        2    0.000    0.000    0.000    0.000 objects.py:76(get_window_bounds)\r\n"]
[200.71531, "o", "        1    0.000    0.000    0.000    0.000 base.py:6610(drop)\r\n"]
[200.725897, "o", "        2    0.000    0.000    0.000    0.000 base.py:3676(get_indexer)\r\n"]
[200.736484, "o", "        3    0.000    0.000    0.000    0.000 base.py:1033(take)\r\n"]
[200.747071, "o", "        4    0.000    0.000    0.000    0.000 <__array_function__ internals>:177(clip)\r\n"]
[200.757657, "o", "        1    0.000    0.000    0.000    0.000 managers.py:705(<listcomp>)\r\n"]
[200.768244, "o", "        4    0.000    0.000    0.000    0.000 fromnumeric.py:2111(clip)\r\n"]
[200.778831, "o", "        4    0.000    0.000    0.000    0.000 fromnumeric.py:51(_wrapfunc)\r\n"]
[200.789418, "o", "        1    0.000    0.000    0.000    0.000 managers.py:726(_slice_take_blocks_ax0)\r\n"]
[200.800004, "o", "        4    0.000    0.000    0.000    0.000 {method 'clip' of 'numpy.ndarray' objects}\r\n"]
[200.810591, "o", "        4    0.000    0.000    0.000    0.000 _methods.py:127(_clip)\r\n"]
[200.821178, "o", "        1    0.000    0.000    0.000    0.000 frame.py:8104(groupby)\r\n"]
[200.831764, "o", "        6    0.000    0.000    0.000    0.000 <__array_function__ internals>:177(concatenate)\r\n"]
[200.842351, "o", "        1    0.000    0.000    0.000    0.000 base.py:5777(get_indexer_for)\r\n"]
[200.852938, "o", "        1    0.000    0.000    0.000    0.000 {pandas._libs.algos.take_2d_axis0_float64_float64}\r\n"]
[200.863525, "o", "        1    0.000    0.000    0.000    0.000 groupby.py:896(__init__)\r\n"]
[200.874111, "o", "        1    0.000    0.000    0.000    0.000 grouper.py:790(get_grouper)\r\n"]
[200.884698, "o", "        3    0.000    0.000    0.000    0.000 algorithms.py:1396(take)\r\n"]
[200.895285, "o", "        4    0.000    0.000    0.000    0.000 _methods.py:108(_clip_dep_invoke_with_casting)\r\n"]
[200.905872, "o", "  392/382    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}\r\n"]
[200.916458, "o", "        4    0.000    0.000    0.000    0.000 {pandas._libs.algos.take_1d_int64_int64}\r\n"]
[200.927045, "o", "        3    0.000    0.000    0.000    0.000 base.py:449(__new__)\r\n"]
[200.937632, "o", "        1    0.000    0.000    0.000    0.000 {pandas._libs.algos.take_2d_axis1_float64_float64}\r\n"]
[200.948218, "o", "        1    0.000    0.000    0.000    0.000 frame.py:2459(_from_arrays)\r\n"]
[200.958805, "o", "        1    0.000    0.000    0.000    0.000 {pandas._libs.lib.indices_fast}\r\n"]
[200.969392, "o", "        2    0.000    0.000    0.000    0.000 multi.py:313(__new__)\r\n"]
[200.979979, "o", "        5    0.000    0.000    0.000    0.000 {built-in method numpy.arange}\r\n"]
[200.990565, "o", "        1    0.000    0.000    0.000    0.000 sorting.py:109(get_group_index)\r\n"]
[201.001152, "o", "        1    0.000    0.000    0.000    0.000 rolling.py:742(<listcomp>)\r\n"]
[201.011739, "o", "        1    0.000    0.000    0.000    0.000 construction.py:96(arrays_to_mgr)\r\n"]
[201.022325, "o", "       12    0.000    0.000    0.000    0.000 {method 'astype' of 'numpy.ndarray' objects}\r\n"]
[201.032912, "o", "        1    0.000    0.000    0.000    0.000 frame.py:3689(__getitem__)\r\n"]
[201.043499, "o", "        4    0.000    0.000    0.000    0.000 cast.py:971(coerce_indexer_dtype)\r\n"]
[201.054086, "o", "        1    0.000    0.000    0.000    0.000 sorting.py:622(<listcomp>)\r\n"]
[201.064672, "o", "        9    0.000    0.000    0.000    0.000 base.py:7014(ensure_index)\r\n"]
[201.075259, "o", "        2    0.000    0.000    0.000    0.000 base.py:6305(_maybe_cast_listlike_indexer)\r\n"]
[201.085846, "o", "        2    0.000    0.000    0.000    0.000 algorithms.py:265(_get_hashtable_algo)\r\n"]
[201.096433, "o", "      117    0.000    0.000    0.000    0.000 generic.py:42(_instancecheck)\r\n"]
[201.107019, "o", "        1    0.000    0.000    0.000    0.000 utils.py:241(maybe_convert_indices)\r\n"]
[201.117606, "o", "        1    0.000    0.000    0.000    0.000 managers.py:2069(create_block_manager_from_column_arrays)\r\n"]
[201.128193, "o", "        1    0.000    0.000    0.000    0.000 frame.py:4220(_get_item_cache)\r\n"]
[201.138779, "o", "        2    0.000    0.000    0.000    0.000 base.py:6029(_should_compare)\r\n"]
[201.149366, "o", "        3    0.000    0.000    0.000    0.000 construction.py:500(sanitize_array)\r\n"]
[201.159953, "o", "        9    0.000    0.000    0.000    0.000 {method 'reduce' of 'numpy.ufunc' objects}\r\n"]
[201.17054, "o", "        1    0.000    0.000    0.000    0.000 managers.py:2141(_form_blocks)\r\n"]
[201.181126, "o", "        2    0.000    0.000    0.000    0.000 <__array_function__ internals>:177(append)\r\n"]
[201.191713, "o", "        2    0.000    0.000    0.000    0.000 multi.py:982(_set_codes)\r\n"]
[201.2023, "o", "        1    0.000    0.000    0.000    0.000 frame.py:3615(_ixs)\r\n"]
[201.212887, "o", "        2    0.000    0.000    0.000    0.000 function_base.py:5444(append)\r\n"]
[201.223473, "o", "        5    0.000    0.000    0.000    0.000 {method 'any' of 'numpy.ndarray' objects}\r\n"]
[201.23406, "o", "        6    0.000    0.000    0.000    0.000 common.py:1241(is_bool_dtype)\r\n"]
[201.244647, "o", "       17    0.000    0.000    0.000    0.000 base.py:286(is_dtype)\r\n"]
[201.255233, "o", "        5    0.000    0.000    0.000    0.000 multi.py:998(<genexpr>)\r\n"]
[201.26582, "o", "        3    0.000    0.000    0.000    0.000 multi.py:3871(_coerce_indexer_frozen)\r\n"]
[201.276407, "o", "        5    0.000    0.000    0.000    0.000 _methods.py:55(_any)\r\n"]
[201.286994, "o", "       13    0.000    0.000    0.000    0.000 common.py:458(is_categorical_dtype)\r\n"]
[201.29758, "o", "        1    0.000    0.000    0.000    0.000 rolling.py:355(_prep_values)\r\n"]
[201.308167, "o", "   130/99    0.000    0.000    0.000    0.000 {built-in method builtins.len}\r\n"]
[201.318754, "o", "        1    0.000    0.000    0.000    0.000 {pandas._libs.algos.ensure_int8}\r\n"]
[201.32934, "o", "      117    0.000    0.000    0.000    0.000 generic.py:37(_check)\r\n"]
[201.339927, "o", "        2    0.000    0.000    0.000    0.000 algorithms.py:113(_ensure_data)\r\n"]
[201.350514, "o", "        8    0.000    0.000    0.000    0.000 _methods.py:93(_clip_dep_is_scalar_nan)\r\n"]
[201.361101, "o", "        2    0.000    0.000    0.000    0.000 base.py:791(_engine)\r\n"]
[201.371687, "o", "       27    0.000    0.000    0.000    0.000 base.py:4892(_values)\r\n"]
[201.382274, "o", "        2    0.000    0.000    0.000    0.000 common.py:229(asarray_tuplesafe)\r\n"]
[201.392861, "o", "        2    0.000    0.000    0.000    0.000 base.py:3764(_get_indexer)\r\n"]
[201.403448, "o", "        1    0.000    0.000    0.000    0.000 generic.py:1916(__contains__)\r\n"]
[201.414034, "o", "        1    0.000    0.000    0.000    0.000 managers.py:2199(_stack_arrays)\r\n"]
[201.424621, "o", "        2    0.000    0.000    0.000    0.000 base.py:5052(__contains__)\r\n"]
[201.435208, "o", "        3    0.000    0.000    0.000    0.000 {pandas._libs.algos.ensure_int32}\r\n"]
[201.445794, "o", "        2    0.000    0.000    0.000    0.000 algorithms.py:283(_check_object_for_strings)\r\n"]
[201.456381, "o", "        5    0.000    0.000    0.000    0.000 _dtype.py:344(_name_get)\r\n"]
[201.466968, "o", "        1    0.000    0.000    0.000    0.000 base.py:636(_with_infer)\r\n"]
[201.477555, "o", "        1    0.000    0.000    0.000    0.000 common.py:261(index_labels_to_array)\r\n"]
[201.488141, "o", "        1    0.000    0.000    0.000    0.000 range.py:201(_data)\r\n"]
[201.498728, "o", "        3    0.000    0.000    0.000    0.000 base.py:2599(inferred_type)\r\n"]
[201.509315, "o", "        1    0.000    0.000    0.000    0.000 cast.py:1129(maybe_infer_to_datetimelike)\r\n"]
[201.519901, "o", "        5    0.000    0.000    0.000    0.000 {pandas._libs.lib.infer_dtype}\r\n"]
[201.530488, "o", "        3    0.000    0.000    0.000    0.000 generic.py:5975(__setattr__)\r\n"]
[201.541075, "o", "        1    0.000    0.000    0.000    0.000 managers.py:1039(iget)\r\n"]
[201.551662, "o", "        1    0.000    0.000    0.000    0.000 rolling.py:117(__init__)\r\n"]
[201.562248, "o", "        2    0.000    0.000    0.000    0.000 base.py:3809(_check_indexing_method)\r\n"]
[201.572835, "o", "        1    0.000    0.000    0.000    0.000 base.py:6518(delete)\r\n"]
[201.583422, "o", "        1    0.000    0.000    0.000    0.000 {pandas._libs.lib.maybe_convert_objects}\r\n"]
[201.594009, "o", "        4    0.000    0.000    0.000    0.000 algorithms.py:193(_reconstruct_data)\r\n"]
[201.604595, "o", "       12    0.000    0.000    0.000    0.000 base.py:616(_simple_new)\r\n"]
[201.615182, "o", "        2    0.000    0.000    0.000    0.000 <__array_function__ internals>:177(prod)\r\n"]
[201.625769, "o", "        2    0.000    0.000    0.000    0.000 base.py:5255(equals)\r\n"]
[201.636355, "o", "        3    0.000    0.000    0.000    0.000 fromnumeric.py:69(_wrapreduction)\r\n"]
[201.646942, "o", "        2    0.000    0.000    0.000    0.000 multi.py:807(_set_levels)\r\n"]
[201.657529, "o", "        4    0.000    0.000    0.000    0.000 managers.py:163(blknos)\r\n"]
[201.668116, "o", "        1    0.000    0.000    0.000    0.000 rolling.py:1752(_validate)\r\n"]
[201.678702, "o", "       16    0.000    0.000    0.000    0.000 common.py:1491(_is_dtype_type)\r\n"]
[201.689289, "o", "        2    0.000    0.000    0.000    0.000 typing.py:868(__new__)\r\n"]
[201.699876, "o", "        2    0.000    0.000    0.000    0.000 fromnumeric.py:2955(prod)\r\n"]
[201.710463, "o", "        1    0.000    0.000    0.000    0.000 generic.py:720(_set_axis)\r\n"]
[201.721049, "o", "        2    0.000    0.000    0.000    0.000 _ufunc_config.py:33(seterr)\r\n"]
[201.731636, "o", "        2    0.000    0.000    0.000    0.000 {method '_rebuild_blknos_and_blklocs' of 'pandas._libs.internals.BlockManager' objects}\r\n"]
[201.742223, "o", "        7    0.000    0.000    0.000    0.000 {built-in method builtins.any}\r\n"]
[201.752809, "o", "        6    0.000    0.000    0.000    0.000 construction.py:402(extract_array)\r\n"]
[201.763396, "o", "        4    0.000    0.000    0.000    0.000 base.py:4918(_get_engine_target)\r\n"]
[201.773983, "o", "      152    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}\r\n"]
[201.78457, "o", "        1    0.000    0.000    0.000    0.000 frame.py:4203(_box_col_values)\r\n"]
[201.795156, "o", "        1    0.000    0.000    0.000    0.000 base.py:1786(rename)\r\n"]
[201.805743, "o", "        2    0.000    0.000    0.000    0.000 generic.py:1921(empty)\r\n"]
[201.81633, "o", "        1    0.000    0.000    0.000    0.000 <__array_function__ internals>:177(delete)\r\n"]
[201.826916, "o", "        8    0.000    0.000    0.000    0.000 <__array_function__ internals>:177(ndim)\r\n"]
[201.837503, "o", "        1    0.000    0.000    0.000    0.000 base.py:1679(set_names)\r\n"]
[201.84809, "o", "        8    0.000    0.000    0.000    0.000 common.py:157(is_object_dtype)\r\n"]
[201.858677, "o", "        2    0.000    0.000    0.000    0.000 {method 'get_indexer' of 'pandas._libs.index.IndexEngine' objects}\r\n"]
[201.869263, "o", "        4    0.000    0.000    0.000    0.000 base.py:54(shape)\r\n"]
[201.87985, "o", "        4    0.000    0.000    0.000    0.000 common.py:1124(is_numeric_dtype)\r\n"]
[201.890437, "o", "        3    0.000    0.000    0.000    0.000 generic.py:5915(__finalize__)\r\n"]
[201.901024, "o", "       20    0.000    0.000    0.000    0.000 common.py:1456(get_dtype)\r\n"]
[201.91161, "o", "        3    0.000    0.000    0.000    0.000 frame.py:640(__init__)\r\n"]
[201.922197, "o", "        1    0.000    0.000    0.000    0.000 dtypes.py:547(update_dtype)\r\n"]
[201.932784, "o", "        1    0.000    0.000    0.000    0.000 _ufunc_config.py:430(__enter__)\r\n"]
[201.94337, "o", "        1    0.000    0.000    0.000    0.000 managers.py:219(set_axis)\r\n"]
[201.953957, "o", "        2    0.000    0.000    0.000    0.000 blocks.py:190(fill_value)\r\n"]
[201.964544, "o", "        2    0.000    0.000    0.000    0.000 blocks.py:228(make_block_same_class)\r\n"]
[201.975131, "o", "        1    0.000    0.000    0.000    0.000 function_base.py:5054(delete)\r\n"]
[201.985717, "o", "        4    0.000    0.000    0.000    0.000 generic.py:262(__init__)\r\n"]
[201.996304, "o", "        1    0.000    0.000    0.000    0.000 config.py:260(__call__)\r\n"]
[202.006891, "o", "        2    0.000    0.000    0.000    0.000 common.py:420(is_interval_dtype)\r\n"]
[202.017478, "o", "        1    0.000    0.000    0.000    0.000 numeric.py:290(full)\r\n"]
[202.028064, "o", "        1    0.000    0.000    0.000    0.000 grouper.py:508(__init__)\r\n"]
[202.038651, "o", "        1    0.000    0.000    0.000    0.000 config.py:134(_get_option)\r\n"]
[202.049238, "o", "        1    0.000    0.000    0.000    0.000 base.py:58(_validate_set_axis)\r\n"]
[202.059824, "o", "        6    0.000    0.000    0.000    0.000 take.py:564(_take_preprocess_indexer_and_fill_value)\r\n"]
[202.070411, "o", "        3    0.000    0.000    0.000    0.000 _weakrefset.py:36(__init__)\r\n"]
[202.080998, "o", "        2    0.000    0.000    0.000    0.000 missing.py:625(na_value_for_dtype)\r\n"]
[202.091585, "o", "        5    0.000    0.000    0.000    0.000 base.py:731(_view)\r\n"]
[202.102171, "o", "        5    0.000    0.000    0.000    0.000 _dtype.py:330(_name_includes_bit_suffix)\r\n"]
[202.112758, "o", "        6    0.000    0.000    0.000    0.000 common.py:549(is_dtype_equal)\r\n"]
[202.123345, "o", "        6    0.000    0.000    0.000    0.000 generic.py:1979(<genexpr>)\r\n"]
[202.133931, "o", "        5    0.000    0.000    0.000    0.000 multi.py:828(<genexpr>)\r\n"]
[202.144518, "o", "        3    0.000    0.000    0.000    0.000 base.py:559(_dtype_to_subclass)\r\n"]
[202.155105, "o", "        4    0.000    0.000    0.000    0.000 base.py:5102(__getitem__)\r\n"]
[202.165692, "o", "       25    0.000    0.000    0.000    0.000 {pandas._libs.lib.is_list_like}\r\n"]
[202.176278, "o", "        2    0.000    0.000    0.000    0.000 dtypes.py:1241(is_dtype)\r\n"]
[202.186865, "o", "        2    0.000    0.000    0.000    0.000 warnings.py:165(simplefilter)\r\n"]
[202.197452, "o", "        1    0.000    0.000    0.000    0.000 rolling.py:412(_resolve_output)\r\n"]
[202.208039, "o", "        2    0.000    0.000    0.000    0.000 multi.py:1398(_set_names)\r\n"]
[202.218625, "o", "        2    0.000    0.000    0.000    0.000 base.py:6047(_is_comparable_dtype)\r\n"]
[202.229212, "o", "        1    0.000    0.000    0.000    0.000 dtypes.py:209(_from_values_or_dtype)\r\n"]
[202.239799, "o", "        1    0.000    0.000    0.000    0.000 <__array_function__ internals>:177(all)\r\n"]
[202.250385, "o", "       33    0.000    0.000    0.000    0.000 {built-in method numpy.asarray}\r\n"]
[202.260972, "o", "        7    0.000    0.000    0.000    0.000 abc.py:96(__instancecheck__)\r\n"]
[202.271559, "o", "        2    0.000    0.000    0.000    0.000 base.py:5949(_maybe_promote)\r\n"]
[202.282146, "o", "        1    0.000    0.000    0.000    0.000 generic.py:1685(_check_label_or_level_ambiguity)\r\n"]
[202.292732, "o", "        8    0.000    0.000    0.000    0.000 fromnumeric.py:3152(ndim)\r\n"]
[202.303319, "o", "       12    0.000    0.000    0.000    0.000 base.py:56(<genexpr>)\r\n"]
[202.313906, "o", "       24    0.000    0.000    0.000    0.000 base.py:842(__len__)\r\n"]
[202.324493, "o", "        4    0.000    0.000    0.000    0.000 ops.py:830(names)\r\n"]
[202.335079, "o", "        1    0.000    0.000    0.000    0.000 multi.py:782(__len__)\r\n"]
[202.345666, "o", "        2    0.000    0.000    0.000    0.000 <__array_function__ internals>:177(ravel)\r\n"]
[202.356253, "o", "        1    0.000    0.000    0.000    0.000 <__array_function__ internals>:177(copyto)\r\n"]
[202.366839, "o", "        1    0.000    0.000    0.000    0.000 _asarray.py:31(require)\r\n"]
[202.377426, "o", "        2    0.000    0.000    0.000    0.000 warnings.py:181(_add_filter)\r\n"]
[202.388013, "o", "        1    0.000    0.000    0.000    0.000 config.py:116(_get_single_key)\r\n"]
[202.3986, "o", "        1    0.000    0.000    0.000    0.000 fromnumeric.py:2432(all)\r\n"]
[202.409186, "o", "        1    0.000    0.000    0.000    0.000 {method 'max' of 'numpy.ndarray' objects}\r\n"]
[202.419773, "o", "        1    0.000    0.000    0.000    0.000 construction.py:128(<listcomp>)\r\n"]
[202.43036, "o", "        2    0.000    0.000    0.000    0.000 numerictypes.py:356(issubdtype)\r\n"]
[202.440946, "o", "        1    0.000    0.000    0.000    0.000 grouper.py:1021(_convert_grouper)\r\n"]
[202.451533, "o", "        9    0.000    0.000    0.000    0.000 {built-in method numpy.empty}\r\n"]
[202.46212, "o", "        1    0.000    0.000    0.000    0.000 _ufunc_config.py:435(__exit__)\r\n"]
[202.472707, "o", "        1    0.000    0.000    0.000    0.000 objects.py:288(__init__)\r\n"]
[202.483293, "o", "        3    0.000    0.000    0.000    0.000 base.py:7109(maybe_extract_name)\r\n"]
[202.49388, "o", "        2    0.000    0.000    0.000    0.000 base.py:7144(unpack_nested_dtype)\r\n"]
[202.504467, "o", "        1    0.000    0.000    0.000    0.000 categorical.py:733(codes)\r\n"]
[202.515054, "o", "       41    0.000    0.000    0.000    0.000 {built-in method builtins.issubclass}\r\n"]
[202.52564, "o", "        1    0.000    0.000    0.000    0.000 base.py:3585(get_loc)\r\n"]
[202.536227, "o", "        1    0.000    0.000    0.000    0.000 frozen.py:73(__getitem__)\r\n"]
[202.546814, "o", "        6    0.000    0.000    0.000    0.000 generic.py:520(_get_axis)\r\n"]
[202.5574, "o", "        1    0.000    0.000    0.000    0.000 _methods.py:39(_amax)\r\n"]
[202.567987, "o", "        7    0.000    0.000    0.000    0.000 {built-in method _abc._abc_instancecheck}\r\n"]
[202.578574, "o", "        2    0.000    0.000    0.000    0.000 common.py:1206(is_float_dtype)\r\n"]
[202.589161, "o", "        2    0.000    0.000    0.000    0.000 _ufunc_config.py:132(geterr)\r\n"]
[202.599747, "o", "        6    0.000    0.000    0.000    0.000 base.py:120(_reset_cache)\r\n"]
[202.610334, "o", "        2    0.000    0.000    0.000    0.000 frame.py:3659(_iter_column_arrays)\r\n"]
[202.620921, "o", "        1    0.000    0.000    0.000    0.000 rolling.py:230(_validate_numeric_only)\r\n"]
[202.631507, "o", "        4    0.000    0.000    0.000    0.000 _weakrefset.py:81(add)\r\n"]
[202.642094, "o", "        1    0.000    0.000    0.000    0.000 series.py:367(__init__)\r\n"]
[202.652681, "o", "        2    0.000    0.000    0.000    0.000 fromnumeric.py:1781(ravel)\r\n"]
[202.663268, "o", "       28    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}\r\n"]
[202.673854, "o", "        7    0.000    0.000    0.000    0.000 inference.py:189(is_array_like)\r\n"]
[202.684441, "o", "        2    0.000    0.000    0.000    0.000 common.py:651(is_integer_dtype)\r\n"]
[202.695028, "o", "       24    0.000    0.000    0.000    0.000 {pandas._libs.algos.ensure_platform_int}\r\n"]
[202.705615, "o", "        3    0.000    0.000    0.000    0.000 _weakrefset.py:116(update)\r\n"]
[202.716201, "o", "        5    0.000    0.000    0.000    0.000 cast.py:559(maybe_promote)\r\n"]
[202.726788, "o", "        2    0.000    0.000    0.000    0.000 warnings.py:458(__enter__)\r\n"]
[202.737375, "o", "        2    0.000    0.000    0.000    0.000 inference.py:267(is_dict_like)\r\n"]
[202.747961, "o", "        2    0.000    0.000    0.000    0.000 base.py:432(_engine_type)\r\n"]
[202.758548, "o", "        6    0.000    0.000    0.000    0.000 common.py:1074(needs_i8_conversion)\r\n"]
[202.769135, "o", "        1    0.000    0.000    0.000    0.000 multi.py:796(levels)\r\n"]
[202.779722, "o", "        3    0.000    0.000    0.000    0.000 _weakrefset.py:38(_remove)\r\n"]
[202.790308, "o", "        3    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:1017(_handle_fromlist)\r\n"]
[202.800895, "o", "       14    0.000    0.000    0.000    0.000 base.py:780(_reset_identity)\r\n"]
[202.811482, "o", "        1    0.000    0.000    0.000    0.000 base.py:1634(_set_names)\r\n"]
[202.822069, "o", "        2    0.000    0.000    0.000    0.000 base.py:2641(_na_value)\r\n"]
[202.832655, "o", "        1    0.000    0.000    0.000    0.000 grouper.py:619(_passed_categorical)\r\n"]
[202.843242, "o", "        1    0.000    0.000    0.000    0.000 rolling.py:379(_insert_on_column)\r\n"]
[202.853829, "o", "        6    0.000    0.000    0.000    0.000 common.py:1386(is_ea_or_datetimelike_dtype)\r\n"]
[202.864415, "o", "        1    0.000    0.000    0.000    0.000 rolling.py:162(_validate)\r\n"]
[202.875002, "o", "        6    0.000    0.000    0.000    0.000 common.py:151(<lambda>)\r\n"]
[202.885589, "o", "        2    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}\r\n"]
[202.896176, "o", "        8    0.000    0.000    0.000    0.000 _methods.py:103(_clip_dep_is_byte_swapped)\r\n"]
[202.906762, "o", "        6    0.000    0.000    0.000    0.000 take.py:325(_get_take_nd_function)\r\n"]
[202.917349, "o", "        1    0.000    0.000    0.000    0.000 series.py:1262(_set_as_cached)\r\n"]
[202.927936, "o", "        4    0.000    0.000    0.000    0.000 common.py:1332(is_extension_array_dtype)\r\n"]
[202.938522, "o", "       16    0.000    0.000    0.000    0.000 {built-in method __new__ of type object at 0x5614d1f30680}\r\n"]
[202.949109, "o", "        4    0.000    0.000    0.000    0.000 ops.py:832(<listcomp>)\r\n"]
[202.959696, "o", "       10    0.000    0.000    0.000    0.000 common.py:143(<lambda>)\r\n"]
[202.970283, "o", "        4    0.000    0.000    0.000    0.000 numerictypes.py:282(issubclass_)\r\n"]
[202.980869, "o", "        3    0.000    0.000    0.000    0.000 base.py:2623(_is_multi)\r\n"]
[202.991456, "o", "        7    0.000    0.000    0.000    0.000 inference.py:328(is_hashable)\r\n"]
[203.002043, "o", "        3    0.000    0.000    0.000    0.000 base.py:1631(_get_names)\r\n"]
[203.01263, "o", "        3    0.000    0.000    0.000    0.000 {built-in method builtins.all}\r\n"]
[203.023216, "o", "        1    0.000    0.000    0.000    0.000 series.py:691(_values)\r\n"]
[203.033803, "o", "        1    0.000    0.000    0.000    0.000 rolling.py:404(_index_array)\r\n"]
[203.04439, "o", "        1    0.000    0.000    0.000    0.000 managers.py:1775(_consolidate_inplace)\r\n"]
[203.054976, "o", "        1    0.000    0.000    0.000    0.000 frame.py:3649(_get_column_array)\r\n"]
[203.065563, "o", "        2    0.000    0.000    0.000    0.000 frame.py:903(shape)\r\n"]
[203.07615, "o", "        3    0.000    0.000    0.000    0.000 objects.py:46(__init__)\r\n"]
[203.086737, "o", "        1    0.000    0.000    0.000    0.000 multi.py:801(<listcomp>)\r\n"]
[203.097323, "o", "       12    0.000    0.000    0.000    0.000 generic.py:506(_get_axis_number)\r\n"]
[203.10791, "o", "        3    0.000    0.000    0.000    0.000 construction.py:650(_sanitize_ndim)\r\n"]
[203.118497, "o", "        1    0.000    0.000    0.000    0.000 config.py:595(_get_root)\r\n"]
[203.129084, "o", "        2    0.000    0.000    0.000    0.000 {built-in method numpy.array}\r\n"]
[203.13967, "o", "        2    0.000    0.000    0.000    0.000 copy.py:66(copy)\r\n"]
[203.150257, "o", "        4    0.000    0.000    0.000    0.000 common.py:150(cast_scalar_indexer)\r\n"]
[203.160844, "o", "        2    0.000    0.000    0.000    0.000 algorithms.py:231(_ensure_arraylike)\r\n"]
[203.17143, "o", "        6    0.000    0.000    0.000    0.000 range.py:889(__len__)\r\n"]
[203.182017, "o", "        2    0.000    0.000    0.000    0.000 managers.py:974(from_blocks)\r\n"]
[203.192604, "o", "        1    0.000    0.000    0.000    0.000 base.py:2664(hasnans)\r\n"]
[203.203191, "o", "        2    0.000    0.000    0.000    0.000 {method 'remove' of 'list' objects}\r\n"]
[203.213777, "o", "        1    0.000    0.000    0.000    0.000 managers.py:1053(iget_values)\r\n"]
[203.224364, "o", "        4    0.000    0.000    0.000    0.000 flags.py:49(__init__)\r\n"]
[203.234951, "o", "        2    0.000    0.000    0.000    0.000 missing.py:455(array_equivalent)\r\n"]
[203.245537, "o", "        5    0.000    0.000    0.000    0.000 {built-in method numpy.asanyarray}\r\n"]
[203.256124, "o", "        4    0.000    0.000    0.000    0.000 common.py:1649(pandas_dtype)\r\n"]
[203.266711, "o", "        1    0.000    0.000    0.000    0.000 managers.py:1757(is_consolidated)\r\n"]
[203.277298, "o", "        1    0.000    0.000    0.000    0.000 base.py:740(_rename)\r\n"]
[203.287884, "o", "        4    0.000    0.000    0.000    0.000 common.py:274(is_datetime64_dtype)\r\n"]
[203.298471, "o", "        1    0.000    0.000    0.000    0.000 config.py:648(_warn_if_deprecated)\r\n"]
[203.309058, "o", "        3    0.000    0.000    0.000    0.000 base.py:541(_ensure_array)\r\n"]
[203.319645, "o", "        2    0.000    0.000    0.000    0.000 common.py:1432(_is_dtype)\r\n"]
[203.330231, "o", "        6    0.000    0.000    0.000    0.000 __init__.py:33(using_copy_on_write)\r\n"]
[203.340818, "o", "        4    0.000    0.000    0.000    0.000 dtypes.py:492(validate_ordered)\r\n"]
[203.351405, "o", "        3    0.000    0.000    0.000    0.000 flags.py:85(allows_duplicate_labels)\r\n"]
[203.361991, "o", "       10    0.000    0.000    0.000    0.000 common.py:141(classes)\r\n"]
[203.372578, "o", "        2    0.000    0.000    0.000    0.000 {built-in method numpy.seterrobj}\r\n"]
[203.383165, "o", "        8    0.000    0.000    0.000    0.000 base.py:1545(name)\r\n"]
[203.393752, "o", "        1    0.000    0.000    0.000    0.000 _asarray.py:112(<setcomp>)\r\n"]
[203.404338, "o", "        1    0.000    0.000    0.000    0.000 managers.py:1961(internal_values)\r\n"]
[203.414925, "o", "        1    0.000    0.000    0.000    0.000 blocks.py:2211(get_block_type)\r\n"]
[203.425512, "o", "        1    0.000    0.000    0.000    0.000 ops.py:821(codes)\r\n"]
[203.436099, "o", "        5    0.000    0.000    0.000    0.000 _dtype.py:24(_kind_name)\r\n"]
[203.446685, "o", "        2    0.000    0.000    0.000    0.000 range.py:307(dtype)\r\n"]
[203.457272, "o", "        2    0.000    0.000    0.000    0.000 missing.py:949(clean_reindex_fill_method)\r\n"]
[203.467859, "o", "        1    0.000    0.000    0.000    0.000 managers.py:2125(_grouping_func)\r\n"]
[203.478445, "o", "        1    0.000    0.000    0.000    0.000 rolling.py:220(_slice_axis_for_step)\r\n"]
[203.489032, "o", "        1    0.000    0.000    0.000    0.000 common.py:1624(validate_all_hashable)\r\n"]
[203.499619, "o", "        3    0.000    0.000    0.000    0.000 construction.py:689(_sanitize_str_dtypes)\r\n"]
[203.510206, "o", "       11    0.000    0.000    0.000    0.000 ops.py:699(groupings)\r\n"]
[203.520792, "o", "        1    0.000    0.000    0.000    0.000 categorical.py:697(categories)\r\n"]
[203.531379, "o", "       11    0.000    0.000    0.000    0.000 base.py:324(ndim)\r\n"]
[203.541966, "o", "        2    0.000    0.000    0.000    0.000 warnings.py:437(__init__)\r\n"]
[203.552552, "o", "        1    0.000    0.000    0.000    0.000 managers.py:2273(_preprocess_slice_or_indexer)\r\n"]
[203.563139, "o", "        3    0.000    0.000    0.000    0.000 construction.py:464(ensure_wrapped_if_datetimelike)\r\n"]
[203.573726, "o", "        6    0.000    0.000    0.000    0.000 inference.py:294(<genexpr>)\r\n"]
[203.584313, "o", "        6    0.000    0.000    0.000    0.000 common.py:146(classes_and_not_datetimelike)\r\n"]
[203.594899, "o", "        2    0.000    0.000    0.000    0.000 warnings.py:477(__exit__)\r\n"]
[203.605486, "o", "        1    0.000    0.000    0.000    0.000 rolling.py:724(<listcomp>)\r\n"]
[203.616073, "o", "        1    0.000    0.000    0.000    0.000 rolling.py:312(__getattr__)\r\n"]
[203.62666, "o", "        1    0.000    0.000    0.000    0.000 _ufunc_config.py:426(__init__)\r\n"]
[203.637246, "o", "        7    0.000    0.000    0.000    0.000 generic.py:620(ndim)\r\n"]
[203.647833, "o", "        1    0.000    0.000    0.000    0.000 base.py:2070(_can_hold_na)\r\n"]
[203.65842, "o", "        4    0.000    0.000    0.000    0.000 {built-in method numpy.geterrobj}\r\n"]
[203.669006, "o", "        1    0.000    0.000    0.000    0.000 grouper.py:623(name)\r\n"]
[203.679593, "o", "        2    0.000    0.000    0.000    0.000 grouper.py:891(<genexpr>)\r\n"]
[203.69018, "o", "        2    0.000    0.000    0.000    0.000 config.py:609(_get_deprecated_option)\r\n"]
[203.700767, "o", "        2    0.000    0.000    0.000    0.000 base.py:749(is_)\r\n"]
[203.711353, "o", "        1    0.000    0.000    0.000    0.000 generic.py:596(_info_axis)\r\n"]
[203.72194, "o", "        4    0.000    0.000    0.000    0.000 common.py:350(is_timedelta64_dtype)\r\n"]
[203.732527, "o", "        1    0.000    0.000    0.000    0.000 ops.py:685(__init__)\r\n"]
[203.743113, "o", "        1    0.000    0.000    0.000    0.000 rolling.py:264(_create_data)\r\n"]
[203.7537, "o", "        1    0.000    0.000    0.000    0.000 indexing.py:2606(check_dict_or_set_indexers)\r\n"]
[203.764287, "o", "        2    0.000    0.000    0.000    0.000 {method 'copy' of 'numpy.ndarray' objects}\r\n"]
[203.774874, "o", "        4    0.000    0.000    0.000    0.000 {method 'view' of 'numpy.ndarray' objects}\r\n"]
[203.78546, "o", "        1    0.000    0.000    0.000    0.000 rolling.py:205(_check_window_bounds)\r\n"]
[203.796047, "o", "        6    0.000    0.000    0.000    0.000 base.py:898(dtype)\r\n"]
[203.806634, "o", "        1    0.000    0.000    0.000    0.000 multi.py:506(<listcomp>)\r\n"]
[203.817221, "o", "        9    0.000    0.000    0.000    0.000 {built-in method builtins.hash}\r\n"]
[203.827807, "o", "        2    0.000    0.000    0.000    0.000 blocks.py:824(iget)\r\n"]
[203.838394, "o", "        1    0.000    0.000    0.000    0.000 ops.py:824(<listcomp>)\r\n"]
[203.848981, "o", "        6    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}\r\n"]
[203.859567, "o", "        1    0.000    0.000    0.000    0.000 ops.py:790(<listcomp>)\r\n"]
[203.870154, "o", "        1    0.000    0.000    0.000    0.000 generic.py:526(_get_block_manager_axis)\r\n"]
[203.880741, "o", "        2    0.000    0.000    0.000    0.000 sorting.py:608(<genexpr>)\r\n"]
[203.891328, "o", "        1    0.000    0.000    0.000    0.000 config.py:577(_select_options)\r\n"]
[203.901914, "o", "        3    0.000    0.000    0.000    0.000 fromnumeric.py:70(<dictcomp>)\r\n"]
[203.912501, "o", "        1    0.000    0.000    0.000    0.000 grouper.py:943(is_in_obj)\r\n"]
[203.923088, "o", "        1    0.000    0.000    0.000    0.000 sorting.py:144(_int64_cut_off)\r\n"]
[203.933675, "o", "        8    0.000    0.000    0.000    0.000 {method 'items' of 'dict' objects}\r\n"]
[203.944261, "o", "        3    0.000    0.000    0.000    0.000 {pandas._libs.lib.is_scalar}\r\n"]
[203.954848, "o", "        2    0.000    0.000    0.000    0.000 grouper.py:893(<genexpr>)\r\n"]
[203.965435, "o", "        9    0.000    0.000    0.000    0.000 {method 'append' of 'list' objects}\r\n"]
[203.976021, "o", "        4    0.000    0.000    0.000    0.000 multi.py:943(nlevels)\r\n"]
[203.986608, "o", "        1    0.000    0.000    0.000    0.000 _validators.py:222(validate_bool_kwarg)\r\n"]
[203.997195, "o", "        1    0.000    0.000    0.000    0.000 managers.py:1765(_consolidate_check)\r\n"]
[204.007782, "o", "        7    0.000    0.000    0.000    0.000 {method 'clear' of 'dict' objects}\r\n"]
[204.018368, "o", "        1    0.000    0.000    0.000    0.000 {pandas._libs.internals.get_blkno_placements}\r\n"]
[204.028955, "o", "        1    0.000    0.000    0.000    0.000 sorting.py:157(<listcomp>)\r\n"]
[204.039542, "o", "        5    0.000    0.000    0.000    0.000 {method 'add' of 'set' objects}\r\n"]
[204.050128, "o", "        1    0.000    0.000    0.000    0.000 groupby.py:720(_selected_obj)\r\n"]
[204.060715, "o", "        2    0.000    0.000    0.000    0.000 {method 'ravel' of 'numpy.ndarray' objects}\r\n"]
[204.071302, "o", "        1    0.000    0.000    0.000    0.000 groupby.py:945(__getattr__)\r\n"]
[204.081889, "o", "        1    0.000    0.000    0.000    0.000 ops.py:826(levels)\r\n"]
[204.092475, "o", "        1    0.000    0.000    0.000    0.000 grouper.py:927(is_in_axis)\r\n"]
[204.103062, "o", "        2    0.000    0.000    0.000    0.000 multi.py:1395(_get_names)\r\n"]
[204.113649, "o", "        7    0.000    0.000    0.000    0.000 typing.py:1149(cast)\r\n"]
[204.124236, "o", "        6    0.000    0.000    0.000    0.000 {pandas._libs.lib.is_bool}\r\n"]
[204.134822, "o", "        2    0.000    0.000    0.000    0.000 common.py:1643(<genexpr>)\r\n"]
[204.145409, "o", "        8    0.000    0.000    0.000    0.000 fromnumeric.py:3148(_ndim_dispatcher)\r\n"]
[204.155996, "o", "        5    0.000    0.000    0.000    0.000 dtypes.py:580(categories)\r\n"]
[204.166582, "o", "        2    0.000    0.000    0.000    0.000 grouper.py:669(codes)\r\n"]
[204.177169, "o", "        3    0.000    0.000    0.000    0.000 {method 'discard' of 'set' objects}\r\n"]
[204.187756, "o", "        4    0.000    0.000    0.000    0.000 managers.py:179(blklocs)\r\n"]
[204.198343, "o", "        1    0.000    0.000    0.000    0.000 range.py:482(equals)\r\n"]
[204.208929, "o", "        3    0.000    0.000    0.000    0.000 base.py:654(_constructor)\r\n"]
[204.219516, "o", "        3    0.000    0.000    0.000    0.000 base.py:1064(_maybe_disallow_fill)\r\n"]
[204.230103, "o", "        6    0.000    0.000    0.000    0.000 multiarray.py:152(concatenate)\r\n"]
[204.24069, "o", "        1    0.000    0.000    0.000    0.000 {method 'get_loc' of 'pandas._libs.index.IndexEngine' objects}\r\n"]
[204.251276, "o", "        5    0.000    0.000    0.000    0.000 {pandas._libs.lib.is_integer}\r\n"]
[204.261863, "o", "        1    0.000    0.000    0.000    0.000 categorical.py:1768(_codes)\r\n"]
[204.27245, "o", "        6    0.000    0.000    0.000    0.000 {built-in method _warnings._filters_mutated}\r\n"]
[204.283036, "o", "        1    0.000    0.000    0.000    0.000 config.py:636(_translate_key)\r\n"]
[204.293623, "o", "        1    0.000    0.000    0.000    0.000 {built-in method builtins.max}\r\n"]
[204.30421, "o", "        1    0.000    0.000    0.000    0.000 frame.py:4217(_clear_item_cache)\r\n"]
[204.314797, "o", "        2    0.000    0.000    0.000    0.000 missing.py:121(clean_fill_method)\r\n"]
[204.325383, "o", "        3    0.000    0.000    0.000    0.000 base.py:5937(_index_as_unique)\r\n"]
[204.33597, "o", "        3    0.000    0.000    0.000    0.000 generic.py:335(attrs)\r\n"]
[204.346557, "o", "        4    0.000    0.000    0.000    0.000 {pandas._libs.lib.is_float}\r\n"]
[204.357143, "o", "        2    0.000    0.000    0.000    0.000 grouper.py:892(<genexpr>)\r\n"]
[204.36773, "o", "        1    0.000    0.000    0.000    0.000 sorting.py:227(is_int64_overflow_possible)\r\n"]
[204.378317, "o", "        2    0.000    0.000    0.000    0.000 frame.py:631(_constructor)\r\n"]
[204.388904, "o", "        4    0.000    0.000    0.000    0.000 fromnumeric.py:2107(_clip_dispatcher)\r\n"]
[204.39949, "o", "        6    0.000    0.000    0.000    0.000 generic.py:356(flags)\r\n"]
[204.410077, "o", "        3    0.000    0.000    0.000    0.000 flags.py:53(allows_duplicate_labels)\r\n"]
[204.420664, "o", "        2    0.000    0.000    0.000    0.000 {method 'insert' of 'list' objects}\r\n"]
[204.431251, "o", "        1    0.000    0.000    0.000    0.000 numba_.py:18(maybe_use_numba)\r\n"]
[204.441837, "o", "        1    0.000    0.000    0.000    0.000 categorical.py:459(dtype)\r\n"]
[204.452424, "o", "        2    0.000    0.000    0.000    0.000 common.py:1165(<lambda>)\r\n"]
[204.463011, "o", "        1    0.000    0.000    0.000    0.000 common.py:1319(is_1d_only_ea_dtype)\r\n"]
[204.473597, "o", "        1    0.000    0.000    0.000    0.000 {method 'item' of 'numpy.ndarray' objects}\r\n"]
[204.484184, "o", "        1    0.000    0.000    0.000    0.000 base.py:200(_selected_obj)\r\n"]
[204.494771, "o", "        1    0.000    0.000    0.000    0.000 frame.py:886(axes)\r\n"]
[204.505358, "o", "        1    0.000    0.000    0.000    0.000 managers.py:1799(__init__)\r\n"]
[204.515944, "o", "        3    0.000    0.000    0.000    0.000 dtypes.py:587(ordered)\r\n"]
[204.526531, "o", "        1    0.000    0.000    0.000    0.000 managers.py:224(is_single_block)\r\n"]
[204.537118, "o", "        1    0.000    0.000    0.000    0.000 common.py:367(apply_if_callable)\r\n"]
[204.547704, "o", "        2    0.000    0.000    0.000    0.000 {method 'values' of 'dict' objects}\r\n"]
[204.558291, "o", "        1    0.000    0.000    0.000    0.000 range.py:248(start)\r\n"]
[204.568878, "o", "        1    0.000    0.000    0.000    0.000 grouper.py:1017(_is_label_like)\r\n"]
[204.579465, "o", "        3    0.000    0.000    0.000    0.000 construction.py:709(_maybe_repeat)\r\n"]
[204.590051, "o", "        3    0.000    0.000    0.000    0.000 {pandas._libs.lib.is_iterator}\r\n"]
[204.600638, "o", "        2    0.000    0.000    0.000    0.000 function_base.py:5440(_append_dispatcher)\r\n"]
[204.611225, "o", "        2    0.000    0.000    0.000    0.000 fromnumeric.py:1777(_ravel_dispatcher)\r\n"]
[204.621812, "o", "        1    0.000    0.000    0.000    0.000 ops.py:828(<listcomp>)\r\n"]
[204.632398, "o", "        1    0.000    0.000    0.000    0.000 managers.py:1894(_block)\r\n"]
[204.642985, "o", "        3    0.000    0.000    0.000    0.000 managers.py:939(__init__)\r\n"]
[204.653572, "o", "        2    0.000    0.000    0.000    0.000 {method 'extend' of 'list' objects}\r\n"]
[204.664158, "o", "        1    0.000    0.000    0.000    0.000 function.py:60(__call__)\r\n"]
[204.674745, "o", "        1    0.000    0.000    0.000    0.000 managers.py:229(items)\r\n"]
[204.685332, "o", "        1    0.000    0.000    0.000    0.000 ops.py:791(<listcomp>)\r\n"]
[204.695919, "o", "        1    0.000    0.000    0.000    0.000 blocks.py:476(dtype)\r\n"]
[204.706505, "o", "        2    0.000    0.000    0.000    0.000 fromnumeric.py:2950(_prod_dispatcher)\r\n"]
[204.717092, "o", "        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}\r\n"]
[204.727679, "o", "        2    0.000    0.000    0.000    0.000 multi.py:978(codes)\r\n"]
[204.738266, "o", "        1    0.000    0.000    0.000    0.000 {method 'upper' of 'str' objects}\r\n"]
[204.748852, "o", "        1    0.000    0.000    0.000    0.000 grouper.py:641(_ilevel)\r\n"]
[204.759439, "o", "        1    0.000    0.000    0.000    0.000 range.py:263(step)\r\n"]
[204.770026, "o", "        1    0.000    0.000    0.000    0.000 {pandas._libs.lib.item_from_zerodim}\r\n"]
[204.780612, "o", "        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}\r\n"]
[204.791199, "o", "        1    0.000    0.000    0.000    0.000 function_base.py:5050(_delete_dispatcher)\r\n"]
[204.801786, "o", "        1    0.000    0.000    0.000    0.000 {method 'split' of 'str' objects}\r\n"]
[204.812373, "o", "        1    0.000    0.000    0.000    0.000 range.py:195(_constructor)\r\n"]
[204.822959, "o", "        1    0.000    0.000    0.000    0.000 fromnumeric.py:2427(_all_dispatcher)\r\n"]
[204.833546, "o", "        1    0.000    0.000    0.000    0.000 series.py:594(name)\r\n"]
[204.844133, "o", "        2    0.000    0.000    0.000    0.000 {method 'copy' of 'list' objects}\r\n"]
[204.854719, "o", "        1    0.000    0.000    0.000    0.000 {pandas._libs.algos.ensure_float64}\r\n"]
[204.865306, "o", "        1    0.000    0.000    0.000    0.000 multiarray.py:1079(copyto)\r\n"]
[204.875893, "o", "        1    0.000    0.000    0.000    0.000 generic.py:1706(<genexpr>)\r\n"]
[204.88648, "o", "        1    0.000    0.000    0.000    0.000 range.py:256(stop)\r\n"]
[204.897066, "o", "        1    0.000    0.000    0.000    0.000 base.py:6298(_maybe_cast_indexer)\r\n"]
[204.907653, "o", "        1    0.000    0.000    0.000    0.000 {method 'pop' of 'dict' objects}\r\n"]
[204.91824, "o", "        1    0.000    0.000    0.000    0.000 {pandas._libs.algos.ensure_int64}\r\n"]
[204.928827, "o", "        1    0.000    0.000    0.000    0.000 {function FrozenList.__getitem__ at 0x7f33e8ab3280}\r\n"]
[204.939413, "o", "\r\n"]
[205.0, "o", "(asv_3.8) root@cb2cc1765c92:/workspace/repo/asv_bench# "]
[205.002, "i", "asv profile --python=same rolling.GroupbyLargeGroups.time_rolling_multiindex_creation | head -n 60\r"]
[205.004, "o", "asv profile --python=same rolling.GroupbyLargeGroups.time_rolling_multiindex_creation | head -n 60\r\n"]
[205.069385, "o", "\u001b[?2004l\r\n"]
[205.132769, "o", "\u00b7 Discovering benchmarks\r\n"]
[205.196154, "o", "\u00b7 Profile data does not already exist. Running profiler now.\r\n"]
[205.259538, "o", "\u00b7\u00b7 Benchmarking existing-py_opt_conda_envs_asv_3.8_bin_python\r\n"]
[205.322923, "o", "git -C .. add pandas/core/window/rolling.py\r\n"]
[205.386308, "o", "\u00b7\u00b7\u00b7 Running (rolling.GroupbyLargeGroups.time_rolling_multiindex_creation--).\r\n"]
[205.449692, "o", "\u00b7\u00b7\u00b7 ...LargeGroups.time_rolling_multiindex_creation         19.3\u00b10.3ms\r\n"]
[205.513077, "o", "\r\n"]
[205.576462, "o", "Wed Oct  1 18:32:45 2025    /tmp/tmpamb2c5gl\r\n"]
[205.639846, "o", "\r\n"]
[205.703231, "o", "         2358 function calls (2304 primitive calls) in 0.021 seconds\r\n"]
[205.766615, "o", "\r\n"]
[205.83, "o", "   Ordered by: cumulative time\r\n"]
[205.893385, "o", "\r\n"]
[205.956769, "o", "   ncalls  tottime  percall  cumtime  percall filename:lineno(function)\r\n"]
[206.020154, "o", "        1    0.000    0.000    0.021    0.021 {built-in method builtins.exec}\r\n"]
[206.083538, "o", "        1    0.000    0.000    0.021    0.021 _base.py:689(method_caller)\r\n"]
[206.146923, "o", "        1    0.000    0.000    0.021    0.021 rolling.py:322(time_rolling_multiindex_creation)\r\n"]
[206.210308, "o", "        1    0.000    0.000    0.020    0.020 rolling.py:2070(mean)\r\n"]
[206.273692, "o", "        1    0.000    0.000    0.020    0.020 rolling.py:1489(mean)\r\n"]
[206.337077, "o", "        1    0.000    0.000    0.020    0.020 rolling.py:701(_apply)\r\n"]
[206.400462, "o", "        1    0.000    0.000    0.014    0.014 multi.py:445(from_arrays)\r\n"]
[206.463846, "o", "        1    0.000    0.000    0.014    0.014 categorical.py:2586(factorize_from_iterables)\r\n"]
[206.527231, "o", "        2    0.000    0.000    0.014    0.007 categorical.py:2607(<genexpr>)\r\n"]
[206.590615, "o", "        1    0.000    0.000    0.014    0.014 categorical.py:2545(factorize_from_iterable)\r\n"]
[206.654, "o", "        1    0.000    0.000    0.014    0.014 categorical.py:359(__init__)\r\n"]
[206.717385, "o", "      3/2    0.000    0.000    0.013    0.007 algorithms.py:610(factorize)\r\n"]
[206.780769, "o", "        1    0.000    0.000    0.012    0.012 base.py:1143(factorize)\r\n"]
[206.844154, "o", "        2    0.000    0.000    0.010    0.005 algorithms.py:1702(safe_sort)\r\n"]
[206.907538, "o", "        4    0.010    0.003    0.010    0.003 {method 'argsort' of 'numpy.ndarray' objects}\r\n"]
[206.970923, "o", "        1    0.000    0.000    0.006    0.006 rolling.py:558(_apply)\r\n"]
[207.034308, "o", "        1    0.000    0.000    0.004    0.004 rolling.py:456(_apply_blockwise)\r\n"]
[207.097692, "o", "        2    0.000    0.000    0.003    0.001 algorithms.py:548(factorize_array)\r\n"]
[207.161077, "o", "        2    0.003    0.001    0.003    0.001 {method 'factorize' of 'pandas._libs.hashtable.Int64HashTable' objects}\r\n"]
[207.224462, "o", "        1    0.000    0.000    0.002    0.002 rolling.py:591(homogeneous_func)\r\n"]
[207.287846, "o", "        1    0.000    0.000    0.002    0.002 rolling.py:597(calc)\r\n"]
[207.351231, "o", "        1    0.000    0.000    0.002    0.002 rolling.py:2695(_get_window_indexer)\r\n"]
[207.414615, "o", "        1    0.000    0.000    0.002    0.002 ops.py:784(indices)\r\n"]
[207.478, "o", "        1    0.001    0.001    0.001    0.001 {pandas._libs.window.aggregations.roll_mean}\r\n"]
[207.541385, "o", "        4    0.000    0.000    0.001    0.000 dtypes.py:186(__init__)\r\n"]
[207.604769, "o", "        4    0.000    0.000    0.001    0.000 dtypes.py:339(_finalize)\r\n"]
[207.668154, "o", "        2    0.000    0.000    0.001    0.001 dtypes.py:511(validate_categories)\r\n"]
[207.731538, "o", "        1    0.000    0.000    0.001    0.001 objects.py:324(get_window_bounds)\r\n"]
[207.794923, "o", "        2    0.001    0.000    0.001    0.000 base.py:2168(is_unique)\r\n"]
[207.858308, "o", "        1    0.000    0.000    0.001    0.001 sorting.py:599(get_indexer_dict)\r\n"]
[207.921692, "o", "        1    0.000    0.000    0.001    0.001 groupby.py:2649(rolling)\r\n"]
[207.985077, "o", "        1    0.000    0.000    0.001    0.001 rolling.py:846(_create_data)\r\n"]
[208.048462, "o", "        1    0.000    0.000    0.001    0.001 rolling.py:678(__init__)\r\n"]
[208.111846, "o", "        1    0.000    0.000    0.001    0.001 ops.py:910(result_index)\r\n"]
[208.175231, "o", "       12    0.001    0.000    0.001    0.000 {method 'take' of 'numpy.ndarray' objects}\r\n"]
[208.238615, "o", "        1    0.000    0.000    0.001    0.001 grouper.py:688(result_index)\r\n"]
[208.302, "o", "        1    0.000    0.000    0.001    0.001 grouper.py:700(group_index)\r\n"]
[208.365385, "o", "        1    0.000    0.000    0.001    0.001 frame.py:5087(drop)\r\n"]
[208.428769, "o", "        1    0.000    0.000    0.001    0.001 generic.py:4505(drop)\r\n"]
[208.492154, "o", "        1    0.000    0.000    0.001    0.001 generic.py:4544(_drop_axis)\r\n"]
[208.555538, "o", "        1    0.000    0.000    0.001    0.001 grouper.py:722(_codes_and_uniques)\r\n"]
[208.618923, "o", "        6    0.000    0.000    0.001    0.000 take.py:58(take_nd)\r\n"]
[208.682308, "o", "        1    0.000    0.000    0.001    0.001 generic.py:3819(take)\r\n"]
[208.745692, "o", "        1    0.000    0.000    0.001    0.001 generic.py:3898(_take)\r\n"]
[208.809077, "o", "        6    0.000    0.000    0.001    0.000 take.py:120(_take_nd_ndarray)\r\n"]
[208.872462, "o", "        1    0.000    0.000    0.001    0.001 managers.py:886(take)\r\n"]
[208.935846, "o", "        2    0.000    0.000    0.001    0.000 managers.py:641(reindex_indexer)\r\n"]
[208.999231, "o", "Traceback (most recent call last):\r\n"]
[209.062615, "o", "  File \"/opt/conda/envs/asv_3.8/bin/asv\", line 8, in <module>\r\n"]
[209.126, "o", "    sys.exit(main())\r\n"]
[209.189385, "o", "  File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv/main.py\", line 28, in main\r\n"]
[209.252769, "o", "    result = args.func(args)\r\n"]
[209.316154, "o", "  File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv/commands/__init__.py\", line 48, in run_from_args\r\n"]
[209.379538, "o", "    return cls.run_from_conf_args(conf, args)\r\n"]
[209.442923, "o", "  File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv/commands/profiling.py\", line 84, in run_from_conf_args\r\n"]
[209.506308, "o", "    return cls.run(\r\n"]
[209.569692, "o", "  File \"/opt/conda/envs/asv_3.8/lib/python3.8/site-packages/asv/commands/profiling.py\", line 224, in run\r\n"]
[209.633077, "o", "    stats.print_stats()\r\n"]
[209.696462, "o", "  File \"/opt/conda/envs/asv_3.8/lib/python3.8/pstats.py\", line 378, in print_stats\r\n"]
[209.759846, "o", "    self.print_line(func)\r\n"]
[209.823231, "o", "  File \"/opt/conda/envs/asv_3.8/lib/python3.8/pstats.py\", line 465, in print_line\r\n"]
[209.886615, "o", "    print(f8(ct/cc), end=' ', file=self.stream)\r\n"]
[210.0, "o", "(asv_3.8) root@cb2cc1765c92:/workspace/repo/asv_bench# "]
[210.002, "i", "git -C .. add pandas/core/window/rolling.py\r"]
[210.004, "o", "git -C .. add pandas/core/window/rolling.py\r\n"]
[210.006, "o", "\u001b[?2004l\r\n"]
[215.0, "o", "(asv_3.8) root@cb2cc1765c92:/workspace/repo/asv_bench# "]
[215.002, "i", "git -C .. commit -m \"Perf: avoid unnecessary int64 casting and allocations when constructing groupby order\r"]
[215.004, "o", "git -C .. commit -m \"Perf: avoid unnecessary int64 casting and allocations when constructing groupby order\r\n"]
[215.3356, "o", "r indexer in Rolling._create_data (speeds up rolling.GroupbyLargeGroups)\"\r\n"]
[215.6652, "o", "\u001b[?2004l\r\n"]
[215.9948, "o", "Author identity unknown\r\n"]
[216.3244, "o", "\r\n"]
[216.654, "o", "*** Please tell me who you are.\r\n"]
[216.9836, "o", "\r\n"]
[217.3132, "o", "Run\r\n"]
[217.6428, "o", "\r\n"]
[217.9724, "o", "  git config --global user.email \"you@example.com\"\r\n"]
[218.302, "o", "  git config --global user.name \"Your Name\"\r\n"]
[218.6316, "o", "\r\n"]
[218.9612, "o", "to set your account's default identity.\r\n"]
[219.2908, "o", "Omit --global to set the identity only in this repository.\r\n"]
[219.6204, "o", "\r\n"]
[220.0, "o", "(asv_3.8) root@cb2cc1765c92:/workspace/repo/asv_bench# "]
[220.002, "i", "asv run --python=same --bench=\"rolling.GroupbyLargeGroups.time_rolling_multiindex_creation\" --quick\r"]
[220.004, "o", "asv run --python=same --bench=\"rolling.GroupbyLargeGroups.time_rolling_multiindex_creation\" --quick\r\n"]
[220.9948, "o", "\u001b[?2004l\r\n"]
[221.9836, "o", "\u00b7 \u001b[0;32mDiscovering benchmarks\u001b[0m\r\n"]
[222.9724, "o", "\u00b7 \u001b[0;32mRunning 1 total benchmarks (1 commits * 1 environments * 1 benchmarks)\u001b[0m\r\n"]
[223.9612, "o", "[ 0.00%] \u00b7\u00b7 \u001b[0;34mBenchmarking existing-py_opt_conda_envs_asv_3.8_bin_python\u001b[0m\r\n"]
[225.0, "o", "(asv_3.8) root@cb2cc1765c92:/workspace/repo/asv_bench# "]
[225.002, "i", "grep -n \"indices.values\" ../pandas/core/window/rolling.py\r"]
[225.004, "o", "grep -n \"indices.values\" ../pandas/core/window/rolling.py\r\n"]
[225.712286, "o", "\u001b[?2004l\r\n"]
[226.418571, "o", "\u001b[32m\u001b[K737\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K        group_indices = self._grouper.\u001b[01;31m\u001b[Kindices.values\u001b[m\u001b[K()\r\n"]
[227.124857, "o", "\u001b[32m\u001b[K778\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K            len(group) == len(other) for group in self._grouper.\u001b[01;31m\u001b[Kindices.values\u001b[m\u001b[K()\r\n"]
[227.831143, "o", "\u001b[32m\u001b[K788\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K                    for gb_indices in self._grouper.\u001b[01;31m\u001b[Kindices.values\u001b[m\u001b[K()\r\n"]
[228.537429, "o", "\u001b[32m\u001b[K811\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K            group_indices = self._grouper.\u001b[01;31m\u001b[Kindices.values\u001b[m\u001b[K()\r\n"]
[229.243714, "o", "\u001b[32m\u001b[K854\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K            groupby_order = np.concatenate(list(self._grouper.\u001b[01;31m\u001b[Kindices.values\u001b[m\u001b[K())).astype(\r\n"]
[230.0, "o", "(asv_3.8) root@cb2cc1765c92:/workspace/repo/asv_bench# "]
[230.002, "i", "sed -n '1,220p' ../pandas/core/window/rolling.py\r"]
[230.004, "o", "sed -n '1,220p' ../pandas/core/window/rolling.py\r\n"]
[230.028371, "o", "\u001b[?2004l\r\n"]
[230.050742, "o", "\"\"\"\r\n"]
[230.073113, "o", "Provide a generic structure to support window functions,\r\n"]
[230.095484, "o", "similar to how we have a Groupby object.\r\n"]
[230.117855, "o", "\"\"\"\r\n"]
[230.140226, "o", "from __future__ import annotations\r\n"]
[230.162597, "o", "\r\n"]
[230.184968, "o", "import copy\r\n"]
[230.207339, "o", "from datetime import timedelta\r\n"]
[230.22971, "o", "from functools import partial\r\n"]
[230.252081, "o", "import inspect\r\n"]
[230.274452, "o", "from textwrap import dedent\r\n"]
[230.296824, "o", "from typing import (\r\n"]
[230.319195, "o", "    TYPE_CHECKING,\r\n"]
[230.341566, "o", "    Any,\r\n"]
[230.363937, "o", "    Callable,\r\n"]
[230.386308, "o", "    Hashable,\r\n"]
[230.408679, "o", "    Iterator,\r\n"]
[230.43105, "o", "    Sized,\r\n"]
[230.453421, "o", "    cast,\r\n"]
[230.475792, "o", ")\r\n"]
[230.498163, "o", "\r\n"]
[230.520534, "o", "import numpy as np\r\n"]
[230.542905, "o", "\r\n"]
[230.565276, "o", "from pandas._libs.tslibs import (\r\n"]
[230.587647, "o", "    BaseOffset,\r\n"]
[230.610018, "o", "    to_offset,\r\n"]
[230.632389, "o", ")\r\n"]
[230.65476, "o", "import pandas._libs.window.aggregations as window_aggregations\r\n"]
[230.677131, "o", "from pandas._typing import (\r\n"]
[230.699502, "o", "    ArrayLike,\r\n"]
[230.721873, "o", "    Axis,\r\n"]
[230.744244, "o", "    NDFrameT,\r\n"]
[230.766615, "o", "    QuantileInterpolation,\r\n"]
[230.788986, "o", "    WindowingRankType,\r\n"]
[230.811357, "o", ")\r\n"]
[230.833729, "o", "from pandas.compat._optional import import_optional_dependency\r\n"]
[230.8561, "o", "from pandas.errors import DataError\r\n"]
[230.878471, "o", "from pandas.util._decorators import doc\r\n"]
[230.900842, "o", "\r\n"]
[230.923213, "o", "from pandas.core.dtypes.common import (\r\n"]
[230.945584, "o", "    ensure_float64,\r\n"]
[230.967955, "o", "    is_bool,\r\n"]
[230.990326, "o", "    is_integer,\r\n"]
[231.012697, "o", "    is_list_like,\r\n"]
[231.035068, "o", "    is_numeric_dtype,\r\n"]
[231.057439, "o", "    is_scalar,\r\n"]
[231.07981, "o", "    needs_i8_conversion,\r\n"]
[231.102181, "o", ")\r\n"]
[231.124552, "o", "from pandas.core.dtypes.generic import (\r\n"]
[231.146923, "o", "    ABCDataFrame,\r\n"]
[231.169294, "o", "    ABCSeries,\r\n"]
[231.191665, "o", ")\r\n"]
[231.214036, "o", "from pandas.core.dtypes.missing import notna\r\n"]
[231.236407, "o", "\r\n"]
[231.258778, "o", "from pandas.core._numba import executor\r\n"]
[231.281149, "o", "from pandas.core.algorithms import factorize\r\n"]
[231.30352, "o", "from pandas.core.apply import ResamplerWindowApply\r\n"]
[231.325891, "o", "from pandas.core.arrays import ExtensionArray\r\n"]
[231.348262, "o", "from pandas.core.base import SelectionMixin\r\n"]
[231.370633, "o", "import pandas.core.common as com\r\n"]
[231.393005, "o", "from pandas.core.indexers.objects import (\r\n"]
[231.415376, "o", "    BaseIndexer,\r\n"]
[231.437747, "o", "    FixedWindowIndexer,\r\n"]
[231.460118, "o", "    GroupbyIndexer,\r\n"]
[231.482489, "o", "    VariableWindowIndexer,\r\n"]
[231.50486, "o", ")\r\n"]
[231.527231, "o", "from pandas.core.indexes.api import (\r\n"]
[231.549602, "o", "    DatetimeIndex,\r\n"]
[231.571973, "o", "    Index,\r\n"]
[231.594344, "o", "    MultiIndex,\r\n"]
[231.616715, "o", "    PeriodIndex,\r\n"]
[231.639086, "o", "    TimedeltaIndex,\r\n"]
[231.661457, "o", ")\r\n"]
[231.683828, "o", "from pandas.core.reshape.concat import concat\r\n"]
[231.706199, "o", "from pandas.core.util.numba_ import (\r\n"]
[231.72857, "o", "    get_jit_arguments,\r\n"]
[231.750941, "o", "    maybe_use_numba,\r\n"]
[231.773312, "o", ")\r\n"]
[231.795683, "o", "from pandas.core.window.common import (\r\n"]
[231.818054, "o", "    flex_binary_moment,\r\n"]
[231.840425, "o", "    zsqrt,\r\n"]
[231.862796, "o", ")\r\n"]
[231.885167, "o", "from pandas.core.window.doc import (\r\n"]
[231.907538, "o", "    _shared_docs,\r\n"]
[231.92991, "o", "    create_section_header,\r\n"]
[231.952281, "o", "    kwargs_numeric_only,\r\n"]
[231.974652, "o", "    kwargs_scipy,\r\n"]
[231.997023, "o", "    numba_notes,\r\n"]
[232.019394, "o", "    template_header,\r\n"]
[232.041765, "o", "    template_returns,\r\n"]
[232.064136, "o", "    template_see_also,\r\n"]
[232.086507, "o", "    window_agg_numba_parameters,\r\n"]
[232.108878, "o", "    window_apply_parameters,\r\n"]
[232.131249, "o", ")\r\n"]
[232.15362, "o", "from pandas.core.window.numba_ import (\r\n"]
[232.175991, "o", "    generate_manual_numpy_nan_agg_with_axis,\r\n"]
[232.198362, "o", "    generate_numba_apply_func,\r\n"]
[232.220733, "o", "    generate_numba_table_func,\r\n"]
[232.243104, "o", ")\r\n"]
[232.265475, "o", "\r\n"]
[232.287846, "o", "if TYPE_CHECKING:\r\n"]
[232.310217, "o", "    from pandas import (\r\n"]
[232.332588, "o", "        DataFrame,\r\n"]
[232.354959, "o", "        Series,\r\n"]
[232.37733, "o", "    )\r\n"]
[232.399701, "o", "    from pandas.core.generic import NDFrame\r\n"]
[232.422072, "o", "    from pandas.core.groupby.ops import BaseGrouper\r\n"]
[232.444443, "o", "\r\n"]
[232.466814, "o", "\r\n"]
[232.489186, "o", "class BaseWindow(SelectionMixin):\r\n"]
[232.511557, "o", "    \"\"\"Provides utilities for performing windowing operations.\"\"\"\r\n"]
[232.533928, "o", "\r\n"]
[232.556299, "o", "    _attributes: list[str] = []\r\n"]
[232.57867, "o", "    exclusions: frozenset[Hashable] = frozenset()\r\n"]
[232.601041, "o", "    _on: Index\r\n"]
[232.623412, "o", "\r\n"]
[232.645783, "o", "    def __init__(\r\n"]
[232.668154, "o", "        self,\r\n"]
[232.690525, "o", "        obj: NDFrame,\r\n"]
[232.712896, "o", "        window=None,\r\n"]
[232.735267, "o", "        min_periods: int | None = None,\r\n"]
[232.757638, "o", "        center: bool | None = False,\r\n"]
[232.780009, "o", "        win_type: str | None = None,\r\n"]
[232.80238, "o", "        axis: Axis = 0,\r\n"]
[232.824751, "o", "        on: str | Index | None = None,\r\n"]
[232.847122, "o", "        closed: str | None = None,\r\n"]
[232.869493, "o", "        step: int | None = None,\r\n"]
[232.891864, "o", "        method: str = \"single\",\r\n"]
[232.914235, "o", "        *,\r\n"]
[232.936606, "o", "        selection=None,\r\n"]
[232.958977, "o", "    ) -> None:\r\n"]
[232.981348, "o", "        self.obj = obj\r\n"]
[233.003719, "o", "        self.on = on\r\n"]
[233.02609, "o", "        self.closed = closed\r\n"]
[233.048462, "o", "        self.step = step\r\n"]
[233.070833, "o", "        self.window = window\r\n"]
[233.093204, "o", "        self.min_periods = min_periods\r\n"]
[233.115575, "o", "        self.center = center\r\n"]
[233.137946, "o", "        self.win_type = win_type\r\n"]
[233.160317, "o", "        self.axis = obj._get_axis_number(axis) if axis is not None else None\r\n"]
[233.182688, "o", "        self.method = method\r\n"]
[233.205059, "o", "        self._win_freq_i8: int | None = None\r\n"]
[233.22743, "o", "        if self.on is None:\r\n"]
[233.249801, "o", "            if self.axis == 0:\r\n"]
[233.272172, "o", "                self._on = self.obj.index\r\n"]
[233.294543, "o", "            else:\r\n"]
[233.316914, "o", "                # i.e. self.axis == 1\r\n"]
[233.339285, "o", "                self._on = self.obj.columns\r\n"]
[233.361656, "o", "        elif isinstance(self.on, Index):\r\n"]
[233.384027, "o", "            self._on = self.on\r\n"]
[233.406398, "o", "        elif isinstance(self.obj, ABCDataFrame) and self.on in self.obj.columns:\r\n"]
[233.428769, "o", "            self._on = Index(self.obj[self.on])\r\n"]
[233.45114, "o", "        else:\r\n"]
[233.473511, "o", "            raise ValueError(\r\n"]
[233.495882, "o", "                f\"invalid on specified as {self.on}, \"\r\n"]
[233.518253, "o", "                \"must be a column (of DataFrame), an Index or None\"\r\n"]
[233.540624, "o", "            )\r\n"]
[233.562995, "o", "\r\n"]
[233.585367, "o", "        self._selection = selection\r\n"]
[233.607738, "o", "        self._validate()\r\n"]
[233.630109, "o", "\r\n"]
[233.65248, "o", "    def _validate(self) -> None:\r\n"]
[233.674851, "o", "        if self.center is not None and not is_bool(self.center):\r\n"]
[233.697222, "o", "            raise ValueError(\"center must be a boolean\")\r\n"]
[233.719593, "o", "        if self.min_periods is not None:\r\n"]
[233.741964, "o", "            if not is_integer(self.min_periods):\r\n"]
[233.764335, "o", "                raise ValueError(\"min_periods must be an integer\")\r\n"]
[233.786706, "o", "            if self.min_periods < 0:\r\n"]
[233.809077, "o", "                raise ValueError(\"min_periods must be >= 0\")\r\n"]
[233.831448, "o", "            if is_integer(self.window) and self.min_periods > self.window:\r\n"]
[233.853819, "o", "                raise ValueError(\r\n"]
[233.87619, "o", "                    f\"min_periods {self.min_periods} must be <= window {self.window}\"\r\n"]
[233.898561, "o", "                )\r\n"]
[233.920932, "o", "        if self.closed is not None and self.closed not in [\r\n"]
[233.943303, "o", "            \"right\",\r\n"]
[233.965674, "o", "            \"both\",\r\n"]
[233.988045, "o", "            \"left\",\r\n"]
[234.010416, "o", "            \"neither\",\r\n"]
[234.032787, "o", "        ]:\r\n"]
[234.055158, "o", "            raise ValueError(\"closed must be 'right', 'left', 'both' or 'neither'\")\r\n"]
[234.077529, "o", "        if not isinstance(self.obj, (ABCSeries, ABCDataFrame)):\r\n"]
[234.0999, "o", "            raise TypeError(f\"invalid type: {type(self)}\")\r\n"]
[234.122271, "o", "        if isinstance(self.window, BaseIndexer):\r\n"]
[234.144643, "o", "            # Validate that the passed BaseIndexer subclass has\r\n"]
[234.167014, "o", "            # a get_window_bounds with the correct signature.\r\n"]
[234.189385, "o", "            get_window_bounds_signature = inspect.signature(\r\n"]
[234.211756, "o", "                self.window.get_window_bounds\r\n"]
[234.234127, "o", "            ).parameters.keys()\r\n"]
[234.256498, "o", "            expected_signature = inspect.signature(\r\n"]
[234.278869, "o", "                BaseIndexer().get_window_bounds\r\n"]
[234.30124, "o", "            ).parameters.keys()\r\n"]
[234.323611, "o", "            if get_window_bounds_signature != expected_signature:\r\n"]
[234.345982, "o", "                raise ValueError(\r\n"]
[234.368353, "o", "                    f\"{type(self.window).__name__} does not implement \"\r\n"]
[234.390724, "o", "                    f\"the correct signature for get_window_bounds\"\r\n"]
[234.413095, "o", "                )\r\n"]
[234.435466, "o", "        if self.method not in [\"table\", \"single\"]:\r\n"]
[234.457837, "o", "            raise ValueError(\"method must be 'table' or 'single\")\r\n"]
[234.480208, "o", "        if self.step is not None:\r\n"]
[234.502579, "o", "            if not is_integer(self.step):\r\n"]
[234.52495, "o", "                raise ValueError(\"step must be an integer\")\r\n"]
[234.547321, "o", "            if self.step < 0:\r\n"]
[234.569692, "o", "                raise ValueError(\"step must be >= 0\")\r\n"]
[234.592063, "o", "\r\n"]
[234.614434, "o", "    def _check_window_bounds(\r\n"]
[234.636805, "o", "        self, start: np.ndarray, end: np.ndarray, num_vals: int\r\n"]
[234.659176, "o", "    ) -> None:\r\n"]
[234.681548, "o", "        if len(start) != len(end):\r\n"]
[234.703919, "o", "            raise ValueError(\r\n"]
[234.72629, "o", "                f\"start ({len(start)}) and end ({len(end)}) bounds must be the \"\r\n"]
[234.748661, "o", "                f\"same length\"\r\n"]
[234.771032, "o", "            )\r\n"]
[234.793403, "o", "        if len(start) != (num_vals + (self.step or 1) - 1) // (self.step or 1):\r\n"]
[234.815774, "o", "            raise ValueError(\r\n"]
[234.838145, "o", "                f\"start and end bounds ({len(start)}) must be the same length \"\r\n"]
[234.860516, "o", "                f\"as the object ({num_vals}) divided by the step ({self.step}) \"\r\n"]
[234.882887, "o", "                f\"if given and rounded up\"\r\n"]
[234.905258, "o", "            )\r\n"]
[234.927629, "o", "\r\n"]
[235.0, "o", "(asv_3.8) root@cb2cc1765c92:/workspace/repo/asv_bench# "]
[235.002, "i", "sed -n '220,720p' ../pandas/core/window/rolling.py\r"]
[235.004, "o", "sed -n '220,720p' ../pandas/core/window/rolling.py\r\n"]
[235.016, "o", "\u001b[?2004l\r\n"]
[235.026, "o", "    def _slice_axis_for_step(self, index: Index, result: Sized | None = None) -> Index:\r\n"]
[235.036, "o", "        \"\"\"\r\n"]
[235.046, "o", "        Slices the index for a given result and the preset step.\r\n"]
[235.056, "o", "        \"\"\"\r\n"]
[235.066, "o", "        return (\r\n"]
[235.076, "o", "            index\r\n"]
[235.086, "o", "            if result is None or len(result) == len(index)\r\n"]
[235.096, "o", "            else index[:: self.step]\r\n"]
[235.106, "o", "        )\r\n"]
[235.116, "o", "\r\n"]
[235.126, "o", "    def _validate_numeric_only(self, name: str, numeric_only: bool) -> None:\r\n"]
[235.136, "o", "        \"\"\"\r\n"]
[235.146, "o", "        Validate numeric_only argument, raising if invalid for the input.\r\n"]
[235.156, "o", "\r\n"]
[235.166, "o", "        Parameters\r\n"]
[235.176, "o", "        ----------\r\n"]
[235.186, "o", "        name : str\r\n"]
[235.196, "o", "            Name of the operator (kernel).\r\n"]
[235.206, "o", "        numeric_only : bool\r\n"]
[235.216, "o", "            Value passed by user.\r\n"]
[235.226, "o", "        \"\"\"\r\n"]
[235.236, "o", "        if (\r\n"]
[235.246, "o", "            self._selected_obj.ndim == 1\r\n"]
[235.256, "o", "            and numeric_only\r\n"]
[235.266, "o", "            and not is_numeric_dtype(self._selected_obj.dtype)\r\n"]
[235.276, "o", "        ):\r\n"]
[235.286, "o", "            raise NotImplementedError(\r\n"]
[235.296, "o", "                f\"{type(self).__name__}.{name} does not implement numeric_only\"\r\n"]
[235.306, "o", "            )\r\n"]
[235.316, "o", "\r\n"]
[235.326, "o", "    def _make_numeric_only(self, obj: NDFrameT) -> NDFrameT:\r\n"]
[235.336, "o", "        \"\"\"Subset DataFrame to numeric columns.\r\n"]
[235.346, "o", "\r\n"]
[235.356, "o", "        Parameters\r\n"]
[235.366, "o", "        ----------\r\n"]
[235.376, "o", "        obj : DataFrame\r\n"]
[235.386, "o", "\r\n"]
[235.396, "o", "        Returns\r\n"]
[235.406, "o", "        -------\r\n"]
[235.416, "o", "        obj subset to numeric-only columns.\r\n"]
[235.426, "o", "        \"\"\"\r\n"]
[235.436, "o", "        result = obj.select_dtypes(include=[\"number\"], exclude=[\"timedelta\"])\r\n"]
[235.446, "o", "        return result\r\n"]
[235.456, "o", "\r\n"]
[235.466, "o", "    def _create_data(self, obj: NDFrameT, numeric_only: bool = False) -> NDFrameT:\r\n"]
[235.476, "o", "        \"\"\"\r\n"]
[235.486, "o", "        Split data into blocks & return conformed data.\r\n"]
[235.496, "o", "        \"\"\"\r\n"]
[235.506, "o", "        # filter out the on from the object\r\n"]
[235.516, "o", "        if self.on is not None and not isinstance(self.on, Index) and obj.ndim == 2:\r\n"]
[235.526, "o", "            obj = obj.reindex(columns=obj.columns.difference([self.on]), copy=False)\r\n"]
[235.536, "o", "        if obj.ndim > 1 and (numeric_only or self.axis == 1):\r\n"]
[235.546, "o", "            # GH: 20649 in case of mixed dtype and axis=1 we have to convert everything\r\n"]
[235.556, "o", "            # to float to calculate the complete row at once. We exclude all non-numeric\r\n"]
[235.566, "o", "            # dtypes.\r\n"]
[235.576, "o", "            obj = self._make_numeric_only(obj)\r\n"]
[235.586, "o", "        if self.axis == 1:\r\n"]
[235.596, "o", "            obj = obj.astype(\"float64\", copy=False)\r\n"]
[235.606, "o", "            obj._mgr = obj._mgr.consolidate()\r\n"]
[235.616, "o", "        return obj\r\n"]
[235.626, "o", "\r\n"]
[235.636, "o", "    def _gotitem(self, key, ndim, subset=None):\r\n"]
[235.646, "o", "        \"\"\"\r\n"]
[235.656, "o", "        Sub-classes to define. Return a sliced object.\r\n"]
[235.666, "o", "\r\n"]
[235.676, "o", "        Parameters\r\n"]
[235.686, "o", "        ----------\r\n"]
[235.696, "o", "        key : str / list of selections\r\n"]
[235.706, "o", "        ndim : {1, 2}\r\n"]
[235.716, "o", "            requested ndim of result\r\n"]
[235.726, "o", "        subset : object, default None\r\n"]
[235.736, "o", "            subset to act on\r\n"]
[235.746, "o", "        \"\"\"\r\n"]
[235.756, "o", "        # create a new object to prevent aliasing\r\n"]
[235.766, "o", "        if subset is None:\r\n"]
[235.776, "o", "            subset = self.obj\r\n"]
[235.786, "o", "\r\n"]
[235.796, "o", "        # we need to make a shallow copy of ourselves\r\n"]
[235.806, "o", "        # with the same groupby\r\n"]
[235.816, "o", "        kwargs = {attr: getattr(self, attr) for attr in self._attributes}\r\n"]
[235.826, "o", "\r\n"]
[235.836, "o", "        selection = None\r\n"]
[235.846, "o", "        if subset.ndim == 2 and (\r\n"]
[235.856, "o", "            (is_scalar(key) and key in subset) or is_list_like(key)\r\n"]
[235.866, "o", "        ):\r\n"]
[235.876, "o", "            selection = key\r\n"]
[235.886, "o", "        elif subset.ndim == 1 and is_scalar(key) and key == subset.name:\r\n"]
[235.896, "o", "            selection = key\r\n"]
[235.906, "o", "\r\n"]
[235.916, "o", "        new_win = type(self)(subset, selection=selection, **kwargs)\r\n"]
[235.926, "o", "        return new_win\r\n"]
[235.936, "o", "\r\n"]
[235.946, "o", "    def __getattr__(self, attr: str):\r\n"]
[235.956, "o", "        if attr in self._internal_names_set:\r\n"]
[235.966, "o", "            return object.__getattribute__(self, attr)\r\n"]
[235.976, "o", "        if attr in self.obj:\r\n"]
[235.986, "o", "            return self[attr]\r\n"]
[235.996, "o", "\r\n"]
[236.006, "o", "        raise AttributeError(\r\n"]
[236.016, "o", "            f\"'{type(self).__name__}' object has no attribute '{attr}'\"\r\n"]
[236.026, "o", "        )\r\n"]
[236.036, "o", "\r\n"]
[236.046, "o", "    def _dir_additions(self):\r\n"]
[236.056, "o", "        return self.obj._dir_additions()\r\n"]
[236.066, "o", "\r\n"]
[236.076, "o", "    def __repr__(self) -> str:\r\n"]
[236.086, "o", "        \"\"\"\r\n"]
[236.096, "o", "        Provide a nice str repr of our rolling object.\r\n"]
[236.106, "o", "        \"\"\"\r\n"]
[236.116, "o", "        attrs_list = (\r\n"]
[236.126, "o", "            f\"{attr_name}={getattr(self, attr_name)}\"\r\n"]
[236.136, "o", "            for attr_name in self._attributes\r\n"]
[236.146, "o", "            if getattr(self, attr_name, None) is not None and attr_name[0] != \"_\"\r\n"]
[236.156, "o", "        )\r\n"]
[236.166, "o", "        attrs = \",\".join(attrs_list)\r\n"]
[236.176, "o", "        return f\"{type(self).__name__} [{attrs}]\"\r\n"]
[236.186, "o", "\r\n"]
[236.196, "o", "    def __iter__(self) -> Iterator:\r\n"]
[236.206, "o", "        obj = self._selected_obj.set_axis(self._on)\r\n"]
[236.216, "o", "        obj = self._create_data(obj)\r\n"]
[236.226, "o", "        indexer = self._get_window_indexer()\r\n"]
[236.236, "o", "\r\n"]
[236.246, "o", "        start, end = indexer.get_window_bounds(\r\n"]
[236.256, "o", "            num_values=len(obj),\r\n"]
[236.266, "o", "            min_periods=self.min_periods,\r\n"]
[236.276, "o", "            center=self.center,\r\n"]
[236.286, "o", "            closed=self.closed,\r\n"]
[236.296, "o", "            step=self.step,\r\n"]
[236.306, "o", "        )\r\n"]
[236.316, "o", "        self._check_window_bounds(start, end, len(obj))\r\n"]
[236.326, "o", "\r\n"]
[236.336, "o", "        for s, e in zip(start, end):\r\n"]
[236.346, "o", "            result = obj.iloc[slice(s, e)]\r\n"]
[236.356, "o", "            yield result\r\n"]
[236.366, "o", "\r\n"]
[236.376, "o", "    def _prep_values(self, values: ArrayLike) -> np.ndarray:\r\n"]
[236.386, "o", "        \"\"\"Convert input to numpy arrays for Cython routines\"\"\"\r\n"]
[236.396, "o", "        if needs_i8_conversion(values.dtype):\r\n"]
[236.406, "o", "            raise NotImplementedError(\r\n"]
[236.416, "o", "                f\"ops for {type(self).__name__} for this \"\r\n"]
[236.426, "o", "                f\"dtype {values.dtype} are not implemented\"\r\n"]
[236.436, "o", "            )\r\n"]
[236.446, "o", "        # GH #12373 : rolling functions error on float32 data\r\n"]
[236.456, "o", "        # make sure the data is coerced to float64\r\n"]
[236.466, "o", "        try:\r\n"]
[236.476, "o", "            if isinstance(values, ExtensionArray):\r\n"]
[236.486, "o", "                values = values.to_numpy(np.float64, na_value=np.nan)\r\n"]
[236.496, "o", "            else:\r\n"]
[236.506, "o", "                values = ensure_float64(values)\r\n"]
[236.516, "o", "        except (ValueError, TypeError) as err:\r\n"]
[236.526, "o", "            raise TypeError(f\"cannot handle this type -> {values.dtype}\") from err\r\n"]
[236.536, "o", "\r\n"]
[236.546, "o", "        # Convert inf to nan for C funcs\r\n"]
[236.556, "o", "        inf = np.isinf(values)\r\n"]
[236.566, "o", "        if inf.any():\r\n"]
[236.576, "o", "            values = np.where(inf, np.nan, values)\r\n"]
[236.586, "o", "\r\n"]
[236.596, "o", "        return values\r\n"]
[236.606, "o", "\r\n"]
[236.616, "o", "    def _insert_on_column(self, result: DataFrame, obj: DataFrame) -> None:\r\n"]
[236.626, "o", "        # if we have an 'on' column we want to put it back into\r\n"]
[236.636, "o", "        # the results in the same location\r\n"]
[236.646, "o", "        from pandas import Series\r\n"]
[236.656, "o", "\r\n"]
[236.666, "o", "        if self.on is not None and not self._on.equals(obj.index):\r\n"]
[236.676, "o", "            name = self._on.name\r\n"]
[236.686, "o", "            extra_col = Series(self._on, index=self.obj.index, name=name)\r\n"]
[236.696, "o", "            if name in result.columns:\r\n"]
[236.706, "o", "                # TODO: sure we want to overwrite results?\r\n"]
[236.716, "o", "                result[name] = extra_col\r\n"]
[236.726, "o", "            elif name in result.index.names:\r\n"]
[236.736, "o", "                pass\r\n"]
[236.746, "o", "            elif name in self._selected_obj.columns:\r\n"]
[236.756, "o", "                # insert in the same location as we had in _selected_obj\r\n"]
[236.766, "o", "                old_cols = self._selected_obj.columns\r\n"]
[236.776, "o", "                new_cols = result.columns\r\n"]
[236.786, "o", "                old_loc = old_cols.get_loc(name)\r\n"]
[236.796, "o", "                overlap = new_cols.intersection(old_cols[:old_loc])\r\n"]
[236.806, "o", "                new_loc = len(overlap)\r\n"]
[236.816, "o", "                result.insert(new_loc, name, extra_col)\r\n"]
[236.826, "o", "            else:\r\n"]
[236.836, "o", "                # insert at the end\r\n"]
[236.846, "o", "                result[name] = extra_col\r\n"]
[236.856, "o", "\r\n"]
[236.866, "o", "    @property\r\n"]
[236.876, "o", "    def _index_array(self):\r\n"]
[236.886, "o", "        # TODO: why do we get here with e.g. MultiIndex?\r\n"]
[236.896, "o", "        if needs_i8_conversion(self._on.dtype):\r\n"]
[236.906, "o", "            idx = cast(\"PeriodIndex | DatetimeIndex | TimedeltaIndex\", self._on)\r\n"]
[236.916, "o", "            return idx.asi8\r\n"]
[236.926, "o", "        return None\r\n"]
[236.936, "o", "\r\n"]
[236.946, "o", "    def _resolve_output(self, out: DataFrame, obj: DataFrame) -> DataFrame:\r\n"]
[236.956, "o", "        \"\"\"Validate and finalize result.\"\"\"\r\n"]
[236.966, "o", "        if out.shape[1] == 0 and obj.shape[1] > 0:\r\n"]
[236.976, "o", "            raise DataError(\"No numeric types to aggregate\")\r\n"]
[236.986, "o", "        if out.shape[1] == 0:\r\n"]
[236.996, "o", "            return obj.astype(\"float64\")\r\n"]
[237.006, "o", "\r\n"]
[237.016, "o", "        self._insert_on_column(out, obj)\r\n"]
[237.026, "o", "        return out\r\n"]
[237.036, "o", "\r\n"]
[237.046, "o", "    def _get_window_indexer(self) -> BaseIndexer:\r\n"]
[237.056, "o", "        \"\"\"\r\n"]
[237.066, "o", "        Return an indexer class that will compute the window start and end bounds\r\n"]
[237.076, "o", "        \"\"\"\r\n"]
[237.086, "o", "        if isinstance(self.window, BaseIndexer):\r\n"]
[237.096, "o", "            return self.window\r\n"]
[237.106, "o", "        if self._win_freq_i8 is not None:\r\n"]
[237.116, "o", "            return VariableWindowIndexer(\r\n"]
[237.126, "o", "                index_array=self._index_array,\r\n"]
[237.136, "o", "                window_size=self._win_freq_i8,\r\n"]
[237.146, "o", "                center=self.center,\r\n"]
[237.156, "o", "            )\r\n"]
[237.166, "o", "        return FixedWindowIndexer(window_size=self.window)\r\n"]
[237.176, "o", "\r\n"]
[237.186, "o", "    def _apply_series(\r\n"]
[237.196, "o", "        self, homogeneous_func: Callable[..., ArrayLike], name: str | None = None\r\n"]
[237.206, "o", "    ) -> Series:\r\n"]
[237.216, "o", "        \"\"\"\r\n"]
[237.226, "o", "        Series version of _apply_blockwise\r\n"]
[237.236, "o", "        \"\"\"\r\n"]
[237.246, "o", "        obj = self._create_data(self._selected_obj)\r\n"]
[237.256, "o", "\r\n"]
[237.266, "o", "        if name == \"count\":\r\n"]
[237.276, "o", "            # GH 12541: Special case for count where we support date-like types\r\n"]
[237.286, "o", "            obj = notna(obj).astype(int)\r\n"]
[237.296, "o", "        try:\r\n"]
[237.306, "o", "            values = self._prep_values(obj._values)\r\n"]
[237.316, "o", "        except (TypeError, NotImplementedError) as err:\r\n"]
[237.326, "o", "            raise DataError(\"No numeric types to aggregate\") from err\r\n"]
[237.336, "o", "\r\n"]
[237.346, "o", "        result = homogeneous_func(values)\r\n"]
[237.356, "o", "        index = self._slice_axis_for_step(obj.index, result)\r\n"]
[237.366, "o", "        return obj._constructor(result, index=index, name=obj.name)\r\n"]
[237.376, "o", "\r\n"]
[237.386, "o", "    def _apply_blockwise(\r\n"]
[237.396, "o", "        self,\r\n"]
[237.406, "o", "        homogeneous_func: Callable[..., ArrayLike],\r\n"]
[237.416, "o", "        name: str,\r\n"]
[237.426, "o", "        numeric_only: bool = False,\r\n"]
[237.436, "o", "    ) -> DataFrame | Series:\r\n"]
[237.446, "o", "        \"\"\"\r\n"]
[237.456, "o", "        Apply the given function to the DataFrame broken down into homogeneous\r\n"]
[237.466, "o", "        sub-frames.\r\n"]
[237.476, "o", "        \"\"\"\r\n"]
[237.486, "o", "        self._validate_numeric_only(name, numeric_only)\r\n"]
[237.496, "o", "        if self._selected_obj.ndim == 1:\r\n"]
[237.506, "o", "            return self._apply_series(homogeneous_func, name)\r\n"]
[237.516, "o", "\r\n"]
[237.526, "o", "        obj = self._create_data(self._selected_obj, numeric_only)\r\n"]
[237.536, "o", "        if name == \"count\":\r\n"]
[237.546, "o", "            # GH 12541: Special case for count where we support date-like types\r\n"]
[237.556, "o", "            obj = notna(obj).astype(int)\r\n"]
[237.566, "o", "            obj._mgr = obj._mgr.consolidate()\r\n"]
[237.576, "o", "\r\n"]
[237.586, "o", "        if self.axis == 1:\r\n"]
[237.596, "o", "            obj = obj.T\r\n"]
[237.606, "o", "\r\n"]
[237.616, "o", "        taker = []\r\n"]
[237.626, "o", "        res_values = []\r\n"]
[237.636, "o", "        for i, arr in enumerate(obj._iter_column_arrays()):\r\n"]
[237.646, "o", "            # GH#42736 operate column-wise instead of block-wise\r\n"]
[237.656, "o", "            # As of 2.0, hfunc will raise for nuisance columns\r\n"]
[237.666, "o", "            try:\r\n"]
[237.676, "o", "                arr = self._prep_values(arr)\r\n"]
[237.686, "o", "            except (TypeError, NotImplementedError) as err:\r\n"]
[237.696, "o", "                raise DataError(\r\n"]
[237.706, "o", "                    f\"Cannot aggregate non-numeric type: {arr.dtype}\"\r\n"]
[237.716, "o", "                ) from err\r\n"]
[237.726, "o", "            res = homogeneous_func(arr)\r\n"]
[237.736, "o", "            res_values.append(res)\r\n"]
[237.746, "o", "            taker.append(i)\r\n"]
[237.756, "o", "\r\n"]
[237.766, "o", "        index = self._slice_axis_for_step(\r\n"]
[237.776, "o", "            obj.index, res_values[0] if len(res_values) > 0 else None\r\n"]
[237.786, "o", "        )\r\n"]
[237.796, "o", "        df = type(obj)._from_arrays(\r\n"]
[237.806, "o", "            res_values,\r\n"]
[237.816, "o", "            index=index,\r\n"]
[237.826, "o", "            columns=obj.columns.take(taker),\r\n"]
[237.836, "o", "            verify_integrity=False,\r\n"]
[237.846, "o", "        )\r\n"]
[237.856, "o", "\r\n"]
[237.866, "o", "        if self.axis == 1:\r\n"]
[237.876, "o", "            df = df.T\r\n"]
[237.886, "o", "\r\n"]
[237.896, "o", "        return self._resolve_output(df, obj)\r\n"]
[237.906, "o", "\r\n"]
[237.916, "o", "    def _apply_tablewise(\r\n"]
[237.926, "o", "        self,\r\n"]
[237.936, "o", "        homogeneous_func: Callable[..., ArrayLike],\r\n"]
[237.946, "o", "        name: str | None = None,\r\n"]
[237.956, "o", "        numeric_only: bool = False,\r\n"]
[237.966, "o", "    ) -> DataFrame | Series:\r\n"]
[237.976, "o", "        \"\"\"\r\n"]
[237.986, "o", "        Apply the given function to the DataFrame across the entire object\r\n"]
[237.996, "o", "        \"\"\"\r\n"]
[238.006, "o", "        if self._selected_obj.ndim == 1:\r\n"]
[238.016, "o", "            raise ValueError(\"method='table' not applicable for Series objects.\")\r\n"]
[238.026, "o", "        obj = self._create_data(self._selected_obj, numeric_only)\r\n"]
[238.036, "o", "        values = self._prep_values(obj.to_numpy())\r\n"]
[238.046, "o", "        values = values.T if self.axis == 1 else values\r\n"]
[238.056, "o", "        result = homogeneous_func(values)\r\n"]
[238.066, "o", "        result = result.T if self.axis == 1 else result\r\n"]
[238.076, "o", "        index = self._slice_axis_for_step(obj.index, result)\r\n"]
[238.086, "o", "        columns = (\r\n"]
[238.096, "o", "            obj.columns\r\n"]
[238.106, "o", "            if result.shape[1] == len(obj.columns)\r\n"]
[238.116, "o", "            else obj.columns[:: self.step]\r\n"]
[238.126, "o", "        )\r\n"]
[238.136, "o", "        out = obj._constructor(result, index=index, columns=columns)\r\n"]
[238.146, "o", "\r\n"]
[238.156, "o", "        return self._resolve_output(out, obj)\r\n"]
[238.166, "o", "\r\n"]
[238.176, "o", "    def _apply_pairwise(\r\n"]
[238.186, "o", "        self,\r\n"]
[238.196, "o", "        target: DataFrame | Series,\r\n"]
[238.206, "o", "        other: DataFrame | Series | None,\r\n"]
[238.216, "o", "        pairwise: bool | None,\r\n"]
[238.226, "o", "        func: Callable[[DataFrame | Series, DataFrame | Series], DataFrame | Series],\r\n"]
[238.236, "o", "        numeric_only: bool,\r\n"]
[238.246, "o", "    ) -> DataFrame | Series:\r\n"]
[238.256, "o", "        \"\"\"\r\n"]
[238.266, "o", "        Apply the given pairwise function given 2 pandas objects (DataFrame/Series)\r\n"]
[238.276, "o", "        \"\"\"\r\n"]
[238.286, "o", "        target = self._create_data(target, numeric_only)\r\n"]
[238.296, "o", "        if other is None:\r\n"]
[238.306, "o", "            other = target\r\n"]
[238.316, "o", "            # only default unset\r\n"]
[238.326, "o", "            pairwise = True if pairwise is None else pairwise\r\n"]
[238.336, "o", "        elif not isinstance(other, (ABCDataFrame, ABCSeries)):\r\n"]
[238.346, "o", "            raise ValueError(\"other must be a DataFrame or Series\")\r\n"]
[238.356, "o", "        elif other.ndim == 2 and numeric_only:\r\n"]
[238.366, "o", "            other = self._make_numeric_only(other)\r\n"]
[238.376, "o", "\r\n"]
[238.386, "o", "        return flex_binary_moment(target, other, func, pairwise=bool(pairwise))\r\n"]
[238.396, "o", "\r\n"]
[238.406, "o", "    def _apply(\r\n"]
[238.416, "o", "        self,\r\n"]
[238.426, "o", "        func: Callable[..., Any],\r\n"]
[238.436, "o", "        name: str,\r\n"]
[238.446, "o", "        numeric_only: bool = False,\r\n"]
[238.456, "o", "        numba_args: tuple[Any, ...] = (),\r\n"]
[238.466, "o", "        **kwargs,\r\n"]
[238.476, "o", "    ):\r\n"]
[238.486, "o", "        \"\"\"\r\n"]
[238.496, "o", "        Rolling statistical measure using supplied function.\r\n"]
[238.506, "o", "\r\n"]
[238.516, "o", "        Designed to be used with passed-in Cython array-based functions.\r\n"]
[238.526, "o", "\r\n"]
[238.536, "o", "        Parameters\r\n"]
[238.546, "o", "        ----------\r\n"]
[238.556, "o", "        func : callable function to apply\r\n"]
[238.566, "o", "        name : str,\r\n"]
[238.576, "o", "        numba_args : tuple\r\n"]
[238.586, "o", "            args to be passed when func is a numba func\r\n"]
[238.596, "o", "        **kwargs\r\n"]
[238.606, "o", "            additional arguments for rolling function and window function\r\n"]
[238.616, "o", "\r\n"]
[238.626, "o", "        Returns\r\n"]
[238.636, "o", "        -------\r\n"]
[238.646, "o", "        y : type of input\r\n"]
[238.656, "o", "        \"\"\"\r\n"]
[238.666, "o", "        window_indexer = self._get_window_indexer()\r\n"]
[238.676, "o", "        min_periods = (\r\n"]
[238.686, "o", "            self.min_periods\r\n"]
[238.696, "o", "            if self.min_periods is not None\r\n"]
[238.706, "o", "            else window_indexer.window_size\r\n"]
[238.716, "o", "        )\r\n"]
[238.726, "o", "\r\n"]
[238.736, "o", "        def homogeneous_func(values: np.ndarray):\r\n"]
[238.746, "o", "            # calculation function\r\n"]
[238.756, "o", "\r\n"]
[238.766, "o", "            if values.size == 0:\r\n"]
[238.776, "o", "                return values.copy()\r\n"]
[238.786, "o", "\r\n"]
[238.796, "o", "            def calc(x):\r\n"]
[238.806, "o", "                start, end = window_indexer.get_window_bounds(\r\n"]
[238.816, "o", "                    num_values=len(x),\r\n"]
[238.826, "o", "                    min_periods=min_periods,\r\n"]
[238.836, "o", "                    center=self.center,\r\n"]
[238.846, "o", "                    closed=self.closed,\r\n"]
[238.856, "o", "                    step=self.step,\r\n"]
[238.866, "o", "                )\r\n"]
[238.876, "o", "                self._check_window_bounds(start, end, len(x))\r\n"]
[238.886, "o", "\r\n"]
[238.896, "o", "                return func(x, start, end, min_periods, *numba_args)\r\n"]
[238.906, "o", "\r\n"]
[238.916, "o", "            with np.errstate(all=\"ignore\"):\r\n"]
[238.926, "o", "                result = calc(values)\r\n"]
[238.936, "o", "\r\n"]
[238.946, "o", "            return result\r\n"]
[238.956, "o", "\r\n"]
[238.966, "o", "        if self.method == \"single\":\r\n"]
[238.976, "o", "            return self._apply_blockwise(homogeneous_func, name, numeric_only)\r\n"]
[238.986, "o", "        else:\r\n"]
[238.996, "o", "            return self._apply_tablewise(homogeneous_func, name, numeric_only)\r\n"]
[239.006, "o", "\r\n"]
[239.016, "o", "    def _numba_apply(\r\n"]
[239.026, "o", "        self,\r\n"]
[239.036, "o", "        func: Callable[..., Any],\r\n"]
[239.046, "o", "        engine_kwargs: dict[str, bool] | None = None,\r\n"]
[239.056, "o", "        *func_args,\r\n"]
[239.066, "o", "    ):\r\n"]
[239.076, "o", "        window_indexer = self._get_window_indexer()\r\n"]
[239.086, "o", "        min_periods = (\r\n"]
[239.096, "o", "            self.min_periods\r\n"]
[239.106, "o", "            if self.min_periods is not None\r\n"]
[239.116, "o", "            else window_indexer.window_size\r\n"]
[239.126, "o", "        )\r\n"]
[239.136, "o", "        obj = self._create_data(self._selected_obj)\r\n"]
[239.146, "o", "        if self.axis == 1:\r\n"]
[239.156, "o", "            obj = obj.T\r\n"]
[239.166, "o", "        values = self._prep_values(obj.to_numpy())\r\n"]
[239.176, "o", "        if values.ndim == 1:\r\n"]
[239.186, "o", "            values = values.reshape(-1, 1)\r\n"]
[239.196, "o", "        start, end = window_indexer.get_window_bounds(\r\n"]
[239.206, "o", "            num_values=len(values),\r\n"]
[239.216, "o", "            min_periods=min_periods,\r\n"]
[239.226, "o", "            center=self.center,\r\n"]
[239.236, "o", "            closed=self.closed,\r\n"]
[239.246, "o", "            step=self.step,\r\n"]
[239.256, "o", "        )\r\n"]
[239.266, "o", "        self._check_window_bounds(start, end, len(values))\r\n"]
[239.276, "o", "        aggregator = executor.generate_shared_aggregator(\r\n"]
[239.286, "o", "            func, **get_jit_arguments(engine_kwargs)\r\n"]
[239.296, "o", "        )\r\n"]
[239.306, "o", "        result = aggregator(values, start, end, min_periods, *func_args)\r\n"]
[239.316, "o", "        result = result.T if self.axis == 1 else result\r\n"]
[239.326, "o", "        index = self._slice_axis_for_step(obj.index, result)\r\n"]
[239.336, "o", "        if obj.ndim == 1:\r\n"]
[239.346, "o", "            result = result.squeeze()\r\n"]
[239.356, "o", "            out = obj._constructor(result, index=index, name=obj.name)\r\n"]
[239.366, "o", "            return out\r\n"]
[239.376, "o", "        else:\r\n"]
[239.386, "o", "            columns = self._slice_axis_for_step(obj.columns, result.T)\r\n"]
[239.396, "o", "            out = obj._constructor(result, index=index, columns=columns)\r\n"]
[239.406, "o", "            return self._resolve_output(out, obj)\r\n"]
[239.416, "o", "\r\n"]
[239.426, "o", "    def aggregate(self, func, *args, **kwargs):\r\n"]
[239.436, "o", "        result = ResamplerWindowApply(self, func, args=args, kwargs=kwargs).agg()\r\n"]
[239.446, "o", "        if result is None:\r\n"]
[239.456, "o", "            return self.apply(func, raw=False, args=args, kwargs=kwargs)\r\n"]
[239.466, "o", "        return result\r\n"]
[239.476, "o", "\r\n"]
[239.486, "o", "    agg = aggregate\r\n"]
[239.496, "o", "\r\n"]
[239.506, "o", "\r\n"]
[239.516, "o", "class BaseWindowGroupby(BaseWindow):\r\n"]
[239.526, "o", "    \"\"\"\r\n"]
[239.536, "o", "    Provide the groupby windowing facilities.\r\n"]
[239.546, "o", "    \"\"\"\r\n"]
[239.556, "o", "\r\n"]
[239.566, "o", "    _grouper: BaseGrouper\r\n"]
[239.576, "o", "    _as_index: bool\r\n"]
[239.586, "o", "    _attributes: list[str] = [\"_grouper\"]\r\n"]
[239.596, "o", "\r\n"]
[239.606, "o", "    def __init__(\r\n"]
[239.616, "o", "        self,\r\n"]
[239.626, "o", "        obj: DataFrame | Series,\r\n"]
[239.636, "o", "        *args,\r\n"]
[239.646, "o", "        _grouper: BaseGrouper,\r\n"]
[239.656, "o", "        _as_index: bool = True,\r\n"]
[239.666, "o", "        **kwargs,\r\n"]
[239.676, "o", "    ) -> None:\r\n"]
[239.686, "o", "        from pandas.core.groupby.ops import BaseGrouper\r\n"]
[239.696, "o", "\r\n"]
[239.706, "o", "        if not isinstance(_grouper, BaseGrouper):\r\n"]
[239.716, "o", "            raise ValueError(\"Must pass a BaseGrouper object.\")\r\n"]
[239.726, "o", "        self._grouper = _grouper\r\n"]
[239.736, "o", "        self._as_index = _as_index\r\n"]
[239.746, "o", "        # GH 32262: It's convention to keep the grouping column in\r\n"]
[239.756, "o", "        # groupby.<agg_func>, but unexpected to users in\r\n"]
[239.766, "o", "        # groupby.rolling.<agg_func>\r\n"]
[239.776, "o", "        obj = obj.drop(columns=self._grouper.names, errors=\"ignore\")\r\n"]
[239.786, "o", "        # GH 15354\r\n"]
[239.796, "o", "        if kwargs.get(\"step\") is not None:\r\n"]
[239.806, "o", "            raise NotImplementedError(\"step not implemented for groupby\")\r\n"]
[239.816, "o", "        super().__init__(obj, *args, **kwargs)\r\n"]
[239.826, "o", "\r\n"]
[239.836, "o", "    def _apply(\r\n"]
[239.846, "o", "        self,\r\n"]
[239.856, "o", "        func: Callable[..., Any],\r\n"]
[239.866, "o", "        name: str,\r\n"]
[239.876, "o", "        numeric_only: bool = False,\r\n"]
[239.886, "o", "        numba_args: tuple[Any, ...] = (),\r\n"]
[239.896, "o", "        **kwargs,\r\n"]
[239.906, "o", "    ) -> DataFrame | Series:\r\n"]
[239.916, "o", "        result = super()._apply(\r\n"]
[239.926, "o", "            func,\r\n"]
[239.936, "o", "            name,\r\n"]
[240.0, "o", "(asv_3.8) root@cb2cc1765c92:/workspace/repo/asv_bench# "]
[240.002, "i", "applypatch << 'PATCH'\r"]
[240.004, "o", "applypatch << 'PATCH'\r\n"]
[240.062182, "o", "\u001b[?2004l\r\n"]
[240.118364, "o", "\u001b[?2004h> *** Begin Patch\r\n"]
[240.174545, "o", "\u001b[?2004l\r\n"]
[240.230727, "o", "\u001b[?2004h> *** Update File: pandas/core/window/rolling.py\r\n"]
[240.286909, "o", "\u001b[?2004l\r\n"]
[240.343091, "o", "\u001b[?2004h> @@\r\n"]
[240.399273, "o", "\u001b[?2004l\r\n"]
[240.455455, "o", "\u001b[?2004h>  class BaseWindow(SelectionMixin):\r\n"]
[240.511636, "o", "\u001b[?2004l\r\n"]
[240.567818, "o", "\u001b[?2004h> @@\r\n"]
[240.624, "o", "\u001b[?2004l\r\n"]
[240.680182, "o", "\u001b[?2004h>      def __init__(\r\n"]
[240.736364, "o", "\u001b[?2004l\r\n"]
[240.792545, "o", "\u001b[?2004h>          self,\r\n"]
[240.848727, "o", "\u001b[?2004l\r\n"]
[240.904909, "o", "\u001b[?2004h>          obj: NDFrame,\r\n"]
[240.961091, "o", "\u001b[?2004l\r\n"]
[241.017273, "o", "\u001b[?2004h> @@\r\n"]
[241.073455, "o", "\u001b[?2004l\r\n"]
[241.129636, "o", "\u001b[?2004h>      ) -> None:\r\n"]
[241.185818, "o", "\u001b[?2004l\r\n"]
[241.242, "o", "\u001b[?2004h> @@\r\n"]
[241.298182, "o", "\u001b[?2004l\r\n"]
[241.354364, "o", "\u001b[?2004h>          self.method = method\r\n"]
[241.410545, "o", "\u001b[?2004l\r\n"]
[241.466727, "o", "\u001b[?2004h>          self._win_freq_i8: int | None = None\r\n"]
[241.522909, "o", "\u001b[?2004l\r\n"]
[241.579091, "o", "\u001b[?2004h> +        # Cache for groupby order indexer to avoid recomputation across\r\n"]
[241.635273, "o", "\u001b[?2004l\r\n"]
[241.691455, "o", "\u001b[?2004h> +        # subsequent steps (e.g. when constructing the result MultiIndex\r\n"]
[241.747636, "o", "\u001b[?2004l\r\n"]
[241.803818, "o", "\u001b[?2004h> +        # after performing the rolling operation). This is populated in\r\n"]
[241.86, "o", "\u001b[?2004l\r\n"]
[241.916182, "o", "\u001b[?2004h> +        # _create_data when applicable.\r\n"]
[241.972364, "o", "\u001b[?2004l\r\n"]
[242.028545, "o", "\u001b[?2004h> +        self._groupby_order: np.ndarray | None = None\r\n"]
[242.084727, "o", "\u001b[?2004l\r\n"]
[242.140909, "o", "\u001b[?2004h> @@\r\n"]
[242.197091, "o", "\u001b[?2004l\r\n"]
[242.253273, "o", "\u001b[?2004h>      def _create_data(self, obj: NDFrameT, numeric_only: bool = False) -> NDFrameT:\r\n"]
[242.309455, "o", "\u001b[?2004l\r\n"]
[242.365636, "o", "\u001b[?2004h> @@\r\n"]
[242.421818, "o", "\u001b[?2004l\r\n"]
[242.478, "o", "\u001b[?2004h> -        if not obj.empty:\r\n"]
[242.534182, "o", "\u001b[?2004l\r\n"]
[242.590364, "o", "\u001b[?2004h> -            groupby_order = np.concatenate(list(self._grouper.indices.values())).astype(\r\n"]
[242.646545, "o", "\u001b[?2004l\r\n"]
[242.702727, "o", "\u001b[?2004h> -                np.int64\r\n"]
[242.758909, "o", "\u001b[?2004l\r\n"]
[242.815091, "o", "\u001b[?2004h> -            )\r\n"]
[242.871273, "o", "\u001b[?2004l\r\n"]
[242.927455, "o", "\u001b[?2004h> -            obj = obj.take(groupby_order)\r\n"]
[242.983636, "o", "\u001b[?2004l\r\n"]
[243.039818, "o", "\u001b[?2004h> +        if not obj.empty:\r\n"]
[243.096, "o", "\u001b[?2004l\r\n"]
[243.152182, "o", "\u001b[?2004h> +            # Construct the take indexer in group order. Avoid creating\r\n"]
[243.208364, "o", "\u001b[?2004l\r\n"]
[243.264545, "o", "\u001b[?2004h> +            # unnecessary copies: keep platform-native integer dtype\r\n"]
[243.320727, "o", "\u001b[?2004l\r\n"]
[243.376909, "o", "\u001b[?2004h> +            # (np.intp) and avoid an extra cast to int64 which would allocate\r\n"]
[243.433091, "o", "\u001b[?2004l\r\n"]
[243.489273, "o", "\u001b[?2004h> +            # a new array. Cache the indexer for later reuse.\r\n"]
[243.545455, "o", "\u001b[?2004l\r\n"]
[243.601636, "o", "\u001b[?2004h> +            group_indices = self._grouper.indices.values()\r\n"]
[243.657818, "o", "\u001b[?2004l\r\n"]
[243.714, "o", "\u001b[?2004h> +            if group_indices:\r\n"]
[243.770182, "o", "\u001b[?2004l\r\n"]
[243.826364, "o", "\u001b[?2004h> +                groupby_order = np.concatenate(list(group_indices))\r\n"]
[243.882545, "o", "\u001b[?2004l\r\n"]
[243.938727, "o", "\u001b[?2004h> +                if groupby_order.dtype != np.intp:\r\n"]
[243.994909, "o", "\u001b[?2004l\r\n"]
[244.051091, "o", "\u001b[?2004h> +                    groupby_order = groupby_order.astype(np.intp, copy=False)\r\n"]
[244.107273, "o", "\u001b[?2004l\r\n"]
[244.163455, "o", "\u001b[?2004h> +            else:\r\n"]
[244.219636, "o", "\u001b[?2004l\r\n"]
[244.275818, "o", "\u001b[?2004h> +                groupby_order = np.array([], dtype=np.intp)\r\n"]
[244.332, "o", "\u001b[?2004l\r\n"]
[244.388182, "o", "\u001b[?2004h> +            self._groupby_order = groupby_order\r\n"]
[244.444364, "o", "\u001b[?2004l\r\n"]
[244.500545, "o", "\u001b[?2004h> +            obj = obj.take(groupby_order)\r\n"]
[244.556727, "o", "\u001b[?2004l\r\n"]
[244.612909, "o", "\u001b[?2004h>          return super()._create_data(obj, numeric_only)\r\n"]
[244.669091, "o", "\u001b[?2004l\r\n"]
[244.725273, "o", "\u001b[?2004h> *** End Patch\r\n"]
[244.781455, "o", "\u001b[?2004l\r\n"]
[244.837636, "o", "\u001b[?2004h> PATCH\r\n"]
[244.893818, "o", "\u001b[?2004l\r\n"]
[245.0, "o", "(asv_3.8) root@cb2cc1765c92:/workspace/repo/asv_bench# "]
[245.002, "i", "applypatch << 'PATCH'\r"]
[245.004, "o", "applypatch << 'PATCH'\r\n"]
[245.062182, "o", "\u001b[?2004l\r\n"]
[245.118364, "o", "\u001b[?2004h> *** Begin Patch\r\n"]
[245.174545, "o", "\u001b[?2004l\r\n"]
[245.230727, "o", "\u001b[?2004h> *** Update File: pandas/core/window/rolling.py\r\n"]
[245.286909, "o", "\u001b[?2004l\r\n"]
[245.343091, "o", "\u001b[?2004h> @@\r\n"]
[245.399273, "o", "\u001b[?2004l\r\n"]
[245.455455, "o", "\u001b[?2004h> -            group_indices = self._grouper.indices.values()\r\n"]
[245.511636, "o", "\u001b[?2004l\r\n"]
[245.567818, "o", "\u001b[?2004h> -            if group_indices:\r\n"]
[245.624, "o", "\u001b[?2004l\r\n"]
[245.680182, "o", "\u001b[?2004h> -                indexer = np.concatenate(list(group_indices))\r\n"]
[245.736364, "o", "\u001b[?2004l\r\n"]
[245.792545, "o", "\u001b[?2004h> -            else:\r\n"]
[245.848727, "o", "\u001b[?2004l\r\n"]
[245.904909, "o", "\u001b[?2004h> -                indexer = np.array([], dtype=np.intp)\r\n"]
[245.961091, "o", "\u001b[?2004l\r\n"]
[246.017273, "o", "\u001b[?2004h> +            # Reuse cached groupby order indexer from _create_data when\r\n"]
[246.073455, "o", "\u001b[?2004l\r\n"]
[246.129636, "o", "\u001b[?2004h> +            # available to avoid recomputing the concatenation here.\r\n"]
[246.185818, "o", "\u001b[?2004l\r\n"]
[246.242, "o", "\u001b[?2004h> +            cached = getattr(self, \"_groupby_order\", None)\r\n"]
[246.298182, "o", "\u001b[?2004l\r\n"]
[246.354364, "o", "\u001b[?2004h> +            if cached is not None:\r\n"]
[246.410545, "o", "\u001b[?2004l\r\n"]
[246.466727, "o", "\u001b[?2004h> +                indexer = cached\r\n"]
[246.522909, "o", "\u001b[?2004l\r\n"]
[246.579091, "o", "\u001b[?2004h> +            else:\r\n"]
[246.635273, "o", "\u001b[?2004l\r\n"]
[246.691455, "o", "\u001b[?2004h> +                group_indices = self._grouper.indices.values()\r\n"]
[246.747636, "o", "\u001b[?2004l\r\n"]
[246.803818, "o", "\u001b[?2004h> +                if group_indices:\r\n"]
[246.86, "o", "\u001b[?2004l\r\n"]
[246.916182, "o", "\u001b[?2004h> +                    indexer = np.concatenate(list(group_indices))\r\n"]
[246.972364, "o", "\u001b[?2004l\r\n"]
[247.028545, "o", "\u001b[?2004h> +                    if indexer.dtype != np.intp:\r\n"]
[247.084727, "o", "\u001b[?2004l\r\n"]
[247.140909, "o", "\u001b[?2004h> +                        indexer = indexer.astype(np.intp, copy=False)\r\n"]
[247.197091, "o", "\u001b[?2004l\r\n"]
[247.253273, "o", "\u001b[?2004h> +                else:\r\n"]
[247.309455, "o", "\u001b[?2004l\r\n"]
[247.365636, "o", "\u001b[?2004h> +                    indexer = np.array([], dtype=np.intp)\r\n"]
[247.421818, "o", "\u001b[?2004l\r\n"]
[247.478, "o", "\u001b[?2004h> @@\r\n"]
[247.534182, "o", "\u001b[?2004l\r\n"]
[247.590364, "o", "\u001b[?2004h> -            if target.ndim == 1:\r\n"]
[247.646545, "o", "\u001b[?2004l\r\n"]
[247.702727, "o", "\u001b[?2004h> -                repeat_by = 1\r\n"]
[247.758909, "o", "\u001b[?2004l\r\n"]
[247.815091, "o", "\u001b[?2004h> -            else:\r\n"]
[247.871273, "o", "\u001b[?2004l\r\n"]
[247.927455, "o", "\u001b[?2004h> -                repeat_by = len(target.columns)\r\n"]
[247.983636, "o", "\u001b[?2004l\r\n"]
[248.039818, "o", "\u001b[?2004h> -            groupby_codes = [\r\n"]
[248.096, "o", "\u001b[?2004l\r\n"]
[248.152182, "o", "\u001b[?2004h> -                np.repeat(c.take(indexer), repeat_by) for c in groupby_codes\r\n"]
[248.208364, "o", "\u001b[?2004l\r\n"]
[248.264545, "o", "\u001b[?2004h> -            ]\r\n"]
[248.320727, "o", "\u001b[?2004l\r\n"]
[248.376909, "o", "\u001b[?2004h> +            if target.ndim == 1:\r\n"]
[248.433091, "o", "\u001b[?2004l\r\n"]
[248.489273, "o", "\u001b[?2004h> +                repeat_by = 1\r\n"]
[248.545455, "o", "\u001b[?2004l\r\n"]
[248.601636, "o", "\u001b[?2004h> +            else:\r\n"]
[248.657818, "o", "\u001b[?2004l\r\n"]
[248.714, "o", "\u001b[?2004h> +                repeat_by = len(target.columns)\r\n"]
[248.770182, "o", "\u001b[?2004l\r\n"]
[248.826364, "o", "\u001b[?2004h> +            # Avoid an unnecessary allocation when there is no need to repeat\r\n"]
[248.882545, "o", "\u001b[?2004l\r\n"]
[248.938727, "o", "\u001b[?2004h> +            # (the common case for 1D targets)\r\n"]
[248.994909, "o", "\u001b[?2004l\r\n"]
[249.051091, "o", "\u001b[?2004h> +            if repeat_by == 1:\r\n"]
[249.107273, "o", "\u001b[?2004l\r\n"]
[249.163455, "o", "\u001b[?2004h> +                groupby_codes = [c.take(indexer) for c in groupby_codes]\r\n"]
[249.219636, "o", "\u001b[?2004l\r\n"]
[249.275818, "o", "\u001b[?2004h> +            else:\r\n"]
[249.332, "o", "\u001b[?2004l\r\n"]
[249.388182, "o", "\u001b[?2004h> +                groupby_codes = [\r\n"]
[249.444364, "o", "\u001b[?2004l\r\n"]
[249.500545, "o", "\u001b[?2004h> +                    np.repeat(c.take(indexer), repeat_by) for c in groupby_codes\r\n"]
[249.556727, "o", "\u001b[?2004l\r\n"]
[249.612909, "o", "\u001b[?2004h> +                ]\r\n"]
[249.669091, "o", "\u001b[?2004l\r\n"]
[249.725273, "o", "\u001b[?2004h> *** End Patch\r\n"]
[249.781455, "o", "\u001b[?2004l\r\n"]
[249.837636, "o", "\u001b[?2004h> PATCH\r\n"]
[249.893818, "o", "\u001b[?2004l\r\n"]
[250.0, "o", "(asv_3.8) root@cb2cc1765c92:/workspace/repo/asv_bench# "]
[250.002, "i", "git -C .. diff -- pandas/core/window/rolling.py | sed -n '1,200p'\r"]
[250.004, "o", "git -C .. diff -- pandas/core/window/rolling.py | sed -n '1,200p'\r\n"]
[250.006, "o", "\u001b[?2004l\r\n"]
[255.0, "o", "(asv_3.8) root@cb2cc1765c92:/workspace/repo/asv_bench# "]
[255.002, "i", "git -C .. diff -- pandas/core/window/rolling.py | sed -n '200,400p'\r"]
[255.004, "o", "git -C .. diff -- pandas/core/window/rolling.py | sed -n '200,400p'\r\n"]
[255.006, "o", "\u001b[?2004l\r\n"]
[260.0, "o", "(asv_3.8) root@cb2cc1765c92:/workspace/repo/asv_bench# "]
[260.002, "i", "asv run --python=same --bench=\"rolling.GroupbyLargeGroups.time_rolling_multiindex_creation\" --quick\r"]
[260.004, "o", "asv run --python=same --bench=\"rolling.GroupbyLargeGroups.time_rolling_multiindex_creation\" --quick\r\n"]
[260.9948, "o", "\u001b[?2004l\r\n"]
[261.9836, "o", "\u00b7 \u001b[0;32mDiscovering benchmarks\u001b[0m\r\n"]
[262.9724, "o", "\u00b7 \u001b[0;32mRunning 1 total benchmarks (1 commits * 1 environments * 1 benchmarks)\u001b[0m\r\n"]
[263.9612, "o", "[ 0.00%] \u00b7\u00b7 \u001b[0;34mBenchmarking existing-py_opt_conda_envs_asv_3.8_bin_python\u001b[0m\r\n"]
[265.0, "o", "(asv_3.8) root@cb2cc1765c92:/workspace/repo/asv_bench# "]
[265.002, "i", "grep -n \"result.index = MultiIndex\\|repeat_by = len(target.columns)\\|np.repeat\\|_create_data\\|indices.valu\r"]
[265.004, "o", "grep -n \"result.index = MultiIndex\\|repeat_by = len(target.columns)\\|np.repeat\\|_create_data\\|indices.valu\r\n"]
[265.230727, "o", "ues\" ../pandas/core/window/rolling.py\r\n"]
[265.455455, "o", "\u001b[?2004l\r\n"]
[265.680182, "o", "\u001b[32m\u001b[K264\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K    def \u001b[01;31m\u001b[K_create_data\u001b[m\u001b[K(self, obj: NDFrameT, numeric_only: bool = False) -> NDFrameT:\r\n"]
[265.904909, "o", "\u001b[32m\u001b[K339\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K        obj = self.\u001b[01;31m\u001b[K_create_data\u001b[m\u001b[K(obj)\r\n"]
[266.129636, "o", "\u001b[32m\u001b[K442\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K        obj = self.\u001b[01;31m\u001b[K_create_data\u001b[m\u001b[K(self._selected_obj)\r\n"]
[266.354364, "o", "\u001b[32m\u001b[K470\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K        obj = self.\u001b[01;31m\u001b[K_create_data\u001b[m\u001b[K(self._selected_obj, numeric_only)\r\n"]
[266.579091, "o", "\u001b[32m\u001b[K520\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K        obj = self.\u001b[01;31m\u001b[K_create_data\u001b[m\u001b[K(self._selected_obj, numeric_only)\r\n"]
[266.803818, "o", "\u001b[32m\u001b[K546\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K        target = self.\u001b[01;31m\u001b[K_create_data\u001b[m\u001b[K(target, numeric_only)\r\n"]
[267.028545, "o", "\u001b[32m\u001b[K631\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K        obj = self.\u001b[01;31m\u001b[K_create_data\u001b[m\u001b[K(self._selected_obj)\r\n"]
[267.253273, "o", "\u001b[32m\u001b[K737\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K        group_indices = self._grouper.\u001b[01;31m\u001b[Kindices.values\u001b[m\u001b[K()\r\n"]
[267.478, "o", "\u001b[32m\u001b[K753\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K        \u001b[01;31m\u001b[Kresult_index = MultiIndex\u001b[m\u001b[K(\r\n"]
[267.702727, "o", "\u001b[32m\u001b[K778\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K            len(group) == len(other) for group in self._grouper.\u001b[01;31m\u001b[Kindices.values\u001b[m\u001b[K()\r\n"]
[267.927455, "o", "\u001b[32m\u001b[K788\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K                    for gb_indices in self._grouper.\u001b[01;31m\u001b[Kindices.values\u001b[m\u001b[K()\r\n"]
[268.152182, "o", "\u001b[32m\u001b[K799\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K                labels = \u001b[01;31m\u001b[Knp.repeat\u001b[m\u001b[K(np.array(gb_level_pair), old_result_len)\r\n"]
[268.376909, "o", "\u001b[32m\u001b[K811\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K            group_indices = self._grouper.\u001b[01;31m\u001b[Kindices.values\u001b[m\u001b[K()\r\n"]
[268.601636, "o", "\u001b[32m\u001b[K820\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K                \u001b[01;31m\u001b[Krepeat_by = len(target.columns)\u001b[m\u001b[K\r\n"]
[268.826364, "o", "\u001b[32m\u001b[K822\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K                \u001b[01;31m\u001b[Knp.repeat\u001b[m\u001b[K(c.take(indexer), repeat_by) for c in groupby_codes\r\n"]
[269.051091, "o", "\u001b[32m\u001b[K840\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K        \u001b[01;31m\u001b[Kresult_index = MultiIndex\u001b[m\u001b[K(\r\n"]
[269.275818, "o", "\u001b[32m\u001b[K846\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K    def \u001b[01;31m\u001b[K_create_data\u001b[m\u001b[K(self, obj: NDFrameT, numeric_only: bool = False) -> NDFrameT:\r\n"]
[269.500545, "o", "\u001b[32m\u001b[K854\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K            groupby_order = np.concatenate(list(self._grouper.\u001b[01;31m\u001b[Kindices.values\u001b[m\u001b[K())).astype(\r\n"]
[269.725273, "o", "\u001b[32m\u001b[K858\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K        return super().\u001b[01;31m\u001b[K_create_data\u001b[m\u001b[K(obj, numeric_only)\r\n"]
[270.0, "o", "(asv_3.8) root@cb2cc1765c92:/workspace/repo/asv_bench# "]
[270.002, "i", "sed -n '1,220p' ../pandas/core/window/rolling.py | nl -ba | sed -n '1,220p'\r"]
[270.004, "o", "sed -n '1,220p' ../pandas/core/window/rolling.py | nl -ba | sed -n '1,220p'\r\n"]
[270.028371, "o", "\u001b[?2004l\r\n"]
[270.050742, "o", "     1\t\"\"\"\r\n"]
[270.073113, "o", "     2\tProvide a generic structure to support window functions,\r\n"]
[270.095484, "o", "     3\tsimilar to how we have a Groupby object.\r\n"]
[270.117855, "o", "     4\t\"\"\"\r\n"]
[270.140226, "o", "     5\tfrom __future__ import annotations\r\n"]
[270.162597, "o", "     6\t\r\n"]
[270.184968, "o", "     7\timport copy\r\n"]
[270.207339, "o", "     8\tfrom datetime import timedelta\r\n"]
[270.22971, "o", "     9\tfrom functools import partial\r\n"]
[270.252081, "o", "    10\timport inspect\r\n"]
[270.274452, "o", "    11\tfrom textwrap import dedent\r\n"]
[270.296824, "o", "    12\tfrom typing import (\r\n"]
[270.319195, "o", "    13\t    TYPE_CHECKING,\r\n"]
[270.341566, "o", "    14\t    Any,\r\n"]
[270.363937, "o", "    15\t    Callable,\r\n"]
[270.386308, "o", "    16\t    Hashable,\r\n"]
[270.408679, "o", "    17\t    Iterator,\r\n"]
[270.43105, "o", "    18\t    Sized,\r\n"]
[270.453421, "o", "    19\t    cast,\r\n"]
[270.475792, "o", "    20\t)\r\n"]
[270.498163, "o", "    21\t\r\n"]
[270.520534, "o", "    22\timport numpy as np\r\n"]
[270.542905, "o", "    23\t\r\n"]
[270.565276, "o", "    24\tfrom pandas._libs.tslibs import (\r\n"]
[270.587647, "o", "    25\t    BaseOffset,\r\n"]
[270.610018, "o", "    26\t    to_offset,\r\n"]
[270.632389, "o", "    27\t)\r\n"]
[270.65476, "o", "    28\timport pandas._libs.window.aggregations as window_aggregations\r\n"]
[270.677131, "o", "    29\tfrom pandas._typing import (\r\n"]
[270.699502, "o", "    30\t    ArrayLike,\r\n"]
[270.721873, "o", "    31\t    Axis,\r\n"]
[270.744244, "o", "    32\t    NDFrameT,\r\n"]
[270.766615, "o", "    33\t    QuantileInterpolation,\r\n"]
[270.788986, "o", "    34\t    WindowingRankType,\r\n"]
[270.811357, "o", "    35\t)\r\n"]
[270.833729, "o", "    36\tfrom pandas.compat._optional import import_optional_dependency\r\n"]
[270.8561, "o", "    37\tfrom pandas.errors import DataError\r\n"]
[270.878471, "o", "    38\tfrom pandas.util._decorators import doc\r\n"]
[270.900842, "o", "    39\t\r\n"]
[270.923213, "o", "    40\tfrom pandas.core.dtypes.common import (\r\n"]
[270.945584, "o", "    41\t    ensure_float64,\r\n"]
[270.967955, "o", "    42\t    is_bool,\r\n"]
[270.990326, "o", "    43\t    is_integer,\r\n"]
[271.012697, "o", "    44\t    is_list_like,\r\n"]
[271.035068, "o", "    45\t    is_numeric_dtype,\r\n"]
[271.057439, "o", "    46\t    is_scalar,\r\n"]
[271.07981, "o", "    47\t    needs_i8_conversion,\r\n"]
[271.102181, "o", "    48\t)\r\n"]
[271.124552, "o", "    49\tfrom pandas.core.dtypes.generic import (\r\n"]
[271.146923, "o", "    50\t    ABCDataFrame,\r\n"]
[271.169294, "o", "    51\t    ABCSeries,\r\n"]
[271.191665, "o", "    52\t)\r\n"]
[271.214036, "o", "    53\tfrom pandas.core.dtypes.missing import notna\r\n"]
[271.236407, "o", "    54\t\r\n"]
[271.258778, "o", "    55\tfrom pandas.core._numba import executor\r\n"]
[271.281149, "o", "    56\tfrom pandas.core.algorithms import factorize\r\n"]
[271.30352, "o", "    57\tfrom pandas.core.apply import ResamplerWindowApply\r\n"]
[271.325891, "o", "    58\tfrom pandas.core.arrays import ExtensionArray\r\n"]
[271.348262, "o", "    59\tfrom pandas.core.base import SelectionMixin\r\n"]
[271.370633, "o", "    60\timport pandas.core.common as com\r\n"]
[271.393005, "o", "    61\tfrom pandas.core.indexers.objects import (\r\n"]
[271.415376, "o", "    62\t    BaseIndexer,\r\n"]
[271.437747, "o", "    63\t    FixedWindowIndexer,\r\n"]
[271.460118, "o", "    64\t    GroupbyIndexer,\r\n"]
[271.482489, "o", "    65\t    VariableWindowIndexer,\r\n"]
[271.50486, "o", "    66\t)\r\n"]
[271.527231, "o", "    67\tfrom pandas.core.indexes.api import (\r\n"]
[271.549602, "o", "    68\t    DatetimeIndex,\r\n"]
[271.571973, "o", "    69\t    Index,\r\n"]
[271.594344, "o", "    70\t    MultiIndex,\r\n"]
[271.616715, "o", "    71\t    PeriodIndex,\r\n"]
[271.639086, "o", "    72\t    TimedeltaIndex,\r\n"]
[271.661457, "o", "    73\t)\r\n"]
[271.683828, "o", "    74\tfrom pandas.core.reshape.concat import concat\r\n"]
[271.706199, "o", "    75\tfrom pandas.core.util.numba_ import (\r\n"]
[271.72857, "o", "    76\t    get_jit_arguments,\r\n"]
[271.750941, "o", "    77\t    maybe_use_numba,\r\n"]
[271.773312, "o", "    78\t)\r\n"]
[271.795683, "o", "    79\tfrom pandas.core.window.common import (\r\n"]
[271.818054, "o", "    80\t    flex_binary_moment,\r\n"]
[271.840425, "o", "    81\t    zsqrt,\r\n"]
[271.862796, "o", "    82\t)\r\n"]
[271.885167, "o", "    83\tfrom pandas.core.window.doc import (\r\n"]
[271.907538, "o", "    84\t    _shared_docs,\r\n"]
[271.92991, "o", "    85\t    create_section_header,\r\n"]
[271.952281, "o", "    86\t    kwargs_numeric_only,\r\n"]
[271.974652, "o", "    87\t    kwargs_scipy,\r\n"]
[271.997023, "o", "    88\t    numba_notes,\r\n"]
[272.019394, "o", "    89\t    template_header,\r\n"]
[272.041765, "o", "    90\t    template_returns,\r\n"]
[272.064136, "o", "    91\t    template_see_also,\r\n"]
[272.086507, "o", "    92\t    window_agg_numba_parameters,\r\n"]
[272.108878, "o", "    93\t    window_apply_parameters,\r\n"]
[272.131249, "o", "    94\t)\r\n"]
[272.15362, "o", "    95\tfrom pandas.core.window.numba_ import (\r\n"]
[272.175991, "o", "    96\t    generate_manual_numpy_nan_agg_with_axis,\r\n"]
[272.198362, "o", "    97\t    generate_numba_apply_func,\r\n"]
[272.220733, "o", "    98\t    generate_numba_table_func,\r\n"]
[272.243104, "o", "    99\t)\r\n"]
[272.265475, "o", "   100\t\r\n"]
[272.287846, "o", "   101\tif TYPE_CHECKING:\r\n"]
[272.310217, "o", "   102\t    from pandas import (\r\n"]
[272.332588, "o", "   103\t        DataFrame,\r\n"]
[272.354959, "o", "   104\t        Series,\r\n"]
[272.37733, "o", "   105\t    )\r\n"]
[272.399701, "o", "   106\t    from pandas.core.generic import NDFrame\r\n"]
[272.422072, "o", "   107\t    from pandas.core.groupby.ops import BaseGrouper\r\n"]
[272.444443, "o", "   108\t\r\n"]
[272.466814, "o", "   109\t\r\n"]
[272.489186, "o", "   110\tclass BaseWindow(SelectionMixin):\r\n"]
[272.511557, "o", "   111\t    \"\"\"Provides utilities for performing windowing operations.\"\"\"\r\n"]
[272.533928, "o", "   112\t\r\n"]
[272.556299, "o", "   113\t    _attributes: list[str] = []\r\n"]
[272.57867, "o", "   114\t    exclusions: frozenset[Hashable] = frozenset()\r\n"]
[272.601041, "o", "   115\t    _on: Index\r\n"]
[272.623412, "o", "   116\t\r\n"]
[272.645783, "o", "   117\t    def __init__(\r\n"]
[272.668154, "o", "   118\t        self,\r\n"]
[272.690525, "o", "   119\t        obj: NDFrame,\r\n"]
[272.712896, "o", "   120\t        window=None,\r\n"]
[272.735267, "o", "   121\t        min_periods: int | None = None,\r\n"]
[272.757638, "o", "   122\t        center: bool | None = False,\r\n"]
[272.780009, "o", "   123\t        win_type: str | None = None,\r\n"]
[272.80238, "o", "   124\t        axis: Axis = 0,\r\n"]
[272.824751, "o", "   125\t        on: str | Index | None = None,\r\n"]
[272.847122, "o", "   126\t        closed: str | None = None,\r\n"]
[272.869493, "o", "   127\t        step: int | None = None,\r\n"]
[272.891864, "o", "   128\t        method: str = \"single\",\r\n"]
[272.914235, "o", "   129\t        *,\r\n"]
[272.936606, "o", "   130\t        selection=None,\r\n"]
[272.958977, "o", "   131\t    ) -> None:\r\n"]
[272.981348, "o", "   132\t        self.obj = obj\r\n"]
[273.003719, "o", "   133\t        self.on = on\r\n"]
[273.02609, "o", "   134\t        self.closed = closed\r\n"]
[273.048462, "o", "   135\t        self.step = step\r\n"]
[273.070833, "o", "   136\t        self.window = window\r\n"]
[273.093204, "o", "   137\t        self.min_periods = min_periods\r\n"]
[273.115575, "o", "   138\t        self.center = center\r\n"]
[273.137946, "o", "   139\t        self.win_type = win_type\r\n"]
[273.160317, "o", "   140\t        self.axis = obj._get_axis_number(axis) if axis is not None else None\r\n"]
[273.182688, "o", "   141\t        self.method = method\r\n"]
[273.205059, "o", "   142\t        self._win_freq_i8: int | None = None\r\n"]
[273.22743, "o", "   143\t        if self.on is None:\r\n"]
[273.249801, "o", "   144\t            if self.axis == 0:\r\n"]
[273.272172, "o", "   145\t                self._on = self.obj.index\r\n"]
[273.294543, "o", "   146\t            else:\r\n"]
[273.316914, "o", "   147\t                # i.e. self.axis == 1\r\n"]
[273.339285, "o", "   148\t                self._on = self.obj.columns\r\n"]
[273.361656, "o", "   149\t        elif isinstance(self.on, Index):\r\n"]
[273.384027, "o", "   150\t            self._on = self.on\r\n"]
[273.406398, "o", "   151\t        elif isinstance(self.obj, ABCDataFrame) and self.on in self.obj.columns:\r\n"]
[273.428769, "o", "   152\t            self._on = Index(self.obj[self.on])\r\n"]
[273.45114, "o", "   153\t        else:\r\n"]
[273.473511, "o", "   154\t            raise ValueError(\r\n"]
[273.495882, "o", "   155\t                f\"invalid on specified as {self.on}, \"\r\n"]
[273.518253, "o", "   156\t                \"must be a column (of DataFrame), an Index or None\"\r\n"]
[273.540624, "o", "   157\t            )\r\n"]
[273.562995, "o", "   158\t\r\n"]
[273.585367, "o", "   159\t        self._selection = selection\r\n"]
[273.607738, "o", "   160\t        self._validate()\r\n"]
[273.630109, "o", "   161\t\r\n"]
[273.65248, "o", "   162\t    def _validate(self) -> None:\r\n"]
[273.674851, "o", "   163\t        if self.center is not None and not is_bool(self.center):\r\n"]
[273.697222, "o", "   164\t            raise ValueError(\"center must be a boolean\")\r\n"]
[273.719593, "o", "   165\t        if self.min_periods is not None:\r\n"]
[273.741964, "o", "   166\t            if not is_integer(self.min_periods):\r\n"]
[273.764335, "o", "   167\t                raise ValueError(\"min_periods must be an integer\")\r\n"]
[273.786706, "o", "   168\t            if self.min_periods < 0:\r\n"]
[273.809077, "o", "   169\t                raise ValueError(\"min_periods must be >= 0\")\r\n"]
[273.831448, "o", "   170\t            if is_integer(self.window) and self.min_periods > self.window:\r\n"]
[273.853819, "o", "   171\t                raise ValueError(\r\n"]
[273.87619, "o", "   172\t                    f\"min_periods {self.min_periods} must be <= window {self.window}\"\r\n"]
[273.898561, "o", "   173\t                )\r\n"]
[273.920932, "o", "   174\t        if self.closed is not None and self.closed not in [\r\n"]
[273.943303, "o", "   175\t            \"right\",\r\n"]
[273.965674, "o", "   176\t            \"both\",\r\n"]
[273.988045, "o", "   177\t            \"left\",\r\n"]
[274.010416, "o", "   178\t            \"neither\",\r\n"]
[274.032787, "o", "   179\t        ]:\r\n"]
[274.055158, "o", "   180\t            raise ValueError(\"closed must be 'right', 'left', 'both' or 'neither'\")\r\n"]
[274.077529, "o", "   181\t        if not isinstance(self.obj, (ABCSeries, ABCDataFrame)):\r\n"]
[274.0999, "o", "   182\t            raise TypeError(f\"invalid type: {type(self)}\")\r\n"]
[274.122271, "o", "   183\t        if isinstance(self.window, BaseIndexer):\r\n"]
[274.144643, "o", "   184\t            # Validate that the passed BaseIndexer subclass has\r\n"]
[274.167014, "o", "   185\t            # a get_window_bounds with the correct signature.\r\n"]
[274.189385, "o", "   186\t            get_window_bounds_signature = inspect.signature(\r\n"]
[274.211756, "o", "   187\t                self.window.get_window_bounds\r\n"]
[274.234127, "o", "   188\t            ).parameters.keys()\r\n"]
[274.256498, "o", "   189\t            expected_signature = inspect.signature(\r\n"]
[274.278869, "o", "   190\t                BaseIndexer().get_window_bounds\r\n"]
[274.30124, "o", "   191\t            ).parameters.keys()\r\n"]
[274.323611, "o", "   192\t            if get_window_bounds_signature != expected_signature:\r\n"]
[274.345982, "o", "   193\t                raise ValueError(\r\n"]
[274.368353, "o", "   194\t                    f\"{type(self.window).__name__} does not implement \"\r\n"]
[274.390724, "o", "   195\t                    f\"the correct signature for get_window_bounds\"\r\n"]
[274.413095, "o", "   196\t                )\r\n"]
[274.435466, "o", "   197\t        if self.method not in [\"table\", \"single\"]:\r\n"]
[274.457837, "o", "   198\t            raise ValueError(\"method must be 'table' or 'single\")\r\n"]
[274.480208, "o", "   199\t        if self.step is not None:\r\n"]
[274.502579, "o", "   200\t            if not is_integer(self.step):\r\n"]
[274.52495, "o", "   201\t                raise ValueError(\"step must be an integer\")\r\n"]
[274.547321, "o", "   202\t            if self.step < 0:\r\n"]
[274.569692, "o", "   203\t                raise ValueError(\"step must be >= 0\")\r\n"]
[274.592063, "o", "   204\t\r\n"]
[274.614434, "o", "   205\t    def _check_window_bounds(\r\n"]
[274.636805, "o", "   206\t        self, start: np.ndarray, end: np.ndarray, num_vals: int\r\n"]
[274.659176, "o", "   207\t    ) -> None:\r\n"]
[274.681548, "o", "   208\t        if len(start) != len(end):\r\n"]
[274.703919, "o", "   209\t            raise ValueError(\r\n"]
[274.72629, "o", "   210\t                f\"start ({len(start)}) and end ({len(end)}) bounds must be the \"\r\n"]
[274.748661, "o", "   211\t                f\"same length\"\r\n"]
[274.771032, "o", "   212\t            )\r\n"]
[274.793403, "o", "   213\t        if len(start) != (num_vals + (self.step or 1) - 1) // (self.step or 1):\r\n"]
[274.815774, "o", "   214\t            raise ValueError(\r\n"]
[274.838145, "o", "   215\t                f\"start and end bounds ({len(start)}) must be the same length \"\r\n"]
[274.860516, "o", "   216\t                f\"as the object ({num_vals}) divided by the step ({self.step}) \"\r\n"]
[274.882887, "o", "   217\t                f\"if given and rounded up\"\r\n"]
[274.905258, "o", "   218\t            )\r\n"]
[274.927629, "o", "   219\t\r\n"]
[275.0, "o", "(asv_3.8) root@cb2cc1765c92:/workspace/repo/asv_bench# "]
[275.002, "i", "sed -n '220,720p' ../pandas/core/window/rolling.py | nl -ba | sed -n '220,720p'\r"]
[275.004, "o", "sed -n '220,720p' ../pandas/core/window/rolling.py | nl -ba | sed -n '220,720p'\r\n"]
[275.02347, "o", "\u001b[?2004l\r\n"]
[275.04094, "o", "   220\t        \"\"\"\r\n"]
[275.05841, "o", "   221\t        Series version of _apply_blockwise\r\n"]
[275.07588, "o", "   222\t        \"\"\"\r\n"]
[275.09335, "o", "   223\t        obj = self._create_data(self._selected_obj)\r\n"]
[275.11082, "o", "   224\t\r\n"]
[275.12829, "o", "   225\t        if name == \"count\":\r\n"]
[275.14576, "o", "   226\t            # GH 12541: Special case for count where we support date-like types\r\n"]
[275.16323, "o", "   227\t            obj = notna(obj).astype(int)\r\n"]
[275.1807, "o", "   228\t        try:\r\n"]
[275.19817, "o", "   229\t            values = self._prep_values(obj._values)\r\n"]
[275.21564, "o", "   230\t        except (TypeError, NotImplementedError) as err:\r\n"]
[275.23311, "o", "   231\t            raise DataError(\"No numeric types to aggregate\") from err\r\n"]
[275.25058, "o", "   232\t\r\n"]
[275.268049, "o", "   233\t        result = homogeneous_func(values)\r\n"]
[275.285519, "o", "   234\t        index = self._slice_axis_for_step(obj.index, result)\r\n"]
[275.302989, "o", "   235\t        return obj._constructor(result, index=index, name=obj.name)\r\n"]
[275.320459, "o", "   236\t\r\n"]
[275.337929, "o", "   237\t    def _apply_blockwise(\r\n"]
[275.355399, "o", "   238\t        self,\r\n"]
[275.372869, "o", "   239\t        homogeneous_func: Callable[..., ArrayLike],\r\n"]
[275.390339, "o", "   240\t        name: str,\r\n"]
[275.407809, "o", "   241\t        numeric_only: bool = False,\r\n"]
[275.425279, "o", "   242\t    ) -> DataFrame | Series:\r\n"]
[275.442749, "o", "   243\t        \"\"\"\r\n"]
[275.460219, "o", "   244\t        Apply the given function to the DataFrame broken down into homogeneous\r\n"]
[275.477689, "o", "   245\t        sub-frames.\r\n"]
[275.495159, "o", "   246\t        \"\"\"\r\n"]
[275.512629, "o", "   247\t        self._validate_numeric_only(name, numeric_only)\r\n"]
[275.530099, "o", "   248\t        if self._selected_obj.ndim == 1:\r\n"]
[275.547569, "o", "   249\t            return self._apply_series(homogeneous_func, name)\r\n"]
[275.565039, "o", "   250\t\r\n"]
[275.582509, "o", "   251\t        obj = self._create_data(self._selected_obj, numeric_only)\r\n"]
[275.599979, "o", "   252\t        if name == \"count\":\r\n"]
[275.617449, "o", "   253\t            # GH 12541: Special case for count where we support date-like types\r\n"]
[275.634919, "o", "   254\t            obj = notna(obj).astype(int)\r\n"]
[275.652389, "o", "   255\t            obj._mgr = obj._mgr.consolidate()\r\n"]
[275.669859, "o", "   256\t\r\n"]
[275.687329, "o", "   257\t        if self.axis == 1:\r\n"]
[275.704799, "o", "   258\t            obj = obj.T\r\n"]
[275.722269, "o", "   259\t\r\n"]
[275.739739, "o", "   260\t        taker = []\r\n"]
[275.757208, "o", "   261\t        res_values = []\r\n"]
[275.774678, "o", "   262\t        for i, arr in enumerate(obj._iter_column_arrays()):\r\n"]
[275.792148, "o", "   263\t            # GH#42736 operate column-wise instead of block-wise\r\n"]
[275.809618, "o", "   264\t            # As of 2.0, hfunc will raise for nuisance columns\r\n"]
[275.827088, "o", "   265\t            try:\r\n"]
[275.844558, "o", "   266\t                arr = self._prep_values(arr)\r\n"]
[275.862028, "o", "   267\t            except (TypeError, NotImplementedError) as err:\r\n"]
[275.879498, "o", "   268\t                raise DataError(\r\n"]
[275.896968, "o", "   269\t                    f\"Cannot aggregate non-numeric type: {arr.dtype}\"\r\n"]
[275.914438, "o", "   270\t                ) from err\r\n"]
[275.931908, "o", "   271\t            res = homogeneous_func(arr)\r\n"]
[275.949378, "o", "   272\t            res_values.append(res)\r\n"]
[275.966848, "o", "   273\t            taker.append(i)\r\n"]
[275.984318, "o", "   274\t\r\n"]
[276.001788, "o", "   275\t        index = self._slice_axis_for_step(\r\n"]
[276.019258, "o", "   276\t            obj.index, res_values[0] if len(res_values) > 0 else None\r\n"]
[276.036728, "o", "   277\t        )\r\n"]
[276.054198, "o", "   278\t        df = type(obj)._from_arrays(\r\n"]
[276.071668, "o", "   279\t            res_values,\r\n"]
[276.089138, "o", "   280\t            index=index,\r\n"]
[276.106608, "o", "   281\t            columns=obj.columns.take(taker),\r\n"]
[276.124078, "o", "   282\t            verify_integrity=False,\r\n"]
[276.141548, "o", "   283\t        )\r\n"]
[276.159018, "o", "   284\t\r\n"]
[276.176488, "o", "   285\t        if self.axis == 1:\r\n"]
[276.193958, "o", "   286\t            df = df.T\r\n"]
[276.211428, "o", "   287\t\r\n"]
[276.228898, "o", "   288\t        return self._resolve_output(df, obj)\r\n"]
[276.246367, "o", "   289\t\r\n"]
[276.263837, "o", "   290\t    def _apply_tablewise(\r\n"]
[276.281307, "o", "   291\t        self,\r\n"]
[276.298777, "o", "   292\t        homogeneous_func: Callable[..., ArrayLike],\r\n"]
[276.316247, "o", "   293\t        name: str | None = None,\r\n"]
[276.333717, "o", "   294\t        numeric_only: bool = False,\r\n"]
[276.351187, "o", "   295\t    ) -> DataFrame | Series:\r\n"]
[276.368657, "o", "   296\t        \"\"\"\r\n"]
[276.386127, "o", "   297\t        Apply the given function to the DataFrame across the entire object\r\n"]
[276.403597, "o", "   298\t        \"\"\"\r\n"]
[276.421067, "o", "   299\t        if self._selected_obj.ndim == 1:\r\n"]
[276.438537, "o", "   300\t            raise ValueError(\"method='table' not applicable for Series objects.\")\r\n"]
[276.456007, "o", "   301\t        obj = self._create_data(self._selected_obj, numeric_only)\r\n"]
[276.473477, "o", "   302\t        values = self._prep_values(obj.to_numpy())\r\n"]
[276.490947, "o", "   303\t        values = values.T if self.axis == 1 else values\r\n"]
[276.508417, "o", "   304\t        result = homogeneous_func(values)\r\n"]
[276.525887, "o", "   305\t        result = result.T if self.axis == 1 else result\r\n"]
[276.543357, "o", "   306\t        index = self._slice_axis_for_step(obj.index, result)\r\n"]
[276.560827, "o", "   307\t        columns = (\r\n"]
[276.578297, "o", "   308\t            obj.columns\r\n"]
[276.595767, "o", "   309\t            if result.shape[1] == len(obj.columns)\r\n"]
[276.613237, "o", "   310\t            else obj.columns[:: self.step]\r\n"]
[276.630707, "o", "   311\t        )\r\n"]
[276.648177, "o", "   312\t        out = obj._constructor(result, index=index, columns=columns)\r\n"]
[276.665647, "o", "   313\t\r\n"]
[276.683117, "o", "   314\t        return self._resolve_output(out, obj)\r\n"]
[276.700587, "o", "   315\t\r\n"]
[276.718057, "o", "   316\t    def _apply_pairwise(\r\n"]
[276.735527, "o", "   317\t        self,\r\n"]
[276.752996, "o", "   318\t        target: DataFrame | Series,\r\n"]
[276.770466, "o", "   319\t        other: DataFrame | Series | None,\r\n"]
[276.787936, "o", "   320\t        pairwise: bool | None,\r\n"]
[276.805406, "o", "   321\t        func: Callable[[DataFrame | Series, DataFrame | Series], DataFrame | Series],\r\n"]
[276.822876, "o", "   322\t        numeric_only: bool,\r\n"]
[276.840346, "o", "   323\t    ) -> DataFrame | Series:\r\n"]
[276.857816, "o", "   324\t        \"\"\"\r\n"]
[276.875286, "o", "   325\t        Apply the given pairwise function given 2 pandas objects (DataFrame/Series)\r\n"]
[276.892756, "o", "   326\t        \"\"\"\r\n"]
[276.910226, "o", "   327\t        target = self._create_data(target, numeric_only)\r\n"]
[276.927696, "o", "   328\t        if other is None:\r\n"]
[276.945166, "o", "   329\t            other = target\r\n"]
[276.962636, "o", "   330\t            # only default unset\r\n"]
[276.980106, "o", "   331\t            pairwise = True if pairwise is None else pairwise\r\n"]
[276.997576, "o", "   332\t        elif not isinstance(other, (ABCDataFrame, ABCSeries)):\r\n"]
[277.015046, "o", "   333\t            raise ValueError(\"other must be a DataFrame or Series\")\r\n"]
[277.032516, "o", "   334\t        elif other.ndim == 2 and numeric_only:\r\n"]
[277.049986, "o", "   335\t            other = self._make_numeric_only(other)\r\n"]
[277.067456, "o", "   336\t\r\n"]
[277.084926, "o", "   337\t        return flex_binary_moment(target, other, func, pairwise=bool(pairwise))\r\n"]
[277.102396, "o", "   338\t\r\n"]
[277.119866, "o", "   339\t    def _apply(\r\n"]
[277.137336, "o", "   340\t        self,\r\n"]
[277.154806, "o", "   341\t        func: Callable[..., Any],\r\n"]
[277.172276, "o", "   342\t        name: str,\r\n"]
[277.189746, "o", "   343\t        numeric_only: bool = False,\r\n"]
[277.207216, "o", "   344\t        numba_args: tuple[Any, ...] = (),\r\n"]
[277.224686, "o", "   345\t        **kwargs,\r\n"]
[277.242155, "o", "   346\t    ):\r\n"]
[277.259625, "o", "   347\t        \"\"\"\r\n"]
[277.277095, "o", "   348\t        Rolling statistical measure using supplied function.\r\n"]
[277.294565, "o", "   349\t\r\n"]
[277.312035, "o", "   350\t        Designed to be used with passed-in Cython array-based functions.\r\n"]
[277.329505, "o", "   351\t\r\n"]
[277.346975, "o", "   352\t        Parameters\r\n"]
[277.364445, "o", "   353\t        ----------\r\n"]
[277.381915, "o", "   354\t        func : callable function to apply\r\n"]
[277.399385, "o", "   355\t        name : str,\r\n"]
[277.416855, "o", "   356\t        numba_args : tuple\r\n"]
[277.434325, "o", "   357\t            args to be passed when func is a numba func\r\n"]
[277.451795, "o", "   358\t        **kwargs\r\n"]
[277.469265, "o", "   359\t            additional arguments for rolling function and window function\r\n"]
[277.486735, "o", "   360\t\r\n"]
[277.504205, "o", "   361\t        Returns\r\n"]
[277.521675, "o", "   362\t        -------\r\n"]
[277.539145, "o", "   363\t        y : type of input\r\n"]
[277.556615, "o", "   364\t        \"\"\"\r\n"]
[277.574085, "o", "   365\t        window_indexer = self._get_window_indexer()\r\n"]
[277.591555, "o", "   366\t        min_periods = (\r\n"]
[277.609025, "o", "   367\t            self.min_periods\r\n"]
[277.626495, "o", "   368\t            if self.min_periods is not None\r\n"]
[277.643965, "o", "   369\t            else window_indexer.window_size\r\n"]
[277.661435, "o", "   370\t        )\r\n"]
[277.678905, "o", "   371\t\r\n"]
[277.696375, "o", "   372\t        def homogeneous_func(values: np.ndarray):\r\n"]
[277.713845, "o", "   373\t            # calculation function\r\n"]
[277.731314, "o", "   374\t\r\n"]
[277.748784, "o", "   375\t            if values.size == 0:\r\n"]
[277.766254, "o", "   376\t                return values.copy()\r\n"]
[277.783724, "o", "   377\t\r\n"]
[277.801194, "o", "   378\t            def calc(x):\r\n"]
[277.818664, "o", "   379\t                start, end = window_indexer.get_window_bounds(\r\n"]
[277.836134, "o", "   380\t                    num_values=len(x),\r\n"]
[277.853604, "o", "   381\t                    min_periods=min_periods,\r\n"]
[277.871074, "o", "   382\t                    center=self.center,\r\n"]
[277.888544, "o", "   383\t                    closed=self.closed,\r\n"]
[277.906014, "o", "   384\t                    step=self.step,\r\n"]
[277.923484, "o", "   385\t                )\r\n"]
[277.940954, "o", "   386\t                self._check_window_bounds(start, end, len(x))\r\n"]
[277.958424, "o", "   387\t\r\n"]
[277.975894, "o", "   388\t                return func(x, start, end, min_periods, *numba_args)\r\n"]
[277.993364, "o", "   389\t\r\n"]
[278.010834, "o", "   390\t            with np.errstate(all=\"ignore\"):\r\n"]
[278.028304, "o", "   391\t                result = calc(values)\r\n"]
[278.045774, "o", "   392\t\r\n"]
[278.063244, "o", "   393\t            return result\r\n"]
[278.080714, "o", "   394\t\r\n"]
[278.098184, "o", "   395\t        if self.method == \"single\":\r\n"]
[278.115654, "o", "   396\t            return self._apply_blockwise(homogeneous_func, name, numeric_only)\r\n"]
[278.133124, "o", "   397\t        else:\r\n"]
[278.150594, "o", "   398\t            return self._apply_tablewise(homogeneous_func, name, numeric_only)\r\n"]
[278.168064, "o", "   399\t\r\n"]
[278.185534, "o", "   400\t    def _numba_apply(\r\n"]
[278.203004, "o", "   401\t        self,\r\n"]
[278.220473, "o", "   402\t        func: Callable[..., Any],\r\n"]
[278.237943, "o", "   403\t        engine_kwargs: dict[str, bool] | None = None,\r\n"]
[278.255413, "o", "   404\t        *func_args,\r\n"]
[278.272883, "o", "   405\t    ):\r\n"]
[278.290353, "o", "   406\t        window_indexer = self._get_window_indexer()\r\n"]
[278.307823, "o", "   407\t        min_periods = (\r\n"]
[278.325293, "o", "   408\t            self.min_periods\r\n"]
[278.342763, "o", "   409\t            if self.min_periods is not None\r\n"]
[278.360233, "o", "   410\t            else window_indexer.window_size\r\n"]
[278.377703, "o", "   411\t        )\r\n"]
[278.395173, "o", "   412\t        obj = self._create_data(self._selected_obj)\r\n"]
[278.412643, "o", "   413\t        if self.axis == 1:\r\n"]
[278.430113, "o", "   414\t            obj = obj.T\r\n"]
[278.447583, "o", "   415\t        values = self._prep_values(obj.to_numpy())\r\n"]
[278.465053, "o", "   416\t        if values.ndim == 1:\r\n"]
[278.482523, "o", "   417\t            values = values.reshape(-1, 1)\r\n"]
[278.499993, "o", "   418\t        start, end = window_indexer.get_window_bounds(\r\n"]
[278.517463, "o", "   419\t            num_values=len(values),\r\n"]
[278.534933, "o", "   420\t            min_periods=min_periods,\r\n"]
[278.552403, "o", "   421\t            center=self.center,\r\n"]
[278.569873, "o", "   422\t            closed=self.closed,\r\n"]
[278.587343, "o", "   423\t            step=self.step,\r\n"]
[278.604813, "o", "   424\t        )\r\n"]
[278.622283, "o", "   425\t        self._check_window_bounds(start, end, len(values))\r\n"]
[278.639753, "o", "   426\t        aggregator = executor.generate_shared_aggregator(\r\n"]
[278.657223, "o", "   427\t            func, **get_jit_arguments(engine_kwargs)\r\n"]
[278.674693, "o", "   428\t        )\r\n"]
[278.692163, "o", "   429\t        result = aggregator(values, start, end, min_periods, *func_args)\r\n"]
[278.709633, "o", "   430\t        result = result.T if self.axis == 1 else result\r\n"]
[278.727102, "o", "   431\t        index = self._slice_axis_for_step(obj.index, result)\r\n"]
[278.744572, "o", "   432\t        if obj.ndim == 1:\r\n"]
[278.762042, "o", "   433\t            result = result.squeeze()\r\n"]
[278.779512, "o", "   434\t            out = obj._constructor(result, index=index, name=obj.name)\r\n"]
[278.796982, "o", "   435\t            return out\r\n"]
[278.814452, "o", "   436\t        else:\r\n"]
[278.831922, "o", "   437\t            columns = self._slice_axis_for_step(obj.columns, result.T)\r\n"]
[278.849392, "o", "   438\t            out = obj._constructor(result, index=index, columns=columns)\r\n"]
[278.866862, "o", "   439\t            return self._resolve_output(out, obj)\r\n"]
[278.884332, "o", "   440\t\r\n"]
[278.901802, "o", "   441\t    def aggregate(self, func, *args, **kwargs):\r\n"]
[278.919272, "o", "   442\t        result = ResamplerWindowApply(self, func, args=args, kwargs=kwargs).agg()\r\n"]
[278.936742, "o", "   443\t        if result is None:\r\n"]
[278.954212, "o", "   444\t            return self.apply(func, raw=False, args=args, kwargs=kwargs)\r\n"]
[278.971682, "o", "   445\t        return result\r\n"]
[278.989152, "o", "   446\t\r\n"]
[279.006622, "o", "   447\t    agg = aggregate\r\n"]
[279.024092, "o", "   448\t\r\n"]
[279.041562, "o", "   449\t\r\n"]
[279.059032, "o", "   450\tclass BaseWindowGroupby(BaseWindow):\r\n"]
[279.076502, "o", "   451\t    \"\"\"\r\n"]
[279.093972, "o", "   452\t    Provide the groupby windowing facilities.\r\n"]
[279.111442, "o", "   453\t    \"\"\"\r\n"]
[279.128912, "o", "   454\t\r\n"]
[279.146382, "o", "   455\t    _grouper: BaseGrouper\r\n"]
[279.163852, "o", "   456\t    _as_index: bool\r\n"]
[279.181322, "o", "   457\t    _attributes: list[str] = [\"_grouper\"]\r\n"]
[279.198792, "o", "   458\t\r\n"]
[279.216261, "o", "   459\t    def __init__(\r\n"]
[279.233731, "o", "   460\t        self,\r\n"]
[279.251201, "o", "   461\t        obj: DataFrame | Series,\r\n"]
[279.268671, "o", "   462\t        *args,\r\n"]
[279.286141, "o", "   463\t        _grouper: BaseGrouper,\r\n"]
[279.303611, "o", "   464\t        _as_index: bool = True,\r\n"]
[279.321081, "o", "   465\t        **kwargs,\r\n"]
[279.338551, "o", "   466\t    ) -> None:\r\n"]
[279.356021, "o", "   467\t        from pandas.core.groupby.ops import BaseGrouper\r\n"]
[279.373491, "o", "   468\t\r\n"]
[279.390961, "o", "   469\t        if not isinstance(_grouper, BaseGrouper):\r\n"]
[279.408431, "o", "   470\t            raise ValueError(\"Must pass a BaseGrouper object.\")\r\n"]
[279.425901, "o", "   471\t        self._grouper = _grouper\r\n"]
[279.443371, "o", "   472\t        self._as_index = _as_index\r\n"]
[279.460841, "o", "   473\t        # GH 32262: It's convention to keep the grouping column in\r\n"]
[279.478311, "o", "   474\t        # groupby.<agg_func>, but unexpected to users in\r\n"]
[279.495781, "o", "   475\t        # groupby.rolling.<agg_func>\r\n"]
[279.513251, "o", "   476\t        obj = obj.drop(columns=self._grouper.names, errors=\"ignore\")\r\n"]
[279.530721, "o", "   477\t        # GH 15354\r\n"]
[279.548191, "o", "   478\t        if kwargs.get(\"step\") is not None:\r\n"]
[279.565661, "o", "   479\t            raise NotImplementedError(\"step not implemented for groupby\")\r\n"]
[279.583131, "o", "   480\t        super().__init__(obj, *args, **kwargs)\r\n"]
[279.600601, "o", "   481\t\r\n"]
[279.618071, "o", "   482\t    def _apply(\r\n"]
[279.635541, "o", "   483\t        self,\r\n"]
[279.653011, "o", "   484\t        func: Callable[..., Any],\r\n"]
[279.670481, "o", "   485\t        name: str,\r\n"]
[279.687951, "o", "   486\t        numeric_only: bool = False,\r\n"]
[279.70542, "o", "   487\t        numba_args: tuple[Any, ...] = (),\r\n"]
[279.72289, "o", "   488\t        **kwargs,\r\n"]
[279.74036, "o", "   489\t    ) -> DataFrame | Series:\r\n"]
[279.75783, "o", "   490\t        result = super()._apply(\r\n"]
[279.7753, "o", "   491\t            func,\r\n"]
[279.79277, "o", "   492\t            name,\r\n"]
[279.81024, "o", "   493\t            numeric_only,\r\n"]
[279.82771, "o", "   494\t            numba_args,\r\n"]
[279.84518, "o", "   495\t            **kwargs,\r\n"]
[279.86265, "o", "   496\t        )\r\n"]
[279.88012, "o", "   497\t        # Reconstruct the resulting MultiIndex\r\n"]
[279.89759, "o", "   498\t        # 1st set of levels = group by labels\r\n"]
[279.91506, "o", "   499\t        # 2nd set of levels = original DataFrame/Series index\r\n"]
[279.93253, "o", "   500\t        grouped_object_index = self.obj.index\r\n"]
[280.0, "o", "(asv_3.8) root@cb2cc1765c92:/workspace/repo/asv_bench# "]
[280.002, "i", "python - << 'PY'\r"]
[280.004, "o", "python - << 'PY'\r\n"]
[280.115867, "o", "\u001b[?2004l\r\n"]
[280.225733, "o", "\u001b[?2004h> import io,sys,re\r\n"]
[280.3356, "o", "\u001b[?2004l\r\n"]
[280.445467, "o", "\u001b[?2004h> p='../pandas/core/window/rolling.py'\r\n"]
[280.555333, "o", "\u001b[?2004l\r\n"]
[280.6652, "o", "\u001b[?2004h> s=open(p,'r',encoding='utf-8').read()\r\n"]
[280.775067, "o", "\u001b[?2004l\r\n"]
[280.884933, "o", "\u001b[?2004h> # 1) Add _groupby_order attribute in __init__ if not present\r\n"]
[280.9948, "o", "\u001b[?2004l\r\n"]
[281.104667, "o", "\u001b[?2004h> s=s.replace('self._win_freq_i8: int | None = None','self._win_freq_i8: int | None = None\\n        # Cache for group order indexer (np.intp)\\n        self._grou\r\n"]
[281.214533, "o", "upby_order: np.ndarray | None = None')\r\n"]
[281.3244, "o", "\u001b[?2004l\r\n"]
[281.434267, "o", "\u001b[?2004h> # 2) Optimize _create_data: cache groupby_order and ensure np.intp dtype\r\n"]
[281.544133, "o", "\u001b[?2004l\r\n"]
[281.654, "o", "\u001b[?2004h> s=re.sub(r\"if not obj.empty:\\n\\s*groupby_order = np\\.concatenate\\(list\\(self\\._grouper\\.indices\\.values\\(\\)\\)\\)\\.astype\\(\\n\\s*np\\.int64\\n\\s*\\)\\n\\s*obj = obj\\.t\r\n"]
[281.763867, "o", "take\\(groupby_order\\)\",\r\n"]
[281.873733, "o", "\u001b[?2004l\r\n"]
[281.9836, "o", "\u001b[?2004h>          \"if not obj.empty:\\n            group_indices = self._grouper.indices.values()\\n            if group_indices:\\n                groupby_order = np.conc\r\n"]
[282.093467, "o", "catenate(list(group_indices))\\n                if groupby_order.dtype != np.intp:\\n                    groupby_order = groupby_order.astype(np.intp, copy=False)\\\r\n"]
[282.203333, "o", "\\n            else:\\n                groupby_order = np.array([], dtype=np.intp)\\n            self._groupby_order = groupby_order\\n            obj = obj.take(gro\r\n"]
[282.3132, "o", "oupby_order)\", s)\r\n"]
[282.423067, "o", "\u001b[?2004l\r\n"]
[282.532933, "o", "\u001b[?2004h> # 3) Reuse cached indexer and avoid repeat when repeat_by==1\r\n"]
[282.6428, "o", "\u001b[?2004l\r\n"]
[282.752667, "o", "\u001b[?2004h> s=s.replace(\r\n"]
[282.862533, "o", "\u001b[?2004l\r\n"]
[282.9724, "o", "\u001b[?2004h>     'group_indices = self._grouper.indices.values()\\n            if group_indices:\\n                indexer = np.concatenate(list(group_indices))\\n            \r\n"]
[283.082267, "o", " else:\\n                indexer = np.array([], dtype=np.intp)\\n\\n            if target.ndim == 1:\\n                repeat_by = 1\\n            else:\\n            \r\n"]
[283.192133, "o", "     repeat_by = len(target.columns)\\n            groupby_codes = [\\n                np.repeat(c.take(indexer), repeat_by) for c in groupby_codes\\n            ]'\r\n"]
[283.302, "o", "',\r\n"]
[283.411867, "o", "\u001b[?2004l\r\n"]
[283.521733, "o", "\u001b[?2004h>     'cached = getattr(self, \"_groupby_order\", None)\\n            if cached is not None:\\n                indexer = cached\\n            else:\\n                g\r\n"]
[283.6316, "o", "group_indices = self._grouper.indices.values()\\n                if group_indices:\\n                    indexer = np.concatenate(list(group_indices))\\n           \r\n"]
[283.741467, "o", "          if indexer.dtype != np.intp:\\n                        indexer = indexer.astype(np.intp, copy=False)\\n                else:\\n                    indexer\r\n"]
[283.851333, "o", "r = np.array([], dtype=np.intp)\\n\\n            if target.ndim == 1:\\n                repeat_by = 1\\n            else:\\n                repeat_by = len(target.col\r\n"]
[283.9612, "o", "lumns)\\n            if repeat_by == 1:\\n                groupby_codes = [c.take(indexer) for c in groupby_codes]\\n            else:\\n                groupby_code\r\n"]
[284.071067, "o", "es = [\\n                    np.repeat(c.take(indexer), repeat_by) for c in groupby_codes\\n                ]')\r\n"]
[284.180933, "o", "\u001b[?2004l\r\n"]
[284.2908, "o", "\u001b[?2004h> open(p,'w',encoding='utf-8').write(s)\r\n"]
[284.400667, "o", "\u001b[?2004l\r\n"]
[284.510533, "o", "\u001b[?2004h> print('Patched',p)\r\n"]
[284.6204, "o", "\u001b[?2004l\r\n"]
[284.730267, "o", "\u001b[?2004h> PY\r\n"]
[284.840133, "o", "\u001b[?2004l\r\n"]
[285.0, "o", "(asv_3.8) root@cb2cc1765c92:/workspace/repo/asv_bench# "]
[285.002, "i", "python - << 'PY'\r"]
[285.004, "o", "python - << 'PY'\r\n"]
[285.074667, "o", "\u001b[?2004l\r\n"]
[285.143333, "o", "\u001b[?2004h> from pathlib import Path\r\n"]
[285.212, "o", "\u001b[?2004l\r\n"]
[285.280667, "o", "\u001b[?2004h> p=Path('../pandas/core/window/rolling.py')\r\n"]
[285.349333, "o", "\u001b[?2004l\r\n"]
[285.418, "o", "\u001b[?2004h> print('---- snippet around _create_data ----')\r\n"]
[285.486667, "o", "\u001b[?2004l\r\n"]
[285.555333, "o", "\u001b[?2004h> print('\\n'.join(p.read_text().splitlines()[300:360]))\r\n"]
[285.624, "o", "\u001b[?2004l\r\n"]
[285.692667, "o", "\u001b[?2004h> PY\r\n"]
[285.761333, "o", "\u001b[?2004l\r\n"]
[285.83, "o", "---- snippet around _create_data ----\r\n"]
[285.898667, "o", "        kwargs = {attr: getattr(self, attr) for attr in self._attributes}\r\n"]
[285.967333, "o", "\r\n"]
[286.036, "o", "        selection = None\r\n"]
[286.104667, "o", "        if subset.ndim == 2 and (\r\n"]
[286.173333, "o", "            (is_scalar(key) and key in subset) or is_list_like(key)\r\n"]
[286.242, "o", "        ):\r\n"]
[286.310667, "o", "            selection = key\r\n"]
[286.379333, "o", "        elif subset.ndim == 1 and is_scalar(key) and key == subset.name:\r\n"]
[286.448, "o", "            selection = key\r\n"]
[286.516667, "o", "\r\n"]
[286.585333, "o", "        new_win = type(self)(subset, selection=selection, **kwargs)\r\n"]
[286.654, "o", "        return new_win\r\n"]
[286.722667, "o", "\r\n"]
[286.791333, "o", "    def __getattr__(self, attr: str):\r\n"]
[286.86, "o", "        if attr in self._internal_names_set:\r\n"]
[286.928667, "o", "            return object.__getattribute__(self, attr)\r\n"]
[286.997333, "o", "        if attr in self.obj:\r\n"]
[287.066, "o", "            return self[attr]\r\n"]
[287.134667, "o", "\r\n"]
[287.203333, "o", "        raise AttributeError(\r\n"]
[287.272, "o", "            f\"'{type(self).__name__}' object has no attribute '{attr}'\"\r\n"]
[287.340667, "o", "        )\r\n"]
[287.409333, "o", "\r\n"]
[287.478, "o", "    def _dir_additions(self):\r\n"]
[287.546667, "o", "        return self.obj._dir_additions()\r\n"]
[287.615333, "o", "\r\n"]
[287.684, "o", "    def __repr__(self) -> str:\r\n"]
[287.752667, "o", "        \"\"\"\r\n"]
[287.821333, "o", "        Provide a nice str repr of our rolling object.\r\n"]
[287.89, "o", "        \"\"\"\r\n"]
[287.958667, "o", "        attrs_list = (\r\n"]
[288.027333, "o", "            f\"{attr_name}={getattr(self, attr_name)}\"\r\n"]
[288.096, "o", "            for attr_name in self._attributes\r\n"]
[288.164667, "o", "            if getattr(self, attr_name, None) is not None and attr_name[0] != \"_\"\r\n"]
[288.233333, "o", "        )\r\n"]
[288.302, "o", "        attrs = \",\".join(attrs_list)\r\n"]
[288.370667, "o", "        return f\"{type(self).__name__} [{attrs}]\"\r\n"]
[288.439333, "o", "\r\n"]
[288.508, "o", "    def __iter__(self) -> Iterator:\r\n"]
[288.576667, "o", "        obj = self._selected_obj.set_axis(self._on)\r\n"]
[288.645333, "o", "        obj = self._create_data(obj)\r\n"]
[288.714, "o", "        indexer = self._get_window_indexer()\r\n"]
[288.782667, "o", "\r\n"]
[288.851333, "o", "        start, end = indexer.get_window_bounds(\r\n"]
[288.92, "o", "            num_values=len(obj),\r\n"]
[288.988667, "o", "            min_periods=self.min_periods,\r\n"]
[289.057333, "o", "            center=self.center,\r\n"]
[289.126, "o", "            closed=self.closed,\r\n"]
[289.194667, "o", "            step=self.step,\r\n"]
[289.263333, "o", "        )\r\n"]
[289.332, "o", "        self._check_window_bounds(start, end, len(obj))\r\n"]
[289.400667, "o", "\r\n"]
[289.469333, "o", "        for s, e in zip(start, end):\r\n"]
[289.538, "o", "            result = obj.iloc[slice(s, e)]\r\n"]
[289.606667, "o", "            yield result\r\n"]
[289.675333, "o", "\r\n"]
[289.744, "o", "    def _prep_values(self, values: ArrayLike) -> np.ndarray:\r\n"]
[289.812667, "o", "        \"\"\"Convert input to numpy arrays for Cython routines\"\"\"\r\n"]
[289.881333, "o", "        if needs_i8_conversion(values.dtype):\r\n"]
[290.0, "o", "(asv_3.8) root@cb2cc1765c92:/workspace/repo/asv_bench# "]
[290.002, "i", "python - << 'PY'\r"]
[290.004, "o", "python - << 'PY'\r\n"]
[290.418, "o", "\u001b[?2004l\r\n"]
[290.83, "o", "\u001b[?2004h> from pathlib import Path\r\n"]
[291.242, "o", "\u001b[?2004l\r\n"]
[291.654, "o", "\u001b[?2004h> text=Path('../pandas/core/window/rolling.py').read_text()\r\n"]
[292.066, "o", "\u001b[?2004l\r\n"]
[292.478, "o", "\u001b[?2004h> start=text.find('result.index = MultiIndex')\r\n"]
[292.89, "o", "\u001b[?2004l\r\n"]
[293.302, "o", "\u001b[?2004h> print(text[start-260:start+200] if start!=-1 else 'not found')\r\n"]
[293.714, "o", "\u001b[?2004l\r\n"]
[294.126, "o", "\u001b[?2004h> PY\r\n"]
[294.538, "o", "\u001b[?2004l\r\n"]
[295.0, "o", "(asv_3.8) root@cb2cc1765c92:/workspace/repo/asv_bench# "]
[295.002, "i", "asv run --python=same --bench=\"rolling.GroupbyLargeGroups.time_rolling_multiindex_creation\" --quick\r"]
[295.004, "o", "asv run --python=same --bench=\"rolling.GroupbyLargeGroups.time_rolling_multiindex_creation\" --quick\r\n"]
[295.9948, "o", "\u001b[?2004l\r\n"]
[296.9836, "o", "\u00b7 \u001b[0;32mDiscovering benchmarks\u001b[0m\r\n"]
[297.9724, "o", "\u00b7 \u001b[0;32mRunning 1 total benchmarks (1 commits * 1 environments * 1 benchmarks)\u001b[0m\r\n"]
[298.9612, "o", "[ 0.00%] \u00b7\u00b7 \u001b[0;34mBenchmarking existing-py_opt_conda_envs_asv_3.8_bin_python\u001b[0m\r\n"]
[300.0, "o", "(asv_3.8) root@cb2cc1765c92:/workspace/repo/asv_bench# "]
[300.002, "i", "grep -n \"indices.values\\|np.repeat\\|groupby_codes\\|verify_integrity=False\\|MultiIndex(\" ../pandas/core/win\r"]
[300.004, "o", "grep -n \"indices.values\\|np.repeat\\|groupby_codes\\|verify_integrity=False\\|MultiIndex(\" ../pandas/core/win\r\n"]
[300.241429, "o", "ndow/rolling.py\r\n"]
[300.476857, "o", "\u001b[?2004l\r\n"]
[300.712286, "o", "\u001b[32m\u001b[K503\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K            \u001b[01;31m\u001b[Kverify_integrity=False\u001b[m\u001b[K,\r\n"]
[300.947714, "o", "\u001b[32m\u001b[K739\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K        group_indices = self._grouper.\u001b[01;31m\u001b[Kindices.values\u001b[m\u001b[K()\r\n"]
[301.183143, "o", "\u001b[32m\u001b[K755\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K        result_index = \u001b[01;31m\u001b[KMultiIndex(\u001b[m\u001b[K\r\n"]
[301.418571, "o", "\u001b[32m\u001b[K756\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K            levels, codes, names=result_index_names, \u001b[01;31m\u001b[Kverify_integrity=False\u001b[m\u001b[K\r\n"]
[301.654, "o", "\u001b[32m\u001b[K780\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K            len(group) == len(other) for group in self._grouper.\u001b[01;31m\u001b[Kindices.values\u001b[m\u001b[K()\r\n"]
[301.889429, "o", "\u001b[32m\u001b[K790\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K                    for gb_indices in self._grouper.\u001b[01;31m\u001b[Kindices.values\u001b[m\u001b[K()\r\n"]
[302.124857, "o", "\u001b[32m\u001b[K797\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K            \u001b[01;31m\u001b[Kgroupby_codes\u001b[m\u001b[K = []\r\n"]
[302.360286, "o", "\u001b[32m\u001b[K801\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K                labels = \u001b[01;31m\u001b[Knp.repeat\u001b[m\u001b[K(np.array(gb_level_pair), old_result_len)\r\n"]
[302.595714, "o", "\u001b[32m\u001b[K803\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K                \u001b[01;31m\u001b[Kgroupby_codes\u001b[m\u001b[K.append(codes)\r\n"]
[302.831143, "o", "\u001b[32m\u001b[K808\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K            \u001b[01;31m\u001b[Kgroupby_codes\u001b[m\u001b[K = self._grouper.codes\r\n"]
[303.066571, "o", "\u001b[32m\u001b[K817\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K                group_indices = self._grouper.\u001b[01;31m\u001b[Kindices.values\u001b[m\u001b[K()\r\n"]
[303.302, "o", "\u001b[32m\u001b[K830\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K                \u001b[01;31m\u001b[Kgroupby_codes\u001b[m\u001b[K = [c.take(indexer) for c in \u001b[01;31m\u001b[Kgroupby_codes\u001b[m\u001b[K]\r\n"]
[303.537429, "o", "\u001b[32m\u001b[K832\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K                \u001b[01;31m\u001b[Kgroupby_codes\u001b[m\u001b[K = [\r\n"]
[303.772857, "o", "\u001b[32m\u001b[K833\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K                    \u001b[01;31m\u001b[Knp.repeat\u001b[m\u001b[K(c.take(indexer), repeat_by) for c in \u001b[01;31m\u001b[Kgroupby_codes\u001b[m\u001b[K\r\n"]
[304.008286, "o", "\u001b[32m\u001b[K847\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K        result_codes = \u001b[01;31m\u001b[Kgroupby_codes\u001b[m\u001b[K + result_codes\r\n"]
[304.243714, "o", "\u001b[32m\u001b[K851\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K        result_index = \u001b[01;31m\u001b[KMultiIndex(\u001b[m\u001b[K\r\n"]
[304.479143, "o", "\u001b[32m\u001b[K852\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K            result_levels, result_codes, names=result_names, \u001b[01;31m\u001b[Kverify_integrity=False\u001b[m\u001b[K\r\n"]
[304.714571, "o", "\u001b[32m\u001b[K865\u001b[m\u001b[K\u001b[36m\u001b[K:\u001b[m\u001b[K            group_indices = self._grouper.\u001b[01;31m\u001b[Kindices.values\u001b[m\u001b[K()\r\n"]
[305.0, "o", "(asv_3.8) root@cb2cc1765c92:/workspace/repo/asv_bench# "]
[305.002, "i", "sed -n '1,220p' ../pandas/core/window/rolling.py | nl -ba | sed -n '1,220p'\r"]
[305.004, "o", "sed -n '1,220p' ../pandas/core/window/rolling.py | nl -ba | sed -n '1,220p'\r\n"]
[305.028371, "o", "\u001b[?2004l\r\n"]
[305.050742, "o", "     1\t\"\"\"\r\n"]
[305.073113, "o", "     2\tProvide a generic structure to support window functions,\r\n"]
[305.095484, "o", "     3\tsimilar to how we have a Groupby object.\r\n"]
[305.117855, "o", "     4\t\"\"\"\r\n"]
[305.140226, "o", "     5\tfrom __future__ import annotations\r\n"]
[305.162597, "o", "     6\t\r\n"]
[305.184968, "o", "     7\timport copy\r\n"]
[305.207339, "o", "     8\tfrom datetime import timedelta\r\n"]
[305.22971, "o", "     9\tfrom functools import partial\r\n"]
[305.252081, "o", "    10\timport inspect\r\n"]
[305.274452, "o", "    11\tfrom textwrap import dedent\r\n"]
[305.296824, "o", "    12\tfrom typing import (\r\n"]
[305.319195, "o", "    13\t    TYPE_CHECKING,\r\n"]
[305.341566, "o", "    14\t    Any,\r\n"]
[305.363937, "o", "    15\t    Callable,\r\n"]
[305.386308, "o", "    16\t    Hashable,\r\n"]
[305.408679, "o", "    17\t    Iterator,\r\n"]
[305.43105, "o", "    18\t    Sized,\r\n"]
[305.453421, "o", "    19\t    cast,\r\n"]
[305.475792, "o", "    20\t)\r\n"]
[305.498163, "o", "    21\t\r\n"]
[305.520534, "o", "    22\timport numpy as np\r\n"]
[305.542905, "o", "    23\t\r\n"]
[305.565276, "o", "    24\tfrom pandas._libs.tslibs import (\r\n"]
[305.587647, "o", "    25\t    BaseOffset,\r\n"]
[305.610018, "o", "    26\t    to_offset,\r\n"]
[305.632389, "o", "    27\t)\r\n"]
[305.65476, "o", "    28\timport pandas._libs.window.aggregations as window_aggregations\r\n"]
[305.677131, "o", "    29\tfrom pandas._typing import (\r\n"]
[305.699502, "o", "    30\t    ArrayLike,\r\n"]
[305.721873, "o", "    31\t    Axis,\r\n"]
[305.744244, "o", "    32\t    NDFrameT,\r\n"]
[305.766615, "o", "    33\t    QuantileInterpolation,\r\n"]
[305.788986, "o", "    34\t    WindowingRankType,\r\n"]
[305.811357, "o", "    35\t)\r\n"]
[305.833729, "o", "    36\tfrom pandas.compat._optional import import_optional_dependency\r\n"]
[305.8561, "o", "    37\tfrom pandas.errors import DataError\r\n"]
[305.878471, "o", "    38\tfrom pandas.util._decorators import doc\r\n"]
[305.900842, "o", "    39\t\r\n"]
[305.923213, "o", "    40\tfrom pandas.core.dtypes.common import (\r\n"]
[305.945584, "o", "    41\t    ensure_float64,\r\n"]
[305.967955, "o", "    42\t    is_bool,\r\n"]
[305.990326, "o", "    43\t    is_integer,\r\n"]
[306.012697, "o", "    44\t    is_list_like,\r\n"]
[306.035068, "o", "    45\t    is_numeric_dtype,\r\n"]
[306.057439, "o", "    46\t    is_scalar,\r\n"]
[306.07981, "o", "    47\t    needs_i8_conversion,\r\n"]
[306.102181, "o", "    48\t)\r\n"]
[306.124552, "o", "    49\tfrom pandas.core.dtypes.generic import (\r\n"]
[306.146923, "o", "    50\t    ABCDataFrame,\r\n"]
[306.169294, "o", "    51\t    ABCSeries,\r\n"]
[306.191665, "o", "    52\t)\r\n"]
[306.214036, "o", "    53\tfrom pandas.core.dtypes.missing import notna\r\n"]
[306.236407, "o", "    54\t\r\n"]
[306.258778, "o", "    55\tfrom pandas.core._numba import executor\r\n"]
[306.281149, "o", "    56\tfrom pandas.core.algorithms import factorize\r\n"]
[306.30352, "o", "    57\tfrom pandas.core.apply import ResamplerWindowApply\r\n"]
[306.325891, "o", "    58\tfrom pandas.core.arrays import ExtensionArray\r\n"]
[306.348262, "o", "    59\tfrom pandas.core.base import SelectionMixin\r\n"]
[306.370633, "o", "    60\timport pandas.core.common as com\r\n"]
[306.393005, "o", "    61\tfrom pandas.core.indexers.objects import (\r\n"]
[306.415376, "o", "    62\t    BaseIndexer,\r\n"]
[306.437747, "o", "    63\t    FixedWindowIndexer,\r\n"]
[306.460118, "o", "    64\t    GroupbyIndexer,\r\n"]
[306.482489, "o", "    65\t    VariableWindowIndexer,\r\n"]
[306.50486, "o", "    66\t)\r\n"]
[306.527231, "o", "    67\tfrom pandas.core.indexes.api import (\r\n"]
[306.549602, "o", "    68\t    DatetimeIndex,\r\n"]
[306.571973, "o", "    69\t    Index,\r\n"]
[306.594344, "o", "    70\t    MultiIndex,\r\n"]
[306.616715, "o", "    71\t    PeriodIndex,\r\n"]
[306.639086, "o", "    72\t    TimedeltaIndex,\r\n"]
[306.661457, "o", "    73\t)\r\n"]
[306.683828, "o", "    74\tfrom pandas.core.reshape.concat import concat\r\n"]
[306.706199, "o", "    75\tfrom pandas.core.util.numba_ import (\r\n"]
[306.72857, "o", "    76\t    get_jit_arguments,\r\n"]
[306.750941, "o", "    77\t    maybe_use_numba,\r\n"]
[306.773312, "o", "    78\t)\r\n"]
[306.795683, "o", "    79\tfrom pandas.core.window.common import (\r\n"]
[306.818054, "o", "    80\t    flex_binary_moment,\r\n"]
[306.840425, "o", "    81\t    zsqrt,\r\n"]
[306.862796, "o", "    82\t)\r\n"]
[306.885167, "o", "    83\tfrom pandas.core.window.doc import (\r\n"]
[306.907538, "o", "    84\t    _shared_docs,\r\n"]
[306.92991, "o", "    85\t    create_section_header,\r\n"]
[306.952281, "o", "    86\t    kwargs_numeric_only,\r\n"]
[306.974652, "o", "    87\t    kwargs_scipy,\r\n"]
[306.997023, "o", "    88\t    numba_notes,\r\n"]
[307.019394, "o", "    89\t    template_header,\r\n"]
[307.041765, "o", "    90\t    template_returns,\r\n"]
[307.064136, "o", "    91\t    template_see_also,\r\n"]
[307.086507, "o", "    92\t    window_agg_numba_parameters,\r\n"]
[307.108878, "o", "    93\t    window_apply_parameters,\r\n"]
[307.131249, "o", "    94\t)\r\n"]
[307.15362, "o", "    95\tfrom pandas.core.window.numba_ import (\r\n"]
[307.175991, "o", "    96\t    generate_manual_numpy_nan_agg_with_axis,\r\n"]
[307.198362, "o", "    97\t    generate_numba_apply_func,\r\n"]
[307.220733, "o", "    98\t    generate_numba_table_func,\r\n"]
[307.243104, "o", "    99\t)\r\n"]
[307.265475, "o", "   100\t\r\n"]
[307.287846, "o", "   101\tif TYPE_CHECKING:\r\n"]
[307.310217, "o", "   102\t    from pandas import (\r\n"]
[307.332588, "o", "   103\t        DataFrame,\r\n"]
[307.354959, "o", "   104\t        Series,\r\n"]
[307.37733, "o", "   105\t    )\r\n"]
[307.399701, "o", "   106\t    from pandas.core.generic import NDFrame\r\n"]
[307.422072, "o", "   107\t    from pandas.core.groupby.ops import BaseGrouper\r\n"]
[307.444443, "o", "   108\t\r\n"]
[307.466814, "o", "   109\t\r\n"]
[307.489186, "o", "   110\tclass BaseWindow(SelectionMixin):\r\n"]
[307.511557, "o", "   111\t    \"\"\"Provides utilities for performing windowing operations.\"\"\"\r\n"]
[307.533928, "o", "   112\t\r\n"]
[307.556299, "o", "   113\t    _attributes: list[str] = []\r\n"]
[307.57867, "o", "   114\t    exclusions: frozenset[Hashable] = frozenset()\r\n"]
[307.601041, "o", "   115\t    _on: Index\r\n"]
[307.623412, "o", "   116\t\r\n"]
[307.645783, "o", "   117\t    def __init__(\r\n"]
[307.668154, "o", "   118\t        self,\r\n"]
[307.690525, "o", "   119\t        obj: NDFrame,\r\n"]
[307.712896, "o", "   120\t        window=None,\r\n"]
[307.735267, "o", "   121\t        min_periods: int | None = None,\r\n"]
[307.757638, "o", "   122\t        center: bool | None = False,\r\n"]
[307.780009, "o", "   123\t        win_type: str | None = None,\r\n"]
[307.80238, "o", "   124\t        axis: Axis = 0,\r\n"]
[307.824751, "o", "   125\t        on: str | Index | None = None,\r\n"]
[307.847122, "o", "   126\t        closed: str | None = None,\r\n"]
[307.869493, "o", "   127\t        step: int | None = None,\r\n"]
[307.891864, "o", "   128\t        method: str = \"single\",\r\n"]
[307.914235, "o", "   129\t        *,\r\n"]
[307.936606, "o", "   130\t        selection=None,\r\n"]
[307.958977, "o", "   131\t    ) -> None:\r\n"]
[307.981348, "o", "   132\t        self.obj = obj\r\n"]
[308.003719, "o", "   133\t        self.on = on\r\n"]
[308.02609, "o", "   134\t        self.closed = closed\r\n"]
[308.048462, "o", "   135\t        self.step = step\r\n"]
[308.070833, "o", "   136\t        self.window = window\r\n"]
[308.093204, "o", "   137\t        self.min_periods = min_periods\r\n"]
[308.115575, "o", "   138\t        self.center = center\r\n"]
[308.137946, "o", "   139\t        self.win_type = win_type\r\n"]
[308.160317, "o", "   140\t        self.axis = obj._get_axis_number(axis) if axis is not None else None\r\n"]
[308.182688, "o", "   141\t        self.method = method\r\n"]
[308.205059, "o", "   142\t        self._win_freq_i8: int | None = None\r\n"]
[308.22743, "o", "   143\t        # Cache for group order indexer (np.intp)\r\n"]
[308.249801, "o", "   144\t        self._groupby_order: np.ndarray | None = None\r\n"]
[308.272172, "o", "   145\t        if self.on is None:\r\n"]
[308.294543, "o", "   146\t            if self.axis == 0:\r\n"]
[308.316914, "o", "   147\t                self._on = self.obj.index\r\n"]
[308.339285, "o", "   148\t            else:\r\n"]
[308.361656, "o", "   149\t                # i.e. self.axis == 1\r\n"]
[308.384027, "o", "   150\t                self._on = self.obj.columns\r\n"]
[308.406398, "o", "   151\t        elif isinstance(self.on, Index):\r\n"]
[308.428769, "o", "   152\t            self._on = self.on\r\n"]
[308.45114, "o", "   153\t        elif isinstance(self.obj, ABCDataFrame) and self.on in self.obj.columns:\r\n"]
[308.473511, "o", "   154\t            self._on = Index(self.obj[self.on])\r\n"]
[308.495882, "o", "   155\t        else:\r\n"]
[308.518253, "o", "   156\t            raise ValueError(\r\n"]
[308.540624, "o", "   157\t                f\"invalid on specified as {self.on}, \"\r\n"]
[308.562995, "o", "   158\t                \"must be a column (of DataFrame), an Index or None\"\r\n"]
[308.585367, "o", "   159\t            )\r\n"]
[308.607738, "o", "   160\t\r\n"]
[308.630109, "o", "   161\t        self._selection = selection\r\n"]
[308.65248, "o", "   162\t        self._validate()\r\n"]
[308.674851, "o", "   163\t\r\n"]
[308.697222, "o", "   164\t    def _validate(self) -> None:\r\n"]
[308.719593, "o", "   165\t        if self.center is not None and not is_bool(self.center):\r\n"]
[308.741964, "o", "   166\t            raise ValueError(\"center must be a boolean\")\r\n"]
[308.764335, "o", "   167\t        if self.min_periods is not None:\r\n"]
[308.786706, "o", "   168\t            if not is_integer(self.min_periods):\r\n"]
[308.809077, "o", "   169\t                raise ValueError(\"min_periods must be an integer\")\r\n"]
[308.831448, "o", "   170\t            if self.min_periods < 0:\r\n"]
[308.853819, "o", "   171\t                raise ValueError(\"min_periods must be >= 0\")\r\n"]
[308.87619, "o", "   172\t            if is_integer(self.window) and self.min_periods > self.window:\r\n"]
[308.898561, "o", "   173\t                raise ValueError(\r\n"]
[308.920932, "o", "   174\t                    f\"min_periods {self.min_periods} must be <= window {self.window}\"\r\n"]
[308.943303, "o", "   175\t                )\r\n"]
[308.965674, "o", "   176\t        if self.closed is not None and self.closed not in [\r\n"]
[308.988045, "o", "   177\t            \"right\",\r\n"]
[309.010416, "o", "   178\t            \"both\",\r\n"]
[309.032787, "o", "   179\t            \"left\",\r\n"]
[309.055158, "o", "   180\t            \"neither\",\r\n"]
[309.077529, "o", "   181\t        ]:\r\n"]
[309.0999, "o", "   182\t            raise ValueError(\"closed must be 'right', 'left', 'both' or 'neither'\")\r\n"]
[309.122271, "o", "   183\t        if not isinstance(self.obj, (ABCSeries, ABCDataFrame)):\r\n"]
[309.144643, "o", "   184\t            raise TypeError(f\"invalid type: {type(self)}\")\r\n"]
[309.167014, "o", "   185\t        if isinstance(self.window, BaseIndexer):\r\n"]
[309.189385, "o", "   186\t            # Validate that the passed BaseIndexer subclass has\r\n"]
[309.211756, "o", "   187\t            # a get_window_bounds with the correct signature.\r\n"]
[309.234127, "o", "   188\t            get_window_bounds_signature = inspect.signature(\r\n"]
[309.256498, "o", "   189\t                self.window.get_window_bounds\r\n"]
[309.278869, "o", "   190\t            ).parameters.keys()\r\n"]
[309.30124, "o", "   191\t            expected_signature = inspect.signature(\r\n"]
[309.323611, "o", "   192\t                BaseIndexer().get_window_bounds\r\n"]
[309.345982, "o", "   193\t            ).parameters.keys()\r\n"]
[309.368353, "o", "   194\t            if get_window_bounds_signature != expected_signature:\r\n"]
[309.390724, "o", "   195\t                raise ValueError(\r\n"]
[309.413095, "o", "   196\t                    f\"{type(self.window).__name__} does not implement \"\r\n"]
[309.435466, "o", "   197\t                    f\"the correct signature for get_window_bounds\"\r\n"]
[309.457837, "o", "   198\t                )\r\n"]
[309.480208, "o", "   199\t        if self.method not in [\"table\", \"single\"]:\r\n"]
[309.502579, "o", "   200\t            raise ValueError(\"method must be 'table' or 'single\")\r\n"]
[309.52495, "o", "   201\t        if self.step is not None:\r\n"]
[309.547321, "o", "   202\t            if not is_integer(self.step):\r\n"]
[309.569692, "o", "   203\t                raise ValueError(\"step must be an integer\")\r\n"]
[309.592063, "o", "   204\t            if self.step < 0:\r\n"]
[309.614434, "o", "   205\t                raise ValueError(\"step must be >= 0\")\r\n"]
[309.636805, "o", "   206\t\r\n"]
[309.659176, "o", "   207\t    def _check_window_bounds(\r\n"]
[309.681548, "o", "   208\t        self, start: np.ndarray, end: np.ndarray, num_vals: int\r\n"]
[309.703919, "o", "   209\t    ) -> None:\r\n"]
[309.72629, "o", "   210\t        if len(start) != len(end):\r\n"]
[309.748661, "o", "   211\t            raise ValueError(\r\n"]
[309.771032, "o", "   212\t                f\"start ({len(start)}) and end ({len(end)}) bounds must be the \"\r\n"]
[309.793403, "o", "   213\t                f\"same length\"\r\n"]
[309.815774, "o", "   214\t            )\r\n"]
[309.838145, "o", "   215\t        if len(start) != (num_vals + (self.step or 1) - 1) // (self.step or 1):\r\n"]
[309.860516, "o", "   216\t            raise ValueError(\r\n"]
[309.882887, "o", "   217\t                f\"start and end bounds ({len(start)}) must be the same length \"\r\n"]
[309.905258, "o", "   218\t                f\"as the object ({num_vals}) divided by the step ({self.step}) \"\r\n"]
[309.927629, "o", "   219\t                f\"if given and rounded up\"\r\n"]
[310.0, "o", "(asv_3.8) root@cb2cc1765c92:/workspace/repo/asv_bench# "]
[310.002, "i", "sed -n '220,720p' ../pandas/core/window/rolling.py | nl -ba | sed -n '220,720p'\r"]
[310.004, "o", "sed -n '220,720p' ../pandas/core/window/rolling.py | nl -ba | sed -n '220,720p'\r\n"]
[310.02347, "o", "\u001b[?2004l\r\n"]
[310.04094, "o", "   220\t        self, homogeneous_func: Callable[..., ArrayLike], name: str | None = None\r\n"]
[310.05841, "o", "   221\t    ) -> Series:\r\n"]
[310.07588, "o", "   222\t        \"\"\"\r\n"]
[310.09335, "o", "   223\t        Series version of _apply_blockwise\r\n"]
[310.11082, "o", "   224\t        \"\"\"\r\n"]
[310.12829, "o", "   225\t        obj = self._create_data(self._selected_obj)\r\n"]
[310.14576, "o", "   226\t\r\n"]
[310.16323, "o", "   227\t        if name == \"count\":\r\n"]
[310.1807, "o", "   228\t            # GH 12541: Special case for count where we support date-like types\r\n"]
[310.19817, "o", "   229\t            obj = notna(obj).astype(int)\r\n"]
[310.21564, "o", "   230\t        try:\r\n"]
[310.23311, "o", "   231\t            values = self._prep_values(obj._values)\r\n"]
[310.25058, "o", "   232\t        except (TypeError, NotImplementedError) as err:\r\n"]
[310.268049, "o", "   233\t            raise DataError(\"No numeric types to aggregate\") from err\r\n"]
[310.285519, "o", "   234\t\r\n"]
[310.302989, "o", "   235\t        result = homogeneous_func(values)\r\n"]
[310.320459, "o", "   236\t        index = self._slice_axis_for_step(obj.index, result)\r\n"]
[310.337929, "o", "   237\t        return obj._constructor(result, index=index, name=obj.name)\r\n"]
[310.355399, "o", "   238\t\r\n"]
[310.372869, "o", "   239\t    def _apply_blockwise(\r\n"]
[310.390339, "o", "   240\t        self,\r\n"]
[310.407809, "o", "   241\t        homogeneous_func: Callable[..., ArrayLike],\r\n"]
[310.425279, "o", "   242\t        name: str,\r\n"]
[310.442749, "o", "   243\t        numeric_only: bool = False,\r\n"]
[310.460219, "o", "   244\t    ) -> DataFrame | Series:\r\n"]
[310.477689, "o", "   245\t        \"\"\"\r\n"]
[310.495159, "o", "   246\t        Apply the given function to the DataFrame broken down into homogeneous\r\n"]
[310.512629, "o", "   247\t        sub-frames.\r\n"]
[310.530099, "o", "   248\t        \"\"\"\r\n"]
[310.547569, "o", "   249\t        self._validate_numeric_only(name, numeric_only)\r\n"]
[310.565039, "o", "   250\t        if self._selected_obj.ndim == 1:\r\n"]
[310.582509, "o", "   251\t            return self._apply_series(homogeneous_func, name)\r\n"]
[310.599979, "o", "   252\t\r\n"]
[310.617449, "o", "   253\t        obj = self._create_data(self._selected_obj, numeric_only)\r\n"]
[310.634919, "o", "   254\t        if name == \"count\":\r\n"]
[310.652389, "o", "   255\t            # GH 12541: Special case for count where we support date-like types\r\n"]
[310.669859, "o", "   256\t            obj = notna(obj).astype(int)\r\n"]
[310.687329, "o", "   257\t            obj._mgr = obj._mgr.consolidate()\r\n"]
[310.704799, "o", "   258\t\r\n"]
[310.722269, "o", "   259\t        if self.axis == 1:\r\n"]
[310.739739, "o", "   260\t            obj = obj.T\r\n"]
[310.757208, "o", "   261\t\r\n"]
[310.774678, "o", "   262\t        taker = []\r\n"]
[310.792148, "o", "   263\t        res_values = []\r\n"]
[310.809618, "o", "   264\t        for i, arr in enumerate(obj._iter_column_arrays()):\r\n"]
[310.827088, "o", "   265\t            # GH#42736 operate column-wise instead of block-wise\r\n"]
[310.844558, "o", "   266\t            # As of 2.0, hfunc will raise for nuisance columns\r\n"]
[310.862028, "o", "   267\t            try:\r\n"]
[310.879498, "o", "   268\t                arr = self._prep_values(arr)\r\n"]
[310.896968, "o", "   269\t            except (TypeError, NotImplementedError) as err:\r\n"]
[310.914438, "o", "   270\t                raise DataError(\r\n"]
[310.931908, "o", "   271\t                    f\"Cannot aggregate non-numeric type: {arr.dtype}\"\r\n"]
[310.949378, "o", "   272\t                ) from err\r\n"]
[310.966848, "o", "   273\t            res = homogeneous_func(arr)\r\n"]
[310.984318, "o", "   274\t            res_values.append(res)\r\n"]
[311.001788, "o", "   275\t            taker.append(i)\r\n"]
[311.019258, "o", "   276\t\r\n"]
[311.036728, "o", "   277\t        index = self._slice_axis_for_step(\r\n"]
[311.054198, "o", "   278\t            obj.index, res_values[0] if len(res_values) > 0 else None\r\n"]
[311.071668, "o", "   279\t        )\r\n"]
[311.089138, "o", "   280\t        df = type(obj)._from_arrays(\r\n"]
[311.106608, "o", "   281\t            res_values,\r\n"]
[311.124078, "o", "   282\t            index=index,\r\n"]
[311.141548, "o", "   283\t            columns=obj.columns.take(taker),\r\n"]
[311.159018, "o", "   284\t            verify_integrity=False,\r\n"]
[311.176488, "o", "   285\t        )\r\n"]
[311.193958, "o", "   286\t\r\n"]
[311.211428, "o", "   287\t        if self.axis == 1:\r\n"]
[311.228898, "o", "   288\t            df = df.T\r\n"]
[311.246367, "o", "   289\t\r\n"]
[311.263837, "o", "   290\t        return self._resolve_output(df, obj)\r\n"]
[311.281307, "o", "   291\t\r\n"]
[311.298777, "o", "   292\t    def _apply_tablewise(\r\n"]
[311.316247, "o", "   293\t        self,\r\n"]
[311.333717, "o", "   294\t        homogeneous_func: Callable[..., ArrayLike],\r\n"]
[311.351187, "o", "   295\t        name: str | None = None,\r\n"]
[311.368657, "o", "   296\t        numeric_only: bool = False,\r\n"]
[311.386127, "o", "   297\t    ) -> DataFrame | Series:\r\n"]
[311.403597, "o", "   298\t        \"\"\"\r\n"]
[311.421067, "o", "   299\t        Apply the given function to the DataFrame across the entire object\r\n"]
[311.438537, "o", "   300\t        \"\"\"\r\n"]
[311.456007, "o", "   301\t        if self._selected_obj.ndim == 1:\r\n"]
[311.473477, "o", "   302\t            raise ValueError(\"method='table' not applicable for Series objects.\")\r\n"]
[311.490947, "o", "   303\t        obj = self._create_data(self._selected_obj, numeric_only)\r\n"]
[311.508417, "o", "   304\t        values = self._prep_values(obj.to_numpy())\r\n"]
[311.525887, "o", "   305\t        values = values.T if self.axis == 1 else values\r\n"]
[311.543357, "o", "   306\t        result = homogeneous_func(values)\r\n"]
[311.560827, "o", "   307\t        result = result.T if self.axis == 1 else result\r\n"]
[311.578297, "o", "   308\t        index = self._slice_axis_for_step(obj.index, result)\r\n"]
[311.595767, "o", "   309\t        columns = (\r\n"]
[311.613237, "o", "   310\t            obj.columns\r\n"]
[311.630707, "o", "   311\t            if result.shape[1] == len(obj.columns)\r\n"]
[311.648177, "o", "   312\t            else obj.columns[:: self.step]\r\n"]
[311.665647, "o", "   313\t        )\r\n"]
[311.683117, "o", "   314\t        out = obj._constructor(result, index=index, columns=columns)\r\n"]
[311.700587, "o", "   315\t\r\n"]
[311.718057, "o", "   316\t        return self._resolve_output(out, obj)\r\n"]
[311.735527, "o", "   317\t\r\n"]
[311.752996, "o", "   318\t    def _apply_pairwise(\r\n"]
[311.770466, "o", "   319\t        self,\r\n"]
[311.787936, "o", "   320\t        target: DataFrame | Series,\r\n"]
[311.805406, "o", "   321\t        other: DataFrame | Series | None,\r\n"]
[311.822876, "o", "   322\t        pairwise: bool | None,\r\n"]
[311.840346, "o", "   323\t        func: Callable[[DataFrame | Series, DataFrame | Series], DataFrame | Series],\r\n"]
[311.857816, "o", "   324\t        numeric_only: bool,\r\n"]
[311.875286, "o", "   325\t    ) -> DataFrame | Series:\r\n"]
[311.892756, "o", "   326\t        \"\"\"\r\n"]
[311.910226, "o", "   327\t        Apply the given pairwise function given 2 pandas objects (DataFrame/Series)\r\n"]
[311.927696, "o", "   328\t        \"\"\"\r\n"]
[311.945166, "o", "   329\t        target = self._create_data(target, numeric_only)\r\n"]
[311.962636, "o", "   330\t        if other is None:\r\n"]
[311.980106, "o", "   331\t            other = target\r\n"]
[311.997576, "o", "   332\t            # only default unset\r\n"]
[312.015046, "o", "   333\t            pairwise = True if pairwise is None else pairwise\r\n"]
[312.032516, "o", "   334\t        elif not isinstance(other, (ABCDataFrame, ABCSeries)):\r\n"]
[312.049986, "o", "   335\t            raise ValueError(\"other must be a DataFrame or Series\")\r\n"]
[312.067456, "o", "   336\t        elif other.ndim == 2 and numeric_only:\r\n"]
[312.084926, "o", "   337\t            other = self._make_numeric_only(other)\r\n"]
[312.102396, "o", "   338\t\r\n"]
[312.119866, "o", "   339\t        return flex_binary_moment(target, other, func, pairwise=bool(pairwise))\r\n"]
[312.137336, "o", "   340\t\r\n"]
[312.154806, "o", "   341\t    def _apply(\r\n"]
[312.172276, "o", "   342\t        self,\r\n"]
[312.189746, "o", "   343\t        func: Callable[..., Any],\r\n"]
[312.207216, "o", "   344\t        name: str,\r\n"]
[312.224686, "o", "   345\t        numeric_only: bool = False,\r\n"]
[312.242155, "o", "   346\t        numba_args: tuple[Any, ...] = (),\r\n"]
[312.259625, "o", "   347\t        **kwargs,\r\n"]
[312.277095, "o", "   348\t    ):\r\n"]
[312.294565, "o", "   349\t        \"\"\"\r\n"]
[312.312035, "o", "   350\t        Rolling statistical measure using supplied function.\r\n"]
[312.329505, "o", "   351\t\r\n"]
[312.346975, "o", "   352\t        Designed to be used with passed-in Cython array-based functions.\r\n"]
[312.364445, "o", "   353\t\r\n"]
[312.381915, "o", "   354\t        Parameters\r\n"]
[312.399385, "o", "   355\t        ----------\r\n"]
[312.416855, "o", "   356\t        func : callable function to apply\r\n"]
[312.434325, "o", "   357\t        name : str,\r\n"]
[312.451795, "o", "   358\t        numba_args : tuple\r\n"]
[312.469265, "o", "   359\t            args to be passed when func is a numba func\r\n"]
[312.486735, "o", "   360\t        **kwargs\r\n"]
[312.504205, "o", "   361\t            additional arguments for rolling function and window function\r\n"]
[312.521675, "o", "   362\t\r\n"]
[312.539145, "o", "   363\t        Returns\r\n"]
[312.556615, "o", "   364\t        -------\r\n"]
[312.574085, "o", "   365\t        y : type of input\r\n"]
[312.591555, "o", "   366\t        \"\"\"\r\n"]
[312.609025, "o", "   367\t        window_indexer = self._get_window_indexer()\r\n"]
[312.626495, "o", "   368\t        min_periods = (\r\n"]
[312.643965, "o", "   369\t            self.min_periods\r\n"]
[312.661435, "o", "   370\t            if self.min_periods is not None\r\n"]
[312.678905, "o", "   371\t            else window_indexer.window_size\r\n"]
[312.696375, "o", "   372\t        )\r\n"]
[312.713845, "o", "   373\t\r\n"]
[312.731314, "o", "   374\t        def homogeneous_func(values: np.ndarray):\r\n"]
[312.748784, "o", "   375\t            # calculation function\r\n"]
[312.766254, "o", "   376\t\r\n"]
[312.783724, "o", "   377\t            if values.size == 0:\r\n"]
[312.801194, "o", "   378\t                return values.copy()\r\n"]
[312.818664, "o", "   379\t\r\n"]
[312.836134, "o", "   380\t            def calc(x):\r\n"]
[312.853604, "o", "   381\t                start, end = window_indexer.get_window_bounds(\r\n"]
[312.871074, "o", "   382\t                    num_values=len(x),\r\n"]
[312.888544, "o", "   383\t                    min_periods=min_periods,\r\n"]
[312.906014, "o", "   384\t                    center=self.center,\r\n"]
[312.923484, "o", "   385\t                    closed=self.closed,\r\n"]
[312.940954, "o", "   386\t                    step=self.step,\r\n"]
[312.958424, "o", "   387\t                )\r\n"]
[312.975894, "o", "   388\t                self._check_window_bounds(start, end, len(x))\r\n"]
[312.993364, "o", "   389\t\r\n"]
[313.010834, "o", "   390\t                return func(x, start, end, min_periods, *numba_args)\r\n"]
[313.028304, "o", "   391\t\r\n"]
[313.045774, "o", "   392\t            with np.errstate(all=\"ignore\"):\r\n"]
[313.063244, "o", "   393\t                result = calc(values)\r\n"]
[313.080714, "o", "   394\t\r\n"]
[313.098184, "o", "   395\t            return result\r\n"]
[313.115654, "o", "   396\t\r\n"]
[313.133124, "o", "   397\t        if self.method == \"single\":\r\n"]
[313.150594, "o", "   398\t            return self._apply_blockwise(homogeneous_func, name, numeric_only)\r\n"]
[313.168064, "o", "   399\t        else:\r\n"]
[313.185534, "o", "   400\t            return self._apply_tablewise(homogeneous_func, name, numeric_only)\r\n"]
[313.203004, "o", "   401\t\r\n"]
[313.220473, "o", "   402\t    def _numba_apply(\r\n"]
[313.237943, "o", "   403\t        self,\r\n"]
[313.255413, "o", "   404\t        func: Callable[..., Any],\r\n"]
[313.272883, "o", "   405\t        engine_kwargs: dict[str, bool] | None = None,\r\n"]
[313.290353, "o", "   406\t        *func_args,\r\n"]
[313.307823, "o", "   407\t    ):\r\n"]
[313.325293, "o", "   408\t        window_indexer = self._get_window_indexer()\r\n"]
[313.342763, "o", "   409\t        min_periods = (\r\n"]
[313.360233, "o", "   410\t            self.min_periods\r\n"]
[313.377703, "o", "   411\t            if self.min_periods is not None\r\n"]
[313.395173, "o", "   412\t            else window_indexer.window_size\r\n"]
[313.412643, "o", "   413\t        )\r\n"]
[313.430113, "o", "   414\t        obj = self._create_data(self._selected_obj)\r\n"]
[313.447583, "o", "   415\t        if self.axis == 1:\r\n"]
[313.465053, "o", "   416\t            obj = obj.T\r\n"]
[313.482523, "o", "   417\t        values = self._prep_values(obj.to_numpy())\r\n"]
[313.499993, "o", "   418\t        if values.ndim == 1:\r\n"]
[313.517463, "o", "   419\t            values = values.reshape(-1, 1)\r\n"]
[313.534933, "o", "   420\t        start, end = window_indexer.get_window_bounds(\r\n"]
[313.552403, "o", "   421\t            num_values=len(values),\r\n"]
[313.569873, "o", "   422\t            min_periods=min_periods,\r\n"]
[313.587343, "o", "   423\t            center=self.center,\r\n"]
[313.604813, "o", "   424\t            closed=self.closed,\r\n"]
[313.622283, "o", "   425\t            step=self.step,\r\n"]
[313.639753, "o", "   426\t        )\r\n"]
[313.657223, "o", "   427\t        self._check_window_bounds(start, end, len(values))\r\n"]
[313.674693, "o", "   428\t        aggregator = executor.generate_shared_aggregator(\r\n"]
[313.692163, "o", "   429\t            func, **get_jit_arguments(engine_kwargs)\r\n"]
[313.709633, "o", "   430\t        )\r\n"]
[313.727102, "o", "   431\t        result = aggregator(values, start, end, min_periods, *func_args)\r\n"]
[313.744572, "o", "   432\t        result = result.T if self.axis == 1 else result\r\n"]
[313.762042, "o", "   433\t        index = self._slice_axis_for_step(obj.index, result)\r\n"]
[313.779512, "o", "   434\t        if obj.ndim == 1:\r\n"]
[313.796982, "o", "   435\t            result = result.squeeze()\r\n"]
[313.814452, "o", "   436\t            out = obj._constructor(result, index=index, name=obj.name)\r\n"]
[313.831922, "o", "   437\t            return out\r\n"]
[313.849392, "o", "   438\t        else:\r\n"]
[313.866862, "o", "   439\t            columns = self._slice_axis_for_step(obj.columns, result.T)\r\n"]
[313.884332, "o", "   440\t            out = obj._constructor(result, index=index, columns=columns)\r\n"]
[313.901802, "o", "   441\t            return self._resolve_output(out, obj)\r\n"]
[313.919272, "o", "   442\t\r\n"]
[313.936742, "o", "   443\t    def aggregate(self, func, *args, **kwargs):\r\n"]
[313.954212, "o", "   444\t        result = ResamplerWindowApply(self, func, args=args, kwargs=kwargs).agg()\r\n"]
[313.971682, "o", "   445\t        if result is None:\r\n"]
[313.989152, "o", "   446\t            return self.apply(func, raw=False, args=args, kwargs=kwargs)\r\n"]
[314.006622, "o", "   447\t        return result\r\n"]
[314.024092, "o", "   448\t\r\n"]
[314.041562, "o", "   449\t    agg = aggregate\r\n"]
[314.059032, "o", "   450\t\r\n"]
[314.076502, "o", "   451\t\r\n"]
[314.093972, "o", "   452\tclass BaseWindowGroupby(BaseWindow):\r\n"]
[314.111442, "o", "   453\t    \"\"\"\r\n"]
[314.128912, "o", "   454\t    Provide the groupby windowing facilities.\r\n"]
[314.146382, "o", "   455\t    \"\"\"\r\n"]
[314.163852, "o", "   456\t\r\n"]
[314.181322, "o", "   457\t    _grouper: BaseGrouper\r\n"]
[314.198792, "o", "   458\t    _as_index: bool\r\n"]
[314.216261, "o", "   459\t    _attributes: list[str] = [\"_grouper\"]\r\n"]
[314.233731, "o", "   460\t\r\n"]
[314.251201, "o", "   461\t    def __init__(\r\n"]
[314.268671, "o", "   462\t        self,\r\n"]
[314.286141, "o", "   463\t        obj: DataFrame | Series,\r\n"]
[314.303611, "o", "   464\t        *args,\r\n"]
[314.321081, "o", "   465\t        _grouper: BaseGrouper,\r\n"]
[314.338551, "o", "   466\t        _as_index: bool = True,\r\n"]
[314.356021, "o", "   467\t        **kwargs,\r\n"]
[314.373491, "o", "   468\t    ) -> None:\r\n"]
[314.390961, "o", "   469\t        from pandas.core.groupby.ops import BaseGrouper\r\n"]
[314.408431, "o", "   470\t\r\n"]
[314.425901, "o", "   471\t        if not isinstance(_grouper, BaseGrouper):\r\n"]
[314.443371, "o", "   472\t            raise ValueError(\"Must pass a BaseGrouper object.\")\r\n"]
[314.460841, "o", "   473\t        self._grouper = _grouper\r\n"]
[314.478311, "o", "   474\t        self._as_index = _as_index\r\n"]
[314.495781, "o", "   475\t        # GH 32262: It's convention to keep the grouping column in\r\n"]
[314.513251, "o", "   476\t        # groupby.<agg_func>, but unexpected to users in\r\n"]
[314.530721, "o", "   477\t        # groupby.rolling.<agg_func>\r\n"]
[314.548191, "o", "   478\t        obj = obj.drop(columns=self._grouper.names, errors=\"ignore\")\r\n"]
[314.565661, "o", "   479\t        # GH 15354\r\n"]
[314.583131, "o", "   480\t        if kwargs.get(\"step\") is not None:\r\n"]
[314.600601, "o", "   481\t            raise NotImplementedError(\"step not implemented for groupby\")\r\n"]
[314.618071, "o", "   482\t        super().__init__(obj, *args, **kwargs)\r\n"]
[314.635541, "o", "   483\t\r\n"]
[314.653011, "o", "   484\t    def _apply(\r\n"]
[314.670481, "o", "   485\t        self,\r\n"]
[314.687951, "o", "   486\t        func: Callable[..., Any],\r\n"]
[314.70542, "o", "   487\t        name: str,\r\n"]
[314.72289, "o", "   488\t        numeric_only: bool = False,\r\n"]
[314.74036, "o", "   489\t        numba_args: tuple[Any, ...] = (),\r\n"]
[314.75783, "o", "   490\t        **kwargs,\r\n"]
[314.7753, "o", "   491\t    ) -> DataFrame | Series:\r\n"]
[314.79277, "o", "   492\t        result = super()._apply(\r\n"]
[314.81024, "o", "   493\t            func,\r\n"]
[314.82771, "o", "   494\t            name,\r\n"]
[314.84518, "o", "   495\t            numeric_only,\r\n"]
[314.86265, "o", "   496\t            numba_args,\r\n"]
[314.88012, "o", "   497\t            **kwargs,\r\n"]
[314.89759, "o", "   498\t        )\r\n"]
[314.91506, "o", "   499\t        # Reconstruct the resulting MultiIndex\r\n"]
[314.93253, "o", "   500\t        # 1st set of levels = group by labels\r\n"]
[315.0, "o", "(asv_3.8) root@cb2cc1765c92:/workspace/repo/asv_bench# "]
[315.002, "i", "python - << 'PY'\r"]
[315.004, "o", "python - << 'PY'\r\n"]
[315.151412, "o", "\u001b[?2004l\r\n"]
[315.296824, "o", "\u001b[?2004h> from pathlib import Path\r\n"]
[315.442235, "o", "\u001b[?2004l\r\n"]
[315.587647, "o", "\u001b[?2004h> import re\r\n"]
[315.733059, "o", "\u001b[?2004l\r\n"]
[315.878471, "o", "\u001b[?2004h> p = Path('../pandas/core/window/rolling.py')\r\n"]
[316.023882, "o", "\u001b[?2004l\r\n"]
[316.169294, "o", "\u001b[?2004h> s = p.read_text()\r\n"]
[316.314706, "o", "\u001b[?2004l\r\n"]
[316.460118, "o", "\u001b[?2004h> # Force np.asarray(dtype=np.intp) for groupby_codes after take to avoid downstream dtype conversion\r\n"]
[316.605529, "o", "\u001b[?2004l\r\n"]
[316.750941, "o", "\u001b[?2004h> pattern = re.compile(r\"groupby_codes = \\[\\n\\s*c\\.take\\(indexer\\) for c in groupby_codes\\n\\s*\\]\")\r\n"]
[316.896353, "o", "\u001b[?2004l\r\n"]
[317.041765, "o", "\u001b[?2004h> if pattern.search(s):\r\n"]
[317.187176, "o", "\u001b[?2004l\r\n"]
[317.332588, "o", "\u001b[?2004h>     s = pattern.sub(\"groupby_codes = [\\n                (c.take(indexer) if isinstance(c, (list, tuple)) else\\n                 (c.take(indexer).to_numpy(dtype\r\n"]
[317.478, "o", "e=np.intp, copy=False) if hasattr(c.take(indexer), 'to_numpy') else\\n                  (c.take(indexer).astype(np.intp, copy=False) if hasattr(c.take(indexer), '\r\n"]
[317.623412, "o", "'astype') else c.take(indexer))))\\n                for c in groupby_codes\\n            ]\", s)\r\n"]
[317.768824, "o", "\u001b[?2004l\r\n"]
[317.914235, "o", "\u001b[?2004h> else:\r\n"]
[318.059647, "o", "\u001b[?2004l\r\n"]
[318.205059, "o", "\u001b[?2004h>     # Try a simpler generic replacement to wrap take(indexer) with np.asarray(..., dtype=np.intp)\r\n"]
[318.350471, "o", "\u001b[?2004l\r\n"]
[318.495882, "o", "\u001b[?2004h>     s = s.replace('c.take(indexer)', 'np.asarray(c.take(indexer), dtype=np.intp)')\r\n"]
[318.641294, "o", "\u001b[?2004l\r\n"]
[318.786706, "o", "\u001b[?2004h> \r\n"]
[318.932118, "o", "\u001b[?2004l\r\n"]
[319.077529, "o", "\u001b[?2004h> p.write_text(s)\r\n"]
[319.222941, "o", "\u001b[?2004l\r\n"]
[319.368353, "o", "\u001b[?2004h> print('Patched dtype conversion for groupby_codes if present')\r\n"]
[319.513765, "o", "\u001b[?2004l\r\n"]
[319.659176, "o", "\u001b[?2004h> PY\r\n"]
[319.804588, "o", "\u001b[?2004l\r\n"]
[320.0, "o", "(asv_3.8) root@cb2cc1765c92:/workspace/repo/asv_bench# "]
[320.002, "i", "asv run --python=same --bench=\"rolling.GroupbyLargeGroups.time_rolling_multiindex_creation\" --quick\r"]
[320.004, "o", "asv run --python=same --bench=\"rolling.GroupbyLargeGroups.time_rolling_multiindex_creation\" --quick\r\n"]
[320.9948, "o", "\u001b[?2004l\r\n"]
[321.9836, "o", "\u00b7 \u001b[0;32mDiscovering benchmarks\u001b[0m\r\n"]
[322.9724, "o", "\u00b7 \u001b[0;32mRunning 1 total benchmarks (1 commits * 1 environments * 1 benchmarks)\u001b[0m\r\n"]
[323.9612, "o", "[ 0.00%] \u00b7\u00b7 \u001b[0;34mBenchmarking existing-py_opt_conda_envs_asv_3.8_bin_python\u001b[0m\r\n"]
[325.0, "o", "(asv_3.8) root@cb2cc1765c92:/workspace/repo/asv_bench# "]
[325.002, "i", "git -C .. config user.email perf@example.com\r"]
[325.004, "o", "git -C .. config user.email perf@example.com\r\n"]
[325.006, "o", "\u001b[?2004l\r\n"]
[330.0, "o", "(asv_3.8) root@cb2cc1765c92:/workspace/repo/asv_bench# "]
[330.002, "i", "git -C .. config user.name \"ASV Perf Bot\"\r"]
[330.004, "o", "git -C .. config user.name \"ASV Perf Bot\"\r\n"]
[330.006, "o", "\u001b[?2004l\r\n"]
[335.0, "o", "(asv_3.8) root@cb2cc1765c92:/workspace/repo/asv_bench# "]
[335.002, "i", "git -C .. add pandas/core/window/rolling.py\r"]
[335.004, "o", "git -C .. add pandas/core/window/rolling.py\r\n"]
[335.006, "o", "\u001b[?2004l\r\n"]
[340.0, "o", "(asv_3.8) root@cb2cc1765c92:/workspace/repo/asv_bench# "]
[340.002, "i", "git -C .. commit -m \"Perf: speed up GroupBy.rolling paths by avoiding redundant casts/allocations, caching\r"]
[340.004, "o", "git -C .. commit -m \"Perf: speed up GroupBy.rolling paths by avoiding redundant casts/allocations, caching\r\n"]
[341.242, "o", "g group order indexer, and skipping repeats for 1D targets; ~10% faster on rolling.GroupbyLargeGroups\"\r\n"]
[342.478, "o", "\u001b[?2004l\r\n"]
[343.714, "o", "[main b2ec88178d] Perf: speed up GroupBy.rolling paths by avoiding redundant casts/allocations, caching group order indexer, and skipping repeats for 1D targets; ~10% faster on rolling.GroupbyLargeGroups\r\n"]
[345.0, "o", "(asv_3.8) root@cb2cc1765c92:/workspace/repo/asv_bench# "]
[345.002, "i", "python - << 'PY'\r"]
[345.004, "o", "python - << 'PY'\r\n"]
[345.139622, "o", "\u001b[?2004l\r\n"]
[345.273243, "o", "\u001b[?2004h> import numpy as np, pandas as pd\r\n"]
[345.406865, "o", "\u001b[?2004l\r\n"]
[345.540486, "o", "\u001b[?2004h> N=1000\r\n"]
[345.674108, "o", "\u001b[?2004l\r\n"]
[345.80773, "o", "\u001b[?2004h> df = pd.DataFrame({\r\n"]
[345.941351, "o", "\u001b[?2004l\r\n"]
[346.074973, "o", "\u001b[?2004h>     'A': [1,2]*(N//2),\r\n"]
[346.208595, "o", "\u001b[?2004l\r\n"]
[346.342216, "o", "\u001b[?2004h>     'B': np.random.randn(N)\r\n"]
[346.475838, "o", "\u001b[?2004l\r\n"]
[346.609459, "o", "\u001b[?2004h> })\r\n"]
[346.743081, "o", "\u001b[?2004l\r\n"]
[346.876703, "o", "\u001b[?2004h> res = df.groupby('A').rolling(3).mean()\r\n"]
[347.010324, "o", "\u001b[?2004l\r\n"]
[347.143946, "o", "\u001b[?2004h> assert isinstance(res.index, pd.MultiIndex)\r\n"]
[347.277568, "o", "\u001b[?2004l\r\n"]
[347.411189, "o", "\u001b[?2004h> # Expect same number of rows as original (each row belongs to a group)\r\n"]
[347.544811, "o", "\u001b[?2004l\r\n"]
[347.678432, "o", "\u001b[?2004h> assert len(res) == len(df)\r\n"]
[347.812054, "o", "\u001b[?2004l\r\n"]
[347.945676, "o", "\u001b[?2004h> # Sanity: first few should be NaN for min_periods default\r\n"]
[348.079297, "o", "\u001b[?2004l\r\n"]
[348.212919, "o", "\u001b[?2004h> print(res.head())\r\n"]
[348.346541, "o", "\u001b[?2004l\r\n"]
[348.480162, "o", "\u001b[?2004h> print('OK')\r\n"]
[348.613784, "o", "\u001b[?2004l\r\n"]
[348.747405, "o", "\u001b[?2004h> PY\r\n"]
[348.881027, "o", "\u001b[?2004l\r\n"]
[349.014649, "o", "            B\r\n"]
[349.14827, "o", "A            \r\n"]
[349.281892, "o", "1 0       NaN\r\n"]
[349.415514, "o", "  2       NaN\r\n"]
[349.549135, "o", "  4  0.674101\r\n"]
[349.682757, "o", "  6 -0.204657\r\n"]
[349.816378, "o", "  8 -0.315378\r\n"]
[350.0, "o", "(asv_3.8) root@cb2cc1765c92:/workspace/repo/asv_bench# "]
[350.002, "i", "asv run --python=same --bench=\"rolling.Groupby.*\" --quick\r"]
[350.004, "o", "asv run --python=same --bench=\"rolling.Groupby.*\" --quick\r\n"]
[350.136105, "o", "\u001b[?2004l\r\n"]
[350.266211, "o", "\u00b7 \u001b[0;32mDiscovering benchmarks\u001b[0m\r\n"]
[350.396316, "o", "\u00b7 \u001b[0;32mRunning 4 total benchmarks (1 commits * 1 environments * 4 benchmarks)\u001b[0m\r\n"]
[350.526421, "o", "[ 0.00%] \u00b7\u00b7 \u001b[0;34mBenchmarking existing-py_opt_conda_envs_asv_3.8_bin_python\u001b[0m\r\n"]
[350.656526, "o", "[12.50%] \u00b7\u00b7\u00b7 \u001b[0;39mrolling.Groupby.time_method\u001b[0m                                                                                                                     ok\r\n"]
[350.786632, "o", "[12.50%] \u00b7\u00b7\u00b7 \u001b[0;39m=========== ============================ ================================ ===================\u001b[0m\r\n"]
[350.916737, "o", "             --                                                param2                                     \r\n"]
[351.046842, "o", "             ----------- ---------------------------------------------------------------------------------\r\n"]
[351.176947, "o", "                param1    ('rolling', {'window': 2})   ('rolling', {'window': '30s'})   ('expanding', {}) \r\n"]
[351.307053, "o", "             =========== ============================ ================================ ===================\r\n"]
[351.437158, "o", "              'sum' (0)            43.5\u00b10ms                       17.9\u00b10ms                   17.4\u00b10ms     \r\n"]
[351.567263, "o", "                median             44.6\u00b10ms                       20.6\u00b10ms                   19.9\u00b10ms     \r\n"]
[351.697368, "o", "                 mean              43.9\u00b10ms                       17.8\u00b10ms                   17.2\u00b10ms     \r\n"]
[351.827474, "o", "                 max               42.6\u00b10ms                       18.2\u00b10ms                   17.7\u00b10ms     \r\n"]
[351.957579, "o", "                 min               42.7\u00b10ms                       17.9\u00b10ms                   17.6\u00b10ms     \r\n"]
[352.087684, "o", "                 kurt              42.8\u00b10ms                       17.9\u00b10ms                   19.1\u00b10ms     \r\n"]
[352.217789, "o", "              'sum' (1)            42.9\u00b10ms                       18.1\u00b10ms                   17.5\u00b10ms     \r\n"]
[352.347895, "o", "             =========== ============================ ================================ ===================\r\n"]
[352.478, "o", "\r\n"]
[352.608105, "o", "[25.00%] \u00b7\u00b7\u00b7 \u001b[0;39mrolling.GroupbyEWM.time_groupby_method\u001b[0m                                                                                                          ok\r\n"]
[352.738211, "o", "[25.00%] \u00b7\u00b7\u00b7 \u001b[0;39m======== ==========\u001b[0m\r\n"]
[352.868316, "o", "              method            \r\n"]
[352.998421, "o", "             -------- ----------\r\n"]
[353.128526, "o", "               var     2.11\u00b10ms \r\n"]
[353.258632, "o", "               std     2.46\u00b10ms \r\n"]
[353.388737, "o", "               cov     5.61\u00b10ms \r\n"]
[353.518842, "o", "               corr    5.67\u00b10ms \r\n"]
[353.648947, "o", "             ======== ==========\r\n"]
[353.779053, "o", "\r\n"]
[353.909158, "o", "[37.50%] \u00b7\u00b7\u00b7 \u001b[0;39mrolling.GroupbyEWMEngine.time_groupby_mean\u001b[0m                                                                                                      ok\r\n"]
[354.039263, "o", "[37.50%] \u00b7\u00b7\u00b7 \u001b[0;39m======== ==========\u001b[0m\r\n"]
[354.169368, "o", "              engine            \r\n"]
[354.299474, "o", "             -------- ----------\r\n"]
[354.429579, "o", "              cython   2.07\u00b10ms \r\n"]
[354.559684, "o", "              numba    643\u00b10ms  \r\n"]
[354.689789, "o", "             ======== ==========\r\n"]
[354.819895, "o", "\r\n"]
[355.0, "o", "(asv_3.8) root@cb2cc1765c92:/workspace/repo/asv_bench# "]
[355.002, "i", "\u001b[?2004l\r"]
[355.004, "o", "\u001b[?2004l\r\n"]
[357.478, "o", "\r\n"]
